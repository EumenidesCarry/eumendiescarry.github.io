<?xml version="1.0" encoding="utf-8"?>
<search>
  
  
  
  <entry>
    <title>Linux è¶…çº§å—å’Œ i-node</title>
    <link href="/2020/09/02/linux_super_inode_block/"/>
    <url>/2020/09/02/linux_super_inode_block/</url>
    
    <content type="html"><![CDATA[<h1 id="ä¸€ã€ä»ç‰©ç†ç£ç›˜åˆ°æ–‡ä»¶ç³»ç»Ÿ"><a href="#ä¸€ã€ä»ç‰©ç†ç£ç›˜åˆ°æ–‡ä»¶ç³»ç»Ÿ" class="headerlink" title="ä¸€ã€ä»ç‰©ç†ç£ç›˜åˆ°æ–‡ä»¶ç³»ç»Ÿ"></a>ä¸€ã€ä»ç‰©ç†ç£ç›˜åˆ°æ–‡ä»¶ç³»ç»Ÿ</h1><p>æ–‡ä»¶ç³»ç»Ÿç”¨æ¥å­˜å‚¨æ–‡ä»¶å†…å®¹ï¼Œæ–‡ä»¶å±æ€§å’Œç›®å½•ã€‚ä¸”åœ¨ Linux é‡Œä¸‡ç‰©ä¸ºæ–‡ä»¶</p><p>Linux æ–‡ä»¶ç³»ç»Ÿä¸­ï¼Œæ˜¯ä»¥å—ä¸ºå•ä½å­˜å‚¨ä¿¡æ¯ï¼ŒæŠŠç¡¬ç›˜åˆ†ä¸ºä¸‰ä¸ªéƒ¨åˆ†ï¼š<strong>è¶…çº§å—ï¼ˆSuper blockï¼‰</strong>ï¼Œ<strong>i-èŠ‚ç‚¹è¡¨ï¼ˆinode tableï¼‰</strong>ï¼Œ<strong>æ•°æ®å—ï¼ˆdata blockï¼‰</strong>ã€‚</p><p>è¦å®ç°æ–‡ä»¶ç³»ç»Ÿç»„ä»¶ï¼Œé¦–å…ˆéœ€è¦äº†è§£ SimpleFS ç£ç›˜å¸ƒå±€ã€‚å¦‚å‰æ‰€è¿°ï¼Œæ­¤é¡¹ç›®å‡å®šæ¯ä¸ªç£ç›˜å—çš„å¤§å°ä¸º4KBã€‚ç£ç›˜çš„ç¬¬ä¸€ä¸ªå—æ˜¯æè¿°æ–‡ä»¶ç³»ç»Ÿå…¶ä½™éƒ¨åˆ†å¸ƒå±€çš„è¶…çº§å—ã€‚è¶…çº§å—ä¹‹åçš„ä¸€å®šæ•°é‡çš„å—åŒ…å« inode æ•°æ®ç»“æ„(å³ i-node è¡¨)ã€‚é€šå¸¸ï¼Œç£ç›˜å—æ€»æ•°çš„10% ç”¨ä½œ inode å—(å³ä¿ç•™ç”¨äºå­˜å‚¨ inode è¡¨çš„å—)ã€‚æ–‡ä»¶ç³»ç»Ÿä¸­å‰©ä½™çš„å—ç”¨ä½œæ™®é€šæ•°æ®å—ï¼Œæœ‰æ—¶ç”¨ä½œé—´æ¥æŒ‡é’ˆå—ï¼Œå¦‚ä¸‹é¢çš„ä¾‹å­æ‰€ç¤º:</p><p><img src="/img/linux_super_inode_block/linux_inode_1.jpg"></p><p><strong>Magic</strong>: The first field is always the MAGIC_NUMBER or 0xf0f03410. The format routine places this number into the very first bytes of the superblock as a sort of filesystem â€œsignatureâ€. When the filesystem is mounted, the OS looks for this magic number. If it is correct, then the disk is assumed to contain a valid filesystem. If some other number is present, then the mount fails, perhaps because the disk is not formatted or contains some other kind of data.ï¼ˆç¬¬ä¸€ä¸ªå­—æ®µæ€»æ˜¯ MAGIC æ•°å­—æˆ–0xf0f03410ã€‚Format ä¾‹ç¨‹å°†è¿™ä¸ªæ•°å­—ä½œä¸ºä¸€ç§æ–‡ä»¶ç³»ç»Ÿâ€œç­¾åâ€æ”¾åœ¨è¶…çº§å—çš„æœ€åˆå­—èŠ‚ä¸­ã€‚å½“æ–‡ä»¶ç³»ç»Ÿè¢«å®‰è£…æ—¶ï¼Œæ“ä½œç³»ç»Ÿä¼šå¯»æ‰¾è¿™ä¸ªç¥å¥‡çš„æ•°å­—ã€‚å¦‚æœæ˜¯æ­£ç¡®çš„ï¼Œåˆ™å‡å®šç£ç›˜åŒ…å«æœ‰æ•ˆçš„æ–‡ä»¶ç³»ç»Ÿã€‚å¦‚æœå­˜åœ¨å…¶ä»–æ•°å­—ï¼Œåˆ™æŒ‚è½½å¤±è´¥ï¼Œå¯èƒ½æ˜¯å› ä¸ºç£ç›˜æ²¡æœ‰æ ¼å¼åŒ–æˆ–åŒ…å«å…¶ä»–ç±»å‹çš„æ•°æ®ã€‚ï¼‰</p><blockquote><p>å‚è€ƒèµ„æ–™ï¼š<a href="https://www3.nd.edu/~pbui/teaching/cse.30341.fa18/project06.html">https://www3.nd.edu/~pbui/teaching/cse.30341.fa18/project06.html</a></p></blockquote><h2 id="1-1-è¶…çº§å—ï¼ˆSuper-blockï¼‰"><a href="#1-1-è¶…çº§å—ï¼ˆSuper-blockï¼‰" class="headerlink" title="1.1 è¶…çº§å—ï¼ˆSuper blockï¼‰"></a>1.1 è¶…çº§å—ï¼ˆSuper blockï¼‰</h2><p>æ–‡ä»¶ç³»ç»Ÿä¸­ç¬¬ä¸€ä¸ªå—è¢«ç§°ä¸º<strong>è¶…çº§å—</strong>ã€‚è¶…çº§å—è®°å½•äº†è¯¥ <strong>filesystem</strong> çš„æ•´ä½“ä¿¡æ¯ï¼Œå…¶ä¸­åŒ…å«ï¼š</p><ul><li>block ä¸ inode çš„æ€»é‡</li><li>æœªä½¿ç”¨ä¸å·²ä½¿ç”¨çš„ inode/block æ•°é‡</li><li>ä¸€ä¸ª block ä¸ ä¸€ä¸ª inode çš„å¤§å°ï¼ˆblock åœ¨ext2 ä¸­ä¸º1ï¼Œ2ï¼Œ4kï¼›inode ä¸º 128bytesæˆ–256bytesï¼‰</li><li>filesystem çš„æŒ‚è½½æ—¶é—´ï¼Œæœ€è¿‘ä¸€æ¬¡å†™å…¥èµ„æ–™çš„æ—¶é—´ï¼Œæœ€è¿‘ä¸€æ¬¡æ£€éªŒç£ç›˜ï¼ˆfsckï¼‰çš„æ—¶é—´ç­‰æ¡£æ¡ˆç³»ç»Ÿçš„ç›¸å…³ä¿¡æ¯</li><li>ä¸€ä¸ª valid bit æ•°å€¼ï¼Œè‹¥è¯¥æ–‡ä»¶ç³»ç»Ÿå·²è¢«æŒ‚è½½ï¼Œåˆ™ valid bit ä¸º0ï¼Œè‹¥æœªè¢«æŒ‚è½½ï¼Œåˆ™ valid bit ä¸º1</li></ul><p>ä¸€èˆ¬æ¥è¯´ï¼Œ superblock çš„å¤§å°ä¸º <strong>1024bytes</strong>ã€‚</p><h2 id="1-2-i-èŠ‚ç‚¹è¡¨ï¼ˆinode-tableï¼‰"><a href="#1-2-i-èŠ‚ç‚¹è¡¨ï¼ˆinode-tableï¼‰" class="headerlink" title="1.2 i-èŠ‚ç‚¹è¡¨ï¼ˆinode tableï¼‰"></a>1.2 i-èŠ‚ç‚¹è¡¨ï¼ˆinode tableï¼‰</h2><p>è¶…çº§å—ä¸‹ä¸€éƒ¨åˆ†å°±æ˜¯ <strong>i-èŠ‚ç‚¹è¡¨</strong> äº†ï¼Œè¯¥æ•°æ®ç»“æ„ç®¡ç†æ‰€æœ‰æ–‡ä»¶çš„å±æ€§ã€‚æ¯ä¸ªLinuxæ–‡ä»¶æˆ–ç›®å½• (ä»æŠ€æœ¯è§’åº¦è®²ï¼Œå®ƒä»¬ä¹‹é—´æ²¡æœ‰æœ¬è´¨çš„åŒºåˆ«ï¼Œéƒ½ä¸ºæ–‡ä»¶) éƒ½æœ‰ä¸€ä¸ªinodeï¼Œè€Œè¿™ä¸ªinodeåŒ…å«äº†æ‰€æœ‰æ–‡ä»¶çš„å…ƒæ•°æ® (ä¹Ÿå°±æ˜¯è¯´ï¼Œè¯»å–æ–‡ä»¶æ‰€éœ€çš„ç®¡ç†æ•°æ®éƒ½å­˜å‚¨åœ¨inodeä¸­)ã€‚ä¾‹å¦‚ï¼ŒinodeåŒ…å«å­˜å‚¨æ–‡ä»¶çš„æ‰€æœ‰å—çš„åˆ—è¡¨ï¼Œè¯¥æ–‡ä»¶æ‰€æœ‰è€…ä¿¡æ¯ã€æƒé™ä»¥åŠä¸ºè¯¥æ–‡ä»¶è®¾ç½®çš„æ‰€æœ‰å…¶ä»–å±æ€§ã€‚</p><p>æ‰€æœ‰i-èŠ‚ç‚¹éƒ½æœ‰ç›¸åŒçš„å¤§å°ï¼Œå¹¶ä¸”i-èŠ‚ç‚¹è¡¨æ˜¯è¿™äº›ç»“æ„çš„ä¸€ä¸ªåˆ—è¡¨ï¼Œæ–‡ä»¶ç³»ç»Ÿä¸­æ¯ä¸ªæ–‡ä»¶åœ¨è¯¥è¡¨ä¸­éƒ½æœ‰ä¸€ä¸ªi-èŠ‚ç‚¹ã€‚</p><h3 id="1-2-1-inode-number"><a href="#1-2-1-inode-number" class="headerlink" title="1.2.1 inode number"></a>1.2.1 inode number</h3><p><strong>inode</strong> æ˜¯ inode table ä¸­çš„ä¸€ä¸ªæ¡ç›®ï¼ŒåŒ…å«æœ‰å…³ç›®å½•å’Œå¸¸è§„æ–‡ä»¶çš„å…ƒæ•°æ®ã€‚inodeæ˜¯ä¼ ç»ŸUnixé£æ ¼æ–‡ä»¶ç³»ç»Ÿ (æ¯”å¦‚ext3/ext4) ä¸Šçš„æ•°æ®ç»“æ„ã€‚Linuxæ‰©å±•æ–‡ä»¶ç³»ç»Ÿ (å¦‚ext2/ext3) ç»´æŠ¤äº†ä¸€ä¸ªinodeçš„æ•°ç»„ï¼šinode tableã€‚inode table åŒ…å«è¯¥æ–‡ä»¶ç³»ç»Ÿä¸­æ‰€æœ‰æ–‡ä»¶çš„åˆ—è¡¨ã€‚inode table ä¸­çš„å„ä¸ªinodeé¡¹å…·æœ‰å”¯ä¸€çš„ç¼–å· (è¯¥æ–‡ä»¶ç³»ç»Ÿå”¯ä¸€)ï¼Œå³inode numberã€‚æ·±å…¥inodeæ•°æ®ç»“æ„ï¼Œæˆ‘ä»¬å‘ç°å®ƒå­˜å‚¨äº†å¦‚ä¸‹ä¿¡æ¯ï¼š</p><ul><li>æ–‡ä»¶ç±»å‹ï¼š æ™®é€šæ–‡ä»¶ï¼Œç›®å½•ï¼Œç®¡é“ç­‰ç­‰</li><li>æƒé™ï¼šå¯è¯»ï¼Œå¯å†™ï¼Œå¯æ‰§è¡Œ(read/write/excute)</li><li>é“¾æ¥æ•°ï¼šé“¾æ¥åˆ°è¯¥inodeçš„ç¡¬é“¾æ¥æ•°</li><li>User IDï¼šæ–‡ä»¶æ‰€æœ‰è€…</li><li>Group IDï¼šæ‰€æœ‰è€…ç»„ID</li><li>æ–‡ä»¶å¤§å°</li><li>æ—¶é—´ä¿¡æ¯ï¼šåˆ›å»ºæ—¶é—´æˆ–çŠ¶æ€æ”¹å˜æ—¶é—´ï¼ˆctimeï¼‰ã€æœ€è¿‘ä¿®ä¿®æ”¹æ—¶é—´ï¼ˆmtimeï¼‰ã€æœ€è¿‘è¯»å–æ—¶é—´ï¼ˆatimeï¼‰</li><li>å±æ€§ï¼šæ¯”å¦‚ï¼Œä¸å¯æ”¹å˜ä½</li><li>è®¿é—®æ§åˆ¶åˆ—è¡¨</li><li>æ–‡ä»¶æ•°æ®å­˜å‚¨çš„å®é™…ä½ç½®</li><li>å…¶ä»–å…ƒæ•°æ®</li></ul><p><font color=red>æ³¨æ„ï¼šinodeä¸­ä¸å­˜å‚¨æ–‡ä»¶åæ•°æ®ï¼Œæ–‡ä»¶åå­˜å‚¨åœ¨ç›®å½•</font></p><p><strong>ç‰¹æ€§ï¼š</strong></p><ul><li>æ¯ä¸ª inode å¤§å°å‡å›ºå®šä¸º 128bytesï¼ˆext4å’Œxfså¯è®¾å®šåˆ°256bytesï¼‰</li><li>æ¯ä¸ªæ¡£æ¡ˆä»…ä¼šå ç”¨ä¸€ä¸ª inode</li><li>æ‰€ä»¥ï¼Œæ–‡ä»¶ç³»ç»Ÿèƒ½å¤Ÿåˆ›å»ºçš„æ–‡ä»¶æ•°ä¸ inode çš„æ•°é‡æœ‰å…³</li><li>ç³»ç»Ÿè¯»å–æ¡£æ¡ˆæ—¶éœ€è¦å…ˆæ‰¾åˆ° inodeï¼Œå¹¶åˆ†æ inode æ‰€è®°å½•çš„æƒé™ä¸ä½¿ç”¨è€…æ˜¯å¦ç›¸ç¬¦ï¼Œç¬¦åˆæ‰èƒ½å¤Ÿå¼€å§‹å®é™…è¯»å– data blcok é‡Œæ–‡ä»¶çš„å†…å®¹</li></ul><h2 id="1-3-æ•°æ®å—ï¼ˆdata-blockï¼‰"><a href="#1-3-æ•°æ®å—ï¼ˆdata-blockï¼‰" class="headerlink" title="1.3 æ•°æ®å—ï¼ˆdata blockï¼‰"></a>1.3 æ•°æ®å—ï¼ˆdata blockï¼‰</h2><p>æ–‡ä»¶ç³»ç»Ÿçš„ç¬¬ä¸‰ä¸ªéƒ¨åˆ†å°±æ˜¯<strong>æ•°æ®å—åŒº</strong>ã€‚æ–‡ä»¶çš„æœ¬èº«å†…å®¹å°±ä¿å­˜åœ¨è¯¥åŒºåŸŸã€‚ç£ç›˜ä¸Šæ‰€æœ‰çš„å—å¤§å°éƒ½ä¸€æ ·ï¼Œå¦‚åœ¨<strong>Ext2æ¡£æ¡ˆç³»ç»Ÿä¸­æ‰€æ”¯æŒçš„blockå¤§å°æœ‰1K, 2KåŠ4Kä¸‰ç§</strong>ã€‚æ ¼å¼åŒ–æ—¶blockçš„å¤§å°å°±å›ºå®šäº†ï¼Œä¸”æ¯ä¸ªblockéƒ½æœ‰ç¼–å·ï¼Œä»¥æ–¹ä¾¿inodeçš„è®°å½•ã€‚<font color=red>å¦‚æœæ–‡ä»¶åŒ…å«è¶…è¿‡ä¸€ä¸ªæ•°æ®å—çš„å†…å®¹ï¼Œåˆ™æ–‡ä»¶å†…å®¹ä¼šå­˜æ”¾åœ¨å¤šä¸ªç£ç›˜å—ä¸­</font>ã€‚</p><h1 id="äºŒã€æ–‡ä»¶åŠç›®å½•çš„åˆ›å»ºè¿‡ç¨‹"><a href="#äºŒã€æ–‡ä»¶åŠç›®å½•çš„åˆ›å»ºè¿‡ç¨‹" class="headerlink" title="äºŒã€æ–‡ä»¶åŠç›®å½•çš„åˆ›å»ºè¿‡ç¨‹"></a>äºŒã€æ–‡ä»¶åŠç›®å½•çš„åˆ›å»ºè¿‡ç¨‹</h1><h2 id="2-1-æ–‡ä»¶åˆ›å»ºè¿‡ç¨‹"><a href="#2-1-æ–‡ä»¶åˆ›å»ºè¿‡ç¨‹" class="headerlink" title="2.1 æ–‡ä»¶åˆ›å»ºè¿‡ç¨‹"></a>2.1 æ–‡ä»¶åˆ›å»ºè¿‡ç¨‹</h2><p>ä½¿ç”¨ <code>touch filename</code> åˆ›å»ºæ–‡ä»¶ï¼š</p><p>æ–‡ä»¶çš„å±æ€§å’Œæ–‡ä»¶çš„å†…å®¹ï¼š<font color=red>å†…æ ¸å°†æ–‡ä»¶çš„å†…å®¹æ”¾å…¥data blockï¼Œå°†æ–‡ä»¶çš„å±æ€§å­˜æ”¾åœ¨ i-èŠ‚ç‚¹ï¼Œæ–‡ä»¶åå­˜æ”¾åœ¨ç›®å½•</font>ã€‚</p><p>ä¸‹å›¾æ˜¾ç¤ºäº†åˆ›å»ºä¸€ä¸ªæ–‡ä»¶çš„ä¾‹å­ï¼Œè¯¥æ–‡ä»¶å ç”¨äº†3ä¸ªæ•°æ®å—ï¼š</p><p><img src="/img/linux_super_inode_block/linux_inode_2.jpg"></p><p>æ­¥éª¤ï¼š</p><ol><li><p>æ–‡ä»¶å±æ€§å­˜å‚¨ï¼šå†…æ ¸æ‰¾åˆ°ä¸€å—ç©ºçš„ i-èŠ‚ç‚¹ï¼Œè¯¥èŠ‚ç‚¹ i-number ä¸º47ã€‚å†…æ ¸æŠŠè¯¥æ–‡ä»¶çš„ä¿¡æ¯è®°å½•å…¶ä¸­ï¼Œè¿™äº›ä¿¡æ¯è¯¦è§ 1.2.1 inode number</p></li><li><p>æ–‡ä»¶å†…å®¹çš„å­˜å‚¨ï¼šç”±äºè¯¥æ–‡ä»¶éœ€è¦3ä¸ªæ•°æ®å—ï¼Œå†…æ ¸éœ€è¦åœ¨è‡ªç”±å—åˆ—è¡¨ä¸­æ‰¾åˆ°3ä¸ªè‡ªç”±å—ã€‚</p></li><li><p>è®°å½•åˆ†é…æƒ…å†µï¼Œæ•°æ®ä¿å­˜åˆ°äº†3ä¸ªæ•°æ®å—ä¸­ï¼Œæ‰€ä»¥éœ€è¦è®°å½•ä¸‹æ¥ã€‚åˆ†é…æƒ…å†µè®°å½•åœ¨ i-èŠ‚ç‚¹ä¸­çš„ç£ç›˜åºå·åˆ—è¡¨é‡Œã€‚è¿™3ä¸ªç¼–å·åˆ†åˆ«æ”¾åœ¨æœ€å¼€å§‹çš„3ä¸ªä½ç½®</p></li><li><p>æ·»åŠ æ–‡ä»¶ååˆ°ç›®å½•ï¼Œæ–°çš„æ–‡ä»¶åä¸º filenameï¼Œå†…æ ¸å°†æ–‡ä»¶çš„å…¥å£ï¼ˆ47ï¼Œfilenameï¼‰æ·»åŠ åˆ°ç›®å½•æ–‡ä»¶é‡Œã€‚æ–‡ä»¶åå’Œ i-èŠ‚ç‚¹å·ä¹‹é—´çš„å¯¹åº”å…³ç³»å°†æ–‡ä»¶åå’Œæ–‡ä»¶çš„å†…å®¹å±æ€§ğŸ”—èµ·æ¥ï¼Œæ‰¾åˆ°æ–‡ä»¶åå°±æ‰¾åˆ°äº†æ–‡ä»¶çš„ i-èŠ‚ç‚¹å·ï¼Œé€šè¿‡ i-èŠ‚ç‚¹å·å°±èƒ½æ‰¾åˆ°æ–‡ä»¶çš„å±æ€§åŠå†…å®¹</p></li></ol><h2 id="2-2-ç›®å½•åˆ›å»ºè¿‡ç¨‹"><a href="#2-2-ç›®å½•åˆ›å»ºè¿‡ç¨‹" class="headerlink" title="2.2 ç›®å½•åˆ›å»ºè¿‡ç¨‹"></a>2.2 ç›®å½•åˆ›å»ºè¿‡ç¨‹</h2><p>ç›®å½•ä¹Ÿæ˜¯æ–‡ä»¶ï¼Œå†…å®¹æ¯”è¾ƒç‰¹æ®Šï¼Œå®ƒåŒ…å«äº†æ–‡ä»¶åå­—åˆ—è¡¨ï¼Œè€Œåˆ—è¡¨ä¸€èˆ¬åŒ…å«ä¸¤ä¸ªéƒ¨åˆ†ï¼š<strong>i-èŠ‚ç‚¹</strong> å’Œ <strong>æ–‡ä»¶å</strong>ã€‚</p>]]></content>
    
    
    <categories>
      
      <category>Linux</category>
      
    </categories>
    
    
    <tags>
      
      <tag>Linux</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>åœ¨ CentOS 7 ä¸‹ æ­å»º Zabbix 5.0 LTS æ—¥å¿—</title>
    <link href="/2020/08/27/zabbix_install/"/>
    <url>/2020/08/27/zabbix_install/</url>
    
    <content type="html"><![CDATA[<h1 id="YUM-å®‰è£…"><a href="#YUM-å®‰è£…" class="headerlink" title="YUM å®‰è£…"></a>YUM å®‰è£…</h1><h2 id="1-å…³é—­é˜²ç«å¢™å’Œ-selinux-ï¼Œé‡å¯"><a href="#1-å…³é—­é˜²ç«å¢™å’Œ-selinux-ï¼Œé‡å¯" class="headerlink" title="1.å…³é—­é˜²ç«å¢™å’Œ selinux ï¼Œé‡å¯"></a>1.å…³é—­é˜²ç«å¢™å’Œ selinux ï¼Œé‡å¯</h2><pre><code class="hljs bash">[root@localhost ~]<span class="hljs-comment"># sed -i &#x27;s/SELINUX=enforcing/SELINUX=disabled/&#x27; /etc/selinux/config</span>[root@localhost ~]<span class="hljs-comment"># systemctl disable firewalld</span>[root@localhost ~]<span class="hljs-comment"># init 6</span></code></pre><h2 id="2-å®‰è£…-zabbix-rpm-æºï¼Œæ›¿æ¢æˆ-é˜¿é‡Œäº‘çš„-zabbix-æº"><a href="#2-å®‰è£…-zabbix-rpm-æºï¼Œæ›¿æ¢æˆ-é˜¿é‡Œäº‘çš„-zabbix-æº" class="headerlink" title="2.å®‰è£… zabbix rpm æºï¼Œæ›¿æ¢æˆ é˜¿é‡Œäº‘çš„ zabbix æº"></a>2.å®‰è£… zabbix rpm æºï¼Œæ›¿æ¢æˆ é˜¿é‡Œäº‘çš„ zabbix æº</h2><p><a href="https://mirrors.aliyun.com/">é˜¿é‡Œäº‘æº</a></p><pre><code class="hljs bash">[root@localhost ~]<span class="hljs-comment"># rpm -Uvh https://mirrors.aliyun.com/zabbix/zabbix/5.0/rhel/7/x86_64/zabbix-release-5.0-1.el7.noarch.rpm</span>[root@localhost ~]<span class="hljs-comment"># sed -i &#x27;s@http://repo.zabbix.com@https://mirrors.aliyun.com/zabbix@&#x27; /etc/yum.repos.d/zabbix.repo</span>[root@localhost ~]<span class="hljs-comment"># yum clean all</span></code></pre><h2 id="3-å®‰è£…-zabbix-server-å’Œ-agent"><a href="#3-å®‰è£…-zabbix-server-å’Œ-agent" class="headerlink" title="3.å®‰è£… zabbix server å’Œ agent"></a>3.å®‰è£… zabbix server å’Œ agent</h2><pre><code class="hljs bash">[root@localhost ~]<span class="hljs-comment"># yum install zabbix-server-mysql zabbix-agent -y</span></code></pre><h2 id="4-å®‰è£…-Software-Collectionsï¼Œä¾¿äºåç»­å®‰è£…é«˜ç‰ˆæœ¬çš„-phpï¼Œé»˜è®¤-yum-å®‰è£…çš„-php-ç‰ˆæœ¬ä¸º-5-4-è¿‡ä½"><a href="#4-å®‰è£…-Software-Collectionsï¼Œä¾¿äºåç»­å®‰è£…é«˜ç‰ˆæœ¬çš„-phpï¼Œé»˜è®¤-yum-å®‰è£…çš„-php-ç‰ˆæœ¬ä¸º-5-4-è¿‡ä½" class="headerlink" title="4.å®‰è£… Software Collectionsï¼Œä¾¿äºåç»­å®‰è£…é«˜ç‰ˆæœ¬çš„ phpï¼Œé»˜è®¤ yum å®‰è£…çš„ php ç‰ˆæœ¬ä¸º 5.4 è¿‡ä½"></a>4.å®‰è£… Software Collectionsï¼Œä¾¿äºåç»­å®‰è£…é«˜ç‰ˆæœ¬çš„ phpï¼Œé»˜è®¤ yum å®‰è£…çš„ php ç‰ˆæœ¬ä¸º 5.4 è¿‡ä½</h2><pre><code class="hljs bash">[root@localhost ~]<span class="hljs-comment"># yum install centos-release-scl -y</span></code></pre><p>å¯ç”¨ zabbix å‰ç«¯æºï¼Œä¿®æ”¹ vi /etc/yum.repos.d/zabbix.repoï¼Œå°† <strong>[zabbix-frontend]</strong> ä¸‹çš„ <strong>enabled=1</strong></p><h2 id="5-å®‰è£…-zabbix-å‰ç«¯å’Œç›¸å…³ç¯å¢ƒ"><a href="#5-å®‰è£…-zabbix-å‰ç«¯å’Œç›¸å…³ç¯å¢ƒ" class="headerlink" title="5.å®‰è£… zabbix å‰ç«¯å’Œç›¸å…³ç¯å¢ƒ"></a>5.å®‰è£… zabbix å‰ç«¯å’Œç›¸å…³ç¯å¢ƒ</h2><pre><code class="hljs bash">[root@localhost ~]<span class="hljs-comment"># yum install zabbix-web-mysql-scl zabbix-apache-conf-scl -y</span></code></pre><h2 id="6-yum-å®‰è£…-centos7-é»˜è®¤çš„-mariadb-æ•°æ®åº“å¹¶é…ç½®æ•°æ®åº“"><a href="#6-yum-å®‰è£…-centos7-é»˜è®¤çš„-mariadb-æ•°æ®åº“å¹¶é…ç½®æ•°æ®åº“" class="headerlink" title="6.yum å®‰è£… centos7 é»˜è®¤çš„ mariadb æ•°æ®åº“å¹¶é…ç½®æ•°æ®åº“"></a>6.yum å®‰è£… centos7 é»˜è®¤çš„ mariadb æ•°æ®åº“å¹¶é…ç½®æ•°æ®åº“</h2><pre><code class="hljs bash">[root@localhost ~]<span class="hljs-comment"># yum install mariadb-server -y</span><span class="hljs-comment">#å¯åŠ¨æ•°æ®åº“ï¼Œå¹¶é…ç½®å¼€æœºè‡ªåŠ¨å¯åŠ¨</span>[root@localhost ~]<span class="hljs-comment"># systemctl enable --now mariadb</span><span class="hljs-comment">#ä½¿ç”¨ä»¥ä¸‹å‘½ä»¤åˆå§‹åŒ– mariadb å¹¶é…ç½® root å¯†ç </span>[root@localhost ~]<span class="hljs-comment"># mysql_secure_installation </span>NOTE: RUNNING ALL PARTS OF THIS SCRIPT IS RECOMMENDED FOR ALL MariaDB      SERVERS IN PRODUCTION USE!  PLEASE READ EACH STEP CAREFULLY!In order to <span class="hljs-built_in">log</span> into MariaDB to secure it, we<span class="hljs-string">&#x27;ll need the current</span><span class="hljs-string">password for the root user.  If you&#x27;</span>ve just installed MariaDB, andyou haven<span class="hljs-string">&#x27;t set the root password yet, the password will be blank,</span><span class="hljs-string">so you should just press enter here.</span><span class="hljs-string"></span><span class="hljs-string">Enter current password for root (enter for none): root123.</span><span class="hljs-string"></span><span class="hljs-string">#ä½¿ç”¨ root ç”¨æˆ·è¿›å…¥ mysqlï¼Œå¹¶å»ºç«‹ zabbix æ•°æ®åº“ï¼Œæ³¨æ„æ•°æ®åº“ç¼–ç </span><span class="hljs-string">[root@localhost ~]# mysql -u root -p </span><span class="hljs-string">Enter password: </span><span class="hljs-string">Welcome to the MariaDB monitor.  Commands end with ; or \g.</span><span class="hljs-string">Your MariaDB connection id is 11</span><span class="hljs-string">Server version: 5.5.65-MariaDB MariaDB Server</span><span class="hljs-string"></span><span class="hljs-string">Copyright (c) 2000, 2018, Oracle, MariaDB Corporation Ab and others.</span><span class="hljs-string"></span><span class="hljs-string">Type &#x27;</span><span class="hljs-built_in">help</span>;<span class="hljs-string">&#x27; or &#x27;</span>\h<span class="hljs-string">&#x27; for help. Type &#x27;</span>\c<span class="hljs-string">&#x27; to clear the current input statement.</span><span class="hljs-string"></span><span class="hljs-string">MariaDB [(none)]&gt; </span><span class="hljs-string">create database zabbix character set utf8 collate utf8_bin;</span><span class="hljs-string">create user zabbix@localhost identified by &#x27;</span>password<span class="hljs-string">&#x27;;</span><span class="hljs-string">grant all privileges on zabbix.* to zabbix@localhost;</span><span class="hljs-string">quit;</span><span class="hljs-string"></span><span class="hljs-string">#ä½¿ç”¨ä»¥ä¸‹å‘½ä»¤å¯¼å…¥ zabbix æ•°æ®åº“ï¼Œzabbix æ•°æ®åº“ç”¨æˆ·ä¸º zabbixï¼Œå¯†ç ä¸º password</span><span class="hljs-string">[root@localhost ~]# zcat /usr/share/doc/zabbix-server-mysql*/create.sql.gz | mysql -uzabbix -p zabbix</span><span class="hljs-string"></span><span class="hljs-string">#ä¿®æ”¹ zabbix server é…ç½®æ–‡ä»¶vi /etc/zabbix/zabbix_server.conf é‡Œçš„æ•°æ®åº“å¯†ç </span><span class="hljs-string">DBPassword=password</span><span class="hljs-string"></span><span class="hljs-string">#ä¿®æ”¹ zabbix çš„ php é…ç½®æ–‡ä»¶vi /etc/opt/rh/rh-php72/php-fpm.d/zabbix.conf é‡Œçš„æ—¶åŒºï¼Œæ”¹æˆ Asia/Shanghai</span><span class="hljs-string">php_value[date.timezone] = Asia/Shanghai</span><span class="hljs-string"></span><span class="hljs-string">#å¯åŠ¨ç›¸å…³æœåŠ¡ï¼Œå¹¶é…ç½®å¼€æœºè‡ªåŠ¨å¯åŠ¨</span><span class="hljs-string">[root@localhost ~]# systemctl restart zabbix-server zabbix-agent httpd rh-php72-php-fpm</span><span class="hljs-string">[root@localhost ~]# systemctl enable zabbix-server zabbix-agent httpd rh-php72-php-fpm</span></code></pre><h2 id="7-ä½¿ç”¨æµè§ˆå™¨è®¿é—®-http-ip-zabbix-å³å¯è®¿é—®-zabbix-çš„-web-é¡µé¢"><a href="#7-ä½¿ç”¨æµè§ˆå™¨è®¿é—®-http-ip-zabbix-å³å¯è®¿é—®-zabbix-çš„-web-é¡µé¢" class="headerlink" title="7.ä½¿ç”¨æµè§ˆå™¨è®¿é—® http://ip/zabbix å³å¯è®¿é—® zabbix çš„ web é¡µé¢"></a>7.ä½¿ç”¨æµè§ˆå™¨è®¿é—® <a href="http://ip/zabbix">http://ip/zabbix</a> å³å¯è®¿é—® zabbix çš„ web é¡µé¢</h2>]]></content>
    
    
    <categories>
      
      <category>Zabbix</category>
      
    </categories>
    
    
    <tags>
      
      <tag>Zabbix</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>HDS VSP åŒç›˜æ•…éšœï¼ˆå­˜åœ¨ pin dataï¼‰</title>
    <link href="/2020/08/24/HDS_VSP_PIN_DATA/"/>
    <url>/2020/08/24/HDS_VSP_PIN_DATA/</url>
    
    <content type="html"><![CDATA[<h1 id="é—®é¢˜æè¿°"><a href="#é—®é¢˜æè¿°" class="headerlink" title="é—®é¢˜æè¿°"></a>é—®é¢˜æè¿°</h1><p>æ¥å®¢æˆ·é‚®ä»¶ï¼ŒHDS VSP æœ‰æ•…éšœï¼Œåˆ°ç°åœºæŸ¥çœ‹ï¼Œæœ‰å—ç¡¬ç›˜æ•…éšœï¼Œæ“ä½œç•Œé¢å‘ç° Pinned Track é—ªçƒï¼Œç‚¹å¼€å¦‚ä¸‹å›¾ï¼š</p><p><img src="/img/HDS_VSP/HDS_VSP_PIN_DATA_pin.jpg"></p><p>æœªç†ç¬ï¼Œæ¥ä¸‹æ¥æ­£å¸¸æ¢æ•…éšœç¡¬ç›˜ï¼Œæ•…éšœç¡¬ç›˜ä¸º HDD24-08ï¼š</p><p><img src="/img/HDS_VSP/HDS_VSP_PIN_DATA_2.jpg"></p><p>æ¢å®Œç¡¬ç›˜åä¸€åˆ‡é¡ºåˆ©ï¼Œæ•…éšœç›˜ä¹Ÿæœ‰å›æ‹·è¿›åº¦æ¡ï¼š</p><p><img src="/img/HDS_VSP/HDS_VSP_PIN_DATA_3.jpg"></p><h1 id="å‘Šè­¦ä¿¡æ¯"><a href="#å‘Šè­¦ä¿¡æ¯" class="headerlink" title="å‘Šè­¦ä¿¡æ¯"></a>å‘Šè­¦ä¿¡æ¯</h1><p>ç¬¬äºŒå¤©ï¼Œå®¢æˆ·ç”µè¯è”ç³»ï¼ŒHDS VSP æœ‰æ•…éšœï¼Œåˆ°ç°åœºæŸ¥çœ‹ä¸ºæ˜¨å¤©æ›´æ¢çš„ç¡¬ç›˜ä½ï¼Œç¡¬ç›˜çŠ¶æ€ä¸º <strong>Blocked</strong>ï¼š</p><p><img src="/img/HDS_VSP/HDS_VSP_PIN_DATA_4.jpg"></p><p>é¦–å…ˆä»¥ä¸ºæ˜¯å¤‡ä»¶ç¡¬ç›˜è´¨é‡é—®é¢˜ï¼Œç›¸ç»§æ›´æ¢ä¸åŒæ‰¹æ¬¡å¤‡ä»¶5æ¬¡ï¼Œæ•…éšœä¾æ—§ï¼Œæ— æ³•ä»çƒ­å¤‡ç›˜ <strong>HDD054-0F</strong> å›æ‹·æ•°æ®ï¼ŒæŸ¥çœ‹ SIM ä¿¡æ¯ï¼Œå‘ç°éƒ½æ˜¯å›æ‹·ä¸åˆ°ä¸€å°æ—¶ä¸­æ–­</p><h1 id="åˆ†æ"><a href="#åˆ†æ" class="headerlink" title="åˆ†æ"></a>åˆ†æ</h1><p>ç»åŸå‚å·¥ç¨‹å¸ˆåˆ†ææ•…éšœåŸå› ï¼š<br>7æœˆ23æ—¥å­˜å‚¨ç¡¬ç›˜ <strong>HDD024-08</strong> å®Œå…¨æ•…éšœï¼Œå†é€šè¿‡RAIDæœºåˆ¶å‘çƒ­å¤‡ç›˜ <strong>HDD54-0F</strong> æ¢å¤æ•°æ®çš„è¿‡ç¨‹ä¸­å‘ç°åŒä¸€RAIDç»„ä¸­çš„ <strong>HDD020-08</strong> ç¡¬ç›˜æ•…éšœï¼Œå¯¼è‡´æœ‰éƒ¨åˆ†æ•°æ®æ— æ³•æ¢å¤åˆ° <strong>HDD54-0F</strong>ï¼Œåœ¨00:27è¿™ä¸ªæ•°æ®lunäº§ç”Ÿäº†pin dataã€‚æ­¤RAIDç»„å‘ç”Ÿäº†ä¸¤å—ç£ç›˜åŒæ—¶æ•…éšœçš„é—®é¢˜ï¼Œå¯¼è‡´RAIDä¿æŠ¤æœºåˆ¶å¤±æ•ˆã€‚</p><p><img src="/img/HDS_VSP/HDS_VSP_PIN_DATA_5.jpg"></p><p>å½“æ—¶ <strong>HDD20-08</strong> SIM ä¿¡æ¯ï¼š<br><img src="/img/HDS_VSP/HDS_VSP_PIN_DATA_6.jpg"></p><p><strong>Pin data</strong> ä¿¡æ¯ï¼š</p><p><img src="/img/HDS_VSP/HDS_VSP_PIN_DATA_7.jpg"></p><h1 id="å¤„ç†è¿‡ç¨‹"><a href="#å¤„ç†è¿‡ç¨‹" class="headerlink" title="å¤„ç†è¿‡ç¨‹"></a>å¤„ç†è¿‡ç¨‹</h1><h2 id="å‡†å¤‡å·¥ä½œ"><a href="#å‡†å¤‡å·¥ä½œ" class="headerlink" title="å‡†å¤‡å·¥ä½œ"></a>å‡†å¤‡å·¥ä½œ</h2><ol><li>å¤‡ä»½ lun 00:27 æ‰€æ¶‰åŠçš„æ•°æ®è¿›è¡Œå¤‡ä»½</li><li>å•ç‹¬å¯¹ lun 00:27 è¿›è¡Œå¤‡ä»½</li></ol><p>?<br>åˆ é™¤æ“ä½œ</p><h2 id="å¤„ç†æ­¥éª¤"><a href="#å¤„ç†æ­¥éª¤" class="headerlink" title="å¤„ç†æ­¥éª¤"></a>å¤„ç†æ­¥éª¤</h2><ol><li>å¼€å¯å­˜å‚¨ MODE MODE æ¨¡å¼ï¼Œå¼€å¯æ–¹å¼ ?ï¼Œå¯†ç ä¸º mode</li><li>è¿›å…¥ <strong>install</strong> â€”&gt; <strong>change configï¼Ÿ</strong> ï¼Œå°† <strong>(SOMs)System option modes</strong> æ”¹ä¸º Mode 22</li><li>åœ¨å­˜å‚¨ä¸­å°† <strong>HDD20-08</strong> ç¡¬ç›˜ä¸Šçš„æ•°æ®æ‹·åˆ° Spare disk<ul><li>æ­¥éª¤ï¼šMantenance â€“&gt; é€‰ä¸­ç¡¬ç›˜ HDD20-08 â€“&gt; Other â€“&gt; Spare Disk</li><li>æ­¤æ—¶ï¼Œæç¤º Pinned Track exists. Do you want to stop this process?</li><li>ç‚¹å‡» Noï¼Œè¾“å…¥å¯†ç  exist-pintrack</li></ul></li><li>ç­‰å¾… Copy endï¼Œæ›´æ¢ HDD20-08 ç¡¬ç›˜å¹¶å›æ‹·æ•°æ®</li><li>æ£€æŸ¥æ˜¯å¦äº§ç”Ÿæ–°çš„ pin dataï¼Œå¦‚æœ‰åˆ™éœ€è¦å†æ¬¡æ£€æŸ¥ç³»ç»Ÿæ—¥å¿—</li><li>æ²¡æœ‰äº§ç”Ÿæ–°çš„ pin dataï¼Œåˆ™å…³é—­ Mode 22 åæ ¼å¼åŒ– lun 00:27ã€‚æ ¼å¼åŒ–å®ŒæˆååŸæœ¬çš„ pin data æ¶ˆå¤±</li></ol><h1 id="æ ¹å› "><a href="#æ ¹å› " class="headerlink" title="æ ¹å› "></a>æ ¹å› </h1>]]></content>
    
    
    <categories>
      
      <category>è¿ç»´</category>
      
    </categories>
    
    
    <tags>
      
      <tag>è¿ç»´</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>IP åœ°å€å‘ç”Ÿå†²çªå¯¼è‡´ç½‘ç»œæ•…éšœï¼Œæ’æŸ¥è§£å†³</title>
    <link href="/2020/08/18/ip_trouble/"/>
    <url>/2020/08/18/ip_trouble/</url>
    
    <content type="html"><![CDATA[<h1 id="1ã€æ•…éšœæ‘˜è¦"><a href="#1ã€æ•…éšœæ‘˜è¦" class="headerlink" title="1ã€æ•…éšœæ‘˜è¦"></a><strong>1ã€æ•…éšœæ‘˜è¦</strong></h1><p>ä¸€èˆ¬ IP å†²çªï¼ˆå¤§å¤šä¸ºè‡ªåŠ¨åˆ†é…åœ°å€çš„ PC å…¥ç½‘ï¼Œä¸ç°æœ‰å›ºå®š IP å‘ç”Ÿå†²çªï¼‰é€ æˆè®¾å¤‡æ— æ³•ä¸Šçº¿æˆ–è€…ä¸æ–­ä¸Šçº¿å’Œä¸‹çº¿ï¼Œç½‘ç»œæ¨æµæ­»æœºç­‰ç°è±¡</p><h1 id="2ã€æ•…éšœå…·ä½“æƒ…å†µ"><a href="#2ã€æ•…éšœå…·ä½“æƒ…å†µ" class="headerlink" title="2ã€æ•…éšœå…·ä½“æƒ…å†µ"></a><strong>2ã€æ•…éšœå…·ä½“æƒ…å†µ</strong></h1><p>å¤§å¤šä¸ºè‡ªåŠ¨åˆ†é…åœ°å€çš„ PC å…¥ç½‘ï¼Œä¸ç°æœ‰å›ºå®š IP å‘ç”Ÿå†²çª</p><h1 id="3ã€æ•…éšœåˆ†æåŠå¤„ç†"><a href="#3ã€æ•…éšœåˆ†æåŠå¤„ç†" class="headerlink" title="3ã€æ•…éšœåˆ†æåŠå¤„ç†"></a><strong>3ã€æ•…éšœåˆ†æåŠå¤„ç†</strong></h1><h2 id="3-1"><a href="#3-1" class="headerlink" title="3.1"></a>3.1</h2><p>å°†ç”µè„‘æ¥å…¥å±€åŸŸç½‘ï¼Œåœ¨ç»ˆç«¯è¾“å…¥ï¼š<code>arp -a</code> ï¼ŒæŸ¥çœ‹å±€åŸŸç½‘å†…æ‰€æœ‰çš„ IPï¼Œå½“çœ‹åˆ°æœ‰ä¸¤ä¸ª IP ä¸€æ ·çš„æ—¶å€™ï¼Œå°±å¯ä»¥ç¡®å®šå†²çªçš„ IP</p><h2 id="3-2"><a href="#3-2" class="headerlink" title="3.2"></a>3.2</h2><p>å½“çŸ¥é“å†²çª IP åï¼Œç”¨<code>nbtstat -a ip</code>(ip ä¸ºå†²çª ip)å‘½ä»¤ï¼ŒæŸ¥çœ‹å†²çª IP çš„è®¾å¤‡ä¿¡æ¯ï¼Œæ‰¾åˆ°è¯¥è®¾å¤‡</p><h2 id="3-3"><a href="#3-3" class="headerlink" title="3.3"></a>3.3</h2><p>ä¿®æ”¹è¯¥è®¾å¤‡ IP ä¿¡æ¯</p><h1 id="4ã€æ€»ç»“"><a href="#4ã€æ€»ç»“" class="headerlink" title="4ã€æ€»ç»“"></a><strong>4ã€æ€»ç»“</strong></h1>]]></content>
    
    
    <categories>
      
      <category>ç½‘ç»œ</category>
      
    </categories>
    
    
    <tags>
      
      <tag>ç½‘ç»œ</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>Linux è¿ç»´åˆçº§å­¦ä¹ ç¬”è®°</title>
    <link href="/2020/08/18/linux_maintenance/"/>
    <url>/2020/08/18/linux_maintenance/</url>
    
    <content type="html"><![CDATA[<h1 id="äº†è§£-Linux"><a href="#äº†è§£-Linux" class="headerlink" title="äº†è§£ Linux"></a>äº†è§£ Linux</h1><h2 id="Linux-çš„åŸºæœ¬åŸåˆ™"><a href="#Linux-çš„åŸºæœ¬åŸåˆ™" class="headerlink" title="Linux çš„åŸºæœ¬åŸåˆ™"></a>Linux çš„åŸºæœ¬åŸåˆ™</h2><ol><li>ç”±ç›®çš„å•ä¸€çš„å°ç¨‹åºç»„æˆï¼›ç»„åˆå°ç¨‹åºå®Œæˆå¤æ‚ä»»åŠ¡</li><li>ä¸€åˆ‡çš†æ–‡ä»¶</li><li>å°½é‡é¿å…æ•è·ç”¨æˆ·æ¥å£</li><li>é…ç½®æ–‡ä»¶ä¿å­˜ä¸ºçº¯æ–‡æœ¬æ ¼å¼</li></ol><h2 id="GUI"><a href="#GUI" class="headerlink" title="GUI"></a>GUI</h2><pre><code class="hljs bash">Graphic User InterfaceWindowsX-Window    Gnome: C    RDE: C++    XFace</code></pre><h2 id="CLI"><a href="#CLI" class="headerlink" title="CLI"></a>CLI</h2><pre><code class="hljs bash">Command-line Interfaceshbashcshzshkshkshtcshå‘½ä»¤æç¤ºç¬¦ï¼Œpromptï¼Œbash(shell)    <span class="hljs-comment">#: root</span>    $: æ™®é€šç”¨æˆ·å‘½ä»¤æ ¼å¼    å‘½ä»¤   é€‰é¡¹     å‚æ•°            é€‰é¡¹ï¼š                çŸ­é€‰é¡¹ï¼š-                    å¤šä¸ªé€‰é¡¹å¯ä»¥ç»„åˆï¼šls -a -l = ls -al                é•¿é€‰é¡¹ï¼š--            å‚æ•°ï¼šå‘½ä»¤ä½œç”¨çš„å¯¹è±¡```  <span class="hljs-comment">## su(SwitchUserï¼Œåˆ‡æ¢ç”¨æˆ·)</span>```NAME       su - run a <span class="hljs-built_in">command</span> with substitute user and group ID[root@localhost ~]<span class="hljs-comment"># su [-l] ç”¨æˆ·å</span></code></pre><h2 id="API-Application-program-Interface"><a href="#API-Application-program-Interface" class="headerlink" title="API(Application program Interface)"></a>API(Application program Interface)</h2><p> .so æ–‡ä»¶ï¼šShared Object åŠ¨æ€é“¾æ¥åº“ï¼Œåº“æ–‡ä»¶ï¼Œåº”ç”¨ç¨‹åºæ‰€éœ€è¦çš„</p><h1 id="åŸºç¡€å‘½ä»¤"><a href="#åŸºç¡€å‘½ä»¤" class="headerlink" title="åŸºç¡€å‘½ä»¤"></a>åŸºç¡€å‘½ä»¤</h1><h2 id="ls"><a href="#ls" class="headerlink" title="ls"></a>ls</h2><pre><code class="hljs bash">ls    -lï¼šé•¿æ ¼å¼        æ–‡ä»¶ç±»å‹ï¼š            -ï¼šæ™®é€šæ–‡ä»¶ï¼ˆfileï¼‰            dï¼šç›®å½•æ–‡ä»¶ï¼ˆdirectoryï¼‰            bï¼šå—è®¾å¤‡æ–‡ä»¶ï¼ˆblockï¼‰            cï¼šå­—ç¬¦è®¾å¤‡æ–‡ä»¶ï¼ˆcharacterï¼‰            lï¼šç¬¦å·é“¾æ¥æ–‡ä»¶ï¼ˆsymbolic link fileï¼‰            pï¼šå‘½ä»¤ç®¡é“æ–‡ä»¶ï¼ˆpipeï¼‰            sï¼šå¥—æ¥å­—æ–‡ä»¶ï¼ˆsocketï¼‰[root@localhost ~]<span class="hljs-comment"># ls -l /dev</span>crw-------. 1 root root     10, 235 7æœˆ  20 18:39 autofsdrwxr-xr-x. 2 root root         200 8æœˆ   9 16:36 blocklrwrwxxrwx. 1 root root           3 7æœˆ  20 18:39 cdrom -&gt; sr0brw-rw----. 1 root cdrom    11,   0 7æœˆ  20 18:39 sr0srw-rw-rw-. 1 root root           0 7æœˆ  20 18:39 <span class="hljs-built_in">log</span>    -aï¼šæ˜¾ç¤ºä»¥ . å¼€å¤´çš„éšè—æ–‡ä»¶    -iï¼šindex nodeï¼Œinode        [root@localhost ~]<span class="hljs-comment"># ls -li</span>        34051578 <span class="hljs-built_in">test</span>    -Rï¼šé€’å½’ï¼ˆrecursiveï¼‰æ˜¾ç¤º</code></pre><h2 id="cd"><a href="#cd" class="headerlink" title="cd"></a>cd</h2><pre><code class="hljs bash"><span class="hljs-built_in">cd</span>ï¼šchange directory    <span class="hljs-built_in">cd</span> ~USERNAMEï¼šè¿›å…¥æŒ‡å®šç”¨æˆ·çš„ home ç›®å½•    <span class="hljs-built_in">cd</span> -ï¼šåœ¨å½“å‰ç›®å½•å’Œå‰ä¸€æ¬¡æ‰€åœ¨ç›®å½•ä¹‹é—´æ¥å›åˆ‡æ¢</code></pre><h2 id="type"><a href="#type" class="headerlink" title="type"></a>type</h2><p>æ˜¾ç¤ºæŒ‡å®šå‘½ä»¤å±äºå“ªç§ç±»å‹<br>å†…ç½®å‘½ä»¤ï¼ˆshell å†…ç½®ï¼‰ï¼šå†…éƒ¨çš„ï¼Œå†…å»º<br>å¤–éƒ¨å‘½ä»¤ï¼šåœ¨æ–‡ä»¶ç³»ç»Ÿçš„æŸä¸ªè·¯å¾„ä¸‹æœ‰ä¸€ä¸ªå‘½ä»¤åç§°ç›¸åº”çš„å¯æ‰§è¡Œæ–‡ä»¶</p><pre><code class="hljs bash">[root@localhost ~]<span class="hljs-comment"># type cd</span><span class="hljs-built_in">cd</span> æ˜¯ shell å†…åµŒ        <span class="hljs-comment">#å†…ç½®å‘½ä»¤</span>[root@localhost ~]<span class="hljs-comment"># which ls</span><span class="hljs-built_in">alias</span> ls=<span class="hljs-string">&#x27;ls --color=auto&#x27;</span>  <span class="hljs-comment">#å¤–éƒ¨å‘½ä»¤</span>        /usr/bin/ls</code></pre><h2 id="ç¯å¢ƒå˜é‡"><a href="#ç¯å¢ƒå˜é‡" class="headerlink" title="ç¯å¢ƒå˜é‡"></a>ç¯å¢ƒå˜é‡</h2><pre><code class="hljs bash">æ˜¾ç¤ºç¯å¢ƒå˜é‡[root@localhost ~]<span class="hljs-comment"># printevn</span>PATH=/usr/<span class="hljs-built_in">local</span>/sbin:/usr/<span class="hljs-built_in">local</span>/bin:/usr/sbin:/usr/bin:/root/bin</code></pre><h2 id="å‘½ä»¤é€‰é¡¹"><a href="#å‘½ä»¤é€‰é¡¹" class="headerlink" title="å‘½ä»¤é€‰é¡¹"></a>å‘½ä»¤é€‰é¡¹</h2><ul><li>&lt;&gt;ï¼šå¿…é€‰é¡¹</li><li>[]ï¼šå¯é€‰é¡¹</li><li>â€¦ï¼šå¯å¤šæ¬¡å‡ºç°</li><li>|ï¼šå¤šé€‰ä¸€</li><li>{}ï¼šåˆ†ç»„</li></ul><h1 id="æ–‡ä»¶ç³»ç»Ÿæ“ä½œ"><a href="#æ–‡ä»¶ç³»ç»Ÿæ“ä½œ" class="headerlink" title="æ–‡ä»¶ç³»ç»Ÿæ“ä½œ"></a>æ–‡ä»¶ç³»ç»Ÿæ“ä½œ</h1><h2 id="ç›®å½•è¯¦è§£"><a href="#ç›®å½•è¯¦è§£" class="headerlink" title="ç›®å½•è¯¦è§£"></a>ç›®å½•è¯¦è§£</h2><p>rootfsï¼šæ ¹æ–‡ä»¶ç³»ç»Ÿ</p><pre><code class="hljs bash">/bootï¼šç³»ç»Ÿå¯åŠ¨ç›¸å…³æ–‡ä»¶ï¼Œå¦‚å†…æ ¸ã€initrd ä»¥åŠ grub(bootloader)/devï¼šè®¾å¤‡æ–‡ä»¶        å—è®¾å¤‡ï¼šéšæœºè®¿é—®ï¼Œå°†æ•°æ®åˆ†ä¸ºå—ï¼Œç§°ä¸ºæ•°æ®å—ï¼Œå¦‚ç¡¬ç›˜        å­—ç¬¦è®¾å¤‡ï¼šçº¿æ€§è®¿é—®ï¼ŒæŒ‰å­—ç¬¦ä¸ºå•ä½        è®¾å¤‡å·ï¼šä¸»è®¾å¤‡å·ï¼ˆmajorï¼‰å’Œæ¬¡è®¾å¤‡å·ï¼ˆminorï¼‰/etcï¼šé…ç½®æ–‡ä»¶/lib64ï¼šåº“æ–‡ä»¶    é™æ€åº“    åŠ¨æ€åº“ï¼š.so(shared object)    /modulesï¼šå†…æ ¸æ¨¡å—æ–‡ä»¶/optï¼šå¯é€‰ç›®å½•/procï¼šä¼ªæ–‡ä»¶ç³»ç»Ÿï¼Œå†…æ ¸æ˜ å°„æ–‡ä»¶/sysï¼šä¼ªæ–‡ä»¶ç³»ç»Ÿï¼Œè·Ÿç¡¬ä»¶è®¾å¤‡ç›¸å…³çš„å±æ€§æ˜ å°„æ–‡ä»¶/tmpï¼šä¸´æ—¶æ–‡ä»¶/varï¼šå¯å˜åŒ–æ–‡ä»¶ï¼Œå¦‚å­˜æ”¾æ—¥å¿—æ–‡ä»¶/binï¼šå¯æ‰§è¡Œæ–‡ä»¶ï¼Œç”¨æˆ·å‘½ä»¤/sbinï¼šç®¡ç†å‘½ä»¤/usrï¼šUnix Software Resource(shared,read-only),æ“ä½œç³»ç»Ÿè½¯ä»¶èµ„æºæ‰€æ”¾ç½®çš„ç›®å½•,æ‰€æœ‰ç³»ç»Ÿé»˜è®¤çš„è½¯ä»¶éƒ½ä¼šæ”¾ç½®åˆ°/usr</code></pre><h2 id="ç®¡ç†"><a href="#ç®¡ç†" class="headerlink" title="ç®¡ç†"></a>ç®¡ç†</h2><h3 id="æ–‡ä»¶ç®¡ç†"><a href="#æ–‡ä»¶ç®¡ç†" class="headerlink" title="æ–‡ä»¶ç®¡ç†"></a>æ–‡ä»¶ç®¡ç†</h3><ul><li>touchï¼šchange file timestamps<br>  -aï¼šä¿®æ”¹è®¿é—®æ—¶é—´<br>  -mï¼šä¿®æ”¹æ›´æ”¹æ—¶é—´<br>  -tï¼šä¿®æ”¹åˆ°æŒ‡å®šæ—¶é—´</li><li>statï¼šæ˜¾ç¤ºæ–‡ä»¶æˆ–æ–‡ä»¶ç³»ç»ŸçŠ¶æ€</li></ul><pre><code class="hljs bash">[root@localhost ~]<span class="hljs-comment"># stat test</span>  File: â€˜<span class="hljs-built_in">test</span>â€™  Size: 4             Blocks: 8          IO Block: 4096   regular fileDevice: fd00h/64768d  Inode: 34051578    Links: 1Access: (0644/-rw-r--r--)  Uid: (    0/    root)   Gid: (    0/    root)Context: unconfined_u:object_r:admin_home_t:s0Access: 2020-08-18 23:29:02.280000000 +0800Modify: 2020-08-18 23:26:58.260000000 +0800Change: 2020-08-18 23:29:02.280000000 +0800 Birth: -</code></pre><ul><li>cp</li></ul><h3 id="ç›®å½•ç®¡ç†"><a href="#ç›®å½•ç®¡ç†" class="headerlink" title="ç›®å½•ç®¡ç†"></a>ç›®å½•ç®¡ç†</h3><ul><li>ls</li><li>cd</li><li>pwd</li><li>mkdirï¼šåˆ›å»ºç©ºç›®å½•<br>  -pï¼šä¾æ¬¡åˆ›å»ºå±‚çº§ç›®å½•ï¼Œå¦‚ mkdir -p /1/2/3<br>  -vï¼šæ˜¾ç¤ºè¯¦æƒ…</li></ul><pre><code class="hljs bash"><span class="hljs-comment">#ä¾‹1ï¼šåœ¨ç›®å½•ä¸‹åˆ›å»ºå¤šä¸ªç›®å½•ï¼Œå¦‚åœ¨ç©ºç›®å½• /mnt/ ä¸‹åˆ›å»º /mnt/test/x/m,/mnt/test/y</span>[root@localhost ~]<span class="hljs-comment"># mkdir -pv /mnt/test/&#123;x/m,y&#125;</span>mkdir: å·²åˆ›å»ºç›®å½• <span class="hljs-string">&quot;/mnt/test&quot;</span>mkdir: å·²åˆ›å»ºç›®å½• <span class="hljs-string">&quot;/mnt/test/x&quot;</span>mkdir: å·²åˆ›å»ºç›®å½• <span class="hljs-string">&quot;/mnt/test/x/m&quot;</span>mkdir: å·²åˆ›å»ºç›®å½• <span class="hljs-string">&quot;/mnt/test/y&quot;</span><span class="hljs-comment">#ä¾‹2ï¼šåœ¨ç›®å½•ä¸‹åˆ›å»º a_b,a_c,d_b,d_C æ–‡ä»¶</span>[root@localhost ~]<span class="hljs-comment"># mkdir -pv /mnt/test2/&#123;a,d&#125;_&#123;b,c&#125;</span>mkdir: å·²åˆ›å»ºç›®å½• <span class="hljs-string">&quot;/mnt/test2&quot;</span>mkdir: å·²åˆ›å»ºç›®å½• <span class="hljs-string">&quot;/mnt/test2/a_b&quot;</span>mkdir: å·²åˆ›å»ºç›®å½• <span class="hljs-string">&quot;/mnt/test2/a_c&quot;</span>mkdir: å·²åˆ›å»ºç›®å½• <span class="hljs-string">&quot;/mnt/test2/d_b&quot;</span>mkdir: å·²åˆ›å»ºç›®å½• <span class="hljs-string">&quot;/mnt/test2/d_c&quot;</span></code></pre><ul><li>rmdirï¼šåˆ é™¤ç©ºç›®å½•</li></ul><h3 id="æ–‡æœ¬å¤„ç†"><a href="#æ–‡æœ¬å¤„ç†" class="headerlink" title="æ–‡æœ¬å¤„ç†"></a>æ–‡æœ¬å¤„ç†</h3><pre><code class="hljs bash">cutï¼š    -dï¼šæŒ‡å®šå­—æ®µåˆ†éš”ç¬¦ï¼Œé»˜è®¤æ˜¯ç©ºæ ¼    -fï¼šæŒ‡å®šè¦æ˜¾ç¤ºçš„å­—æ®µ        -f 1ï¼Œ3 æ˜¾ç¤ºå­—æ®µ1å’Œ3çš„å­—ç¬¦        -f 1-3 æ˜¾ç¤ºå­—æ®µ1åˆ°3çš„å­—ç¬¦</code></pre><h3 id="å‘½ä»¤å†å²"><a href="#å‘½ä»¤å†å²" class="headerlink" title="å‘½ä»¤å†å²"></a>å‘½ä»¤å†å²</h3><pre><code class="hljs bash"><span class="hljs-built_in">history</span>ï¼šæŸ¥çœ‹å†å²å‘½ä»¤    -cï¼šæ¸…ç©ºå‘½ä»¤å†å²    -d OFFSET [n]ï¼šåˆ é™¤æŒ‡å®šä½ç½®çš„å‘½ä»¤    -wï¼šä¿å­˜å‘½ä»¤å†å²è‡³å†å²æ–‡ä»¶ä¸­!nï¼šæ‰§è¡Œå‘½ä»¤å†å²çš„ç¬¬Næ¡å‘½ä»¤</code></pre><h3 id="grep"><a href="#grep" class="headerlink" title="grep"></a>grep</h3><p>æ ¹æ®æ¨¡å¼ï¼Œæœç´¢æ–‡æœ¬ï¼Œå¹¶å°†ç¬¦åˆæ¨¡å¼çš„æ–‡æœ¬è¡Œæ˜¾ç¤ºå‡ºæ¥<br>Patternï¼šæ–‡æœ¬å­—ç¬¦å’Œæ­£åˆ™è¡¨è¾¾å¼çš„å…ƒå­—ç¬¦ç»„åˆè€Œæˆçš„åŒ¹é…æ¡ä»¶</p><pre><code class="hljs bash">grep [OPTIONS] PATTERN [FILE...]        -iï¼šå¿½ç•¥å¤§å°å­—æ¯        -vï¼šæ˜¾ç¤ºæ²¡æœ‰è¢«åŒ¹é…åˆ°çš„è¡Œ        -oï¼šåªæ˜¾ç¤ºè¢«æ¨¡å¼åŒ¹é…åˆ°çš„å­—ç¬¦ä¸²        -Eï¼šä½¿ç”¨æ‰©å±•æ­£åˆ™è¡¨è¾¾å¼        -A <span class="hljs-comment">#ï¼šæ˜¾ç¤ºåŒ¹é…åˆ°çš„å#è¡Œ</span>        -B <span class="hljs-comment">#ï¼šæ˜¾ç¤ºåŒ¹é…åˆ°çš„å‰#è¡Œ</span>        -C <span class="hljs-comment">#ï¼šæ˜¾ç¤ºåŒ¹é…åˆ°çš„ä¸Šä¸‹#è¡Œ</span></code></pre><h3 id="æ­£åˆ™è¡¨è¾¾å¼ï¼ˆREGular-EXPression-REGEXPï¼‰"><a href="#æ­£åˆ™è¡¨è¾¾å¼ï¼ˆREGular-EXPression-REGEXPï¼‰" class="headerlink" title="æ­£åˆ™è¡¨è¾¾å¼ï¼ˆREGular EXPression, REGEXPï¼‰"></a>æ­£åˆ™è¡¨è¾¾å¼ï¼ˆREGular EXPression, REGEXPï¼‰</h3><p><strong>å…ƒå­—ç¬¦ï¼š</strong></p><p>.ï¼šåŒ¹é…å…¶å‰é¢çš„å­—ç¬¦ä»»æ„æ¬¡</p><p>[]ï¼šåŒ¹é…æŒ‡å®šèŒƒå›´å†…çš„ä»»æ„å•å­—ç¬¦</p><p>[^]ï¼šåŒ¹é…æŒ‡å®šèŒƒå›´å¤–çš„ä»»æ„å•ä¸ªå­—ç¬¦</p><table><thead><tr><th align="left">å­—ç¬¦ç°‡</th><th align="left">æè¿°</th></tr></thead><tbody><tr><td align="left">[[:alpha:]]</td><td align="left">ä»»ä½•å­—æ¯</td></tr><tr><td align="left">[[:digit:]]</td><td align="left">ä»»ä½•æ•°å­—</td></tr><tr><td align="left">[[:alnum:]]</td><td align="left">ä»»ä½•å­—æ¯å’Œæ•°å­—</td></tr><tr><td align="left">[[:space:]]</td><td align="left">ä»»ä½•ç©ºç™½å­—ç¬¦</td></tr><tr><td align="left">[[:upper:]]</td><td align="left">ä»»ä½•å¤§å†™å­—æ¯</td></tr><tr><td align="left">[[:lower:]]</td><td align="left">ä»»ä½•å°å†™å­—æ¯</td></tr><tr><td align="left">[[:punct:]]</td><td align="left">ä»»ä½•æ ‡ç‚¹ç¬¦å·</td></tr><tr><td align="left">[[:xdigit:]]</td><td align="left">ä»»ä½•16è¿›åˆ¶çš„æ•°å­—ï¼Œç›¸å½“äº[0-9a-fA-F]</td></tr></tbody></table><p><strong>åŒ¹é…æ¬¡æ•°ï¼š</strong></p><pre><code class="hljs bash">*ï¼šåŒ¹é…å…¶å‰é¢çš„å­—ç¬¦ä»»æ„æ¬¡\?ï¼šåŒ¹é…å…¶å‰é¢çš„çš„å­—ç¬¦1æ¬¡æˆ–0æ¬¡\&#123;m,n\&#125;ï¼šåŒ¹é…å…¶å‰é¢çš„å­—ç¬¦è‡³å°‘mæ¬¡ï¼Œè‡³å¤šnæ¬¡</code></pre><p><strong>ä½ç½®é”šå®šï¼š</strong></p><pre><code class="hljs bash">^ï¼šé”šå®šè¡Œé¦–ï¼Œæ­¤å­—ç¬¦åé¢çš„ä»»æ„å†…å®¹å¿…é¡»å‡ºç°åœ¨è¡Œé¦–[root@localhost learing]<span class="hljs-comment"># cat test_grep_fenzu.txt </span> 1space  2space   3space<span class="hljs-comment">#æ˜¾ç¤ºè¡Œé¦–è‡³å°‘æœ‰ä¸€ä¸ªç©ºç™½å­—ç¬¦</span>[root@localhost learing]<span class="hljs-comment"># grep -E &#x27;^[[:space:]]+&#x27; test_grep_fenzu.txt </span> 1space  2space   3space$ï¼šé”šå®šè¡Œå°¾ï¼Œæ­¤å­—ç¬¦åé¢çš„ä»»æ„å†…å®¹å¿…é¡»å‡ºç°åœ¨è¡Œå°¾^$ï¼šç©ºç™½è¡Œ\&lt;æˆ–\bï¼šé”šå®šè¯é¦–ï¼Œå…¶åé¢çš„ä»»æ„å­—ç¬¦å¿…é¡»ä½œä¸ºå•æ¬¡é¦–éƒ¨å‡ºç°\&gt;æˆ–\bï¼šé”šå®šè¯å°¾ï¼Œå…¶å‰é¢çš„ä»»æ„å­—ç¬¦å¿…é¡»ä½œä¸ºå•æ¬¡å°¾éƒ¨å‡ºç°<span class="hljs-comment">#ä½¿ç”¨ \&lt;()\&gt; æ‰¾å‡º1-255çš„æ•°å­—</span>[root@localhost learing]<span class="hljs-comment"># ifconfig | grep -E &#x27;\&lt;([1-9]|[1-9][0-9]|1[0-9][0-9]|2[0-4][0-9]|25[0-5])\&gt;&#x27;</span>        inet 192.168.2.22  netmask 255.255.255.0  broadcast 192.168.2.255        inet6 fd2a:2d84:d032:0:650f:b141:8e42:b014  prefixlen 64  scopeid 0x0&lt;global&gt;        inet6 fe80::3416:22f7:9cb1:88ba  prefixlen 64  scopeid 0x20&lt;link&gt;        inet6 fd2a:2d84:d032::778  prefixlen 128  scopeid 0x0&lt;global&gt;        RX packets 976525  bytes 271923354 (259.3 MiB)        TX packets 884321  bytes 110229028 (105.1 MiB)<span class="hljs-comment">#æŸ¥æ‰¾ ip åœ°å€</span>[root@localhost learing]<span class="hljs-comment"># ifconfig | grep -E &#x27;(\&lt;([0-9]|[1-9][0-9]|1[0-9][0-9]|2[0-4][0-9]|25[0-5])\&gt;\.)&#123;3&#125;\&lt;([0-9]|[1-9][0-9]|1[0-9][0-9]|2[0-4][0-9]|25[0-5])\&gt;&#x27;</span>        inet 192.168.2.22  netmask 255.255.255.0  broadcast 192.168.2.255        inet 127.0.0.1  netmask 255.0.0.0</code></pre><p><strong>åˆ†ç»„ï¼š</strong></p><pre><code class="hljs bash">\(\)    \(ab\)ï¼šabä¸ºä¸€æ•´ä½“å‡ºç°[root@localhost learing]<span class="hljs-comment"># cat test_grep_fenzu.txt </span>catCatchinacCChina 1space  2space   3space<span class="hljs-comment">#not use ()</span>[root@localhost learing]<span class="hljs-comment"># grep -E &#x27;C|cat&#x27; test_grep_fenzu.txt </span>catCatCChina<span class="hljs-comment">#use ()</span>[root@localhost learing]<span class="hljs-comment"># grep -E &#x27;(C|c)at&#x27; test_grep_fenzu.txt </span>catCat</code></pre><h1 id="bash"><a href="#bash" class="headerlink" title="bash"></a>bash</h1><h2 id="å˜é‡ç±»å‹"><a href="#å˜é‡ç±»å‹" class="headerlink" title="å˜é‡ç±»å‹"></a>å˜é‡ç±»å‹</h2><p><strong>å˜é‡ç®—æ³•ï¼š</strong></p><p>$[$A-$B]ï¼šå˜é‡ A å‡å» å˜é‡ B</p><h2 id="å¼•ç”¨å˜é‡"><a href="#å¼•ç”¨å˜é‡" class="headerlink" title="å¼•ç”¨å˜é‡"></a>å¼•ç”¨å˜é‡</h2><p>${VAR_NAME}ï¼Œä¸€èˆ¬èŠ±æ‹¬å·å¯çœç•¥ï¼ŒæŸäº›æƒ…å†µæ— æ³•çœç•¥</p><pre><code class="hljs bash"><span class="hljs-comment">#æ— æ³•çœç•¥</span>[root@localhost learing]<span class="hljs-comment"># ANIMAL=pig</span>[root@localhost learing]<span class="hljs-comment"># echo &quot;there are some $ANIMALs.&quot;</span>there are some .[root@localhost learing]<span class="hljs-comment"># echo &quot;there are some $&#123;ANIMAL&#125;s.&quot;</span>there are some pigs.</code></pre><h2 id="ç¨‹åºæ‰§è¡Œè¿”å›"><a href="#ç¨‹åºæ‰§è¡Œè¿”å›" class="headerlink" title="ç¨‹åºæ‰§è¡Œè¿”å›"></a>ç¨‹åºæ‰§è¡Œè¿”å›</h2><p>ç¨‹åºæ‰§è¡Œè¿”å›çŠ¶æ€ç ï¼ˆ0-255ï¼‰ï¼š</p><ul><li>0ï¼šæ­£ç¡®æ‰§è¡Œ</li><li>1-255ï¼šé”™è¯¯æ‰§è¡Œï¼Œ1ã€2ã€127 ä¸ºç³»ç»Ÿé¢„ç•™</li></ul><h2 id="æ¡ä»¶åˆ¤æ–­"><a href="#æ¡ä»¶åˆ¤æ–­" class="headerlink" title="æ¡ä»¶åˆ¤æ–­"></a>æ¡ä»¶åˆ¤æ–­</h2><h3 id="æ¡ä»¶æµ‹è¯•ç±»å‹"><a href="#æ¡ä»¶æµ‹è¯•ç±»å‹" class="headerlink" title="æ¡ä»¶æµ‹è¯•ç±»å‹"></a>æ¡ä»¶æµ‹è¯•ç±»å‹</h3><ul><li>æ•´æ•°æµ‹è¯•</li><li>å­—ç¬¦æµ‹è¯•</li><li>æ–‡ä»¶æµ‹è¯•</li></ul><h3 id="æ¡ä»¶æµ‹è¯•è¡¨è¾¾å¼"><a href="#æ¡ä»¶æµ‹è¯•è¡¨è¾¾å¼" class="headerlink" title="æ¡ä»¶æµ‹è¯•è¡¨è¾¾å¼"></a>æ¡ä»¶æµ‹è¯•è¡¨è¾¾å¼</h3><ul><li>[ expression ]</li><li>[[ expression]]</li></ul><h3 id="å‘½ä»¤é€»è¾‘å…³ç³»"><a href="#å‘½ä»¤é€»è¾‘å…³ç³»" class="headerlink" title="å‘½ä»¤é€»è¾‘å…³ç³»"></a>å‘½ä»¤é€»è¾‘å…³ç³»</h3><p><strong>é€»è¾‘ä¸ï¼š&amp;&amp;</strong></p><ul><li>ç¬¬ä¸€ä¸ªæ¡ä»¶ä¸ºå‡æ—¶ï¼Œç¬¬äºŒä¸ªæ¡ä»¶å°±ä¸ç”¨å†åˆ¤æ–­ï¼Œæœ€æ€»ç»“æœä¸ºå‡</li><li>ç¬¬ä¸€ä¸ªæ¡ä»¶ä¸ºçœŸæ˜¯ï¼Œè¿˜éœ€è¦åˆ¤æ–­ç¬¬äºŒä¸ªæ¡ä»¶</li></ul><p>ä¾‹å­ï¼š</p><pre><code class="hljs bahs">#åˆ¤æ–­ç”¨æˆ· user1 æ˜¯å¦å­˜åœ¨ï¼Œä¸å­˜åœ¨å°±å¢åŠ  user1 ç”¨æˆ·! id user1 &amp;&amp; useradd user1</code></pre><p><strong>é€»è¾‘æˆ–ï¼š||</strong><br>æœ‰ä¸ªçœŸï¼Œå°±æ˜¯çœŸ<br>ä¾‹å­ï¼š</p><pre><code class="hljs bash"><span class="hljs-comment">#åˆ¤æ–­ç”¨æˆ· user1 å­˜åœ¨ï¼Œå°±æ˜¾ç¤ºç”¨æˆ·å·²å­˜åœ¨ï¼Œå¦åˆ™ï¼Œå°±æ·»åŠ ç”¨æˆ·</span>id user1 &amp;&amp; <span class="hljs-built_in">echo</span> <span class="hljs-string">&#x27;user1 exists.&#x27;</span> || useradd user1<span class="hljs-comment">#åˆ¤æ–­ç”¨æˆ· user1 ä¸å­˜åœ¨ï¼Œå°±æ·»åŠ ç”¨æˆ·ï¼Œå¦åˆ™ï¼Œæ˜¾ç¤ºå·²å­˜åœ¨</span>! id user1 &amp;&amp; useradd user1 || <span class="hljs-built_in">echo</span> <span class="hljs-string">&#x27;user1 exists.&#x27;</span></code></pre><h3 id="shell-ç®—æœ¯è¿ç®—"><a href="#shell-ç®—æœ¯è¿ç®—" class="headerlink" title="shell ç®—æœ¯è¿ç®—"></a>shell ç®—æœ¯è¿ç®—</h3><ol><li>let ç®—æ•°è¡¨è¾¾å¼<ul><li>let C=$A+$B</li></ul></li><li>$[ç®—æœ¯è¡¨è¾¾å¼]<ul><li>$[$A-$B]</li></ul></li><li>$((ç®—æœ¯è¡¨è¾¾å¼))<ul><li>$((ç®—æœ¯è¡¨è¾¾å¼))</li></ul></li></ol><h3 id="exit"><a href="#exit" class="headerlink" title="exit"></a>exit</h3><p>é€€å‡ºè„šæœ¬</p><h3 id="æ–‡ä»¶æµ‹è¯•"><a href="#æ–‡ä»¶æµ‹è¯•" class="headerlink" title="æ–‡ä»¶æµ‹è¯•"></a>æ–‡ä»¶æµ‹è¯•</h3><ul><li>-e Fileï¼šæµ‹è¯•æ–‡ä»¶æ˜¯å¦å­˜åœ¨</li><li>-f Fileï¼šæµ‹è¯•æ–‡ä»¶æ˜¯å¦ä¸ºæ™®é€šæ–‡ä»¶</li><li>-d Fileï¼šæµ‹è¯•æŒ‡å®šç›®å½•æ˜¯å¦ä¸ºç›®å½•</li><li>-r Fileï¼šæµ‹è¯•å½“å‰ç”¨æˆ·å¯¹æŒ‡å®šæ–‡ä»¶æ˜¯å¦æœ‰å¯è¯»æƒé™</li><li>-w</li><li>-x</li></ul><h2 id="sed-Stream-EDitor"><a href="#sed-Stream-EDitor" class="headerlink" title="sed (Stream EDitor)"></a>sed (Stream EDitor)</h2><p><font color=red>é»˜è®¤ä¸ç¼–è¾‘åŸæ–‡ä»¶ï¼Œä»…å¯¹æ¨¡å¼ç©ºé—´çš„æ•°æ®åšå¤„ç†</font></p><pre><code class="hljs bash">sed [options] <span class="hljs-string">&#x27;AddressCommand&#x27;</span> file1 [file2 ...]    -nï¼šé™é»˜æ¨¡å¼ï¼Œä¸å†é»˜è®¤æ˜¾ç¤ºæ¨¡å¼ç©ºé—´çš„å†…å®¹    -iï¼šç›´æ¥ä¿®æ”¹åŸæ–‡ä»¶    -e scriptï¼šå¯ä»¥åŒæ—¶æ‰§è¡Œå¤šä¸ªè„šæœ¬    -f filenameï¼šè¯»å– filename é‡Œçš„è„šæœ¬å¤„ç† sed /path/to/sed_script ä½œç”¨file    -rï¼šè¡¨ç¤ºä½¿ç”¨æ‰©å±•æ­£åˆ™è¡¨è¾¾å¼</code></pre><p><strong>Address</strong></p><ol><li><p>StartLine,EndLine: </p><ul><li>1,100 ï¼š1åˆ°100è¡Œ</li><li>$ï¼šæœ€åä¸€è¡Œ</li></ul></li><li><p>/æ¨¡å¼å®šä¹‰/ï¼š/^root/</p></li><li><p>/pattern1/,/pattern2/ï¼šç¬¬ä¸€æ¬¡è¢« pattern1 åŒ¹é…åˆ°çš„è¡Œï¼Œè‡³ç¬¬ä¸€æ¬¡è¢« pattern2 åŒ¹é…åˆ°çš„è¡Œç»“æŸï¼Œä¸­ä¸­é—´çš„è¡Œ</p></li><li><p>LineNumberï¼šæŒ‡å®šçš„è¡Œæ•°</p></li><li><p>StartLineï¼Œ+Nï¼šä» StartLine å¼€å§‹ï¼Œå‘åçš„ Nè¡Œ</p></li></ol><p><strong>Command</strong></p><ol><li><p>dï¼šåˆ é™¤ç¬¦åˆæ¡ä»¶çš„è¡Œ</p><ul><li>sed â€˜1,3dâ€™ /etc/fstab ï¼šåˆ é™¤ fstab çš„ç¬¬ 1 åˆ° ç¬¬ 3 è¡Œ</li><li>sed â€˜/oot/dâ€™ /etc/fstab ï¼šåˆ é™¤åŒ…å« oot çš„è¡Œ</li></ul></li><li><p>pï¼šæ˜¾ç¤ºç¬¦åˆæ¡ä»¶çš„è¡Œ</p><ul><li>sed -n â€˜/^//a#sed testâ€™ /etc/fstab <pre><code class="hljs bash">[root@localhost ~]<span class="hljs-comment"># sed -n &#x27;/^\//p&#x27; /etc/fstab </span>/dev/mapper/centos-root /                       xfs     defaults        0 0/dev/mapper/centos-swap swap                    swap    defaults        0 0</code></pre></li></ul></li><li><p>a \stringï¼šåœ¨æŒ‡å®šçš„è¡Œåé¢è¿½åŠ æ–°è¡Œï¼Œå†…å®¹ä¸º string</p><ul><li>sed â€˜/^//a#sed testâ€™ /etc/fstab ï¼šåœ¨ / å¼€å¤´çš„è¡Œä¸‹è¡Œæ·»åŠ ä¸€è¡Œå†…å®¹ä¸º #sed test çš„è¡Œ</li><li>\n å¯ä»¥æ¢è¡Œ<pre><code class="hljs bash">[root@localhost ~]<span class="hljs-comment"># sed &#x27;/^\//a\#sed test&#x27; /etc/fstab </span><span class="hljs-comment">#</span><span class="hljs-comment"># /etc/fstab</span><span class="hljs-comment"># Created by anaconda on Sat Jun  6 20:09:07 2020</span><span class="hljs-comment">#</span><span class="hljs-comment"># Accessible filesystems, by reference, are maintained under &#x27;/dev/disk&#x27;</span><span class="hljs-comment"># See man pages fstab(5), findfs(8), mount(8) and/or blkid(8) for more info</span><span class="hljs-comment">#</span>/dev/mapper/centos-root /                       xfs     defaults        0 0<span class="hljs-comment">#sed test</span>UUID=39b6f37f-531f-41c2-a498-dbe216fcfc4b /boot                   xfs     defaults        0 0/dev/mapper/centos-swap swap                    swap    defaults        0 0<span class="hljs-comment">#sed test</span></code></pre></li></ul></li><li><p>i \stringï¼šåœ¨æŒ‡å®šçš„è¡Œå‰é¢æ·»åŠ æ–°è¡Œï¼Œå†…å®¹ä¸º string</p></li><li><p>r filenameï¼šå°†æŒ‡å®šæ–‡ä»¶çš„å†…å®¹æ·»åŠ è‡³ç¬¦åˆæ¡ä»¶çš„è¡Œå¤„</p><pre><code class="hljs bash">[root@localhost ~]<span class="hljs-comment"># cat /etc/issue</span>\SKernel \r on an \m[root@localhost ~]<span class="hljs-comment"># sed &#x27;1r /etc/issue&#x27; /etc/fstab </span>\SKernel \r on an \m<span class="hljs-comment">#</span><span class="hljs-comment"># /etc/fstab</span><span class="hljs-comment"># Created by anaconda on Sat Jun  6 20:09:07 2020</span><span class="hljs-comment">#</span><span class="hljs-comment"># Accessible filesystems, by reference, are maintained under &#x27;/dev/disk&#x27;</span><span class="hljs-comment"># See man pages fstab(5), findfs(8), mount(8) and/or blkid(8) for more info</span><span class="hljs-comment">#</span>/dev/mapper/centos-root /                       xfs     defaults        0 0UUID=39b6f37f-531f-41c2-a498-dbe216fcfc4b /boot                   xfs     defaults        0 0/dev/mapper/centos-swap swap                    swap    defaults        0 0</code></pre></li><li><p>w filenameï¼šå°†æŒ‡å®šèŒƒå›´å†…çš„å†…å®¹å¦å­˜è‡³æŒ‡å®šçš„æ–‡ä»¶ä¸­</p><pre><code class="hljs bash">[root@localhost ~]<span class="hljs-comment"># sed -n &#x27;/^\//w /root/mount.txt&#x27; /etc/fstab </span>[root@localhost ~]<span class="hljs-comment"># cat /root/mount.txt </span>/dev/mapper/centos-root /                       xfs     defaults        0 0/dev/mapper/centos-swap swap                    swap    defaults        0 0</code></pre></li><li><p>s/pattern/string/[ä¿®é¥°ç¬¦]ï¼šæŸ¥æ‰¾å¹¶æ›¿æ¢ï¼Œæ›¿æ¢æ¯è¡Œä¸­ç¬¬ä¸€æ¬¡è¢«åŒ¹é…åˆ°çš„å­—ç¬¦ä¸²</p></li></ol><ul><li>ä¿®é¥°ç¬¦<ul><li>g ï¼šå…¨å±€æ›¿æ¢</li><li>iï¼šå¿½ç•¥å¤§å°å†™</li></ul></li><li>s///,s###,s@@@ï¼šå¯ä½¿ç”¨å…¶ä»–åˆ†éš”ç¬¦</li></ul><pre><code class="hljs bash"><span class="hljs-comment">#æŸ¥æ‰¾ root æ›¿æ¢æˆ ROOTï¼ŒæŸ¥æ‰¾èƒ½å¤Ÿç”¨æ­£åˆ™è¡¨è¾¾å¼</span>[root@localhost ~]<span class="hljs-comment"># sed &#x27;s/root/ROOT/&#x27; /etc/fstab </span>/dev/mapper/centos-ROOT /                       xfs     defaults        0 0UUID=39b6f37f-531f-41c2-a498-dbe216fcfc4b /boot                   xfs     defaults        0 0/dev/mapper/centos-swap swap                    swap    defaults        0 0</code></pre><ol start="8"><li>æ›´æ”¹å­—ç¬¦ä¸²</li></ol><pre><code class="hljs bash"><span class="hljs-comment">#å°†å­—ç¬¦å¸¦æœ‰ l..k åé¢æ·»åŠ  r</span>[root@localhost learing]<span class="hljs-comment"># cat sed.txt </span>likelove<span class="hljs-comment">#ç¬¬ä¸€ç§ï¼Œç”¨ &amp;</span>[root@localhost learing]<span class="hljs-comment"># sed &#x27;s/l..e/&amp;r/&#x27; sed.txt </span>likerlover<span class="hljs-comment">#ç¬¬äºŒç§ï¼Œç”¨åˆ†ç»„</span>[root@localhost learing]<span class="hljs-comment"># sed &#x27;s/\(l..e\)/\1r/&#x27; sed.txt </span>likerlover</code></pre><ol start="9"><li>åˆ é™¤æ¯è¡Œå¼€å¤´çš„ç©ºæ ¼</li></ol><pre><code class="hljs bash"><span class="hljs-comment">#å¯åˆ é™¤å¤šä¸ªç©ºæ ¼</span>[root@localhost learing]<span class="hljs-comment"># history | sed &#x27;s/^[[:space:]]*//g&#x27;</span>1022  <span class="hljs-built_in">history</span> | sed <span class="hljs-string">&#x27;s/ //&#x27;</span>1023  <span class="hljs-built_in">history</span> | sed <span class="hljs-string">&#x27;s/^ //&#x27;</span>1024  <span class="hljs-built_in">history</span> | sed <span class="hljs-string">&#x27;s/[[:space:]//&#x27;</span>1025  <span class="hljs-built_in">history</span> | sed <span class="hljs-string">&#x27;s/[[:space:]]//&#x27;</span>1026  <span class="hljs-built_in">history</span> | sed <span class="hljs-string">&#x27;s/^[[:space:]]+//&#x27;</span>1027  <span class="hljs-built_in">history</span> | sed <span class="hljs-string">&#x27;s/^[[:space:]]*//&#x27;</span>1028  <span class="hljs-built_in">history</span> | sed <span class="hljs-string">&#x27;s/^[[:space:]]+1//&#x27;</span>1029  <span class="hljs-built_in">history</span> | sed <span class="hljs-string">&#x27;s/^[[:space:]]*//&#x27;</span></code></pre>]]></content>
    
    
    <categories>
      
      <category>Linux</category>
      
    </categories>
    
    
    <tags>
      
      <tag>Linux</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>åä¸º HCNA å­¦ä¹ ç¬”è®°</title>
    <link href="/2020/07/26/Huawei_route_base/"/>
    <url>/2020/07/26/Huawei_route_base/</url>
    
    <content type="html"><![CDATA[<p>åä¸ºè®¤è¯ç½‘ç»œå·¥ç¨‹å¸ˆæ˜¯ç”±åä¸ºå…¬å¸è®¤è¯ä¸é‡‡è´­éƒ¨æ¨å‡ºçš„ç‹¬ç«‹è®¤è¯ä½“ç³»ï¼Œä¸ä¹‹å‰çš„åä¸ºè®¤è¯ä¸åŒï¼Œç®€ç§°HCNAã€‚</p><h1 id="ä¸€ã€åŸºæœ¬æ“ä½œ"><a href="#ä¸€ã€åŸºæœ¬æ“ä½œ" class="headerlink" title="ä¸€ã€åŸºæœ¬æ“ä½œ"></a>ä¸€ã€åŸºæœ¬æ“ä½œ</h1><h2 id="1-1-åä¸ºè·¯ç”±-äº¤æ¢è§†å›¾åˆ‡æ¢"><a href="#1-1-åä¸ºè·¯ç”±-äº¤æ¢è§†å›¾åˆ‡æ¢" class="headerlink" title="1.1 åä¸ºè·¯ç”±/äº¤æ¢è§†å›¾åˆ‡æ¢"></a>1.1 åä¸ºè·¯ç”±/äº¤æ¢è§†å›¾åˆ‡æ¢</h2><p>&lt;Huawei&gt; ç”¨æˆ·è§†å›¾ â€”-&gt; [Huawei] ç³»ç»Ÿè§†å›¾</p><pre><code class="hljs routeros">&lt;Huawei&gt;system-view Enter<span class="hljs-built_in"> system </span>view, return<span class="hljs-built_in"> user </span>view with Ctrl+Z.[Huawei]</code></pre><h2 id="1-2-æŸ¥çœ‹è·¯ç”±ä¿¡æ¯"><a href="#1-2-æŸ¥çœ‹è·¯ç”±ä¿¡æ¯" class="headerlink" title="1.2 æŸ¥çœ‹è·¯ç”±ä¿¡æ¯"></a>1.2 æŸ¥çœ‹è·¯ç”±ä¿¡æ¯</h2><p>ç‰ˆæœ¬ï¼š</p><pre><code class="hljs routeros">&lt;Huawei&gt;dis version Huawei Versatile<span class="hljs-built_in"> Routing </span>Platform SoftwareVRP (R) software, Version 5.110 (eNSP V100R001C00)Copyright (c) 2000-2011 HUAWEI TECH CO., LTD</code></pre><p>æ“ä½œç³»ç»Ÿ <font color=red>VRP</font>â€”&gt; Huawei Versatile Routing Platform Software</p><p>æŸ¥çœ‹ flashï¼ˆæ“ä½œç³»ç»ŸåŠé…ç½®æ–‡ä»¶éƒ½æ”¾åœ¨ flash é‡Œé¢ï¼‰ï¼š</p><pre><code class="hljs angelscript">&lt;Huawei&gt;dir#æ˜¾ç¤ºæ‰€æœ‰æ–‡ä»¶Directory of flash:/  Idx  Attr     Size(Byte)  Date        Time       FileName     <span class="hljs-number">0</span>  drw-              -  Aug <span class="hljs-number">07</span> <span class="hljs-number">2015</span> <span class="hljs-number">13</span>:<span class="hljs-number">51</span>:<span class="hljs-number">14</span>   src    <span class="hljs-number">1</span>  drw-              -  Jul <span class="hljs-number">31</span> <span class="hljs-number">2020</span> <span class="hljs-number">14</span>:<span class="hljs-number">34</span>:<span class="hljs-number">44</span>   pmdata    <span class="hljs-number">2</span>  drw-              -  Jul <span class="hljs-number">31</span> <span class="hljs-number">2020</span> <span class="hljs-number">14</span>:<span class="hljs-number">34</span>:<span class="hljs-number">50</span>   dhcp    <span class="hljs-number">3</span>  -rw-             <span class="hljs-number">28</span>  Jul <span class="hljs-number">31</span> <span class="hljs-number">2020</span> <span class="hljs-number">14</span>:<span class="hljs-number">34</span>:<span class="hljs-number">50</span>   <span class="hljs-keyword">private</span>-data.txt    <span class="hljs-number">4</span>  -rw-            <span class="hljs-number">452</span>  Jul <span class="hljs-number">31</span> <span class="hljs-number">2020</span> <span class="hljs-number">14</span>:<span class="hljs-number">39</span>:<span class="hljs-number">27</span>   vrpcfg.zip#è·¯ç”±é…ç½®ä¿¡æ¯ï¼Œé…ç½®å®Œè·¯ç”±å™¨ save åç”Ÿæˆçš„æ–‡ä»¶<span class="hljs-number">32</span>,<span class="hljs-number">004</span> KB total (<span class="hljs-number">31</span>,<span class="hljs-number">995</span> KB free)</code></pre><p>æ–‡ä»¶æ“ä½œå‘½ä»¤ï¼š</p><pre><code class="hljs sql"><span class="hljs-keyword">delete</span> vrpcfg.zip<span class="hljs-comment">#åˆ é™¤é…ç½®æ–‡ä»¶</span><span class="hljs-keyword">rename</span> vrpcfg.zip vrpcfg.zip.bak<span class="hljs-comment">#é‡å‘½åé…ç½®æ–‡ä»¶</span>copy vrpcfg.zip vrpcfg.zip.bak<span class="hljs-comment">#å¤åˆ¶æ–‡ä»¶</span>mkdirdemo<span class="hljs-comment">#åˆ›å»ºæ–‡ä»¶å¤¹</span>cd demo<span class="hljs-comment">#è¿›å…¥demoæ–‡ä»¶å¤¹</span>unzip xx.zip <span class="hljs-comment">#è§£å‹</span>more xx<span class="hljs-comment">#æŸ¥çœ‹æ–‡ä»¶å†…å®¹</span>å¸¦ [ ] è¡¨ç¤ºä½äºå›æ”¶ç«™é‡Œçš„æ–‡ä»¶<span class="hljs-keyword">reset</span> <span class="hljs-keyword">recycle</span>-<span class="hljs-keyword">bin</span>  <span class="hljs-comment">#æ¸…ç©ºå›æ”¶ç«™</span></code></pre><h1 id="äºŒã€é…ç½®ç«¯å£"><a href="#äºŒã€é…ç½®ç«¯å£" class="headerlink" title="äºŒã€é…ç½®ç«¯å£"></a>äºŒã€é…ç½®ç«¯å£</h1><pre><code class="hljs routeros">[Huawei]int e0/0/0#è¿›å…¥ç«¯å£[Huawei-Ethernet0/0/0]ip <span class="hljs-builtin-name">add</span> 192.168.1.1 24#é…ç½®ipå’Œ24ä½å­ç½‘æ©ç [Huawei-Ethernet0/0/0]dis this#æ˜¾ç¤ºæ¥å£ä¿¡æ¯<span class="hljs-comment">#</span>interface Ethernet0/0/0<span class="hljs-built_in"> ip address </span>192.168.1.1 255.255.255.0<span class="hljs-comment">#</span>return[Huawei-Ethernet0/0/0]undo<span class="hljs-built_in"> ip address </span>#åˆ é™¤æ¥å£ä¿¡æ¯</code></pre><h2 id="2-1-æ˜¾ç¤ºæ¥å£æ‘˜è¦"><a href="#2-1-æ˜¾ç¤ºæ¥å£æ‘˜è¦" class="headerlink" title="2.1 æ˜¾ç¤ºæ¥å£æ‘˜è¦"></a>2.1 æ˜¾ç¤ºæ¥å£æ‘˜è¦</h2><pre><code class="hljs routeros">[Huawei]display<span class="hljs-built_in"> ip </span>int brief <span class="hljs-number">*d</span>own: administratively down!down: FIB overload down^down: standby(l): loopback(s): spoofing(d): Dampening SuppressedThe number of<span class="hljs-built_in"> interface </span>that is UP <span class="hljs-keyword">in</span> Physical is 3The number of<span class="hljs-built_in"> interface </span>that is DOWN <span class="hljs-keyword">in</span> Physical is 8The number of<span class="hljs-built_in"> interface </span>that is UP <span class="hljs-keyword">in</span> Protocol is 3The number of<span class="hljs-built_in"> interface </span>that is DOWN <span class="hljs-keyword">in</span> Protocol is 8Interface                        <span class="hljs-built_in"> IP </span>Address/Mask      Physical   Protocol  Ethernet0/0/0                     192.168.1.1/24       up         up        Ethernet0/0/1                     172.16.1.1/24        up         up        GigabitEthernet0/0/0              unassigned           down       down      GigabitEthernet0/0/1              unassigned           down       down      GigabitEthernet0/0/2              unassigned           down       down      GigabitEthernet0/0/3              unassigned           down       down      NULL0                             unassigned           up         up(s)     Serial0/0/0                       unassigned           down       down      Serial0/0/1                       unassigned           down       down      Serial0/0/2                       unassigned           down       down      Serial0/0/3                       unassigned           down       down</code></pre><h2 id="2-2-æ˜¾ç¤ºè·¯ç”±è¡¨"><a href="#2-2-æ˜¾ç¤ºè·¯ç”±è¡¨" class="headerlink" title="2.2 æ˜¾ç¤ºè·¯ç”±è¡¨"></a>2.2 æ˜¾ç¤ºè·¯ç”±è¡¨</h2><blockquote><p>è·¯ç”±å™¨è½¬å‘æ•°æ®åŒ…çš„å”¯ä¸€ä¾æ®ï¼Œæ˜¯è·¯ç”±å™¨è½¬å‘æ•°æ®åŒ…çš„ä¸€å¼ â€œåœ°å›¾â€</p></blockquote><pre><code class="hljs angelscript">[Huawei]display ip routing-table Route Flags: R - relay, D - download to fib------------------------------------------------------------------------------Routing Tables: Public         Destinations : <span class="hljs-number">6</span>        Routes : <span class="hljs-number">6</span>        Destination/Mask    Proto   Pre  Cost      Flags NextHop         Interface      <span class="hljs-number">127.0</span><span class="hljs-number">.0</span><span class="hljs-number">.0</span>/<span class="hljs-number">8</span>   Direct  <span class="hljs-number">0</span>    <span class="hljs-number">0</span>           D   <span class="hljs-number">127.0</span><span class="hljs-number">.0</span><span class="hljs-number">.1</span>       InLoopBack0      <span class="hljs-number">127.0</span><span class="hljs-number">.0</span><span class="hljs-number">.1</span>/<span class="hljs-number">32</span>  Direct  <span class="hljs-number">0</span>    <span class="hljs-number">0</span>           D   <span class="hljs-number">127.0</span><span class="hljs-number">.0</span><span class="hljs-number">.1</span>       InLoopBack0     <span class="hljs-number">172.16</span><span class="hljs-number">.1</span><span class="hljs-number">.0</span>/<span class="hljs-number">24</span>  Direct  <span class="hljs-number">0</span>    <span class="hljs-number">0</span>           D   <span class="hljs-number">172.16</span><span class="hljs-number">.1</span><span class="hljs-number">.1</span>      Ethernet0/<span class="hljs-number">0</span>/<span class="hljs-number">1</span>     <span class="hljs-number">172.16</span><span class="hljs-number">.1</span><span class="hljs-number">.1</span>/<span class="hljs-number">32</span>  Direct  <span class="hljs-number">0</span>    <span class="hljs-number">0</span>           D   <span class="hljs-number">127.0</span><span class="hljs-number">.0</span><span class="hljs-number">.1</span>       Ethernet0/<span class="hljs-number">0</span>/<span class="hljs-number">1</span>    <span class="hljs-number">192.168</span><span class="hljs-number">.1</span><span class="hljs-number">.0</span>/<span class="hljs-number">24</span>  Direct  <span class="hljs-number">0</span>    <span class="hljs-number">0</span>           D   <span class="hljs-number">192.168</span><span class="hljs-number">.1</span><span class="hljs-number">.1</span>     Ethernet0/<span class="hljs-number">0</span>/<span class="hljs-number">0</span>    <span class="hljs-number">192.168</span><span class="hljs-number">.1</span><span class="hljs-number">.1</span>/<span class="hljs-number">32</span>  Direct  <span class="hljs-number">0</span>    <span class="hljs-number">0</span>           D   <span class="hljs-number">127.0</span><span class="hljs-number">.0</span><span class="hljs-number">.1</span>       Ethernet0/<span class="hljs-number">0</span>/<span class="hljs-number">0</span></code></pre><h2 id="2-3-å…³é—­ä¿¡æ¯ä¸­å¿ƒé˜²æ­¢å¼¹å‡ºæ—¥å¿—"><a href="#2-3-å…³é—­ä¿¡æ¯ä¸­å¿ƒé˜²æ­¢å¼¹å‡ºæ—¥å¿—" class="headerlink" title="2.3 å…³é—­ä¿¡æ¯ä¸­å¿ƒé˜²æ­¢å¼¹å‡ºæ—¥å¿—"></a>2.3 å…³é—­ä¿¡æ¯ä¸­å¿ƒé˜²æ­¢å¼¹å‡ºæ—¥å¿—</h2><pre><code class="hljs pgsql">[Huawei]undo <span class="hljs-keyword">info</span>-center <span class="hljs-keyword">enable</span> <span class="hljs-keyword">Info</span>: Information center <span class="hljs-keyword">is</span> disabled.</code></pre><h1 id="ä¸‰ã€é…ç½®è·¯ç”±"><a href="#ä¸‰ã€é…ç½®è·¯ç”±" class="headerlink" title="ä¸‰ã€é…ç½®è·¯ç”±"></a>ä¸‰ã€é…ç½®è·¯ç”±</h1><p><img src="/img/Huawei_route/Huawei_route_base_route.jpg"></p><h2 id="3-1-ç›´è¿è·¯ç”±ï¼ˆDirect-routingï¼‰"><a href="#3-1-ç›´è¿è·¯ç”±ï¼ˆDirect-routingï¼‰" class="headerlink" title="3.1 ç›´è¿è·¯ç”±ï¼ˆDirect routingï¼‰"></a>3.1 ç›´è¿è·¯ç”±ï¼ˆDirect routingï¼‰</h2><blockquote><p>è·¯ç”±å™¨æ¥å£æ‰€è¿æ¥çš„å­ç½‘çš„è·¯ç”±æ–¹å¼ç§°ä¸ºç›´è¿è·¯ç”±</p></blockquote><p>ç›´æ¥è¿æ¥çš„è·¯ç”±ï¼Œå½“è·¯ç”±å™¨çš„æ¥å£é…ç½®å¥½ ip åœ°å€å¹¶ä¸” up åï¼Œä¼šè‡ªåŠ¨åˆ›å»ºè¯¥è·¯ç”±ã€‚è·¯ç”±å™¨é»˜è®¤æƒ…å†µä¸‹ï¼Œåªèƒ½åˆ°è¾¾ç›´è¿çš„ç½‘æ®µã€‚</p><p>åˆ—ï¼šè·¯ç”±å™¨ R2 ï¼Œåªèƒ½åœ¨ç›´è¿ç½‘æ®µ 12.1.1.x å’Œ 23.1.1.x ä¸‹é€šä¿¡</p><p><img src="/img/Huawei_route/Huawei_route_base_1.jpg"></p><p>å…¶è·¯ç”±è¡¨ï¼š</p><p><img src="/img/Huawei_route/Huawei_route_base_2.jpg"></p><h2 id="3-2-é™æ€è·¯ç”±ï¼ˆStatic-routingï¼‰"><a href="#3-2-é™æ€è·¯ç”±ï¼ˆStatic-routingï¼‰" class="headerlink" title="3.2 é™æ€è·¯ç”±ï¼ˆStatic routingï¼‰"></a>3.2 é™æ€è·¯ç”±ï¼ˆStatic routingï¼‰</h2><blockquote><p>ä¸€ç§è·¯ç”±çš„æ–¹å¼ï¼Œè·¯ç”±é¡¹ï¼ˆrouting entryï¼‰ç”±æ‰‹åŠ¨é…ç½®ï¼Œè€ŒéåŠ¨æ€å†³å®šã€‚</p></blockquote><p>PC1 ä¸ PC2 é€šä¿¡ï¼Œéœ€è¦é…ç½®é™æ€è·¯ç”±ï¼š</p><p><img src="/img/Huawei_route/Huawei_route_base_3.jpg"></p><p>PC1 â€”&gt; PC2</p><p> <font color=pink>src:192.168.1.2 â€”&gt; dst:172.16.1.2</font></p><p>R1ï¼š</p><p>[R1]ip route-static <font color=red>172.16.1.0 24</font> <font color=blue>12.1.1.2</font></p><p><font color=red>çº¢è‰²</font>ï¼šç›®æ ‡ç½‘æ®µ</p><p><font color=blue>è“è‰²</font>ï¼šä¸‹ä¸€è·³ï¼ˆnext-hopï¼‰ï¼Œä¸‹ä¸€ä¸ªä¼ é€’è€…ã€æ‰¿æ¥è€…</p><p>è·¯ç”±è¡¨ï¼š</p><pre><code class="hljs angelscript">[R1]display ip routing-table Route Flags: R - relay, D - download to fib------------------------------------------------------------------------------Routing Tables: Public         Destinations : <span class="hljs-number">7</span>        Routes : <span class="hljs-number">7</span>        Destination/Mask    Proto   Pre  Cost      Flags NextHop         Interface       <span class="hljs-number">12.1</span><span class="hljs-number">.1</span><span class="hljs-number">.0</span>/<span class="hljs-number">24</span>  Direct  <span class="hljs-number">0</span>    <span class="hljs-number">0</span>           D   <span class="hljs-number">12.1</span><span class="hljs-number">.1</span><span class="hljs-number">.1</span>        Ethernet0/<span class="hljs-number">0</span>/<span class="hljs-number">1</span>       <span class="hljs-number">12.1</span><span class="hljs-number">.1</span><span class="hljs-number">.1</span>/<span class="hljs-number">32</span>  Direct  <span class="hljs-number">0</span>    <span class="hljs-number">0</span>           D   <span class="hljs-number">127.0</span><span class="hljs-number">.0</span><span class="hljs-number">.1</span>       Ethernet0/<span class="hljs-number">0</span>/<span class="hljs-number">1</span>      <span class="hljs-number">127.0</span><span class="hljs-number">.0</span><span class="hljs-number">.0</span>/<span class="hljs-number">8</span>   Direct  <span class="hljs-number">0</span>    <span class="hljs-number">0</span>           D   <span class="hljs-number">127.0</span><span class="hljs-number">.0</span><span class="hljs-number">.1</span>       InLoopBack0      <span class="hljs-number">127.0</span><span class="hljs-number">.0</span><span class="hljs-number">.1</span>/<span class="hljs-number">32</span>  Direct  <span class="hljs-number">0</span>    <span class="hljs-number">0</span>           D   <span class="hljs-number">127.0</span><span class="hljs-number">.0</span><span class="hljs-number">.1</span>       InLoopBack0     <span class="hljs-number">172.16</span><span class="hljs-number">.1</span><span class="hljs-number">.0</span>/<span class="hljs-number">24</span>  Static  <span class="hljs-number">60</span>   <span class="hljs-number">0</span>          RD   <span class="hljs-number">12.1</span><span class="hljs-number">.1</span><span class="hljs-number">.2</span>        Ethernet0/<span class="hljs-number">0</span>/<span class="hljs-number">1</span>    <span class="hljs-number">192.168</span><span class="hljs-number">.1</span><span class="hljs-number">.0</span>/<span class="hljs-number">24</span>  Direct  <span class="hljs-number">0</span>    <span class="hljs-number">0</span>           D   <span class="hljs-number">192.168</span><span class="hljs-number">.1</span><span class="hljs-number">.1</span>     Ethernet0/<span class="hljs-number">0</span>/<span class="hljs-number">0</span>    <span class="hljs-number">192.168</span><span class="hljs-number">.1</span><span class="hljs-number">.1</span>/<span class="hljs-number">32</span>  Direct  <span class="hljs-number">0</span>    <span class="hljs-number">0</span>           D   <span class="hljs-number">127.0</span><span class="hljs-number">.0</span><span class="hljs-number">.1</span>       Ethernet0/<span class="hljs-number">0</span>/<span class="hljs-number">0</span></code></pre><p>R2ï¼š</p><p>[R2]ip route-static <font color=red>172.16.1.0 24</font> <font color=blue>23.1.1.3</font></p><p>å›åŒ…è·¯ç”±é…ç½®ï¼š</p><p>PC2 â€”&gt; PC1</p><p><font color=pink>dst:192.168.1.2Â &lt;â€” src:172.16.1.2</font></p><p>R3:</p><p>[R3]ip route-static 192.168.1.0 24 23.1.1.2</p><p>R2:</p><p>[R2]ip route-static 192.168.1.0 24 12.1.1.1</p><h2 id="3-3-è·¯ç”±ä¼˜å…ˆçº§ï¼ˆPreferenceï¼‰"><a href="#3-3-è·¯ç”±ä¼˜å…ˆçº§ï¼ˆPreferenceï¼‰" class="headerlink" title="3.3 è·¯ç”±ä¼˜å…ˆçº§ï¼ˆPreferenceï¼‰"></a>3.3 è·¯ç”±ä¼˜å…ˆçº§ï¼ˆPreferenceï¼‰</h2><blockquote><p>æ€ç§‘ï¼šç®¡ç†è·ç¦»ã€‚è¡¡é‡è·¯ç”±çš„ä¼˜å…ˆç¨‹åº¦ï¼Œåˆ°è¾¾åŒæ¬¾åŒä¸€ç›®æ ‡æœ‰ä¸¤ç§åè®®ï¼Œæ­¤æ—¶ä¼˜é€‰è·¯ç”±ä¼˜å…ˆçº§è¾ƒå°çš„è·¯ç”±åè®®ã€‚</p></blockquote><p>è·¯ç”±ä¼˜å…ˆçº§èŒƒå›´ï¼š0-255</p><p>å¸¸è§è·¯ç”±åè®®é»˜è®¤çš„ä¼˜å…ˆçº§ï¼ˆæ•°å­—è¶Šå°ï¼Œä¼˜å…ˆçº§è¶Šé«˜ï¼‰ï¼š</p><ul><li>ç›´è¿è·¯ç”± 0</li><li>é™æ€è·¯ç”± 60</li><li>Ripï¼ˆè·¯ç”±ä¿¡æ¯åè®®ï¼‰ 100</li><li>Ospfï¼ˆOpen Shortest Path Firstå¼€æ”¾å¼æœ€çŸ­è·¯å¾„ä¼˜å…ˆï¼‰ 10</li></ul><p>ç¦ç”¨ç«¯å£ï¼š</p><pre><code class="hljs awk">[Huawei]int e0<span class="hljs-regexp">/0/</span><span class="hljs-number">1</span> [Huawei-Ethernet0<span class="hljs-regexp">/0/</span><span class="hljs-number">1</span>]shutdown<span class="hljs-comment">#å…³é—­ç«¯å£</span>[Huawei-Ethernet0<span class="hljs-regexp">/0/</span><span class="hljs-number">1</span>]undo shutdown <span class="hljs-comment">#å¼€å¯ç«¯å£</span></code></pre><p><img src="/img/Huawei_route/Huawei_route_base_4.jpg"></p><p>ç›®æ ‡ï¼šå®ç°åƒå…† Ge 0/0/0 ä½œä¸ºä¸»é“¾è·¯ï¼Œç™¾å…† E 0/0/0 ä½œä¸ºå¤‡ä»½é“¾è·¯</p><p>R1:</p><pre><code class="hljs angelscript">[R1]ip route-static <span class="hljs-number">210.1</span><span class="hljs-number">.1</span><span class="hljs-number">.0</span> <span class="hljs-number">24</span> <span class="hljs-number">21.1</span><span class="hljs-number">.1</span><span class="hljs-number">.2</span> preference <span class="hljs-number">50</span></code></pre><p>CTï¼š</p><pre><code class="hljs angelscript">[ct]ip route-static <span class="hljs-number">192.168</span><span class="hljs-number">.1</span><span class="hljs-number">.0</span> <span class="hljs-number">24</span> <span class="hljs-number">21.1</span><span class="hljs-number">.1</span><span class="hljs-number">.1</span> preference <span class="hljs-number">50</span></code></pre><p>è°ƒæ•´ä¼˜å…ˆçº§ï¼š</p><pre><code class="hljs angelscript">[Huawei]ip route-static <span class="hljs-number">210.1</span><span class="hljs-number">.1</span><span class="hljs-number">.0</span> <span class="hljs-number">24</span> <span class="hljs-number">21.1</span><span class="hljs-number">.1</span><span class="hljs-number">.2</span> preference <span class="hljs-number">50</span></code></pre><p><font color=red>è¾¾åˆ°æŸç›¸åŒç›®æ ‡ç½‘æ®µï¼Œè·¯ç”±è¡¨å§‹ç»ˆæ”¾ç½®æœ€ä¼˜è·¯ç”±</font></p><pre><code class="hljs angelscript">[Huawei]dis ip rouRoute Flags: R - relay, D - download to fib------------------------------------------------------------------------------Routing Tables: Public         Destinations : <span class="hljs-number">9</span>        Routes : <span class="hljs-number">9</span>        Destination/Mask    Proto   Pre  Cost      Flags NextHop         Interface       <span class="hljs-number">12.1</span><span class="hljs-number">.1</span><span class="hljs-number">.0</span>/<span class="hljs-number">24</span>  Direct  <span class="hljs-number">0</span>    <span class="hljs-number">0</span>           D   <span class="hljs-number">12.1</span><span class="hljs-number">.1</span><span class="hljs-number">.1</span>        Ethernet0/<span class="hljs-number">0</span>/<span class="hljs-number">1</span>       <span class="hljs-number">12.1</span><span class="hljs-number">.1</span><span class="hljs-number">.1</span>/<span class="hljs-number">32</span>  Direct  <span class="hljs-number">0</span>    <span class="hljs-number">0</span>           D   <span class="hljs-number">127.0</span><span class="hljs-number">.0</span><span class="hljs-number">.1</span>       Ethernet0/<span class="hljs-number">0</span>/<span class="hljs-number">1</span>       <span class="hljs-number">21.1</span><span class="hljs-number">.1</span><span class="hljs-number">.0</span>/<span class="hljs-number">24</span>  Direct  <span class="hljs-number">0</span>    <span class="hljs-number">0</span>           D   <span class="hljs-number">21.1</span><span class="hljs-number">.1</span><span class="hljs-number">.1</span>        GigabitEthernet0/<span class="hljs-number">0</span>/<span class="hljs-number">0</span>       <span class="hljs-number">21.1</span><span class="hljs-number">.1</span><span class="hljs-number">.1</span>/<span class="hljs-number">32</span>  Direct  <span class="hljs-number">0</span>    <span class="hljs-number">0</span>           D   <span class="hljs-number">127.0</span><span class="hljs-number">.0</span><span class="hljs-number">.1</span>       GigabitEthernet0/<span class="hljs-number">0</span>/<span class="hljs-number">0</span>      <span class="hljs-number">127.0</span><span class="hljs-number">.0</span><span class="hljs-number">.0</span>/<span class="hljs-number">8</span>   Direct  <span class="hljs-number">0</span>    <span class="hljs-number">0</span>           D   <span class="hljs-number">127.0</span><span class="hljs-number">.0</span><span class="hljs-number">.1</span>       InLoopBack0      <span class="hljs-number">127.0</span><span class="hljs-number">.0</span><span class="hljs-number">.1</span>/<span class="hljs-number">32</span>  Direct  <span class="hljs-number">0</span>    <span class="hljs-number">0</span>           D   <span class="hljs-number">127.0</span><span class="hljs-number">.0</span><span class="hljs-number">.1</span>       InLoopBack0    <span class="hljs-number">192.168</span><span class="hljs-number">.1</span><span class="hljs-number">.0</span>/<span class="hljs-number">24</span>  Direct  <span class="hljs-number">0</span>    <span class="hljs-number">0</span>           D   <span class="hljs-number">192.168</span><span class="hljs-number">.1</span><span class="hljs-number">.1</span>     Ethernet0/<span class="hljs-number">0</span>/<span class="hljs-number">0</span>    <span class="hljs-number">192.168</span><span class="hljs-number">.1</span><span class="hljs-number">.1</span>/<span class="hljs-number">32</span>  Direct  <span class="hljs-number">0</span>    <span class="hljs-number">0</span>           D   <span class="hljs-number">127.0</span><span class="hljs-number">.0</span><span class="hljs-number">.1</span>       Ethernet0/<span class="hljs-number">0</span>/<span class="hljs-number">0</span>      <span class="hljs-number">210.1</span><span class="hljs-number">.1</span><span class="hljs-number">.0</span>/<span class="hljs-number">24</span>  Static  <span class="hljs-number">50</span>   <span class="hljs-number">0</span>          RD   <span class="hljs-number">21.1</span><span class="hljs-number">.1</span><span class="hljs-number">.2</span>        GigabitEthernet0/<span class="hljs-number">0</span>/<span class="hljs-number">0</span></code></pre><h2 id="3-4-è´Ÿè½½å‡è¡¡"><a href="#3-4-è´Ÿè½½å‡è¡¡" class="headerlink" title="3.4 è´Ÿè½½å‡è¡¡"></a>3.4 è´Ÿè½½å‡è¡¡</h2><p>æ•°æ®ï¼ˆè´Ÿè½½ï¼‰è¢«å‡åˆ†åˆ°ä¸¤æ¡é“¾è·¯ä¼ è¾“</p><h2 id="3-5-è·¯ç”±åº¦é‡"><a href="#3-5-è·¯ç”±åº¦é‡" class="headerlink" title="3.5 è·¯ç”±åº¦é‡"></a>3.5 è·¯ç”±åº¦é‡</h2><blockquote><p>åº¦é‡å€¼ï¼Œè·¯ç”±å¼€é”€ï¼Œmetricï¼Œcostã€‚åˆ°è¾¾æŸç›®æ ‡æ‰€èŠ±è´¹çš„å¼€é”€ï¼ˆä»£ä»·ï¼‰çš„æ€»å’Œï¼Œç”¨æ¥è¡¡é‡è·¯å¾„çš„ä¼˜åŠ£</p></blockquote><h2 id="3-6-ç¼ºçœè·¯ç”±ï¼ˆDefault-routeï¼‰"><a href="#3-6-ç¼ºçœè·¯ç”±ï¼ˆDefault-routeï¼‰" class="headerlink" title="3.6 ç¼ºçœè·¯ç”±ï¼ˆDefault routeï¼‰"></a>3.6 ç¼ºçœè·¯ç”±ï¼ˆDefault routeï¼‰</h2><blockquote><p>é»˜è®¤è·¯ç”±ï¼Œdefault routeï¼Œpre 60</p></blockquote><pre><code class="hljs angelscript">[Huawei]ip route-static <span class="hljs-number">0.0</span><span class="hljs-number">.0</span><span class="hljs-number">.0</span> <span class="hljs-number">0</span> <span class="hljs-number">12.1</span><span class="hljs-number">.1</span><span class="hljs-number">.2</span> #è®¿é—®ä»»ä½•ç½‘æ®µéƒ½å°†æ•°æ®åŒ…äº¤ç»™ <span class="hljs-number">12.1</span><span class="hljs-number">.1</span><span class="hljs-number">.2</span></code></pre><p><font color=red>æ³¨ï¼šç¼ºçœè·¯ç”±å±äºç‰¹æ®Šçš„é™æ€è·¯ç”±</font></p><p><font color=red>æ³¨ï¼šPC çš„ç½‘å…³å…¶å®å°±æ˜¯ä¸€ç§ç¼ºçœè·¯ç”±</font></p><p><font color=red>ç¼ºçœè·¯ç”±å±äºâ€œæ›¿è¡¥è·¯ç”±â€ï¼Œåªæœ‰å½“å…¶ä»–è·¯ç”±ä¸å¯è¾¾æ—¶æ‰ä¼šä½¿ç”¨ç¼ºçœè·¯ç”±ã€‚</font></p><p>ç¼ºçœè·¯ç”±é€‚ç”¨äº<font color=red>è¾¹ç¼˜èŠ‚ç‚¹</font>åŠ<font color=red>ä¼ä¸šå‡ºå£</font></p><h2 id="3-7-ç¯å›æ¥å£ï¼ˆLoopbackï¼‰"><a href="#3-7-ç¯å›æ¥å£ï¼ˆLoopbackï¼‰" class="headerlink" title="3.7 ç¯å›æ¥å£ï¼ˆLoopbackï¼‰"></a>3.7 ç¯å›æ¥å£ï¼ˆLoopbackï¼‰</h2><blockquote><p>é€»è¾‘æ¥å£ï¼Œæ¨¡æ‹Ÿç½‘æ®µã€PCã€æœåŠ¡å™¨ã€åæœŸç”¨äºåŠ¨æ€è·¯ç”±é€‰ä¸¾ Router-ID</p></blockquote><p>é…ç½®ç¯å›æ¥å£ï¼š</p><pre><code class="hljs angelscript">[Huawei]<span class="hljs-built_in">int</span> LoopBack <span class="hljs-number">0</span>[Huawei-LoopBack0]ip add <span class="hljs-number">220.1</span><span class="hljs-number">.1</span><span class="hljs-number">.2</span> <span class="hljs-number">24</span></code></pre><h2 id="3-8-DHCPï¼ˆDynamic-Host-Configuration-Protocolï¼‰"><a href="#3-8-DHCPï¼ˆDynamic-Host-Configuration-Protocolï¼‰" class="headerlink" title="3.8 DHCPï¼ˆDynamic Host Configuration Protocolï¼‰"></a>3.8 DHCPï¼ˆDynamic Host Configuration Protocolï¼‰</h2><blockquote><p>åŠ¨æ€ä¸»æœºé…ç½®åè®®æ˜¯ä¸€ä¸ªå±€åŸŸç½‘çš„ç½‘ç»œåè®®ã€‚æŒ‡çš„æ˜¯ç”±æœåŠ¡å™¨æ§åˆ¶ä¸€æ®µIPåœ°å€èŒƒå›´ï¼Œå®¢æˆ·æœºç™»å½•æœåŠ¡å™¨æ—¶å°±å¯ä»¥è‡ªåŠ¨è·å¾—æœåŠ¡å™¨åˆ†é…çš„IPåœ°å€å’Œå­ç½‘æ©ç ã€‚</p></blockquote><p><font color=red>BOOTPï¼ˆBootstrap Protocolï¼Œå¼•å¯¼ç¨‹åºåè®®ï¼‰æ˜¯ä¸€ç§å¼•å¯¼åè®®ï¼ŒåŸºäºIP/UDPåè®®ï¼Œä¹Ÿç§°è‡ªä¸¾åè®®ï¼Œæ˜¯DHCPåè®®çš„å‰èº«ã€‚</font></p><p><img src="/img/Huawei_route/Huawei_route_base_5.jpg"></p><p>å¼€å¯ DHCP åŠŸèƒ½ï¼š</p><pre><code class="hljs bash">[Huawei]dhcp <span class="hljs-built_in">enable</span></code></pre><p>åˆ›å»ºåœ°å€æ± ï¼š</p><pre><code class="hljs routeros">[Huawei]ip<span class="hljs-built_in"> pool </span>add_pool[Huawei-ip-pool-add_pool]gateway-list 192.168.1.1[Huawei-ip-pool-add_pool]network 192.168.1.0 mask 24[Huawei-ip-pool-add_pool]dns-list 192.168.1.1 8.8.8.8[Huawei-ip-pool-add_pool]dis this<span class="hljs-comment">#</span>ip<span class="hljs-built_in"> pool </span>add_pool gateway-list 192.168.1.1<span class="hljs-built_in"> network </span>192.168.1.0 mask 255.255.255.0 dns-list 192.168.1.1 8.8.8.8<span class="hljs-comment">#</span>return[Huawei-ip-pool-add_pool]q[Huawei]int e0/0/0#å’Œç”¨æˆ·ç›¸è¿ç«¯å£[Huawei-Ethernet0/0/0]dhcp select global #ä½¿ç”¨æœ¬åœ°å…¨å±€é…ç½®çš„åœ°å€æ± åˆ†é…<span class="hljs-built_in"> IP </span>åœ°å€</code></pre><p>å®¢æˆ·ç«¯ PC6 ä»æœ¬åœ°æœåŠ¡åœ°å€æ±  add_pool è·å– DHCP åœ°å€ï¼š</p><p><img src="/img/Huawei_route/Huawei_route_base_6.jpg"></p><p>è·å–åœ°å€åŒ…ï¼š</p><p><img src="/img/Huawei_route/Huawei_route_base_7.jpg"></p><p>ç”¨æˆ·å‘é€çš„ç¬¬ä¸€ä¸ª DHCP è¯·æ±‚åŒ…æºæ˜¯ 0.0.0.0 ç›®æ ‡ä¸º 255.255.255.255 çš„å¹¿æ’­æŠ¥æ–‡ï¼Œè¯¥æŠ¥æ–‡ç§°ä¸º dhcp discover</p><p><img src="/img/Huawei_route/Huawei_route_base_8.jpg"></p><p>æ˜¾ç¤º dhcp åˆ†é…è®°å½•ï¼š</p><pre><code class="hljs routeros">[Huawei]dis<span class="hljs-built_in"> ip pool </span>name add_pool used    Pool-name      : add_pool  Pool-No        : 0 <span class="hljs-built_in"> Lease </span>         : 1 Days 0 Hours 0 Minutes  Domain-name    : -  DNS-server0    : 192.168.1.1       DNS-server1    : 8.8.8.8           NBNS-server0   : -                 Netbios-type   : -                 Position       : Local           Status           : Unlocked  Gateway-0      : 192.168.1.1       Mask           : 255.255.255.0  VPN<span class="hljs-built_in"> instance </span>  : -- -----------------------------------------------------------------------------         Start           End     Total  Used  Idle(Expired)  Conflict  Disable -----------------------------------------------------------------------------     192.168.1.1   192.168.1.254   253     3        250(0)         0        0 -----------------------------------------------------------------------------  <span class="hljs-built_in"> Network </span>section :   --------------------------------------------------------------------------  Index             <span class="hljs-built_in"> IP </span>              MAC     <span class="hljs-built_in"> Lease </span>  Status    --------------------------------------------------------------------------    251   192.168.1.252    5489-98c2-3d98       3018   Used           252   192.168.1.253    5489-98e4-1b88       3360   Used           253   192.168.1.254    5489-9856-795c       3364   Used         --------------------------------------------------------------------------</code></pre><h2 id="3-9-RIP-Routing-Information-Protocol"><a href="#3-9-RIP-Routing-Information-Protocol" class="headerlink" title="3.9 RIP(Routing Information Protocol)"></a>3.9 RIP(Routing Information Protocol)</h2><blockquote><p>RIPï¼ˆè·¯ç”±ä¿¡æ¯åè®®ï¼‰åè®®åŸºäºè·ç¦»çŸ¢é‡ç®—æ³•ï¼ˆDistanceVectorAlgorithmsï¼‰ï¼Œä½¿ç”¨â€œè·³æ•°â€(å³metric)æ¥è¡¡é‡åˆ°è¾¾ç›®æ ‡åœ°å€çš„è·¯ç”±è·ç¦»ã€‚è¿™ç§åè®®çš„è·¯ç”±å™¨åªå…³å¿ƒè‡ªå·±å‘¨å›´çš„ä¸–ç•Œï¼Œåªä¸è‡ªå·±ç›¸é‚»çš„è·¯ç”±å™¨äº¤æ¢ä¿¡æ¯ï¼ŒèŒƒå›´é™åˆ¶åœ¨15è·³(15åº¦)ä¹‹å†…ï¼Œå†è¿œï¼Œå®ƒå°±ä¸å…³å¿ƒäº†ã€‚RIPåº”ç”¨äºOSIç½‘ç»œä¸ƒå±‚æ¨¡å‹çš„åº”ç”¨å±‚ã€‚å„å‚å®¶å®šä¹‰çš„ç®¡ç†è·ç¦»ï¼ˆADï¼Œå³ä¼˜å…ˆçº§ï¼‰å¦‚ä¸‹ï¼šåä¸ºå®šä¹‰çš„ä¼˜å…ˆçº§æ˜¯100ï¼Œæ€ç§‘å®šä¹‰çš„ä¼˜å…ˆçº§æ˜¯120ã€‚ç¼ºç‚¹ï¼šå¤è€ï¼Œæ”¶æ•›é€Ÿåº¦å¾ˆæ…¢ï¼</p></blockquote><p><img src="/img/Huawei_route/Huawei_route_base_9.jpg"></p><p>é…ç½®RIPï¼š</p><p><img src="/img/Huawei_route/Huawei_route_base_10.jpg"></p><p>R1:</p><pre><code class="hljs routeros">[R1-rip-1]dis this<span class="hljs-comment">#</span>rip 1 undo summary#å…³é—­è‡ªåŠ¨æ±‡æ€» version 2#ç‰ˆæœ¬2<span class="hljs-built_in"> network </span>192.168.1.0#å®£å‘Šç›´è¿ä¸»ç±»ç½‘ç»œ<span class="hljs-built_in"> network </span>12.0.0.0#å®£å‘Šç›´è¿ä¸»ç±»ç½‘ç»œ<span class="hljs-comment">#</span>return</code></pre><p>R2:</p><pre><code class="hljs routeros">[R2-rip-1]dis this<span class="hljs-comment">#</span>rip 1 undo summary version 2<span class="hljs-built_in"> network </span>12.0.0.0<span class="hljs-built_in"> network </span>23.0.0.0<span class="hljs-built_in"> network </span>172.16.0.0<span class="hljs-comment">#</span>return</code></pre><p>R3:</p><pre><code class="hljs routeros">[R3-rip-1]dis this<span class="hljs-comment">#</span>rip 1 undo summary version 2<span class="hljs-built_in"> network </span>23.0.0.0<span class="hljs-built_in"> network </span>10.0.0.0<span class="hljs-comment">#</span>return</code></pre><p>Rip æŠ¥æ–‡ï¼š</p><p><img src="/img/Huawei_route/Huawei_route_base_11.jpg"></p><p>æ¯éš” 30s å‘é€ä¸€æ¬¡æŠ¥æ–‡ï¼Œç›®æ ‡åœ°å€æ˜¯ï¼š224.0.0.9 ç»„æ’­åœ°å€ï¼ŒæŠ¥æ–‡é‡Œå­˜æ”¾çš„æ˜¯è·¯ç”±ä¿¡æ¯</p><p><img src="/img/Huawei_route/Huawei_route_base_12.jpg"></p><p>Rip åªçœ‹è·ç¦»è¿œè¿‘ï¼Œè·ç¦»æ˜¯ä»¥è·³æ•°ï¼ˆMetricï¼Œç»è¿‡è·¯ç”±å™¨çš„ä¸ªæ•°ï¼‰</p><h2 id="3-10-é™é»˜æ¥å£ï¼ˆSilent-interfaceï¼‰"><a href="#3-10-é™é»˜æ¥å£ï¼ˆSilent-interfaceï¼‰" class="headerlink" title="3.10 é™é»˜æ¥å£ï¼ˆSilent-interfaceï¼‰"></a>3.10 é™é»˜æ¥å£ï¼ˆSilent-interfaceï¼‰</h2><p><font color=red>PC/å®¢æˆ·ç«¯ ä¸éœ€è¦ Rip æŠ¥æ–‡ï¼Œå¯ä»¥å°†è·¯ç”±è¿æ¥å®¢æˆ·ç«¯æ¥å£é…ç½®ä¸ºæŠ‘åˆ¶æ¥å£ï¼ˆsilent-interfaceï¼Œé™é»˜æ¥å£ï¼‰ï¼š</font></p><pre><code class="hljs angelscript">[Huawei-rip<span class="hljs-number">-1</span>]silent-<span class="hljs-keyword">interface</span> <span class="hljs-symbol">e0</span>/<span class="hljs-symbol">0</span>/<span class="hljs-symbol">0</span>#å°† <span class="hljs-symbol">e0</span>/<span class="hljs-symbol">0</span>/<span class="hljs-symbol">0</span> å£é…ç½®ä¸ºé™é»˜æ¥å£ï¼Œ<span class="hljs-symbol">Rip</span>çš„è·¯ç”±æ›´æ–°å°†ä¸å†ä»è¯¥æ¥å£å‘é€</code></pre><p>æ­¤æ—¶ï¼ŒR1 çš„è·¯ç”±è¡¨ï¼š</p><pre><code class="hljs angelscript">[R1]dis ip routing-table Route Flags: R - relay, D - download to fib------------------------------------------------------------------------------Routing Tables: Public         Destinations : <span class="hljs-number">9</span>        Routes : <span class="hljs-number">9</span>        Destination/Mask    Proto   Pre  Cost      Flags NextHop         Interface     <span class="hljs-number">10.10</span><span class="hljs-number">.10</span><span class="hljs-number">.0</span>/<span class="hljs-number">24</span>  RIP     <span class="hljs-number">100</span>  <span class="hljs-number">2</span>           D   <span class="hljs-number">12.1</span><span class="hljs-number">.1</span><span class="hljs-number">.2</span>        Ethernet0/<span class="hljs-number">0</span>/<span class="hljs-number">1</span>#Ripä¼˜å…ˆçº§ä¸º<span class="hljs-number">100</span>       <span class="hljs-number">12.1</span><span class="hljs-number">.1</span><span class="hljs-number">.0</span>/<span class="hljs-number">24</span>  Direct  <span class="hljs-number">0</span>    <span class="hljs-number">0</span>           D   <span class="hljs-number">12.1</span><span class="hljs-number">.1</span><span class="hljs-number">.1</span>        Ethernet0/<span class="hljs-number">0</span>/<span class="hljs-number">1</span>       <span class="hljs-number">12.1</span><span class="hljs-number">.1</span><span class="hljs-number">.1</span>/<span class="hljs-number">32</span>  Direct  <span class="hljs-number">0</span>    <span class="hljs-number">0</span>           D   <span class="hljs-number">127.0</span><span class="hljs-number">.0</span><span class="hljs-number">.1</span>       Ethernet0/<span class="hljs-number">0</span>/<span class="hljs-number">1</span>       <span class="hljs-number">23.1</span><span class="hljs-number">.1</span><span class="hljs-number">.0</span>/<span class="hljs-number">24</span>  RIP     <span class="hljs-number">100</span>  <span class="hljs-number">1</span>           D   <span class="hljs-number">12.1</span><span class="hljs-number">.1</span><span class="hljs-number">.2</span>        Ethernet0/<span class="hljs-number">0</span>/<span class="hljs-number">1</span>      <span class="hljs-number">127.0</span><span class="hljs-number">.0</span><span class="hljs-number">.0</span>/<span class="hljs-number">8</span>   Direct  <span class="hljs-number">0</span>    <span class="hljs-number">0</span>           D   <span class="hljs-number">127.0</span><span class="hljs-number">.0</span><span class="hljs-number">.1</span>       InLoopBack0      <span class="hljs-number">127.0</span><span class="hljs-number">.0</span><span class="hljs-number">.1</span>/<span class="hljs-number">32</span>  Direct  <span class="hljs-number">0</span>    <span class="hljs-number">0</span>           D   <span class="hljs-number">127.0</span><span class="hljs-number">.0</span><span class="hljs-number">.1</span>       InLoopBack0     <span class="hljs-number">172.16</span><span class="hljs-number">.1</span><span class="hljs-number">.0</span>/<span class="hljs-number">24</span>  RIP     <span class="hljs-number">100</span>  <span class="hljs-number">1</span>           D   <span class="hljs-number">12.1</span><span class="hljs-number">.1</span><span class="hljs-number">.2</span>        Ethernet0/<span class="hljs-number">0</span>/<span class="hljs-number">1</span>    <span class="hljs-number">192.168</span><span class="hljs-number">.1</span><span class="hljs-number">.0</span>/<span class="hljs-number">24</span>  Direct  <span class="hljs-number">0</span>    <span class="hljs-number">0</span>           D   <span class="hljs-number">192.168</span><span class="hljs-number">.1</span><span class="hljs-number">.1</span>     Ethernet0/<span class="hljs-number">0</span>/<span class="hljs-number">0</span>    <span class="hljs-number">192.168</span><span class="hljs-number">.1</span><span class="hljs-number">.1</span>/<span class="hljs-number">32</span>  Direct  <span class="hljs-number">0</span>    <span class="hljs-number">0</span>           D   <span class="hljs-number">127.0</span><span class="hljs-number">.0</span><span class="hljs-number">.1</span>       Ethernet0/<span class="hljs-number">0</span>/<span class="hljs-number">0</span></code></pre><h2 id="3-11-OSPF-Open-Shortest-Path-First"><a href="#3-11-OSPF-Open-Shortest-Path-First" class="headerlink" title="3.11 OSPF(Open Shortest Path First)"></a>3.11 OSPF(Open Shortest Path First)</h2><blockquote><p>å¼€æ”¾å¼æœ€çŸ­è·¯å¾„ä¼˜å…ˆåè®®æ˜¯ IETF å®šä¹‰çš„ä¸€ç§åŸºäºé“¾è·¯çŠ¶æ€çš„å†…éƒ¨ç½‘å…³è·¯ç”±åè®®</p></blockquote><p>ospf ä¼˜å…ˆçº§ä¸ºï¼š10</p><p><img src="/img/Huawei_route/Huawei_route_base_13.jpg"></p><p>Area 0ï¼šéª¨å¹²åŒºåŸŸã€æ ¸å¿ƒåŒºåŸŸ</p><p>Area 1ã€2â€¦ï¼šå¸¸è§„åŒºåŸŸ</p><ul><li>æ¯ä¸ªåŒºåŸŸéƒ½ç»´æŠ¤ä¸€ä¸ªç‹¬ç«‹çš„LSDB</li><li><font color=red>Area 0æ˜¯éª¨å¹²åŒºåŸŸï¼Œå…¶ä»–åŒºåŸŸéƒ½å¿…é¡»ä¸æ­¤åŒºåŸŸç›¸è¿</font></li></ul><h3 id="3-11-1-é…ç½®-OSPFï¼š"><a href="#3-11-1-é…ç½®-OSPFï¼š" class="headerlink" title="3.11.1 é…ç½® OSPFï¼š"></a>3.11.1 é…ç½® OSPFï¼š</h3><p><img src="/img/Huawei_route/Huawei_route_base_14.jpg"></p><p>R1ï¼š</p><pre><code class="hljs angelscript">[Huawei]ospf <span class="hljs-number">1</span>[Huawei-ospf<span class="hljs-number">-1</span>]area <span class="hljs-number">0</span>[Huawei-ospf<span class="hljs-number">-1</span>-area<span class="hljs-number">-0.0</span><span class="hljs-number">.0</span><span class="hljs-number">.0</span>]network <span class="hljs-number">192.168</span><span class="hljs-number">.1</span><span class="hljs-number">.0</span> ?  X.X.X.X  OSPF wild card bits[Huawei-ospf<span class="hljs-number">-1</span>-area<span class="hljs-number">-0.0</span><span class="hljs-number">.0</span><span class="hljs-number">.0</span>]network <span class="hljs-number">192.168</span><span class="hljs-number">.1</span><span class="hljs-number">.0</span> <span class="hljs-number">0.0</span><span class="hljs-number">.0</span><span class="hljs-number">.255</span>[Huawei-ospf<span class="hljs-number">-1</span>-area<span class="hljs-number">-0.0</span><span class="hljs-number">.0</span><span class="hljs-number">.0</span>]network <span class="hljs-number">12.1</span><span class="hljs-number">.1</span><span class="hljs-number">.0</span> <span class="hljs-number">0.0</span><span class="hljs-number">.0</span><span class="hljs-number">.255</span>[Huawei-ospf<span class="hljs-number">-1</span>-area<span class="hljs-number">-0.0</span><span class="hljs-number">.0</span><span class="hljs-number">.0</span>]dis <span class="hljs-keyword">this</span># area <span class="hljs-number">0.0</span><span class="hljs-number">.0</span><span class="hljs-number">.0</span>  network <span class="hljs-number">192.168</span><span class="hljs-number">.1</span><span class="hljs-number">.0</span> <span class="hljs-number">0.0</span><span class="hljs-number">.0</span><span class="hljs-number">.255</span>  network <span class="hljs-number">12.1</span><span class="hljs-number">.1</span><span class="hljs-number">.0</span> <span class="hljs-number">0.0</span><span class="hljs-number">.0</span><span class="hljs-number">.255</span>#<span class="hljs-keyword">return</span></code></pre><p>R2ï¼š</p><pre><code class="hljs angelscript">[Huawei]ospf <span class="hljs-number">1</span>[Huawei-ospf<span class="hljs-number">-1</span>]area <span class="hljs-number">0</span>[Huawei-ospf<span class="hljs-number">-1</span>-area<span class="hljs-number">-0.0</span><span class="hljs-number">.0</span><span class="hljs-number">.0</span>]network <span class="hljs-number">12.1</span><span class="hljs-number">.1</span><span class="hljs-number">.0</span> <span class="hljs-number">0.0</span><span class="hljs-number">.0</span><span class="hljs-number">.255</span>[Huawei-ospf<span class="hljs-number">-1</span>-area<span class="hljs-number">-0.0</span><span class="hljs-number">.0</span><span class="hljs-number">.0</span>]network <span class="hljs-number">23.1</span><span class="hljs-number">.1</span><span class="hljs-number">.0</span> <span class="hljs-number">0.0</span><span class="hljs-number">.0</span><span class="hljs-number">.255</span>[Huawei-ospf<span class="hljs-number">-1</span>-area<span class="hljs-number">-0.0</span><span class="hljs-number">.0</span><span class="hljs-number">.0</span>]network <span class="hljs-number">172.16</span><span class="hljs-number">.1</span><span class="hljs-number">.0</span> <span class="hljs-number">0.0</span><span class="hljs-number">.0</span><span class="hljs-number">.255</span>[Huawei-ospf<span class="hljs-number">-1</span>-area<span class="hljs-number">-0.0</span><span class="hljs-number">.0</span><span class="hljs-number">.0</span>]dis <span class="hljs-keyword">this</span># area <span class="hljs-number">0.0</span><span class="hljs-number">.0</span><span class="hljs-number">.0</span>  network <span class="hljs-number">12.1</span><span class="hljs-number">.1</span><span class="hljs-number">.0</span> <span class="hljs-number">0.0</span><span class="hljs-number">.0</span><span class="hljs-number">.255</span>  network <span class="hljs-number">23.1</span><span class="hljs-number">.1</span><span class="hljs-number">.0</span> <span class="hljs-number">0.0</span><span class="hljs-number">.0</span><span class="hljs-number">.255</span>  network <span class="hljs-number">172.16</span><span class="hljs-number">.1</span><span class="hljs-number">.0</span> <span class="hljs-number">0.0</span><span class="hljs-number">.0</span><span class="hljs-number">.255</span>#<span class="hljs-keyword">return</span></code></pre><p>R3:</p><pre><code class="hljs angelscript">[Huawei]ospf <span class="hljs-number">1</span>[Huawei-ospf<span class="hljs-number">-1</span>]area <span class="hljs-number">0</span>[Huawei-ospf<span class="hljs-number">-1</span>-area<span class="hljs-number">-0.0</span><span class="hljs-number">.0</span><span class="hljs-number">.0</span>]network <span class="hljs-number">23.1</span><span class="hljs-number">.1</span><span class="hljs-number">.0</span> <span class="hljs-number">0.0</span><span class="hljs-number">.0</span><span class="hljs-number">.255</span>[Huawei-ospf<span class="hljs-number">-1</span>-area<span class="hljs-number">-0.0</span><span class="hljs-number">.0</span><span class="hljs-number">.0</span>]network <span class="hljs-number">10.10</span><span class="hljs-number">.10</span><span class="hljs-number">.0</span> <span class="hljs-number">0.0</span><span class="hljs-number">.0</span><span class="hljs-number">.255</span>[Huawei-ospf<span class="hljs-number">-1</span>-area<span class="hljs-number">-0.0</span><span class="hljs-number">.0</span><span class="hljs-number">.0</span>]dis <span class="hljs-keyword">this</span># area <span class="hljs-number">0.0</span><span class="hljs-number">.0</span><span class="hljs-number">.0</span>  network <span class="hljs-number">23.1</span><span class="hljs-number">.1</span><span class="hljs-number">.0</span> <span class="hljs-number">0.0</span><span class="hljs-number">.0</span><span class="hljs-number">.255</span>  network <span class="hljs-number">10.10</span><span class="hljs-number">.10</span><span class="hljs-number">.0</span> <span class="hljs-number">0.0</span><span class="hljs-number">.0</span><span class="hljs-number">.255</span>#<span class="hljs-keyword">return</span></code></pre><p>é…ç½®å®Œ OSPF çš„ R1 è·¯ç”±ä¿¡æ¯ï¼š</p><pre><code class="hljs angelscript">[Huawei]dis ip routing-tableRoute Flags: R - relay, D - download to fib------------------------------------------------------------------------------Routing Tables: Public         Destinations : <span class="hljs-number">9</span>        Routes : <span class="hljs-number">9</span>        Destination/Mask    Proto   Pre  Cost      Flags NextHop         Interface     <span class="hljs-number">10.10</span><span class="hljs-number">.10</span><span class="hljs-number">.0</span>/<span class="hljs-number">24</span>  OSPF    <span class="hljs-number">10</span>   <span class="hljs-number">3</span>           D   <span class="hljs-number">12.1</span><span class="hljs-number">.1</span><span class="hljs-number">.2</span>        Ethernet0/<span class="hljs-number">0</span>/<span class="hljs-number">1</span>       <span class="hljs-number">12.1</span><span class="hljs-number">.1</span><span class="hljs-number">.0</span>/<span class="hljs-number">24</span>  Direct  <span class="hljs-number">0</span>    <span class="hljs-number">0</span>           D   <span class="hljs-number">12.1</span><span class="hljs-number">.1</span><span class="hljs-number">.1</span>        Ethernet0/<span class="hljs-number">0</span>/<span class="hljs-number">1</span>       <span class="hljs-number">12.1</span><span class="hljs-number">.1</span><span class="hljs-number">.1</span>/<span class="hljs-number">32</span>  Direct  <span class="hljs-number">0</span>    <span class="hljs-number">0</span>           D   <span class="hljs-number">127.0</span><span class="hljs-number">.0</span><span class="hljs-number">.1</span>       Ethernet0/<span class="hljs-number">0</span>/<span class="hljs-number">1</span>       <span class="hljs-number">23.1</span><span class="hljs-number">.1</span><span class="hljs-number">.0</span>/<span class="hljs-number">24</span>  OSPF    <span class="hljs-number">10</span>   <span class="hljs-number">2</span>           D   <span class="hljs-number">12.1</span><span class="hljs-number">.1</span><span class="hljs-number">.2</span>        Ethernet0/<span class="hljs-number">0</span>/<span class="hljs-number">1</span>      <span class="hljs-number">127.0</span><span class="hljs-number">.0</span><span class="hljs-number">.0</span>/<span class="hljs-number">8</span>   Direct  <span class="hljs-number">0</span>    <span class="hljs-number">0</span>           D   <span class="hljs-number">127.0</span><span class="hljs-number">.0</span><span class="hljs-number">.1</span>       InLoopBack0      <span class="hljs-number">127.0</span><span class="hljs-number">.0</span><span class="hljs-number">.1</span>/<span class="hljs-number">32</span>  Direct  <span class="hljs-number">0</span>    <span class="hljs-number">0</span>           D   <span class="hljs-number">127.0</span><span class="hljs-number">.0</span><span class="hljs-number">.1</span>       InLoopBack0     <span class="hljs-number">172.16</span><span class="hljs-number">.1</span><span class="hljs-number">.0</span>/<span class="hljs-number">24</span>  OSPF    <span class="hljs-number">10</span>   <span class="hljs-number">2</span>           D   <span class="hljs-number">12.1</span><span class="hljs-number">.1</span><span class="hljs-number">.2</span>        Ethernet0/<span class="hljs-number">0</span>/<span class="hljs-number">1</span>    <span class="hljs-number">192.168</span><span class="hljs-number">.1</span><span class="hljs-number">.0</span>/<span class="hljs-number">24</span>  Direct  <span class="hljs-number">0</span>    <span class="hljs-number">0</span>           D   <span class="hljs-number">192.168</span><span class="hljs-number">.1</span><span class="hljs-number">.1</span>     Ethernet0/<span class="hljs-number">0</span>/<span class="hljs-number">0</span>    <span class="hljs-number">192.168</span><span class="hljs-number">.1</span><span class="hljs-number">.1</span>/<span class="hljs-number">32</span>  Direct  <span class="hljs-number">0</span>    <span class="hljs-number">0</span>           D   <span class="hljs-number">127.0</span><span class="hljs-number">.0</span><span class="hljs-number">.1</span>       Ethernet0/<span class="hljs-number">0</span>/<span class="hljs-number">0</span></code></pre><h3 id="3-11-2-OSPF-çš„æŠ¥æ–‡ï¼šå¸¸è§5ç§"><a href="#3-11-2-OSPF-çš„æŠ¥æ–‡ï¼šå¸¸è§5ç§" class="headerlink" title="3.11.2 OSPF çš„æŠ¥æ–‡ï¼šå¸¸è§5ç§"></a>3.11.2 OSPF çš„æŠ¥æ–‡ï¼šå¸¸è§5ç§</h3><p>helloï¼šå°å·§ï¼Œç”¨æ¥å»ºç«‹å’Œç»´æŒé‚»å±…å…³ç³»</p><p><img src="/img/Huawei_route/Huawei_route_base_15.jpg"></p><p>DBD ã€LSRã€LSUã€LSackï¼šç”¨äºä¼ é€’è·¯ç”±ä¿¡æ¯ï¼Œåˆšå¼€å§‹æ—¶å‘é€</p><p>é‡ç½® OSPF è¿›ç¨‹æ¥æŠ“å–ä¸Šé¢4ä¸ªåŒ…ï¼š</p><pre><code class="hljs routeros">&lt;Huawei&gt;reset<span class="hljs-built_in"> ospf </span>process #é‡ç½®ï¼ˆresetï¼‰å¤§å¤šéœ€è¦åœ¨\&lt;Huawei&gt; ç”¨æˆ·è§†å›¾ ä¸‹æ“ä½œWarning: The<span class="hljs-built_in"> OSPF </span>process will be reset. Continue? [Y/N]:y</code></pre><p><img src="/img/Huawei_route/Huawei_route_base_16.jpg"></p><h3 id="3-11-3-OSPF-é‚»å±…è¡¨"><a href="#3-11-3-OSPF-é‚»å±…è¡¨" class="headerlink" title="3.11.3 OSPF é‚»å±…è¡¨"></a>3.11.3 OSPF é‚»å±…è¡¨</h3><pre><code class="hljs routeros">[R2]dis<span class="hljs-built_in"> ospf peer </span>brief <span class="hljs-built_in"> OSPF </span>Process 1 with Router ID 12.1.1.2 <span class="hljs-built_in"> Peer </span>Statistic Information ----------------------------------------------------------------------------<span class="hljs-built_in"> Area </span>Id         <span class="hljs-built_in"> Interface </span>                      <span class="hljs-built_in"> Neighbor </span>id      State     0.0.0.0          Ethernet0/0/0                    192.168.1.1      Full         0.0.0.0          Ethernet0/0/1                    23.1.1.1         Full         ----------------------------------------------------------------------------</code></pre><h3 id="3-11-4-OSPF-é™é»˜æ¥å£ï¼ˆsilent-interfaceï¼‰"><a href="#3-11-4-OSPF-é™é»˜æ¥å£ï¼ˆsilent-interfaceï¼‰" class="headerlink" title="3.11.4 OSPF é™é»˜æ¥å£ï¼ˆsilent-interfaceï¼‰"></a>3.11.4 OSPF é™é»˜æ¥å£ï¼ˆsilent-interfaceï¼‰</h3><pre><code class="hljs routeros">[R1]ospf 1[R1-ospf-1]silent-interface e0/0/0[R1-ospf-1]dis this<span class="hljs-comment">#</span>ospf 1 silent-interface Ethernet0/0/0<span class="hljs-built_in"> area </span>0.0.0.0 <span class="hljs-built_in"> network </span>192.168.1.0 0.0.0.255 <span class="hljs-built_in"> network </span>12.1.1.0 0.0.0.255<span class="hljs-comment">#</span>return</code></pre><h2 id="3-12-Telnet"><a href="#3-12-Telnet" class="headerlink" title="3.12 Telnet"></a>3.12 Telnet</h2><p><img src="/img/Huawei_route/Huawei_route_base_17.jpg"></p><p>å¼€å¯ telnet æœåŠ¡ï¼ˆåä¸ºé»˜è®¤å¼€å¯ï¼‰ï¼š</p><pre><code class="hljs routeros">[R4]telnet<span class="hljs-built_in"> server </span><span class="hljs-builtin-name">enable</span> Info: The Telnet<span class="hljs-built_in"> server </span>has been enabled.</code></pre><p>R4 åˆ›å»ºç”¨æˆ·åå’Œå¯†ç ï¼š</p><pre><code class="hljs ada">[R4]aaa#ä¸‰ A è®¤è¯[R4-aaa]local-user ?  STRING&lt;<span class="hljs-number">1</span>-<span class="hljs-number">64</span>&gt;   User name, <span class="hljs-keyword">in</span> form <span class="hljs-keyword">of</span> <span class="hljs-symbol">&#x27;user</span>@domain&#x27;. Can <span class="hljs-keyword">use</span> wildcard <span class="hljs-string">&#x27;*&#x27;</span>,                 <span class="hljs-keyword">while</span> displaying <span class="hljs-keyword">and</span> modifying, such as *@isp,user@*,*@*.Can                 <span class="hljs-keyword">not</span> include invalid character / \ : * ? &quot; &lt; &gt; | @ &#x27;[R4-aaa]local-user telnetuser ?  <span class="hljs-keyword">access</span>-limit   Set <span class="hljs-keyword">access</span> limit <span class="hljs-keyword">of</span> user(s)  ftp-directory  Set user(s) FTP directory permitted  idle-timeout   Set the timeout period <span class="hljs-keyword">for</span> terminal user(s)  password       Set password   privilege      Set admin user(s) level  service-<span class="hljs-keyword">type</span>   <span class="hljs-type">Service </span>types <span class="hljs-keyword">for</span> authorized user(s)  state          Activate/Block the user(s)  user-group     User group[R4-aaa]local-user telnetuser password cipher telnetuser privilege level <span class="hljs-number">3</span> #é…ç½®ç”¨æˆ·åå¯†ç ï¼Œæƒé™ä¸º<span class="hljs-number">3</span>[R4-aaa]local-user telnetuser service-<span class="hljs-keyword">type</span> <span class="hljs-type">telnet  </span>#æŒ‡å®šè´¦æˆ·çš„ç±»å‹ä¸º telnet[R4]user-<span class="hljs-keyword">interface</span> [R4]user-<span class="hljs-keyword">interface</span> ?  INTEGER&lt;<span class="hljs-number">0</span>,<span class="hljs-number">34</span>-<span class="hljs-number">48</span>,<span class="hljs-number">50</span>-<span class="hljs-number">54</span>&gt;   The first user terminal <span class="hljs-keyword">interface</span> to be configured  console                  Primary user terminal <span class="hljs-keyword">interface</span>  current                  The current user terminal <span class="hljs-keyword">interface</span>  maximum-vty              The maximum number <span class="hljs-keyword">of</span> VTY users, the default value                           <span class="hljs-keyword">is</span> <span class="hljs-number">5</span>  vty                      The virtual user terminal <span class="hljs-keyword">interface</span> [R4]user-<span class="hljs-keyword">interface</span> vty <span class="hljs-number">0</span> <span class="hljs-number">4</span>[R4-ui-vty0-<span class="hljs-number">4</span>]au[R4-ui-vty0-<span class="hljs-number">4</span>]authe[R4-ui-vty0-<span class="hljs-number">4</span>]authentication-mode ?  aaa       AAA authentication  none      Login without checking  password  Authentication through the password <span class="hljs-keyword">of</span> a user terminal <span class="hljs-keyword">interface</span>[R4-ui-vty0-<span class="hljs-number">4</span>]authentication-mode aaa[R4-ui-vty0-<span class="hljs-number">4</span>]dis this#user-<span class="hljs-keyword">interface</span> con <span class="hljs-number">0</span>user-<span class="hljs-keyword">interface</span> vty <span class="hljs-number">0</span> <span class="hljs-number">4</span> authentication-mode aaauser-<span class="hljs-keyword">interface</span> vty <span class="hljs-number">16</span> <span class="hljs-number">20</span>#<span class="hljs-keyword">return</span>[R4]user-<span class="hljs-keyword">interface</span> ?  INTEGER&lt;<span class="hljs-number">0</span>,<span class="hljs-number">34</span>-<span class="hljs-number">48</span>,<span class="hljs-number">50</span>-<span class="hljs-number">54</span>&gt;   The first user terminal <span class="hljs-keyword">interface</span> to be configured  console                  Primary user terminal <span class="hljs-keyword">interface</span>  current                  The current user terminal <span class="hljs-keyword">interface</span>  maximum-vty              The maximum number <span class="hljs-keyword">of</span> VTY users, the default value                           <span class="hljs-keyword">is</span> <span class="hljs-number">5</span>  vty                      The virtual user terminal <span class="hljs-keyword">interface</span> [R4]user-<span class="hljs-keyword">interface</span> vty <span class="hljs-number">0</span> <span class="hljs-number">4</span># åŒæ—¶å…è®¸<span class="hljs-number">5</span>ä¸ªäººè¿œç¨‹æ§åˆ¶[R4-ui-vty0-<span class="hljs-number">4</span>]authentication-mode ?  aaa       AAA authentication  none      Login without checking  password  Authentication through the password <span class="hljs-keyword">of</span> a user terminal <span class="hljs-keyword">interface</span>[R4-ui-vty0-<span class="hljs-number">4</span>]authentication-mode aaa#è®¤è¯æ¨¡å¼ä¸º aaa [R4-ui-vty0-<span class="hljs-number">4</span>]dis this#user-<span class="hljs-keyword">interface</span> con <span class="hljs-number">0</span>user-<span class="hljs-keyword">interface</span> vty <span class="hljs-number">0</span> <span class="hljs-number">4</span> authentication-mode aaauser-<span class="hljs-keyword">interface</span> vty <span class="hljs-number">16</span> <span class="hljs-number">20</span>#<span class="hljs-keyword">return</span></code></pre><p>R1 è¿æ¥ telnet æœåŠ¡ç«¯ï¼š</p><pre><code class="hljs routeros">&lt;R1&gt;telnet 34.1.1.2Trying 34.1.1.2 <span class="hljs-built_in">..</span>.Press CTRL+K <span class="hljs-keyword">to</span> abortConnected <span class="hljs-keyword">to</span> 34.1.1.2 <span class="hljs-built_in">..</span>.Login authenticationUsername:adminPassword:Info: The max number of VTY<span class="hljs-built_in"> users </span>is 10, <span class="hljs-keyword">and</span> the number      of current VTY<span class="hljs-built_in"> users </span>on line is 1.      The current login time is 2020-07-31 10:14:55.&lt;R4&gt;</code></pre><h3 id="3-12-1-PC-å®¢æˆ·ç«¯è¿æ¥-telnet-æœåŠ¡å™¨ï¼š"><a href="#3-12-1-PC-å®¢æˆ·ç«¯è¿æ¥-telnet-æœåŠ¡å™¨ï¼š" class="headerlink" title="3.12.1 PC å®¢æˆ·ç«¯è¿æ¥ telnet æœåŠ¡å™¨ï¼š"></a>3.12.1 PC å®¢æˆ·ç«¯è¿æ¥ telnet æœåŠ¡å™¨ï¼š</h3><p>PC å¼€å¯ telnet æœåŠ¡ï¼š</p><p>æ§åˆ¶é¢æ¿â€“&gt;ç¨‹åºâ€“&gt;å¯åŠ¨æˆ–å…³é—­ Windows åŠŸèƒ½ â€“&gt; Telnet Client</p><p><img src="/img/Huawei_route/Huawei_route_base_19.jpg"></p><p>æœ¬æœº PC è¿æ¥ eNSP Cloud è®¾ç½®ï¼š</p><p><img src="/img/Huawei_route/Huawei_route_base_18.jpg"></p><p>æœ¬æœºéœ€è¦å¢åŠ é™æ€è·¯ç”±ä»192.168.1.1 é€šä¿¡ï¼š</p><p><img src="/img/Huawei_route/Huawei_route_base_20.jpg"></p><p>æ˜¾ç¤ºæœ¬åœ° PC è·¯ç”±è¡¨ï¼š</p><p><img src="/img/Huawei_route/Huawei_route_base_21.jpg"></p><h2 id="3-13-FTPï¼ˆFile-Transfer-Protocol"><a href="#3-13-FTPï¼ˆFile-Transfer-Protocol" class="headerlink" title="3.13 FTPï¼ˆFile Transfer Protocol)"></a>3.13 FTPï¼ˆFile Transfer Protocol)</h2><p>ä½¿ç”¨ FTP å®ç°è¿œç¨‹æ–‡ä»¶ä¼ è¾“çš„åŒæ—¶ï¼Œè¿˜å¯ä»¥ä¿è¯æ•°æ®ä¼ è¾“çš„å¯é æ€§å’Œé«˜æ•ˆæ€§ã€‚</p><h3 id="3-13-1-å¼€å¯-FTP-æœåŠ¡"><a href="#3-13-1-å¼€å¯-FTP-æœåŠ¡" class="headerlink" title="3.13.1 å¼€å¯ FTP æœåŠ¡"></a>3.13.1 å¼€å¯ FTP æœåŠ¡</h3><pre><code class="hljs routeros">[R4]ftp<span class="hljs-built_in"> server </span><span class="hljs-builtin-name">enable</span> Info: Succeeded <span class="hljs-keyword">in</span> starting the FTP server.</code></pre><p><img src="/img/Huawei_route/Huawei_route_base_22.jpg"></p><p>åˆ›å»º FTP  è´¦æˆ·ï¼š</p><pre><code class="hljs crmsh">[R4]aaa[R4-aaa]local-<span class="hljs-keyword">user</span> <span class="hljs-title">ftpuser</span> password cipher ftpuser privilege level <span class="hljs-number">3</span> ftp-directory flash:<span class="hljs-literal">Inf</span>o: Add a new user.[R4-aaa]local-<span class="hljs-keyword">user</span> <span class="hljs-title">ftpuser</span> service-<span class="hljs-keyword">type</span> ftp<span class="hljs-comment">#æ­¤è´¦æˆ·ç”¨äº FTP æœåŠ¡</span></code></pre><p>è¿æ¥ FTP æœåŠ¡å™¨ï¼š</p><pre><code class="hljs angelscript">&lt;R1&gt;ftp <span class="hljs-number">34.1</span><span class="hljs-number">.1</span><span class="hljs-number">.2</span>Trying <span class="hljs-number">34.1</span><span class="hljs-number">.1</span><span class="hljs-number">.2</span> ...Press CTRL+K to abortConnected to <span class="hljs-number">34.1</span><span class="hljs-number">.1</span><span class="hljs-number">.2</span>.<span class="hljs-number">220</span> FTP service ready.User(<span class="hljs-number">34.1</span><span class="hljs-number">.1</span><span class="hljs-number">.2</span>:(none)):ftpuser<span class="hljs-number">331</span> Password required <span class="hljs-keyword">for</span> ftpuser.Enter password:<span class="hljs-number">230</span> User logged <span class="hljs-keyword">in</span>.[ftp]dir<span class="hljs-number">200</span> Port command okay.<span class="hljs-number">150</span> Opening ASCII mode data connection <span class="hljs-keyword">for</span> *.drwxrwxrwx   <span class="hljs-number">1</span> noone    nogroup         <span class="hljs-number">0</span> Aug <span class="hljs-number">07</span>  <span class="hljs-number">2015</span> srcdrwxrwxrwx   <span class="hljs-number">1</span> noone    nogroup         <span class="hljs-number">0</span> Jul <span class="hljs-number">31</span> <span class="hljs-number">08</span>:<span class="hljs-number">39</span> pmdatadrwxrwxrwx   <span class="hljs-number">1</span> noone    nogroup         <span class="hljs-number">0</span> Jul <span class="hljs-number">31</span> <span class="hljs-number">08</span>:<span class="hljs-number">39</span> dhcp-rwxrwxrwx   <span class="hljs-number">1</span> noone    nogroup       <span class="hljs-number">603</span> Jul <span class="hljs-number">31</span> <span class="hljs-number">15</span>:<span class="hljs-number">09</span> <span class="hljs-keyword">private</span>-data.txtdrwxrwxrwx   <span class="hljs-number">1</span> noone    nogroup         <span class="hljs-number">0</span> Jul <span class="hljs-number">31</span> <span class="hljs-number">08</span>:<span class="hljs-number">54</span> mplstpoam-rwxrwxrwx   <span class="hljs-number">1</span> noone    nogroup       <span class="hljs-number">507</span> Jul <span class="hljs-number">31</span> <span class="hljs-number">15</span>:<span class="hljs-number">19</span> ftp.demo-rwxrwxrwx   <span class="hljs-number">1</span> noone    nogroup       <span class="hljs-number">507</span> Jul <span class="hljs-number">31</span> <span class="hljs-number">15</span>:<span class="hljs-number">09</span> vrpcfg.zip<span class="hljs-number">226</span> Transfer complete.</code></pre><h1 id="å››ã€æ„å»ºå†—ä½™å‹ä¼ä¸šç½‘ç»œ"><a href="#å››ã€æ„å»ºå†—ä½™å‹ä¼ä¸šç½‘ç»œ" class="headerlink" title="å››ã€æ„å»ºå†—ä½™å‹ä¼ä¸šç½‘ç»œ"></a>å››ã€æ„å»ºå†—ä½™å‹ä¼ä¸šç½‘ç»œ</h1><p>VLANã€Trunkã€STPã€VRRPã€é“¾è·¯èšåˆã€ACL</p><h2 id="4-1-VLANï¼ˆVirtual-Local-Area-Networkï¼‰"><a href="#4-1-VLANï¼ˆVirtual-Local-Area-Networkï¼‰" class="headerlink" title="4.1 VLANï¼ˆVirtual Local Area Networkï¼‰"></a>4.1 VLANï¼ˆVirtual Local Area Networkï¼‰</h2><blockquote><p>è™šæ‹Ÿå±€åŸŸç½‘æ˜¯å°†ä¸€ä¸ªç‰©ç†çš„å±€åŸŸç½‘åœ¨é€»è¾‘ä¸Šåˆ’åˆ†æˆå¤šä¸ªå¹¿æ’­åŸŸçš„æŠ€æœ¯ã€‚é€šè¿‡åœ¨äº¤æ¢æœºä¸Šé…ç½® VLAN ï¼Œå¯ä»¥å®ç°åœ¨åŒä¸€ä¸ª VLAN å†…çš„ç”¨æˆ·å¯ä»¥è¿›è¡ŒäºŒå±‚äº’è®¿ï¼Œè€Œä¸åŒ VLAN é—´çš„ç”¨æˆ·è¢«äºŒå±‚éš”ç¦»ã€‚è¿™æ ·æ—¢èƒ½å¤Ÿéš”ç¦»å¹¿æ’­åŸŸï¼Œåˆèƒ½å¤Ÿæå‡ç½‘ç»œçš„å®‰å…¨æ€§ã€‚</p></blockquote><h3 id="4-1-1-é…ç½®"><a href="#4-1-1-é…ç½®" class="headerlink" title="4.1.1 é…ç½®"></a>4.1.1 é…ç½®</h3><p><img src="/img/Huawei_route/Huawei_route_base_23.jpg"></p><p>åˆ›å»º VLANï¼š</p><pre><code class="hljs routeros">[SW1]vlan batch 10 20#åŒæ—¶åˆ›å»ºå¤šä¸ª<span class="hljs-built_in"> VLAN </span>ï¼š<span class="hljs-built_in"> VLAN </span>10 ã€VLAN 20[SW1]int gi0/0/1#è¿›å…¥ GE 0/0/1 å£[SW1-GigabitEthernet0/0/1]port link-type access #å°†æ¥å£ç±»å‹é…ç½®ä¸º access[SW1-GigabitEthernet0/0/1]port<span class="hljs-built_in"> default vlan </span>10 #å°†æ¥å£åˆ’åˆ†åˆ°<span class="hljs-built_in"> VLAN </span>10 é‡Œ[SW1-GigabitEthernet0/0/1]dis this<span class="hljs-comment">#</span>interface GigabitEthernet0/0/1<span class="hljs-built_in"> port </span>link-type access<span class="hljs-built_in"> port default vlan </span>10<span class="hljs-comment">#</span>return<span class="hljs-comment">#æŸ¥çœ‹ VLAN é…ç½®</span>[SW1]dis vlanThe total number of vlans is : 3--------------------------------------------------------------------------------U: Up;         D: Down;         TG: Tagged;         UT: Untagged;MP: Vlan-mapping;               ST: Vlan-stacking;<span class="hljs-comment">#: ProtocolTransparent-vlan;    *: Management-vlan;</span>--------------------------------------------------------------------------------VID <span class="hljs-built_in"> Type </span>   Ports                                                          --------------------------------------------------------------------------------1    common  UT:GE0/0/4(U)      GE0/0/5(D)      GE0/0/6(D)      GE0/0/7(D)                      GE0/0/8(D)      GE0/0/9(D)      GE0/0/10(D)     GE0/0/11(D)                     GE0/0/12(D)     GE0/0/13(D)     GE0/0/14(D)     GE0/0/15(D)                     GE0/0/16(D)     GE0/0/17(D)     GE0/0/18(D)     GE0/0/19(D)                     GE0/0/20(D)     GE0/0/21(D)     GE0/0/22(D)     GE0/0/23(D)                     GE0/0/24(D)                                                     10   common  UT:GE0/0/1(U)      GE0/0/2(U)                                      20   common  UT:GE0/0/3(U)                                                      VID  Status  Property      MAC-LRN Statistics Description      --------------------------------------------------------------------------------1    <span class="hljs-builtin-name">enable</span> <span class="hljs-built_in"> default </span>      <span class="hljs-builtin-name">enable</span>  <span class="hljs-builtin-name">disable</span>   <span class="hljs-built_in"> VLAN </span>0001                         10   <span class="hljs-builtin-name">enable</span> <span class="hljs-built_in"> default </span>      <span class="hljs-builtin-name">enable</span>  <span class="hljs-builtin-name">disable</span>   <span class="hljs-built_in"> VLAN </span>0010                         20   <span class="hljs-builtin-name">enable</span> <span class="hljs-built_in"> default </span>      <span class="hljs-builtin-name">enable</span>  <span class="hljs-builtin-name">disable</span>   <span class="hljs-built_in"> VLAN </span>0020</code></pre><p><font color=red>æ³¨ï¼š VLAN 1 å±äºé»˜è®¤ VLANï¼Œé»˜è®¤æƒ…å†µä¸‹æ‰€æœ‰æ¥å£éƒ½åœ¨ VLAN 1 ä¸‹ã€‚VLAN éš”ç¦»å¹¿æ’­çš„åŒæ—¶ï¼Œä¹Ÿä¼šéš”ç¦» arpï¼Œä»è€Œå¯¼è‡´å•æ’­æ— æ³•é€šä¿¡ã€‚å¦‚æœæƒ³è®©ä¸åŒ VLAN å•æ’­å¯ä»¥é€šä¿¡ï¼Œè¿˜éœ€è¦ä¸‰å±‚è®¾å¤‡ï¼ˆè·¯ç”±å™¨ã€ä¸‰å±‚äº¤æ¢æœºï¼‰åšè·¯ç”±ã€‚</font></p><p>æ³¨ï¼šé»˜è®¤æƒ…å†µä¸‹ï¼Œäº¤æ¢æœºçš„ä¸€ä¸ªæ¥å£åªèƒ½ä»å±ä¸€ä¸ª VLANï¼Œåªå…è®¸è¯¥ VLAN çš„æ•°æ®é€šè¿‡ã€‚</p><h2 id="4-2-Trunkï¼ˆå¹²é“ï¼Œä¸»å¹²é“¾è·¯ï¼‰"><a href="#4-2-Trunkï¼ˆå¹²é“ï¼Œä¸»å¹²é“¾è·¯ï¼‰" class="headerlink" title="4.2 Trunkï¼ˆå¹²é“ï¼Œä¸»å¹²é“¾è·¯ï¼‰"></a>4.2 Trunkï¼ˆå¹²é“ï¼Œä¸»å¹²é“¾è·¯ï¼‰</h2><blockquote><p>é€šå¸¸ç”¨äºäº¤æ¢æœºå’Œäº¤æ¢æœºä¹‹é—´ï¼Œé€šè¿‡ä¸€ä¸ªæ¥å£ä¼ è¾“å¤šä¸ª VLAN çš„æ•°æ®åŒ…ã€‚</p></blockquote><h3 id="4-2-1-é…ç½®"><a href="#4-2-1-é…ç½®" class="headerlink" title="4.2.1 é…ç½®"></a>4.2.1 é…ç½®</h3><p><img src="/img/Huawei_route/Huawei_route_base_24.jpg"></p><p>å°†äº¤æ¢æœºä¸äº¤æ¢æœºç›¸è¿æ¥çš„ç«¯å£ç±»å‹æ”¹ä¸º Trunk ç±»å‹</p><pre><code class="hljs routeros">[SW1]int gi0/0/4[SW1-GigabitEthernet0/0/4]port link-type trunk #å°†æ¥å£ç±»å‹é…ç½®ä¸º trunk[SW1-GigabitEthernet0/0/4]port trunk allow-pass<span class="hljs-built_in"> vlan </span>all #å…è®¸æ‰€æœ‰çš„<span class="hljs-built_in"> VLAN </span>é€šè¿‡[SW1-GigabitEthernet0/0/4]dis this<span class="hljs-comment">#</span>interface GigabitEthernet0/0/4<span class="hljs-built_in"> port </span>link-type trunk<span class="hljs-built_in"> port </span>trunk allow-pass<span class="hljs-built_in"> vlan </span>2 <span class="hljs-keyword">to</span> 4094<span class="hljs-comment">#</span>return[SW1-GigabitEthernet0/0/4]port link-type ?  access        Access<span class="hljs-built_in"> port</span>#æ¥ PC ç«¯å£  dot1q-tunnel  QinQ port  hybrid        Hybrid<span class="hljs-built_in"> port</span>#æ··åˆå£ å³å¯ä»¥æ¥ PC ä¹Ÿå¯ä»¥æ¥äº¤æ¢æœºï¼ˆåä¸ºäº¤æ¢æœºçš„é»˜è®¤æ¥å£ï¼‰  trunk         Trunk<span class="hljs-built_in"> port</span>#æ¥äº¤æ¢æœº  <span class="hljs-comment">#æŸ¥çœ‹æ¥å£ç±»å‹</span>[SW1]dis<span class="hljs-built_in"> port </span>vlanPort                    Link<span class="hljs-built_in"> Type </span>   PVID  Trunk<span class="hljs-built_in"> VLAN </span>List-------------------------------------------------------------------------------GigabitEthernet0/0/1    access       10    -                                   GigabitEthernet0/0/2    access       10    -                                   GigabitEthernet0/0/3    access       20    -                                   GigabitEthernet0/0/4    trunk        1     1GigabitEthernet0/0/5    hybrid       1     -                                   GigabitEthernet0/0/6    hybrid       1     -                                             GigabitEthernet0/0/7    hybrid       1     -</code></pre><p>PC åˆ°äº¤æ¢æœº access å£çš„åŒ…ï¼š</p><p><img src="/img/Huawei_route/Huawei_route_base_25.jpg"></p><p><font color=red>æ³¨ï¼šPC ä¸è¯† VLAN æ ‡è®°ï¼Œä¸è¯† tagï¼Œåªæœ‰é€šè¿‡äº¤æ¢æœºçš„ trunk æ¥å£å‘å‡ºçš„æŠ¥æ–‡æ‰å…·å¤‡ VLAN çš„æ ‡è®°ï¼ˆ802.1q tagï¼‰ï¼Œè§ä¸‹å›¾</font></p><p>äº¤æ¢æœº trunk åˆ° trunk äº¤æ¢æœºåŒ…ï¼š</p><p><img src="/img/Huawei_route/Huawei_route_base_26.jpg"></p><h3 id="4-2-2-PVID-æœ¬å¾-VLANï¼Œnative-vlan"><a href="#4-2-2-PVID-æœ¬å¾-VLANï¼Œnative-vlan" class="headerlink" title="4.2.2 PVID(æœ¬å¾ VLANï¼Œnative vlan)"></a>4.2.2 PVID(æœ¬å¾ VLANï¼Œnative vlan)</h3><p>è¯¥ VLAN çš„æŠ¥æ–‡ç»è¿‡ trunk æ¥å£æ—¶ä¸æ‰“æ ‡è®°ã€‚é»˜è®¤æƒ…å†µä¸‹æœ¬å¾ VLAN æ˜¯ VLAN 1ã€‚</p><pre><code class="hljs routeros">[SW1]dis<span class="hljs-built_in"> port vlan </span>Port                    Link<span class="hljs-built_in"> Type </span>   PVID  Trunk<span class="hljs-built_in"> VLAN </span>List-------------------------------------------------------------------------------GigabitEthernet0/0/1    access       10    -                                   GigabitEthernet0/0/2    access       10    -                                   GigabitEthernet0/0/3    access       20    -                                   GigabitEthernet0/0/4    trunk        1     1-4094GigabitEthernet0/0/5    hybrid       1     -                                   GigabitEthernet0/0/6    hybrid       1     -                                   GigabitEthernet0/0/7    hybrid       1     -</code></pre><p>ä¾‹ï¼š</p><p><img src="/img/Huawei_route/Huawei_route_base_27.jpg"></p><p>PC8 å’Œ PC9 é»˜è®¤å±äº VLAN 1ï¼Œå®ƒä»¬é€šä¿¡ç»è¿‡äº¤æ¢æœº trunk æ—¶ï¼Œæ˜¯ä¸æ‰“ tag çš„ã€‚</p><p><img src="/img/Huawei_route/Huawei_route_base_28.jpg"></p><h4 id="ä¿®æ”¹-PVID"><a href="#ä¿®æ”¹-PVID" class="headerlink" title="ä¿®æ”¹ PVID"></a>ä¿®æ”¹ PVID</h4><pre><code class="hljs routeros"><span class="hljs-comment">#ä¸¤å°ç›¸è¿äº¤æ¢æœº trunk éƒ½éœ€è¦ä¿®æ”¹</span>[SW1]int gi 0/0/4[SW1-GigabitEthernet0/0/4]port trunk pvid<span class="hljs-built_in"> vlan </span>20[SW2]int gi 0/0/1[SW2-GigabitEthernet0/0/1]port trunk pvid<span class="hljs-built_in"> vlan </span>20</code></pre><p>å½“ PVID ä¿®æ”¹ä¸º VLAN 20 åï¼ŒVLAN 20 ä¸‹çš„ PC é€šä¿¡ç»è¿‡äº¤æ¢æœº trunk æ—¶ä¸æ‰“ tagã€‚</p><h2 id="4-3-VLAN-é—´è·¯ç”±"><a href="#4-3-VLAN-é—´è·¯ç”±" class="headerlink" title="4.3 VLAN é—´è·¯ç”±"></a>4.3 VLAN é—´è·¯ç”±</h2><p><font color=red>æ³¨ï¼šä¸åŒçš„ VLAN ä¹‹é—´äº’ç›¸é€šä¿¡å¿…é¡»è¦æœ‰ä¸‰å±‚è®¾å¤‡ï¼ˆè·¯ç”±å™¨ã€å¤šå±‚äº¤æ¢æœºï¼‰åšä¸­è½¬ã€‚</font></p><h3 id="4-3-1-å¤šå±‚äº¤æ¢æœºâ€“SVIï¼ˆswitch-virtual-interfaceï¼Œå¸¸ç”¨ï¼‰"><a href="#4-3-1-å¤šå±‚äº¤æ¢æœºâ€“SVIï¼ˆswitch-virtual-interfaceï¼Œå¸¸ç”¨ï¼‰" class="headerlink" title="4.3.1 å¤šå±‚äº¤æ¢æœºâ€“SVIï¼ˆswitch virtual interfaceï¼Œå¸¸ç”¨ï¼‰"></a>4.3.1 å¤šå±‚äº¤æ¢æœºâ€“SVIï¼ˆswitch virtual interfaceï¼Œå¸¸ç”¨ï¼‰</h3><p><img src="/img/Huawei_route/Huawei_route_base_29.jpg"></p><h4 id="SVI-é…ç½®"><a href="#SVI-é…ç½®" class="headerlink" title="SVI é…ç½®"></a>SVI é…ç½®</h4><pre><code class="hljs routeros">[Huawei]int Vlanif 10[Huawei-Vlanif10]ip<span class="hljs-built_in"> address </span>192.168.10.1 24#ç»™<span class="hljs-built_in"> VLAN </span>10 é…ç½®<span class="hljs-built_in"> ip </span>åœ°å€ 10.1 ä½œä¸º<span class="hljs-built_in"> VLAN </span>10 çš„ç”¨æˆ·ç½‘å…³[Huawei-Vlanif10]dis this<span class="hljs-comment">#</span>interface Vlanif10<span class="hljs-built_in"> ip address </span>192.168.10.1 255.255.255.0<span class="hljs-comment">#</span>return[Huawei]int Vlanif 20[Huawei-Vlanif20]ip<span class="hljs-built_in"> address </span>192.168.20.1 24#ç»™<span class="hljs-built_in"> VLAN </span>20 é…ç½®<span class="hljs-built_in"> ip </span>åœ°å€ 20.1 ä½œä¸º<span class="hljs-built_in"> VLAN </span>20 çš„ç”¨æˆ·ç½‘å…³<span class="hljs-comment">#è°ƒè¯•</span>[Huawei]dis<span class="hljs-built_in"> ip interface </span>brief <span class="hljs-number">*d</span>own: administratively down^down: standby(l): loopback(s): spoofingThe number of<span class="hljs-built_in"> interface </span>that is UP <span class="hljs-keyword">in</span> Physical is 4The number of<span class="hljs-built_in"> interface </span>that is DOWN <span class="hljs-keyword">in</span> Physical is 1The number of<span class="hljs-built_in"> interface </span>that is UP <span class="hljs-keyword">in</span> Protocol is 3The number of<span class="hljs-built_in"> interface </span>that is DOWN <span class="hljs-keyword">in</span> Protocol is 2Interface                        <span class="hljs-built_in"> IP </span>Address/Mask      Physical   Protocol  MEth0/0/1                         unassigned           down       down      NULL0                             unassigned           up         up(s)     Vlanif1                           unassigned           up         down      Vlanif10                          192.168.10.1/24      up         up        Vlanif20                          192.168.20.1/24      up         up<span class="hljs-comment">#æ˜¾ç¤ºè·¯ç”±è¡¨</span>[Huawei]dis<span class="hljs-built_in"> ip </span>routing-table Route Flags: R - relay, D - download <span class="hljs-keyword">to</span> fib------------------------------------------------------------------------------Routing Tables: Public         Destinations : 6        Routes : 6        Destination/Mask    Proto   Pre  Cost      Flags NextHop         Interface      127.0.0.0/8   Direct  0    0           D   127.0.0.1       InLoopBack0      127.0.0.1/32  Direct  0    0           D   127.0.0.1       InLoopBack0   192.168.10.0/24  Direct  0    0           D   192.168.10.1    Vlanif10   192.168.10.1/32  Direct  0    0           D   127.0.0.1       Vlanif10   192.168.20.0/24  Direct  0    0           D   192.168.20.1    Vlanif20   192.168.20.1/32  Direct  0    0           D   127.0.0.1       Vlanif20</code></pre><p>æ³¨ï¼š</p><p>VLAN é—´è·¯ç”±ï¼šé€šè¿‡ä¸‰å±‚è®¾å¤‡è·¯ç”±ï¼Œä½¿å¾—ä¸åŒ VLAN é—´å¯ä»¥äº’ç›¸é€šä¿¡ï¼Œä½†æ˜¯ä»…ä»…å…è®¸å•æ’­é€šä¿¡ã€‚ä¸åŒ VLAN ä¹‹é—´å¹¿æ’­å¸§ä¾ç„¶è¢«éš”ç¦»æ—¢æ²¡æœ‰å¤±å» VLAN åŸæœ¬çš„æ„ä¹‰ã€‚</p><h3 id="4-3-2-è·¯ç”±å™¨â€“å•è‡‚è·¯ç”±"><a href="#4-3-2-è·¯ç”±å™¨â€“å•è‡‚è·¯ç”±" class="headerlink" title="4.3.2 è·¯ç”±å™¨â€“å•è‡‚è·¯ç”±"></a>4.3.2 è·¯ç”±å™¨â€“å•è‡‚è·¯ç”±</h3><p><img src="/img/Huawei_route/Huawei_route_base_30.jpg"></p><h4 id="è·¯ç”±é…ç½®"><a href="#è·¯ç”±é…ç½®" class="headerlink" title="è·¯ç”±é…ç½®"></a>è·¯ç”±é…ç½®</h4><pre><code class="hljs routeros">[Router]int e0/0/0.?#å¯ç”Ÿæˆçš„é€»è¾‘æ¥å£  &lt;1-4096&gt;   [Router]int e0/0/0.10[Router-Ethernet0/0/0.10]ip<span class="hljs-built_in"> address </span>192.168.10.254 24#ä¸ºé€»è¾‘æ¥å£ 10 é…ç½®10ç½‘æ®µçš„ç½‘å…³[Router-Ethernet0/0/0.10]dot1q termination vid 10#ç»‘å®š<span class="hljs-built_in"> VLAN </span>10[Router-Ethernet0/0/0.10]arp broadcast <span class="hljs-builtin-name">enable</span> #ä½¿å­æ¥å£æœ‰ARPå¹¿æ’­åŠŸèƒ½[Router-Ethernet0/0/0.10]dis this<span class="hljs-comment">#</span>interface Ethernet0/0/0.10 dot1q termination vid 10<span class="hljs-built_in"> ip address </span>192.168.10.254 255.255.255.0 arp broadcast enable<span class="hljs-comment">#</span>return[Router]int e0/0/0.20[Router-Ethernet0/0/0.20]ip<span class="hljs-built_in"> address </span>192.168.20.254 24[Router-Ethernet0/0/0.20]dot1q termination vid 20[Router-Ethernet0/0/0.20]arp broadcast <span class="hljs-builtin-name">enable</span> [Router-Ethernet0/0/0.20]dis this<span class="hljs-comment">#</span>interface Ethernet0/0/0.20 dot1q termination vid 20<span class="hljs-built_in"> ip address </span>192.168.20.254 255.255.255.0 arp broadcast enable<span class="hljs-comment">#</span>return[Router]dis<span class="hljs-built_in"> ip </span>routing-tableRoute Flags: R - relay, D - download <span class="hljs-keyword">to</span> fib------------------------------------------------------------------------------Routing Tables: Public         Destinations : 8        Routes : 8        Destination/Mask    Proto   Pre  Cost      Flags NextHop         Interface      127.0.0.0/8   Direct  0    0           D   127.0.0.1       InLoopBack0      127.0.0.1/32  Direct  0    0           D   127.0.0.1       InLoopBack0   192.168.10.0/24  Direct  0    0           D   192.168.10.254  Ethernet0/0/0.10   192.168.10.2/32  Direct  0    0           D   192.168.10.2    Ethernet0/0/0.10 192.168.10.254/32  Direct  0    0           D   127.0.0.1       Ethernet0/0/0.10   192.168.20.0/24  Direct  0    0           D   192.168.20.254  Ethernet0/0/0.20   192.168.20.2/32  Direct  0    0           D   192.168.20.2    Ethernet0/0/0.20 192.168.20.254/32  Direct  0    0           D   127.0.0.1       Ethernet0/0/0.20</code></pre><h2 id="4-4-ACLï¼ˆAccess-Control-Listï¼‰"><a href="#4-4-ACLï¼ˆAccess-Control-Listï¼‰" class="headerlink" title="4.4 ACLï¼ˆAccess Control Listï¼‰"></a>4.4 ACLï¼ˆAccess Control Listï¼‰</h2><blockquote><p>è®¿é—®æ§åˆ¶åˆ—è¡¨</p></blockquote><ul><li>åŸºæœ¬ACLï¼ˆ2000-2999ï¼‰ï¼šåªèƒ½åŒ¹é…æº IP åœ°å€</li><li>é«˜çº§ACLï¼ˆ3000-3999ï¼‰ï¼šå¯ä»¥åŒ¹é…æºIPã€ç›®æ ‡IPã€æºç«¯å£ã€ç›®æ ‡ç«¯å£ç­‰ä¸‰å±‚å’Œå››å±‚çš„å­—æ®µ</li></ul><h3 id="4-4-1-é…ç½®"><a href="#4-4-1-é…ç½®" class="headerlink" title="4.4.1 é…ç½®"></a>4.4.1 é…ç½®</h3><p><img src="/img/Huawei_route/Huawei_route_base_31.jpg"></p><p><strong>ä¾‹1ï¼š</strong></p><p>ç¦æ­¢ Client 1 192.168.10.1 è®¿é—®172.16.10.0 ç½‘æ®µï¼š</p><p>é…ç½® R2 è·¯ç”±ï¼š</p><pre><code class="hljs routeros"><span class="hljs-comment">#é…ç½® ACL è§„åˆ™</span>[R2]acl ?  INTEGER&lt;2000-2999&gt;  Basic access-list(<span class="hljs-builtin-name">add</span> <span class="hljs-keyword">to</span> current using rules)#åŸºæœ¬ ACL  INTEGER&lt;3000-3999&gt;  Advanced access-list(<span class="hljs-builtin-name">add</span> <span class="hljs-keyword">to</span> current using rules)#é«˜çº§ ACL  INTEGER&lt;4000-4999&gt;  Specify a L2 acl group <span class="hljs-built_in"> ipv6 </span>               ACL<span class="hljs-built_in"> IPv6 </span>  name                Specify a named ACL  number              Specify a numbered ACL[R2-acl-basic-2000]rule ?  INTEGER&lt;0-4294967294&gt;  ID of ACL rule  deny                   Specify matched packet deny#æ‹’ç»  permit                 Specify matched packet permit#å…è®¸[R2-acl-basic-2000]rule deny source 192.168.10.1 ?  IP_ADDR&lt;X.X.X.X&gt;  Wildcard of source  0                 Wildcard bits : 0.0.0.0 ( a host )[R2-acl-basic-2000]rule deny source 192.168.10.1 0#æ‹’ç»æºåœ°å€ä¸º192.168.10.1çš„ä»»ä½•æ•°æ®åŒ…ï¼Œ0ä»£è¡¨ä¸»æœºï¼Œä¸ä»£è¡¨æŸä¸ªç½‘æ®µ[R2-acl-basic-2000]dis this[V200R003C00]<span class="hljs-comment">#</span>acl number 2000   rule 5 deny source 192.168.10.1 0 # 5 ä¸ºè‡ªåŠ¨ç”Ÿæˆçš„æ‰§è¡Œç¼–å·ï¼Œç¬¬äºŒæ¡åˆ™ä¸º10ï¼ˆæ¯æ¡+5ï¼‰<span class="hljs-comment">#</span>return<span class="hljs-comment">#åœ¨æ¥å£çš„å…¥æ–¹å‘è°ƒç”¨ ACL è§„åˆ™</span>[R2]int gi0/0/0[R2-GigabitEthernet0/0/0]traffic-filter inbound acl 2000 #åœ¨ R2 æ¥å£çš„å…¥ï¼ˆinboundï¼‰æ–¹å‘è°ƒç”¨ acl[R2-GigabitEthernet0/0/0]dis this[V200R003C00]<span class="hljs-comment">#</span>interface GigabitEthernet0/0/0<span class="hljs-built_in"> ip address </span>12.1.1.2 255.255.255.0  traffic-filter inbound acl 2000<span class="hljs-comment">#</span>return</code></pre><p><strong>ä¾‹2ï¼š</strong></p><p><img src="/img/Huawei_route/Huawei_route_base_31.jpg"></p><p>åœ¨ R2 ä¸Šé…ç½®<em>é«˜çº§ ACL</em> æ‹’ç» Client 1 å’Œ PC2 ping Server1ï¼ˆæ‹’ç» ICMP åè®®æ•°æ®åŒ…ï¼‰ï¼Œä½†æ˜¯å…è®¸å…¶ HTTP è®¿é—® Server 1ã€‚</p><pre><code class="hljs angelscript">#é…ç½® ACL è§„åˆ™[R2]acl <span class="hljs-number">3000</span>[R2-acl-adv<span class="hljs-number">-3000</span>]rule deny icmp source <span class="hljs-number">192.168</span><span class="hljs-number">.10</span><span class="hljs-number">.0</span> <span class="hljs-number">0.0</span><span class="hljs-number">.0</span><span class="hljs-number">.255</span> destination <span class="hljs-number">172.16</span><span class="hljs-number">.10</span><span class="hljs-number">.2</span> <span class="hljs-number">0</span>#æ‹’ç» <span class="hljs-number">192.168</span><span class="hljs-number">.10</span><span class="hljs-number">.0</span> ç½‘æ®µ pingï¼ˆICMPï¼‰ Server <span class="hljs-number">1</span>(<span class="hljs-number">172.16</span><span class="hljs-number">.10</span><span class="hljs-number">.2</span> <span class="hljs-number">0</span>ä»£è¡¨æœ¬æœº)[R2-acl-adv<span class="hljs-number">-3000</span>]dis <span class="hljs-keyword">this</span>[V200R003C00]#acl number <span class="hljs-number">3000</span>   rule <span class="hljs-number">5</span> deny icmp source <span class="hljs-number">192.168</span><span class="hljs-number">.10</span><span class="hljs-number">.0</span> <span class="hljs-number">0.0</span><span class="hljs-number">.0</span><span class="hljs-number">.255</span> destination <span class="hljs-number">172.16</span><span class="hljs-number">.10</span><span class="hljs-number">.2</span> <span class="hljs-number">0</span> #<span class="hljs-keyword">return</span>#æ¥å£å…¥è°ƒç”¨ ACL è§„åˆ™[R2]<span class="hljs-built_in">int</span> gi0/<span class="hljs-number">0</span>/<span class="hljs-number">0</span>[R2-GigabitEthernet0/<span class="hljs-number">0</span>/<span class="hljs-number">0</span>]traffic-filter inbound acl <span class="hljs-number">3000</span></code></pre><p><strong>ä¾‹3ï¼š</strong></p><p><img src="/img/Huawei_route/Huawei_route_base_31.jpg"></p><p>æ‹’ç»æºåœ°å€ 192.168.10.2 telnetï¼ˆport 23ï¼‰ è®¿é—®12.1.1.2</p><pre><code class="hljs angelscript">#é…ç½® ACL è§„åˆ™[R2]acl <span class="hljs-number">3001</span>[R2-acl-adv<span class="hljs-number">-3001</span>]rule deny tcp source <span class="hljs-number">192.168</span><span class="hljs-number">.10</span><span class="hljs-number">.2</span> <span class="hljs-number">0</span> destination <span class="hljs-number">12.1</span><span class="hljs-number">.1</span><span class="hljs-number">.2</span> <span class="hljs-number">0</span> destination-port eq <span class="hljs-number">23</span>[R2-acl-adv<span class="hljs-number">-3001</span>]dis <span class="hljs-keyword">this</span>[V200R003C00]#acl number <span class="hljs-number">3001</span>   rule <span class="hljs-number">5</span> deny tcp source <span class="hljs-number">192.168</span><span class="hljs-number">.10</span><span class="hljs-number">.2</span> <span class="hljs-number">0</span> destination <span class="hljs-number">12.1</span><span class="hljs-number">.1</span><span class="hljs-number">.2</span> <span class="hljs-number">0</span> destination-port eq telnet #<span class="hljs-keyword">return</span>#æ¥å£å…¥è°ƒç”¨ ACL è§„åˆ™[R2]<span class="hljs-built_in">int</span> gi0/<span class="hljs-number">0</span>/<span class="hljs-number">0</span>[R2-GigabitEthernet0/<span class="hljs-number">0</span>/<span class="hljs-number">0</span>]traffic-filter inbound acl <span class="hljs-number">3001</span></code></pre><p><font color=red><strong>æ³¨ï¼š</strong></font></p><ol><li><strong>ä¸€ä¸ªæ¥å£çš„åŒä¸€ä¸ªæ–¹å‘ï¼Œåªèƒ½è°ƒç”¨ä¸€ä¸ª ACL</strong></li><li><strong>ä¸€ä¸ª ACL é‡Œé¢å¯ä»¥æœ‰å¤šä¸ª rule è§„åˆ™ï¼Œä»ä¸Šå¾€ä¸‹ä¾æ¬¡æ‰§è¡Œ</strong></li><li><strong>æ•°æ®åŒ…ä¸€æ—¦è¢«æŸ rule åŒ¹é…ï¼Œå°±ä¸å†ç»§ç»­å‘ä¸‹åŒ¹é…</strong></li><li><strong>é»˜è®¤éšå«æ”¾è¿‡æ‰€æœ‰ï¼ˆåä¸ºçš„ ACL ç”¨æ¥æ‹’ç»æ•°æ®åŒ…æ—¶ï¼‰</strong></li></ol><h1 id="äº”ã€NATï¼ˆNetwork-Address-Translationï¼‰"><a href="#äº”ã€NATï¼ˆNetwork-Address-Translationï¼‰" class="headerlink" title="äº”ã€NATï¼ˆNetwork Address Translationï¼‰"></a>äº”ã€NATï¼ˆNetwork Address Translationï¼‰</h1><blockquote><p>ç½‘ç»œåœ°å€è½¬æ¢ä¸»è¦ç”¨äºå®ç°ä½äºå†…éƒ¨ç½‘ç»œçš„ä¸»æœºè®¿é—®å¤–éƒ¨ç½‘ç»œçš„åŠŸèƒ½ã€‚å½“å±€åŸŸç½‘å†…çš„ä¸»æœºéœ€è¦è®¿é—®å¤–éƒ¨ç½‘ç»œæ—¶ï¼Œé€šè¿‡ NAT æŠ€æœ¯å¯ä»¥å°†å…¶ç§ç½‘åœ°å€è½¬æ¢ä¸ºå…¬ç½‘åœ°å€ï¼Œå¹¶ä¸”å¤šä¸ªç§ç½‘åœ°å€å¯ä»¥å…±ç”¨ä¸€ä¸ªå…¬ç½‘åœ°å€ï¼Œè¿™æ ·æ—¢èƒ½ä¿è¯ç½‘ç»œäº’é€šï¼Œæœ‰èŠ‚çœå…¬ç½‘åœ°å€ã€‚</p></blockquote><ul><li>NAT ä¸€èˆ¬éƒ¨ç½²åœ¨è¿æ¥å†…ç½‘å’Œå¤–ç½‘çš„ç½‘å…³è®¾å¤‡ä¸Š</li></ul><p><strong>ç§æœ‰åœ°å€ï¼šä»»ä½•äººéƒ½èƒ½ä½¿ç”¨</strong></p><p>A 10.0.0.0/8</p><p>B 172.16.0.0-172.31.255.255</p><p>C 192.168.0.0/16</p><h2 id="5-1-Static-NAT-é…ç½®"><a href="#5-1-Static-NAT-é…ç½®" class="headerlink" title="5.1 Static NAT é…ç½®"></a>5.1 Static NAT é…ç½®</h2><blockquote><p>ä¸€å¯¹ä¸€ï¼ˆä¸€ä¸€æ˜ å°„ï¼‰ï¼Œä¸€ä¸ªç§ç½‘åœ°å€å¯¹åº”ä¸€ä¸ªå…¬ç½‘åœ°å€ï¼Œå¤–ç½‘çš„ç”¨æˆ·å¯ä»¥è®¿é—®å†…ç½‘çš„ä¸»æœº</p></blockquote><p><img src="/img/Huawei_route/Huawei_route_base_32.jpg"></p><p>åŸºç¡€é…ç½®ï¼š</p><ol><li>é…ç½®å¥½ IP åœ°å€</li><li>å‡ºå£é…ç½®ç¼ºçœè·¯ç”±<code>[OUT]ip route-static 0.0.0.0 0 12.1.1.6</code></li><li>åœ¨ä¼ä¸šè·¯ç”±WANç«¯å£ï¼ˆGE 0/0/1ï¼‰é…ç½® Static NAT</li></ol><pre><code class="hljs routeros">[OUT]int gi 0/0/1[OUT-GigabitEthernet0/0/1]nat static ?  <span class="hljs-builtin-name">enable</span>    <span class="hljs-builtin-name">Enable</span> function  global    Specify global information of<span class="hljs-built_in"> NAT</span>#å…¨å±€å…¬ç½‘åœ°å€  protocol  Specify protocol[OUT-GigabitEthernet0/0/1]nat static global 12.1.1.2 ?  inside  Specify inside information of<span class="hljs-built_in"> NAT </span> #å†…éƒ¨ç½‘ç»œ[OUT-GigabitEthernet0/0/1]nat static global 12.1.1.2 inside 192.168.1.2 #å°†ç§ç½‘åœ°å€ 1.2 å’Œ 12.1.1.2 åšä¸€å¯¹ä¸€æ˜ å°„[OUT-GigabitEthernet0/0/1]dis this[V200R003C00]<span class="hljs-comment">#</span>interface GigabitEthernet0/0/1 description TO_wan<span class="hljs-built_in"> ip address </span>12.1.1.1 255.255.255.248 <span class="hljs-built_in"> nat </span>static global 12.1.1.2 inside 192.168.1.2 netmask 255.255.255.255<span class="hljs-comment">#</span>return</code></pre><p>ç”¨å†…ç½‘ PC 192.168.1.2 Ping ç™¾åº¦ï¼ˆ9.9.9.9ï¼‰ï¼Œä»ä¼ä¸šè·¯ç”±WANç«¯å£ï¼ˆGE 0/0/1ï¼‰å‡ºæŠ“åŒ…ï¼š</p><p><img src="/img/Huawei_route/Huawei_route_base_33.jpg"></p><p>å‘ç°æ­¤æ—¶å†…ç½‘åœ°å€ 192.168.1.2 å·²ç»è¢«è½¬æ¢ä¸º 12.1.1.2 </p><p>è°ƒè¯•ï¼šæŸ¥çœ‹ NAT è½¬æ¢è¿‡ç¨‹ï¼š</p><pre><code class="hljs routeros">[OUT]dis<span class="hljs-built_in"> nat </span>session protocol icmp <span class="hljs-built_in"> NAT </span>Session Table Information:     Protocol          : ICMP(1)     SrcAddr   Vpn     : 192.168.1.2                                         DestAddr  Vpn     : 9.9.9.9                                            <span class="hljs-built_in"> Type </span>Code IcmpId  : 0   8   49311     NAT-Info       New SrcAddr     : 12.1.1.2              New DestAddr    : ----       New IcmpId      : ----</code></pre><h2 id="5-2-NAPT-Network-Address-Port-Translation"><a href="#5-2-NAPT-Network-Address-Port-Translation" class="headerlink" title="5.2 NAPT (Network Address Port Translation)"></a>5.2 NAPT (Network Address Port Translation)</h2><p>ç”±äºNATå®ç°æ˜¯ç§æœ‰IPå’ŒNATçš„å…¬å…±IPä¹‹é—´çš„è½¬æ¢ï¼Œé‚£ä¹ˆï¼Œç§æœ‰ç½‘ä¸­åŒæ—¶ä¸å…¬å…±ç½‘è¿›è¡Œé€šä¿¡çš„ä¸»æœºæ•°é‡å°±å—åˆ°NATçš„å…¬å…±IPåœ°å€æ•°é‡çš„é™åˆ¶ã€‚ä¸ºäº†å…‹æœ è¿™ç§é™åˆ¶ï¼ŒNATè¢«è¿›ä¸€æ­¥æ‰©å±•åˆ°åœ¨è¿›è¡ŒIPåœ°å€è½¬æ¢çš„åŒæ—¶è¿›è¡ŒPortçš„è½¬æ¢ï¼Œè¿™å°±æ˜¯ç½‘ç»œåœ°å€ç«¯å£è½¬æ¢NAPTï¼ˆNetwork Address Port Translationï¼‰æŠ€æœ¯ã€‚<br>    NAPTä¸NATçš„åŒºåˆ«åœ¨äºï¼ŒNAPTä¸ä»…è½¬æ¢IPåŒ…ä¸­çš„IPåœ°å€ï¼Œè¿˜å¯¹IPåŒ…ä¸­TCPå’ŒUDPçš„Portè¿›è¡Œè½¬æ¢ã€‚è¿™ä½¿å¾—å¤šå°ç§æœ‰ç½‘ä¸»æœºåˆ©ç”¨1ä¸ªNATå…¬å…±IPå°±å¯ä»¥åŒæ—¶å’Œå…¬å…±ç½‘è¿›è¡Œé€šä¿¡ã€‚ï¼ˆNAPTå¤šäº†å¯¹TCPå’ŒUDPçš„ç«¯å£å·çš„è½¬æ¢ï¼‰</p><pre><code>ç§æœ‰ç½‘ä¸»æœº192.168.1.2è¦è®¿é—®å…¬å…±ç½‘ä¸­çš„ HttpæœåŠ¡å™¨166.111.80.200ã€‚é¦–å…ˆï¼Œè¦å»ºç«‹TCPè¿æ¥ï¼Œå‡è®¾åˆ†é…çš„TCP Portæ˜¯1010ï¼Œå‘é€äº†1ä¸ªIPåŒ…ï¼ˆDes=166.111.80.200:80,Src=192.168.1.2:1010ï¼‰,å½“IPåŒ…ç»è¿‡NAT ç½‘å…³æ—¶ï¼ŒNATä¼šå°†IPåŒ…çš„æºIPè½¬æ¢ä¸ºNATçš„å…¬å…±IPï¼ŒåŒæ—¶å°†æºPortè½¬æ¢ä¸ºNATåŠ¨æ€åˆ†é…çš„1ä¸ªPortã€‚ç„¶åï¼Œè½¬å‘åˆ°å…¬å…±ç½‘ï¼Œæ­¤æ—¶IPåŒ… ï¼ˆDes=166.111.80.200ï¼š80ï¼ŒSrc=202.204.65.2:2010ï¼‰å·²ç»ä¸å«ä»»ä½•ç§æœ‰ç½‘IPå’ŒPortçš„ä¿¡æ¯ã€‚ç”±äºIPåŒ…çš„æº IPå’ŒPortå·²ç»è¢«è½¬æ¢æˆNATçš„å…¬å…±IPå’ŒPortï¼Œå“åº”çš„IPåŒ… ï¼ˆDes=202.204.65.2:,Src=2010166.111.80.200:80ï¼‰å°†è¢«å‘é€åˆ°NATã€‚è¿™æ—¶NATä¼šå°†IPåŒ…çš„ç›®çš„IPè½¬æ¢æˆ ç§æœ‰ç½‘ä¸»æœºçš„IPï¼ŒåŒæ—¶å°†ç›®çš„Portè½¬æ¢ä¸ºç§æœ‰ç½‘ä¸»æœºçš„Portï¼Œç„¶åå°†IPåŒ… ï¼ˆDes=192.168.1.2:1010ï¼ŒSrc=166.111.80.200:80ï¼‰è½¬å‘åˆ°ç§ç½‘ã€‚å¯¹äºé€šä¿¡åŒæ–¹è€Œè¨€ï¼Œè¿™ç§IPåœ°å€å’ŒPortçš„è½¬ æ¢æ˜¯å®Œå…¨é€æ˜çš„ã€‚</code></pre><h2 id="5-3-NAT-â€“-Easy-IP"><a href="#5-3-NAT-â€“-Easy-IP" class="headerlink" title="5.3 NAT â€“ Easy IP"></a>5.3 NAT â€“ Easy IP</h2><p>Easy IP æ–¹å¼çš„å®ç°åŸç†ä¸ä¸ŠèŠ‚ä»‹ç»çš„åœ°å€æ± NAPT è½¬æ¢åŸç†ç±»ä¼¼ï¼Œå¯ä»¥ç®—æ˜¯NAPTçš„ä¸€ç§ç‰¹ä¾‹ï¼Œä¸åŒçš„æ˜¯Easy IP æ–¹å¼å¯ä»¥å®ç°è‡ªåŠ¨æ ¹æ®è·¯ç”±å™¨ä¸ŠWAN æ¥å£çš„å…¬ç½‘IP åœ°å€å®ç°ä¸ç§ç½‘IP åœ°å€ä¹‹é—´çš„æ˜ å°„ï¼ˆæ— éœ€åˆ›å»ºå…¬ç½‘åœ°å€æ± ï¼‰ã€‚<br>Easy IP ä¸»è¦åº”ç”¨äºå°†è·¯ç”±å™¨WAN æ¥å£IP åœ°å€ä½œä¸ºè¦è¢«æ˜ å°„çš„å…¬ç½‘IP åœ°å€çš„æƒ…å½¢ï¼Œç‰¹åˆ«é€‚åˆå°å‹å±€åŸŸç½‘æ¥å…¥Internet çš„æƒ…å†µã€‚è¿™é‡Œçš„å°å‹å±€åŸŸç½‘ä¸»è¦æŒ‡ä¸­å°å‹ç½‘å§ã€å°å‹åŠå…¬å®¤ç­‰ç¯å¢ƒï¼Œä¸€èˆ¬å…·æœ‰ä»¥ä¸‹ç‰¹ç‚¹ï¼šå†…éƒ¨ä¸»æœºè¾ƒå°‘ã€å‡ºæ¥å£é€šè¿‡æ‹¨å·æ–¹å¼è·å¾—ä¸´æ—¶ï¼ˆæˆ–å›ºå®šï¼‰å…¬ç½‘IP åœ°å€ä»¥ä¾›å†…éƒ¨ä¸»æœºè®¿é—®Internetã€‚å›¾6-3 æ‰€ç¤ºä¸ºEasy IP æ–¹å¼çš„å®ç°åŸç†ï¼Œå…·ä½“è¿‡ç¨‹å¦‚ä¸‹ã€‚<br><img src="/img/Huawei_route/Huawei_route_base_57.jpg"><br>â‘  å‡è®¾ç§ç½‘ä¸­çš„Host A ä¸»æœºè¦è®¿é—®å…¬ç½‘çš„Serverï¼Œé¦–å…ˆè¦å‘Router å‘é€ä¸€ä¸ªè¯·æ±‚æŠ¥æ–‡ï¼ˆå³Outbound æ–¹å‘ï¼‰ï¼Œæ­¤æ—¶æŠ¥æ–‡ä¸­çš„æºåœ°å€æ˜¯10.1.1.100ï¼Œç«¯å£å·1540ã€‚<br>â‘¡ Router åœ¨æ”¶åˆ°è¯·æ±‚æŠ¥æ–‡åè‡ªåŠ¨åˆ©ç”¨å…¬ç½‘ä¾§WAN æ¥å£ä¸´æ—¶æˆ–è€…å›ºå®šçš„â€œå…¬ç½‘IPåœ°å€:ç«¯å£å·â€ï¼ˆ162.10.2.8:5480ï¼‰ï¼Œå»ºç«‹ä¸å†…ç½‘ä¾§æŠ¥æ–‡â€œæºIP åœ°å€:æºç«¯å£å·â€é—´çš„Easy IPè½¬æ¢è¡¨é¡¹ï¼ˆä¹ŸåŒ…æ‹¬æ­£ã€åä¸¤ä¸ªæ–¹å‘ï¼‰ï¼Œå¹¶ä¾æ®æ­£å‘Easy IP è¡¨é¡¹çš„æŸ¥æ‰¾ç»“æœå°†æŠ¥æ–‡è½¬æ¢åå‘å…¬ç½‘ä¾§å‘é€ã€‚æ­¤æ—¶ï¼Œè½¬æ¢åçš„æŠ¥æ–‡æºåœ°å€å’Œæºç«¯å£å·ç”±åŸæ¥çš„ï¼ˆ10.1.1.100:1540ï¼‰è½¬æ¢æˆäº†ï¼ˆ162.10.2.8:5480ï¼‰ã€‚<br>â‘¢ Server åœ¨æ”¶åˆ°è¯·æ±‚æŠ¥æ–‡åéœ€è¦å‘Router å‘é€å“åº”æŠ¥æ–‡ï¼ˆå³Inbound æ–¹å‘ï¼‰ï¼Œæ­¤æ—¶åªé¡»å°†æ”¶åˆ°çš„è¯·æ±‚æŠ¥æ–‡ä¸­çš„æºIP åœ°å€ã€æºç«¯å£å·å’Œç›®çš„IP åœ°å€ã€ç›®çš„ç«¯å£å·å¯¹è°ƒå³å¯ï¼Œå³æ­¤æ—¶çš„å“åº”æŠ¥æ–‡ä¸­çš„ç›®çš„IP åœ°å€ã€ç›®çš„ç«¯å£å·ä¸º162.10.2.8:5480ã€‚<br>â‘£ Router åœ¨æ”¶åˆ°å…¬ç½‘ä¾§Server çš„å›åº”æŠ¥æ–‡åï¼Œæ ¹æ®å…¶â€œç›®çš„IP åœ°å€:ç›®çš„ç«¯å£å·â€æŸ¥æ‰¾åå‘Easy IP è¡¨é¡¹ï¼Œå¹¶ä¾æ®æŸ¥æ‰¾ç»“æœå°†æŠ¥æ–‡è½¬æ¢åå‘å†…ç½‘ä¾§å‘é€ã€‚å³è½¬æ¢åçš„æŠ¥æ–‡ä¸­çš„ç›®çš„IP åœ°å€ä¸º10.1.1.100ï¼Œç›®çš„ç«¯å£å·ä¸º1540ï¼Œä¸Host A å‘é€è¯·æ±‚æŠ¥æ–‡ä¸­çš„æºIPåœ°å€å’Œæºç«¯å£å®Œå…¨ä¸€æ ·ã€‚<br>å¦‚æœç§ç½‘ä¸­çš„Host B ä¹Ÿè¦è®¿é—®å…¬ç½‘ï¼Œåˆ™å®ƒæ‰€åˆ©ç”¨çš„å…¬ç½‘IP åœ°å€ä¸Host A ä¸€æ ·ï¼Œéƒ½æ˜¯è·¯ç”±å™¨WAN å£çš„å…¬ç½‘IP åœ°å€ï¼Œä½†è½¬æ¢æ—¶æ‰€ç”¨çš„ç«¯å£å·ä¸€å®šè¦ä¸Host A è½¬æ¢æ—¶æ‰€ç”¨çš„ç«¯å£ä¸ä¸€æ ·ã€‚</p><blockquote><p>å…è®¸å¤šä¸ªç§ç½‘åœ°å€è½¬æ¢æˆä¸€ä¸ªå…¬ç½‘ IP ï¼Œå¸¸ç”¨</p></blockquote><p><img src="/img/Huawei_route/Huawei_route_base_32.jpg"></p><p>åŸºç¡€é…ç½®ï¼š</p><ol><li><p>é¦–å…ˆé…ç½® ACL åŒ¹é…å†…ç½‘ç§ç½‘åœ°å€æ®µ</p><pre><code class="hljs angelscript">[OUT]acl <span class="hljs-number">2000</span>[OUT-acl-basic<span class="hljs-number">-2000</span>]rule permit source <span class="hljs-number">192.168</span><span class="hljs-number">.1</span><span class="hljs-number">.0</span> <span class="hljs-number">0.0</span><span class="hljs-number">.0</span><span class="hljs-number">.255</span>[OUT-acl-basic<span class="hljs-number">-2000</span>]dis <span class="hljs-keyword">this</span>[V200R003C00]#acl number <span class="hljs-number">2000</span>   rule <span class="hljs-number">5</span> permit source <span class="hljs-number">192.168</span><span class="hljs-number">.1</span><span class="hljs-number">.0</span> <span class="hljs-number">0.0</span><span class="hljs-number">.0</span><span class="hljs-number">.255</span> #<span class="hljs-keyword">return</span>[OUT-acl-basic<span class="hljs-number">-2000</span>]</code></pre></li></ol><p><font color=red>æ³¨ï¼šACL ç”¨æ¥åšåŒ¹é…èŒƒå›´æ—¶ï¼Œæ²¡æœ‰é»˜è®¤éšå«å…è®¸æ‰€æœ‰çš„è§„åˆ™</font></p><ol start="2"><li><pre><code>[OUT-GigabitEthernet0/0/1]nat ?  outbound  Specify net address translation        #Easy IPï¼Œé…ç½® NAT åœ°å€æ± çš„è½¬æ¢ç­–ç•¥ï¼Œå¯ä»¥é€‰æ‹©åŒ¹é…ACLæ¨¡å¼æˆ–ä¸åŒ¹é…ACLä¸¤ç§æ¨¡å¼  server    Specify NAT server            #å¯ä»¥å°†æŸæœåŠ¡å™¨çš„æŸç«¯å£æ˜ å°„å‡ºå»ï¼ˆå®‰å…¨ï¼‰  static    Specify static NAT            #é™æ€ NATï¼Œä¸€å¯¹ä¸€ [OUT-GigabitEthernet0/0/1]nat outbound ?  INTEGER&lt;2000-3999&gt;  Apply basic or advanced ACL        #é…ç½®çš„ ACL ç¼–å·[OUT-GigabitEthernet0/0/1]nat outbound 2000 <pre><code class="hljs routeros">   åŸç†ï¼šå†…ç½‘ç§ç½‘åœ°å€å‡ºåŒ…æ—¶è½¬æ¢æˆå…¬ç½‘æ¥å£ WANï¼ˆGE 0/0/1ï¼‰å½“å‰çš„<span class="hljs-built_in"> IP </span>åœ°å€<span class="hljs-comment">### 5.3.1 NAT -- Server</span>&gt; å¯ä»¥å°†æŸæœåŠ¡å™¨çš„æŸç«¯å£æ˜ å°„å‡ºå»ï¼ˆå®‰å…¨ï¼‰é…ç½®ï¼š![](/img/Huawei_route/Huawei_route_base_34.jpg)</code></pre>[OUT-GigabitEthernet0/0/1]nat server protocol tcp global 12.1.1.3 www inside 192.168.1.254 www         #å°†æœåŠ¡å™¨çš„80ç«¯å£æ˜ å°„æˆå…¬ç½‘åœ°å€çš„80ç«¯å£[OUT-GigabitEthernet0/0/1]dis this[V200R003C00]#interface GigabitEthernet0/0/1description TO_wanip address 12.1.1.1 255.255.255.248 nat server protocol tcp global 12.1.1.3 www inside 192.168.1.254 www#return<pre><code class="hljs http"># å…­ã€å¹¿åŸŸç½‘å°è£…åè®®&gt; å¹¿åŸŸç½‘ä¸­ç»å¸¸ä¼šä½¿ç”¨ä¸²è¡Œé“¾è·¯æ¥æä¾›è¿œè·ç¦»çš„æ•°æ®ä¼ è¾“ï¼Œé«˜çº§æ•°æ®é“¾è·¯æ§åˆ¶ HDLC ï¼ˆ  High-Level Data Link Control  ï¼‰å’Œç‚¹å¯¹ç‚¹åè®® PPP ï¼ˆ  Point to Point Protocol ï¼‰æ˜¯ä¸¤ç§å…¸å‹çš„ä¸²å£å°è£…åè®®ã€‚ ## 6.1 PPPï¼ˆ  Point to Point Protocol ï¼‰&gt; PPP ï¼ˆç‚¹å¯¹ç‚¹åè®®ï¼‰åè®®æ˜¯ä¸€ç§ç‚¹åˆ°ç‚¹é“¾è·¯å±‚åè®®ï¼Œä¸»è¦ç”¨äºåœ¨å…¨åŒå·¥çš„åŒå¼‚æ­¥é“¾è·¯ä¸Šè¿›è¡Œç‚¹åˆ°ç‚¹çš„æ•°æ®ä¼ è¾“### 6.1.1 PPP é…ç½®![](/img/Huawei_route/Huawei_route_base_35.jpg)</code></pre>[R1]int Serial 4/0/0[R1-Serial4/0/0]ip add 12.1.1.1 24[R1-Serial4/0/0]dis this[V200R003C00]#interface Serial4/0/0link-protocol pppip address 12.1.1.1 255.255.255.0 #return[R1]ping 12.1.1.2PING 12.1.1.2: 56  data bytes, press CTRL_C to break Reply from 12.1.1.2: bytes=56 Sequence=1 ttl=255 time=20 ms Reply from 12.1.1.2: bytes=56 Sequence=2 ttl=255 time=30 ms</code></pre></li></ol><pre><code class="hljs awk">æŠ“åŒ…ï¼ŒPPPçš„å°è£…æ–¹å¼ï¼š![](<span class="hljs-regexp">/img/</span>Huawei_route/Huawei_route_base_36.jpg) &lt;font color=red&gt;æ³¨ï¼šPPP å¯ä»¥å¯¹é“¾è·¯åšè®¤è¯&lt;/font&gt;ï¼šPAP è®¤è¯ã€CHAP è®¤è¯<span class="hljs-comment">#### PAPè®¤è¯é…ç½®ï¼ˆå¯†ç æ˜æ–‡ä¼ è¾“ï¼Œä¸¤æ¬¡æ¡æ‰‹ï¼‰</span>![](<span class="hljs-regexp">/img/</span>Huawei_route/Huawei_route_base_37.jpg)</code></pre><p>#è®¤è¯ç«¯ï¼ˆæœåŠ¡ç«¯ï¼‰<br>[R2]aaa<br>[R2-aaa]local-user HCNP password cipher hcnp123        #åˆ›å»ºæœ¬åœ°ç”¨æˆ·åå’Œå¯†ç <br>Info: Add a new user.<br>[R2-aaa]local-user hcnp service-type ppp            #åˆ›å»ºçš„è´¦æˆ·ç”¨ä½œ ppp è®¤è¯<br>[R2]int Serial 4/0/0<br>[R2-Serial4/0/0]ppp authentication-mode pap            #è¿›å…¥æ¥å£å¼€å¯è®¤è¯</p><p>#è¢«è®¤è¯ç«¯ï¼ˆå®¢æˆ·ç«¯ï¼‰<br>[R1]int Serial 4/0/0<br>[R1-Serial4/0/0]ppp pap local-user HCNP password ?<br>  cipher  Display the current password with cipher text<br>  simple  Display the current password with plain text<br>[R1-Serial4/0/0]ppp pap local-user HCNP password simple hcnp123 #å‘é€ pap ç”¨æˆ·åå¯†ç è®¤è¯</p><pre><code class="hljs http">#### CHAP è®¤è¯é…ç½®ï¼ˆä¸‰æ¬¡æ¡æ‰‹ï¼ŒåŠ å¯†ä¼ è¾“ï¼‰![](/img/Huawei_route/Huawei_route_base_37.jpg)</code></pre><p>#è®¤è¯ç«¯ï¼ˆæœåŠ¡ç«¯ï¼‰<br>[R2-Serial4/0/0]ppp authentication-mode chap<br>[R2-Serial4/0/0]dis this<br>[V200R003C00]<br>#<br>interface Serial4/0/0<br> link-protocol ppp<br> ppp authentication-mode chap<br> ip address 12.1.1.2 255.255.255.0<br>#<br>return</p><p>#è¢«è®¤è¯ç«¯ï¼ˆå®¢æˆ·ç«¯ï¼‰<br>[R1-Serial4/0/0]ppp chap user HCNP<br>[R1-Serial4/0/0]ppp chap password simple hcnp123</p><pre><code class="hljs http">## 6.2 HDLCï¼ˆHigh-Level Data Link Control ï¼‰&gt; HDLCï¼ˆé«˜çº§æ•°æ®é“¾è·¯æ§åˆ¶ï¼‰ æ˜¯é«˜çº§æ•°æ®é“¾è·¯æ§åˆ¶åè®®ï¼Œæ˜¯ä¸€ç§æ•°æ®é“¾è·¯å±‚çš„åè®®ã€‚HDLC æ˜¯ä¸€ä¸ª ISO æ ‡å‡†çš„é¢å‘ä½çš„æ•°æ®é“¾è·¯åè®®ï¼Œå…¶åœ¨åŒæ­¥ä¸²è¡Œæ•°æ®é“¾è·¯ä¸Šå°è£…æ•°æ®ï¼Œæœ€å¸¸ç”¨äºç‚¹å¯¹ç‚¹é“¾æ¥### 6.2.1 HDLC é…ç½®![](/img/Huawei_route/Huawei_route_base_35.jpg)</code></pre><p>[R1]int s4/0/0<br>[R1-Serial4/0/0]dis this<br>[V200R003C00]<br>#<br>interface Serial4/0/0<br> link-protocol ppp                    #åä¸ºã€H3C ä¸²å£é»˜è®¤å°è£…æ–¹å¼ä¸º PPPï¼Œæ€ç§‘ä¸º HDLC<br> ip address 12.1.1.1 255.255.255.0<br>#<br>return<br>[R1-Serial4/0/0]link-protocol ?<br>  fr    Select FR as line protocol<br>  hdlc  Enable HDLC protocol<br>  lapb  LAPB(X.25 level 2 protocol)<br>  ppp   Point-to-Point protocol<br>  sdlc  SDLC(Synchronous Data Line Control) protocol<br>  x25   X.25 protocol<br>[R1-Serial4/0/0]link-protocol hdlc         #æ‰‹åŠ¨ä¿®æ”¹æˆ HDLC<br>Warning: The encapsulation protocol of the link will be changed. Continue? [Y/N]<br>:y<br>[R1-Serial4/0/0]dis this<br>[V200R003C00]<br>#<br>interface Serial4/0/0<br> link-protocol hdlc<br> ip address 12.1.1.1 255.255.255.0<br>#<br>return</p><pre><code class="hljs awk">&lt;font color=red&gt;æ³¨ï¼šä¸¤ä¸ªç›¸è¿ç«¯å£å°è£…æ–¹å¼éœ€è¦ä¸€è‡´ï¼Œä¸ç„¶æ— æ³•é€šä¿¡ï¼Œæ‰€ä»¥è·¯ç”± R2 éœ€è¦åšç›¸åŒé…ç½®ã€‚&lt;/font&gt;é€šä¿¡æŠ“åŒ…ï¼š![](<span class="hljs-regexp">/img/</span>Huawei_route/Huawei_route_base_35.jpg)<span class="hljs-comment">## 6.3 FRï¼ˆFrame-relayï¼‰</span>&gt; å¸§ä¸­ç»§<span class="hljs-comment">### 6.3.1 FR é…ç½®</span>![](<span class="hljs-regexp">/img/</span>Huawei_route/Huawei_route_base_39.jpg)</code></pre><p>[R1-Serial4/0/0]dis this<br>[V200R003C00]<br>#<br>interface Serial4/0/0<br> link-protocol fr<br> ip address 12.1.1.1 255.255.255.0<br>#<br>return</p><p>#æŸ¥çœ‹æ˜ å°„<br>[R1]dis fr map-info<br>Map Statistics for interface Serial4/0/0 (DTE)<br>  DLCI = 102, IP INARP 12.1.1.2, Serial4/0/0<br>    create time = 2020/08/07 09:25:46, status = ACTIVE<br>    encapsulation = ietf, vlink = 2, broadcast</p><pre><code class="hljs shell">æŠ“åŒ…ï¼š![](/img/Huawei_route_base_40.jpg)<span class="hljs-meta">#</span><span class="bash"> ä¸ƒã€é“¾è·¯èšåˆ</span><span class="hljs-meta">&gt;</span><span class="bash">é“¾è·¯æ†ç»‘ã€ç«¯å£èšåˆã€eth-channel</span><span class="hljs-meta">&gt;</span><span class="hljs-meta">&gt;</span><span class="bash">éšç€ç½‘ç»œè§„æ¨¡ä¸æ–­æ‰©å¤§ï¼Œç”¨æˆ·å¯¹éª¨å¹²é“¾è·¯çš„å¸¦å®½å’Œå¯é æ€§æå‡ºäº†è¶Šæ¥è¶Šé«˜çš„è¦æ±‚ã€‚åœ¨ä¼ ç»ŸæŠ€æœ¯ä¸­ï¼Œå¸¸ç”¨æ›´æ¢é«˜é€Ÿç‡çš„æ¥å£æ¿æˆ–æ›´æ¢æ”¯æŒé«˜é€Ÿç‡æ¥å£æ¿çš„è®¾å¤‡çš„æ–¹å¼æ¥å¢åŠ å¸¦å®½ï¼Œä½†è¿™ç§æ–¹æ¡ˆéœ€è¦ä»˜å‡ºé«˜é¢çš„è´¹ç”¨ï¼Œè€Œä¸”ä¸å¤Ÿçµæ´»ã€‚</span><span class="hljs-meta">&gt;</span><span class="bash">é‡‡ç”¨é“¾è·¯èšåˆæŠ€æœ¯å¯ä»¥åœ¨ä¸è¿›è¡Œç¡¬ä»¶å‡çº§çš„æ¡ä»¶ä¸‹ï¼Œé€šè¿‡å°†å¤šä¸ªç‰©ç†æ¥å£æ†ç»‘ä¸ºä¸€ä¸ªé€»è¾‘æ¥å£ï¼Œæ¥è¾¾åˆ°å¢åŠ é“¾è·¯å¸¦å®½çš„ç›®çš„ã€‚åœ¨å®ç°å¢å¤§å¸¦å®½ç›®çš„çš„åŒæ—¶ï¼Œé“¾è·¯èšåˆé‡‡ç”¨å¤‡ä»½é“¾è·¯çš„æœºåˆ¶ï¼Œå¯ä»¥æœ‰æ•ˆçš„æé«˜è®¾å¤‡ä¹‹é—´é“¾è·¯çš„å¯é æ€§ã€‚</span><span class="hljs-meta">#</span><span class="bash"><span class="hljs-comment">## é…ç½®</span></span>![](/img/Huawei_route_base_41.jpg)</code></pre><p>#ç°çŠ¶æ€<br>[SW1]dis stp brief<br> MSTID  Port                        Role  STP State     Protection<br>   0    GigabitEthernet0/0/1        ROOT  FORWARDING      NONE        #FORWARDINGï¼šè½¬å‘<br>   0    GigabitEthernet0/0/2        ALTE  DISCARDING      NONE        #DISCARDINGï¼šä¸¢å¼ƒ<br>   0    GigabitEthernet0/0/3        ALTE  DISCARDING      NONE<br>   0    GigabitEthernet0/0/4        DESI  FORWARDING      NONE</p><p>#é…ç½®é“¾è·¯èšåˆ<br>[SW1]int Eth-Trunk 1                #åˆ›å»ºé€»è¾‘æ†ç»‘æ¥å£ç»„ 1<br>[SW1-GigabitEthernet0/0/1]eth-trunk 1    #è¿›å…¥æ¥å£ï¼Œå°†æ¥å£åŠ å…¥ Eth-Trunk 1<br>[SW1-GigabitEthernet0/0/2]eth-trunk 1<br>[SW1-GigabitEthernet0/0/3]eth-trunk 1<br>#æŸ¥çœ‹é…ç½®<br>[SW1]dis eth-trunk<br>Eth-Trunk1â€™s state information is:<br>WorkingMode: NORMAL         Hash arithmetic: According to SIP-XOR-DIP<br>Least Active-linknumber: 1  Max Bandwidth-affected-linknumber: 8  #æœ€å¤šèƒ½æ†ç»‘8ä¸ªé“¾è·¯<br>Operate status: up         Number Of Up Port In Trunk: 3                     </p><hr><p>PortName                      Status      Weight<br>GigabitEthernet0/0/1          Up          1<br>GigabitEthernet0/0/2          Up          1<br>GigabitEthernet0/0/3          Up          1   </p><p>[SW1]dis stp brief<br> MSTID  Port                        Role  STP State     Protection<br>   0    GigabitEthernet0/0/4        DESI  FORWARDING      NONE<br>   0    Eth-Trunk1                  ROOT  FORWARDING      NONE<br>#äº¤æ¢æœº R2 åŒæ ·é…ç½®</p><pre><code class="hljs http"># å…«ã€VRRP&gt; Virtual Router Redundancy [rÉªËˆdÊŒndÉ™nsi] Protocolï¼Œ**è™šæ‹Ÿç½‘å…³å†—ä½™åè®®**&gt;&gt; ä¸‰å±‚ç½‘å…³å†—ä½™æŠ€æœ¯ï¼Œå¯¹ç”¨æˆ·çš„ç½‘å…³åšå†—ä½™## 8.1 é…ç½®![](/img/Huawei_route/Huawei_route_base_42.jpg)#### åŸºç¡€é…ç½®- æ ¸å¿ƒçš„ IP åœ°å€- æ¥å…¥å±‚äº¤æ¢æœºæ— éœ€é…ç½®- ç”¨æˆ·ç½‘å…³é…ç½®æˆ 192.168.10.1#### VRRP é…ç½®</code></pre><p>#æ ¸å¿ƒ1<br>[core1]int gi 0/0/0            #ä¸‹è”ç”¨æˆ·æ¥å£é…ç½®<br>[core1-GigabitEthernet0/0/0]vrrp ?<br>  arp       Gratuitous arp<br>  un-check  Uncheck VRRP packet TTL value<br>  vrid      Specify virtual router identifier<br>[core1-GigabitEthernet0/0/0]vrrp vrid ?            #æŒ‡å®šè™šæ‹Ÿè·¯ç”±å™¨æ ‡è¯†ç¬¦ï¼ˆSpecify virtual router identifierï¼‰<br>  INTEGER&lt;1-255&gt;  Virtual router identifier<br>[core1-GigabitEthernet0/0/0]vrrp vrid 1 ?<br>  authentication-mode  Specify password and authentication mode<br>  preempt-mode         Specify preempt mode<br>  priority             Specify priority<br>  timer                Specify timer<br>  track                Specify the track configuration<br>  version-3            Specify the device to support V3 for VRRP<br>  virtual-ip           Specify virtual IP address<br>#åˆ›å»ºè™šæ‹Ÿç»„1ï¼Œå¹¶æŒ‡å®šè™šæ‹Ÿ IP åœ°å€ï¼Œè¯¥è™šæ‹Ÿåœ°å€ä½œä¸ºç”¨æˆ·ç½‘å…³<br>[core1-GigabitEthernet0/0/0]vrrp vrid 1 virtual-ip 192.168.10.1<br>[core1-GigabitEthernet0/0/0]dis this<br>[V200R003C00]<br>#<br>interface GigabitEthernet0/0/0<br> ip address 192.168.10.253 255.255.255.0<br> vrrp vrid 1 virtual-ip 192.168.10.1<br>#<br>return<br>#æ ¸å¿ƒ2åŒæ ·é…ç½®<br>[core2-GigabitEthernet0/0/0]vrrp vrid 1 priority 105    #å°†ä¼˜å…ˆçº§æ”¹ä¸º105ä½œä¸ºä¸»è·¯ç”±å™¨ï¼Œä¼˜å…ˆçº§é»˜è®¤æ˜¯100ã€‚æ•°å­—è¶Šå¤§è¶Šä¼˜å…ˆ<br>[core2-GigabitEthernet0/0/0]dis this<br>[V200R003C00]<br>#<br>interface GigabitEthernet0/0/0<br> ip address 192.168.10.254 255.255.255.0<br> vrrp vrid 1 virtual-ip 192.168.10.1<br> vrrp vrid 1 priority 105<br>#<br>return<br>#æŸ¥çœ‹ VRRP çŠ¶æ€<br>[core1]dis vrrp brief<br>Total:1     Master:0     Backup:1     Non-active:0<br>VRID  State        Interface                Type     Virtual IP     </p><hr><p>1     Backup       GE0/0/0                  Normal   192.168.10.1 </p><p>[core2]dis vrrp brief<br>Total:1     Master:1     Backup:0     Non-active:0<br>VRID  State        Interface                Type     Virtual IP     </p><hr><p>1     Master       GE0/0/0                  Normal   192.168.10.1 ã€</p><p>#æŸ¥çœ‹ VRRP è¯¦ç»†ä¿¡æ¯<br>[core2]dis vrrp<br>  GigabitEthernet0/0/0 | Virtual Router 1<br>    State : Master<br>    Virtual IP : 192.168.10.1<br>    Master IP : 192.168.10.254<br>    PriorityRun : 105<br>    PriorityConfig : 105<br>    MasterPriority : 105<br>    Preempt : YES   Delay Time : 0 s<br>    TimerRun : 1 s<br>    TimerConfig : 1 s<br>    Auth type : NONE                #è®¤è¯ä¿¡æ¯<br>    Virtual MAC : 0000-5e00-0101<br>    Check TTL : YES<br>    Config type : normal-vrrp<br>    Backup-forward : disabled<br>    Create time : 2020-08-10 12:19:35 UTC-08:00<br>    Last change time : 2020-08-10 12:24:04 UTC-08:00</p><p>#é…ç½®å¦‚ä¸Šè”æ¥å£æ–­å¼€ï¼Œé™ä½ master ä¼˜å…ˆçº§<br>##é…ç½®è·Ÿè¸ªä¸Šè”æ¥å£ GE 0/0/1 çŠ¶æ€ï¼Œå½“å‘ç° GE 0/0/1 å£ down æ—¶ï¼Œå°†è‡ªåŠ¨é™ä½æ­¤è·¯ç”±çš„ä¼˜å…ˆçº§-10ï¼Œä»¥è®©å‡º master çš„ä½ç½®<br>[core2-GigabitEthernet0/0/0]vrrp vrid 1 track interface  GigabitEthernet 0/0/1<br>[core2-GigabitEthernet0/0/0]dis this<br>[V200R003C00]<br>#<br>interface GigabitEthernet0/0/0<br> ip address 192.168.10.254 255.255.255.0<br> vrrp vrid 1 virtual-ip 192.168.10.1<br> vrrp vrid 1 priority 105<br> vrrp vrid 1 trackï¼ˆè·Ÿè¸ªï¼‰ interface GigabitEthernet0/0/1<br>#<br>return<br>[core2]dis vrrp<br>  GigabitEthernet0/0/0 | Virtual Router 1<br>    State : Backup<br>    Virtual IP : 192.168.10.1<br>    Master IP : 192.168.10.253<br>    PriorityRun : 95        &lt;â€”é™ä½åçš„ä¼˜å…ˆçº§<br>    PriorityConfig : 105<br>    MasterPriority : 100<br>    Preempt : YES   Delay Time : 0 s<br>    TimerRun : 1 s<br>    TimerConfig : 1 s<br>    Auth type : NONE<br>    Virtual MAC : 0000-5e00-0101<br>    Check TTL : YES<br>    Config type : normal-vrrp<br>    Backup-forward : disabled<br>    Track IF : GigabitEthernet0/0/1   Priority reduced : 10    &lt;â€”é™ä½ä¼˜å…ˆçº§10<br>    IF state : DOWN        &lt;â€”ä¸Šè”ç«¯å£æ–­å¼€<br>    Create time : 2020-08-10 12:19:35 UTC-08:00<br>    Last change time : 2020-08-10 13:17:30 UTC-08:00</p><p>#å¼€å¯ç®€å•çš„å¯†ç è®¤è¯ï¼Œä¸¤ä¸ªæ ¸å¿ƒéƒ½éœ€è¦é…ç½®ï¼ˆå¯é€‰é…ç½®ï¼‰<br>[core2-GigabitEthernet0/0/0]vrrp vrid 1 authentication-mode simple plain 123  #é…ç½®ç®€å•æ˜æ–‡å¯†ç 123</p><pre><code class="hljs routeros"><span class="hljs-comment">#### å·¥ä½œåŸç†</span>æŠ“å–æ ¸å¿ƒ1 GE 0/0/0 å£æŠ¥æ–‡![](/img/Huawei_route/Huawei_route_base_43.jpg)æ ¸å¿ƒè·¯ç”±å™¨ä¼šæ¯éš”ä¸€æ®µæ—¶é—´ï¼ˆçº¦1Sï¼‰å‘é€ä¸€ä¸ªç‰¹å®šçš„<span class="hljs-built_in"> VRRP </span>æŠ¥æ–‡ã€‚å¦‚æœä¸€æ®µæ—¶é—´æ²¡æœ‰æ”¶åˆ°å¯¹æ–¹å‘æ¥çš„<span class="hljs-built_in"> VRRP </span>æŠ¥æ–‡ï¼Œå°±è®¤å®šå¯¹æ–¹ master è®¾å¤‡å‡ºç°æ•…éšœã€‚æ­¤æ—¶ backup ä¼šæ€»åŠ¨åˆ‡æ¢æˆ master<span class="hljs-comment"># ä¹ã€STP ï¼ˆSpanning Tree Protocolï¼‰</span>&gt;ä¸ºäº†æé«˜ç½‘ç»œå¯é æ€§ï¼Œäº¤æ¢ç½‘ç»œä¸­é€šå¸¸ä¼šä½¿ç”¨å†—ä½™é“¾è·¯ã€‚ç„¶è€Œï¼Œå†—ä½™é“¾è·¯ä¼šç»™äº¤æ¢ç½‘ç»œå¸¦æ¥ç¯è·¯é£é™©ï¼Œå¹¶å¯¼è‡´å¹¿æ’­é£æš´ä»¥åŠ MAC åœ°å€è¡¨ä¸ç¨³å®šç­‰é—®é¢˜ï¼Œè¿›è€Œä¼šå½±å“åˆ°ç”¨æˆ·çš„é€šä¿¡è´¨é‡ã€‚ç”Ÿæˆæ ‘åè®® STP å¯ä»¥åœ¨æé«˜å¯é æ€§çš„åŒæ—¶åˆèƒ½é¿å…ç¯è·¯å¸¦æ¥çš„å„ç§é—®é¢˜ã€‚&lt;font <span class="hljs-attribute">color</span>=red&gt;**ä½œç”¨ï¼šé˜²æ­¢äº¤æ¢ç¯è·¯**&lt;/font&gt;![](/img/Huawei_route/Huawei_route_base_44.jpg)åä¸ºäº¤æ¢æœºé»˜è®¤å¼€æœºå¯åŠ¨ STP<span class="hljs-comment">## 9.1 å®éªŒ</span>å°†äº¤æ¢æœº STP å…³é—­ï¼ŒæŠ“åŒ…ï¼š![](/img/Huawei_route/Huawei_route_base_44.jpg)</code></pre><p>[SW1]stp disable </p><pre><code class="hljs clean">PC ping ip <span class="hljs-number">1.1</span><span class="hljs-number">.1</span><span class="hljs-number">.255</span> ï¼Œä¸ºå¹¿æ’­åœ°å€ï¼Œå…¶ç›®æ ‡ MAC åœ°å€ä¸º ff:ff:ff:ff:ff:ffï¼ˆäº¤æ¢æœºé  MAC è½¬å‘ï¼‰![](/img/Huawei_route/Huawei_route_base_45.jpg)### <span class="hljs-number">9.1</span><span class="hljs-number">.1</span> å¼•å‘å„ç§é—®é¢˜#### å¹¿æ’­é£æš´![](/img/Huawei_route/Huawei_route_base_46.jpg)#### MAC åœ°å€è¡¨éœ‡è¡![](/imgHuawei_route<span class="hljs-comment">//Huawei_route_base_47.jpg)</span>## <span class="hljs-number">9.2</span> å·¥ä½œåŸç†STPé€šè¿‡é˜»å¡ç«¯å£æ¥æ¶ˆé™¤ç¯è·¯ï¼Œå¹¶èƒ½å¤Ÿå®ç°é“¾è·¯å¤‡ä»½çš„ç›®çš„ã€‚æŸ¥çœ‹é˜»å¡ç«¯å£ï¼š</code></pre><p>[SW1]dis stp brief<br> MSTID  Port                        Role  STP State     Protection<br>   0    GigabitEthernet0/0/1        DESI  DISCARDING      NONE<br>   0    GigabitEthernet0/0/2        DESI  DISCARDING      NONE<br>   0    GigabitEthernet0/0/3        ROOT  FORWARDING      NONE</p><pre><code class="hljs angelscript">## <span class="hljs-number">9.3</span> STP ç®—æ³•å…ˆé€‰å‡ºä¸è¢«é˜»å¡çš„æ¥å£ï¼Œå‰©ä¸‹çš„æ¥å£éƒ½ä¼šè¢«é˜»å¡ã€‚### <span class="hljs-number">9.3</span><span class="hljs-number">.1</span> è¿‡ç¨‹<span class="hljs-number">1.</span> æ•´ä¸ªç½‘ç»œï¼ˆå¹¿æ’­åŸŸï¼‰å…ˆé€‰å‡ºæ ¹æ¡¥ï¼ˆæ ¹äº¤æ¢æœºï¼‰ï¼Œå…ˆæ¯”è¾ƒä¼˜å…ˆçº§ï¼ˆé»˜è®¤<span class="hljs-number">32768</span>ï¼‰ï¼Œå†æ¯”è¾ƒ MAC åœ°å€ï¼Œè¶Šå°è¶Šä¼˜å…ˆã€‚æ ¹æ¡¥ä¸Šé¢çš„ç«¯å£éƒ½æ˜¯**æŒ‡å®šç«¯å£**![](/img/Huawei_route/Huawei_route_base_48.jpg)æ˜¾ç¤ºï¼š</code></pre><p><SW1>dis stp<br>â€”â€”-[CIST Global Info][Mode MSTP]â€”â€”-<br>CIST Bridge         :32768.4c1f-cc6b-2dc9     #æ¡¥IDï¼ˆä¼˜å…ˆçº§+MACï¼‰<br>Config Times        :Hello 2s MaxAge 20s FwDly 15s MaxHop 20<br>Active Times        :Hello 2s MaxAge 20s FwDly 15s MaxHop 20<br>CIST Root/ERPC      :32768.4c1f-cc5f-2395 / 20000   #æ˜¾ç¤ºæ ¹æ¡¥ä¿¡æ¯<br>CIST RegRoot/IRPC   :32768.4c1f-cc6b-2dc9 / 0<br>CIST RootPortId     :128.3<br>BPDU-Protection     :Disabled<br>TC or TCN received  :5<br>TC count per hello  :0<br>STP Converge Mode   :Normal<br>Time since last TC  :0 days 0h:17m:53s<br>Number of TC        :6<br>Last TC occurred    :GigabitEthernet0/0/1<br>â€”-[Port1(GigabitEthernet0/0/1)][FORWARDING]â€”-<br> Port Protocol       :Enabled<br> Port Role           :Designated Port<br> Port Priority       :128<br> Port Cost(Dot1T )   :Config=auto / Active=20000<br> Designated Bridge/Port   :32768.4c1f-cc6b-2dc9 / 128.1<br> Port Edged          :Config=default / Active=disabled<br> Point-to-point      :Config=auto / Active=true<br> Transit Limit       :147 packets/hello-time<br> Protection Type     :None<br>  â€”- More â€”-</p><pre><code class="hljs">2. éæ ¹æ¡¥ä¸Šé¢é€‰ä¸¾æ ¹ç«¯å£ï¼ˆæ ¹ç«¯å£æœ‰ä¸”ä»…æœ‰ä¸€ä¸ªï¼‰åˆ°è¾¾æ ¹æ¡¥æœ€è¿‘çš„ç«¯å£å½“é€‰ä¸ºæ ¹ç«¯å£éæ ¹äº¤æ¢æœºåœ¨é€‰ä¸¾æ ¹ç«¯å£æ—¶åˆ†åˆ«ä¾æ®è¯¥ç«¯å£çš„æ ¹è·¯åŠ²å¼€é”€ã€å¯¹ç«¯BIDï¼ˆæ¡¥IDï¼‰ã€å¯¹ç«¯ PID å’Œæœ¬ç«¯ PID![](/img/Huawei_route_base_49.jpg)3. æ¯æ®µé“¾è·¯å¿…é¡»é€‰ä¸¾ä¸€ä¸ªæŒ‡å®šç«¯å£ï¼ˆä¸”åªæœ‰ä¸€ä¸ªï¼‰ï¼Œæ¡¥ ID ï¼ˆä¼˜å…ˆçº§+MACï¼‰è¾ƒå°çš„äº¤æ¢æœºä¸Šé¢çš„ç«¯å£å½“é€‰ä¸ºæŒ‡å®šç«¯å£![](/img/Huawei_route_base_50.jpg)4. å‰©ä¸‹çš„ç«¯å£å…¨éƒ¨è¢«é˜»å¡![](/img/Huawei_route_base_51.jpg)æŸ¥çœ‹çŠ¶æ€ï¼š</code></pre><p><SW2>dis stp brief<br> MSTID  Port                        Role  STP State     Protection<br>   0    GigabitEthernet0/0/1        ALTE  DISCARDING      NONE    #é˜»å¡<br>   0    GigabitEthernet0/0/2        ROOT  FORWARDING      NONE</p><pre><code class="hljs">## 9.4 æ›´æ”¹äº¤æ¢æœºçš„ä¼˜å…ˆçº§</code></pre><p>[SW2]stp priority ?<br>  INTEGER&lt;0-61440&gt;  Bridge priority, in steps of 4096   #éœ€è¦4096çš„å€æ•°</p><p>[SW2]stp priority 0   #å°†ä¼˜å…ˆçº§æ”¹ä¸º0<br>#æˆ–è€…ç›´æ¥è®¾ç½®ä¸ºæ ¹æ¡¥<br>[SW2]stp root ?<br>  primary    Primary root switch    #è®¾ç½®ä¸ºæ ¹æ¡¥<br>  secondary  Secondary root switch  #è®¾å¤‡å¤‡ä»½æ ¹æ¡¥</p><pre><code class="hljs elixir">![](<span class="hljs-regexp">/img/</span>Huawei_route/Huawei_route_base_51.jpg)----------------&gt;![](<span class="hljs-regexp">/img/</span>Huawei_route/Huawei_route_base_52.jpg)<span class="hljs-comment">## 9.5 BPDU æŠ¥æ–‡</span>BPDU åŒ…å«æ¡¥ IDã€è·¯å¾„å¼€é”€ã€ç«¯å£ IDã€è®¡æ•°å™¨ç­‰å‚æ•°![](<span class="hljs-regexp">/img/</span>Huawei_route/Huawei_route_base_53.jpg)<span class="hljs-comment">## 9.6 ç«¯å£é‡å¯è¿‡ç¨‹</span>down ---&gt; listening ---&gt; learning ---&gt; forwardingæ­¤è¿‡ç¨‹å¤§æ¦‚ <span class="hljs-number">30</span>slisteningï¼šç›‘å¬ç«¯å£learningï¼šæ£€æµ‹è¯¥ç«¯å£æ˜¯å¦éœ€è¦é˜»å¡ï¼Œå¦‚è¦é˜»å¡ï¼Œåˆ™é˜»å¡ç«¯å£ï¼Œé˜²æ­¢ç¯è·¯è®¾ç½®è¾¹ç¼˜ç«¯å£ï¼šå»ºè®®å°†æ¥ PC çš„æ¥å£é…ç½®ä¸ºè¾¹ç¼˜ç«¯å£ï¼ˆå‡å°‘æ¥å£çš„æ”¶æ•›æ—¶é—´ï¼‰</code></pre><p>[SW1-GigabitEthernet0/0/1]stp edged-port enable</p><pre><code class="hljs dts"><span class="hljs-meta">## 9.7 STP æ ¹ä¿æŠ¤</span>ä¸€æ—¦ä½¿èƒ½æ ¹ä¿æŠ¤åŠŸèƒ½çš„æŒ‡å®šç«¯å£æ”¶åˆ°ä¼˜å…ˆçº§æ›´ä½çš„ BPUD æ—¶ï¼Œç«¯å£çŠ¶æ€å°†è¿›å…¥ Discarding çŠ¶æ€ï¼Œä¸å†è½¬å‘æŠ¥æ–‡ã€‚ç»è¿‡ä¸€æ®µæ—¶é—´ï¼ˆé€šå¸¸ä¸ºä¸¤å€çš„ Forward Delayï¼‰,å¦‚æœç«¯å£ä¸€ç›´æ²¡æœ‰å†æ”¶åˆ°ä¼˜å…ˆçº§è¾ƒé«˜ï¼ˆæ•°å€¼ä½ï¼‰çš„ BPUDï¼Œç«¯å£ä¼šè‡ªåŠ¨æ¢å¤åˆ°æ­£å¸¸çš„ Forwarding çŠ¶æ€ã€‚<span class="hljs-params">&lt;font color=red&gt;</span>æ³¨ï¼šè¯¥æŒ‡ä»¤åªèƒ½åœ¨æŒ‡å®šç«¯å£é…ç½®æ‰ä¼šç”Ÿæ•ˆ<span class="hljs-params">&lt;/font&gt;</span>![](<span class="hljs-meta-keyword">/img/</span>Huawei_route/Huawei_route_base_54.jpg)åœ¨æ ¹æ¡¥ä¸Šçš„ä¸¤ä¸ªç«¯å£è®¾ç½®æ ¹ä¿æŠ¤ï¼Œåœ¨ SW1 ä¸Šæ¥ä¸ªä¼˜å…ˆçº§ä¸º <span class="hljs-number">0</span> çš„äº¤æ¢æœº</code></pre><p>[SW2-GigabitEthernet0/0/1]stp root-protection<br>[SW2-GigabitEthernet0/0/2]stp root-protection<br>#æ¥ä¸Šä¼˜å…ˆçº§ä¸º0çš„äº¤æ¢æœºï¼Œå‘ç°æ ¹æ¡¥è®¾ç½®æ ¹ä¿æŠ¤çš„ç«¯å£ä¸ºé˜»å¡çŠ¶æ€<br>[SW2]dis stp brief<br> MSTID  Port                        Role  STP State     Protection<br>   0    GigabitEthernet0/0/1        DESI  DISCARDING      ROOT<br>   0    GigabitEthernet0/0/2        DESI  DISCARDING      ROOT</p><pre><code class="hljs dts"><span class="hljs-meta">## 9.8 STP BPDU é˜²æŠ¤</span>ä½œç”¨ï¼šä¿æŠ¤æ ¹æ¡¥ï¼ˆå…¨å±€ï¼‰ï¼Œå¼€å¯ BPDU ä¿æŠ¤åï¼Œå¦‚æœä»<span class="hljs-params">&lt;font color=red&gt;</span>è¾¹ç¼˜ç«¯å£<span class="hljs-params">&lt;/font&gt;</span>æ”¶åˆ° STP æŠ¥æ–‡ï¼Œäº¤æ¢æœºä¼šè‡ªåŠ¨å°†è¯¥æ¥å£ shutdownï¼Œä»è€Œç¡®ä¿æ ¹æ¡¥ä¸ä¼šè¢«æŠ¢å ï¼ŒåŒæ—¶ç¡®ä¿ä¸ä¼šå‡ºç°ç¯è·¯ã€‚![](<span class="hljs-meta-keyword">/img/</span>Huawei_route/Huawei_route_base_54.jpg)</code></pre><p>#é¦–å…ˆåœ¨ SW1 ä¸Šçš„ GE 0/0/1 å£é…ç½®è¾¹ç¼˜æ¥å£<br>[SW1-GigabitEthernet0/0/1]stp edged-port enable<br>åœ¨äº¤æ¢æœº SW1 ä¸Šé…ç½® STP BPUD é˜²æŠ¤<br>[SW1]stp bpdu-protection<br>#30S åè‡ªåŠ¨ up ï¼Œè‡ªåŠ¨æ¢å¤æœºåˆ¶<br>[SW1]error-down auto-recovery cause bpdu-protection interval 30</p><pre><code class="hljs clean">## <span class="hljs-number">9.9</span> RSTPRapaid STP  å¿«é€Ÿçš„ç”Ÿæˆæ ‘åè®®ï¼ŒSTP å‡çº§ç‰ˆè®¾ç½®:</code></pre><p>[SW2]stp mode rstp    #å°† STP æ¨¡å¼åˆ‡æ¢ä¸º RSTP</p><pre><code class="hljs http"># åã€IPV6&gt;Internal protocol version 6ipv4 32bit åœ°å€ä¸ªæ•°ä¸º 2^32ipv6 128bit åœ°å€ä¸ªæ•°ä¸º 2^128ipv6 å®ä¾‹ï¼š**2001:0DB8:0000:0000:0000:0000:0346:8D58**ipv6 ç”±8ä¸ªå­—æ®µç»„æˆï¼Œæ¯ä¸ªå­—æ®µå 16ä¸ª bitä¸Šé¢åœ°å€ç®€å†™ï¼š2001:DB8:0:0:0:0:346:8D58 ---&gt; 2001:DB8::346:8D58## 10.1 ç‰¹æ®Š ipv6 åœ°å€1. ::1 æœ¬åœ°ç¯å›åœ°å€2. :: ç›¸å½“äº ipv4 0.0.0.03. FF å¼€å¤´ ç»„æ’­ v6 åœ°å€ ä¾‹å¦‚ï¼šFF::5 ç±»ä¼¼äº224.0.0.5## 10.2 ipv6 é™æ€è·¯ç”±é…ç½®![](/img/Huawei_route/Huawei_route_base_56.jpg)</code></pre><p>[R1]ipv6      #å…¨å±€ä½¿èƒ½ ipv6 åŠŸèƒ½<br>[R1-GigabitEthernet0/0/1]ipv6 enable<br>[R1-GigabitEthernet0/0/1]ipv6 address 12::1 ?<br>  INTEGER&lt;1-128&gt;  IPv6 prefix length &lt;1-128&gt;<br>  link-local      Use link-local address<br>[R1-GigabitEthernet0/0/1]ipv6 address 12::1 64  #è®¾ç½® ipv6 åœ°å€å’Œå‰ç¼€é•¿åº¦64<br>#æŸ¥çœ‹è·¯ç”±å™¨æ¥å£ä¿¡æ¯<br>[R1]dis ipv6 int brief<br>*down: administratively down<br>(l): loopback<br>(s): spoofing<br>Interface                    Physical              Protocol<br>GigabitEthernet0/0/0         up                    up<br>[IPv6 Address] 2001::1<br>GigabitEthernet0/0/1         up                    up<br>[IPv6 Address] 12::1<br>#æŸ¥çœ‹è·¯ç”±è¡¨<br>[R1]dis ipv6 routing-table<br>#é…ç½®é™æ€è·¯ç”±<br>[R1]ipv6 route-static 2002:: 64 12::2<br>#åœ¨ R2 é…ç½®ç¼ºçœè·¯ç”±<br>[R2]ipv6 route-static :: 0 12::1<br>#æŸ¥çœ‹ R1 è·¯ç”±è¡¨<br>[R1]dis ipv6 routing-table<br>Routing Table : Public<br>    Destinations : 7    Routes : 7</p><p> Destination  : ::1                             PrefixLength : 128<br> NextHop      : ::1                             Preference   : 0<br> Cost         : 0                               Protocol     : Direct<br> RelayNextHop : ::                              TunnelID     : 0x0<br> Interface    : InLoopBack0                     Flags        : D</p><p> Destination  : 2002::                          PrefixLength : 64<br> NextHop      : 12::2                           Preference   : 60<br> Cost         : 0                               Protocol     : Static<br> RelayNextHop : ::                              TunnelID     : 0x0<br> Interface    : GigabitEthernet0/0/1            Flags        : RD</p><pre><code>ipv6 æŠ¥æ–‡ï¼š![](/img/Huawei_route/Huawei_route_base_54.jpg)## 10.3 IPV6 åœ°å€åˆ†ç±»#### å•æ’­#### ç»„æ’­#### ä»»æ„æ’­ï¼ˆå–æ¶ˆå¹¿æ’­æ¦‚å¿µï¼‰ipv6 æ— çŠ¶æ€è‡ªåŠ¨é…ç½®ï¼šPC ä¼šé€šè¿‡å‘é€ç‰¹å®šç±»å‹çš„ icmp æŠ¥æ–‡è¯·æ±‚è·¯ç”±å™¨æ¥å£å‰ç¼€ï¼Œç»“åˆè‡ªå·±çš„ MAC åœ°å€è‡ªåŠ¨ç”Ÿæˆå…¨çƒç‹¬ä¸€æ— äºŒçš„ ipv6 åœ°å€ipv6 ä¸­ä»¥ FE80:: å¼€å¤´çš„åœ°å€éƒ½å±äºæœ¬åœ°é“¾è·¯åœ°å€ï¼ˆLink-localï¼‰ï¼Œåªæœ‰åœ¨æœ¬åœ°é“¾è·¯æœ‰æ•ˆã€‚å¯ç”¨äº† ipv6 åŠŸèƒ½çš„æ¥å£éƒ½ä¼šè‡ªåŠ¨ç”Ÿæˆç›¸åº”çš„ Link-local åœ°å€ã€‚</code></pre>]]></content>
    
    
    <categories>
      
      <category>ç½‘ç»œ</category>
      
    </categories>
    
    
    <tags>
      
      <tag>HCNA</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>TCP UDP çš„åŒºåˆ«</title>
    <link href="/2020/07/24/tcp_udp/"/>
    <url>/2020/07/24/tcp_udp/</url>
    
    <content type="html"><![CDATA[<h1 id="TCP"><a href="#TCP" class="headerlink" title="TCP"></a>TCP</h1><p>å¯é ä¼ è¾“ã€é¢å‘è¿æ¥ï¼šé€Ÿåº¦æ…¢ï¼Œä½†æ˜¯å‡†ç¡®æ€§é«˜ </p><h2 id="å¯é ä¼ è¾“"><a href="#å¯é ä¼ è¾“" class="headerlink" title="å¯é ä¼ è¾“"></a>å¯é ä¼ è¾“</h2><p>å®¢æˆ·ç«¯æ”¶åˆ°æŠ¥æ–‡åï¼Œéœ€è¦å‘é€ TCP çš„ ACK ç¡®è®¤åŒ…ï¼Œå¹¶å‘Šè¯‰æœåŠ¡ç«¯æ¥ä¸‹æ¥è¦æ”¶åˆ°çš„æŠ¥æ–‡çš„åºå·ã€‚åŒæ—¶è¯¥è¿‡ç¨‹ç¡®å®šäº†ä¸¤è€…ä¼ è¾“çš„ â€œWindows çª—å£â€å¤§å°ã€‚</p><h2 id="é¢å‘è¿æ¥"><a href="#é¢å‘è¿æ¥" class="headerlink" title="é¢å‘è¿æ¥"></a>é¢å‘è¿æ¥</h2><p>å¦‚æœæŸåº”ç”¨å±‚åè®®çš„å››å±‚ä½¿ç”¨ TCP ç«¯å£ï¼Œé‚£ä¹ˆåœ¨æ­£å¼çš„æ•°æ®æŠ¥æ–‡ä¼ è¾“ä¹‹å‰ï¼Œéœ€è¦å…ˆå»ºç«‹å®Œè¿æ¥åæ‰å¯ä»¥ä¼ è¾“æ•°æ®ã€‚</p><p>å»ºç«‹è¿æ¥ï¼š<font color=red>ä¸‰æ¬¡æ¡æ‰‹</font>â€”é¢å‘è¿æ¥çš„é«˜å±‚åè®®åœ¨æ­£å¼ä¼ è¾“æ•°æ®ä¹‹å‰éœ€è¦å…ˆå»ºç«‹è¿æ¥ï¼Œå»ºç«‹è¿æ¥çš„è¿‡ç¨‹éœ€è¦æ¥å›äº¤äº’ä¸‰ä¸ªæŠ¥æ–‡ï¼ˆ[SYN]-[SYN,ACK]-[ACK]ï¼‰</p><p><img src="/img/tcp_udp/tcp_udp_4.jpg"> </p><p>â‘ æ¬¡æ¡æ‰‹ å®¢æˆ·ç«¯â€“SYNâ€“&gt;æœåŠ¡å™¨</p><p><img src="/img/tcp_udp/tcp_udp_1.jpg"> </p><p>â‘¡æ¬¡æ¡æ‰‹ æœåŠ¡å™¨â€“SYN+ACKâ€“&gt;å®¢æˆ·ç«¯</p><p><img src="/img/tcp_udp/tcp_udp_2.jpg"> </p><p>â‘¢æ¬¡æ¡æ‰‹ å®¢æˆ·ç«¯â€“ACKâ€“&gt;æœåŠ¡å™¨</p><p><img src="/img/tcp_udp/tcp_udp_3.jpg"> </p><h1 id="UDP"><a href="#UDP" class="headerlink" title="UDP"></a>UDP</h1><p>ä¸å¯é ä¼ è¾“ï¼Œéé¢å‘è¿æ¥ï¼šé€Ÿåº¦å¿«ï¼Œä½†å‡†ç¡®æ€§å·®</p><h1 id="Wireshark-è¿‡æ»¤è§„åˆ™"><a href="#Wireshark-è¿‡æ»¤è§„åˆ™" class="headerlink" title="Wireshark è¿‡æ»¤è§„åˆ™"></a>Wireshark è¿‡æ»¤è§„åˆ™</h1><p>ip.addr == 59.36.202.3 è¿‡æ»¤å‡ºåŒ…å« 59.36.202.3 çš„æŠ¥æ–‡</p><p>ip.src == x.x.x.x æºåœ°å€</p><p>ip.dst == x.x.x.x ç›®æ ‡</p><p>tcp.dstport == 80 è¿‡æ»¤å‡ºç›®æ ‡ç«¯å£ä¸º 80 ç«¯å£</p><p>tcp.srcport == 80 è¿‡æ»¤å‡ºæºç«¯å£ä¸º 80 ç«¯å£</p><p>eth.dst == 48:89:e7:ae:71:53 è¿‡æ»¤å‡ºç›®æ ‡ MAC åœ°å€</p><p>eth.src == 48:89:e7:ae:71:53 è¿‡æ»¤å‡ºæº MAC åœ°å€</p><p>http è¿‡æ»¤é«˜å±‚åè®®</p><p>and or not åŒæ—¶è¿‡æ»¤â€“&gt; tcp or http and (not xxx)</p><h1 id="å¸¸ç”¨åè®®ç«¯å£å·"><a href="#å¸¸ç”¨åè®®ç«¯å£å·" class="headerlink" title="å¸¸ç”¨åè®®ç«¯å£å·"></a>å¸¸ç”¨åè®®ç«¯å£å·</h1><p>HTTP : tcp 80 ç½‘é¡µæµè§ˆ</p><p>telnet : tcp 23 è¿œç¨‹æ§åˆ¶</p><p>FTP : tcp 20 21 æ–‡ä»¶ä¼ è¾“</p><p>RDP : tcp 3389 è¿œç¨‹æ¡Œé¢</p><h1 id="ç”¨-telnet-æµ‹è¯•æŸä¸ªç«¯å£æ˜¯å¦å¼€æ”¾"><a href="#ç”¨-telnet-æµ‹è¯•æŸä¸ªç«¯å£æ˜¯å¦å¼€æ”¾" class="headerlink" title="ç”¨ telnet æµ‹è¯•æŸä¸ªç«¯å£æ˜¯å¦å¼€æ”¾"></a>ç”¨ telnet æµ‹è¯•æŸä¸ªç«¯å£æ˜¯å¦å¼€æ”¾</h1><p>æœªæ‰“å¼€ï¼š</p><pre><code class="hljs routeros">[root@localhost ~]# telnet 192.168.2.89 3389Trying 192.168.2.89<span class="hljs-built_in">..</span>.telnet: connect <span class="hljs-keyword">to</span><span class="hljs-built_in"> address </span>192.168.2.89: <span class="hljs-literal">No</span><span class="hljs-built_in"> route </span><span class="hljs-keyword">to</span> host</code></pre><p>æ‰“å¼€çŠ¶æ€ï¼š</p><pre><code class="hljs angelscript">[<span class="hljs-symbol">root@</span>localhost ~]# telnet <span class="hljs-number">192.168</span><span class="hljs-number">.2</span><span class="hljs-number">.98</span> <span class="hljs-number">3389</span>Trying <span class="hljs-number">192.168</span><span class="hljs-number">.2</span><span class="hljs-number">.98</span>...</code></pre>]]></content>
    
    
    <categories>
      
      <category>ç½‘ç»œ</category>
      
    </categories>
    
    
    <tags>
      
      <tag>ç½‘ç»œ</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>IP å­ç½‘åˆ’åˆ†</title>
    <link href="/2020/07/22/ip_netmask/"/>
    <url>/2020/07/22/ip_netmask/</url>
    
    <content type="html"><![CDATA[<h2 id="IPåœ°å€ï¼ˆInternet-Protocolï¼‰"><a href="#IPåœ°å€ï¼ˆInternet-Protocolï¼‰" class="headerlink" title="IPåœ°å€ï¼ˆInternet Protocolï¼‰"></a>IPåœ°å€ï¼ˆInternet Protocolï¼‰</h2><p>åœ¨äº’è”ç½‘æ¼«æ¸¸çš„è®¡ç®—æœºçš„èº«ä»½IDã€‚å”¯ä¸€æ ‡è¯†ä¸€å°ç½‘ç»œè®¾å¤‡çš„èº«ä»½IDã€‚</p><p>IP åœ°å€ä¸ºï¼šç½‘ç»œä½ + ä¸»æœºä½ -&gt; å­ç½‘æ©ç ä¸‹è¯¦è§£</p><p>IPV4åœ°å€ï¼šç‚¹åˆ†åè¿›åˆ¶ 32bit</p><p>192.168.1.1-&gt;11000000.10101000.00000001.00000001</p><table><thead><tr><th align="center">1</th><th>1</th><th>1</th><th>1</th><th>1</th><th>1</th><th>1</th><th>1</th></tr></thead><tbody><tr><td align="center">2<sup>7</sup>=128</td><td>2<sup>6</sup>=64</td><td>2<sup>5</sup>=32</td><td>2<sup>4</sup>=16</td><td>2<sup>3</sup>=8</td><td>2<sup>2</sup>=4</td><td>2<sup>1</sup>=2</td><td>2<sup>0</sup>=1</td></tr><tr><td align="center">128</td><td>192</td><td>224</td><td>240</td><td>248</td><td>252</td><td>254</td><td>255</td></tr></tbody></table><a id="more"></a><h2 id="å­ç½‘æ©ç ï¼ˆNetmaskï¼‰"><a href="#å­ç½‘æ©ç ï¼ˆNetmaskï¼‰" class="headerlink" title="å­ç½‘æ©ç ï¼ˆNetmaskï¼‰"></a>å­ç½‘æ©ç ï¼ˆNetmaskï¼‰</h2><p>å­ç½‘æ©ç æ˜¯ä¸€ä¸ª32ä½åœ°å€ï¼Œç”¨äºå±è”½IPåœ°å€çš„ä¸€éƒ¨åˆ†ä»¥åŒºåˆ«ç½‘ç»œæ ‡è¯†å’Œä¸»æœºæ ‡è¯†ï¼Œå¹¶è¯´æ˜è¯¥IPåœ°å€æ˜¯åœ¨å±€åŸŸç½‘ä¸Šï¼Œè¿˜æ˜¯åœ¨å¹¿åŸŸç½‘ä¸Šã€‚</p><p><strong>ä¾‹å­ï¼š</strong>  </p><p>ipï¼š192.168.1.1</p><p>äºŒè¿›åˆ¶ï¼š11000000.10101000.00000001.00000001</p><p>netmaskï¼š255.255.255.0</p><p>äºŒè¿›åˆ¶ï¼š<font color=green > 11111111.11111111.11111111</font>.<font color=blue > 00000000</font></p><p>æ ¹æ®äºŒè¿›åˆ¶å­ç½‘æ©ç ï¼Œç»¿è‰²ä¸ºç½‘ç»œä½ï¼Œè“è‰²ä¸ºä¸»æœºä½ï¼Œå³ï¼š</p><p>ç½‘ç»œä½ï¼šå­ç½‘æ©ç 1 bit å¯¹åº”çš„ä½</p><p>ä¸»æœºä½ï¼šå­ç½‘æ©ç 0 bit å¯¹åº”çš„ä½</p><p>ç½‘ç»œä½ä¸ºï¼š192.168.1-&gt;11000000.10101000.00000001</p><p>ä¸»æœºä½ï¼š00000001</p><p>ä¸»æœºä½å…¨0ï¼šå­ç½‘åœ°å€</p><p>ä¸»æœºä½å…¨1ï¼šå­ç½‘å¹¿æ’­åœ°å€</p><p><font color=red >æ³¨ï¼šä¸»æœºä½å…¨ 0 å…¨1 çš„ ip åœ°å€å’Œæ©ç çš„ç»„åˆæ˜¯æ— æ•ˆçš„ã€‚</font></p><p><strong>ä¾‹å­ï¼š</strong></p><p>192.168.1.127 255.255.255.128</p><p>192.168.1.0â€”1111111</p><p>255.255.255.1â€”0000000</p><h2 id="ç½‘æ®µ"><a href="#ç½‘æ®µ" class="headerlink" title="ç½‘æ®µ"></a>ç½‘æ®µ</h2><p>å…·æœ‰<font color=red >ç›¸åŒç½‘ç»œä½</font>çš„ipå’Œæ©ç çš„ç»„åˆç§°ä¸ºåŒä¸€ä¸ªç½‘æ®µï¼ˆå±€åŸŸç½‘ã€å­ç½‘ï¼‰</p><p><font color=red >æ³¨ï¼šåŒä¸€ç½‘æ®µçš„PCäº’é€šä¸éœ€è¦ç½‘å…³ã€‚</font></p><p><strong>ä¾‹å­ï¼š</strong></p><p>å·²çŸ¥æŸä¸ªç½‘ç»œçš„æ©ç æ˜¯ 255.255.248.0ï¼Œä¸‹é¢å±äºåŒä¸€ç½‘æ®µçš„æ˜¯:</p><p>A. 10.110.16.1 å’Œ 10.110.25.1</p><p>B. 10.76.129.21 å’Œ 10.76.137.1</p><p>C.  10.52.57.34 å’Œ 10.52.62.2</p><p>D. 10.33.23.2 å’Œ 10.33.31.1</p><p>è§£ï¼š</p><p>å­ç½‘æ©ç  255.255.248.0 -&gt; </p><p>-&gt;äºŒè¿›åˆ¶ <font color=green >255.255.11111</font>   <font color=blue >000.0</font></p><p><font color=green >ç»¿è‰²ï¼šç½‘ç»œä½</font>         <font color=blue >è“è‰²ï¼šä¸»æœºä½</font></p><p>A.</p><p><font color=green >10.110.  00010</font>   <font color=blue >000.1</font><br><font color=green >10.110.  00011</font>   <font color=blue >001.1</font></p><p>B.</p><p><font color=green >10.76.    10000</font>   <font color=blue >001.21</font><br><font color=green >10.76.    10001</font>   <font color=blue >001.1</font>  </p><p>C.</p><p><font color=green >10.52.    00111</font>   <font color=blue >001.34</font><br><font color=green >10.52.    00111</font>   <font color=blue >110.2</font></p><p>D.</p><p><font color=green >10.22.    00010</font>   <font color=blue >111.2</font><br><font color=green >10.33.    00011</font>   <font color=blue >111.1</font></p><p><strong>ä¾‹å­ï¼š</strong></p><p>172.16.0.0/16 åˆ†æˆ6ä¸ªå­ç½‘æ®µï¼š</p><p>2^n&gt;=6 n=3 éœ€è¦3ä¸ª bit çš„å­ç½‘ä½ </p><p>172.16.<font color=red ><strong>000</strong></font>00000.0</p><ol><li>172.16.<font color=red ><strong>000</strong></font>00000.0 â€“&gt; 172.16.0.0/19</li><li>172.16.<font color=red ><strong>001</strong></font>00000.0 â€“&gt; 172.16.32.0/19</li><li>172.16.<font color=red ><strong>010</strong></font>00000.0 â€“&gt; 172.16.64.0/19</li><li>172.16.<font color=red ><strong>011</strong></font>00000.0 </li><li>172.16.<font color=red ><strong>100</strong></font>00000.0 </li><li>172.16.<font color=red ><strong>101</strong></font>00000.0 </li><li>172.16.<font color=red ><strong>110</strong></font>00000.0 </li><li>172.16.<font color=red ><strong>111</strong></font>00000.0 </li></ol><h2 id="ç½‘å…³ï¼ˆGatewayï¼‰"><a href="#ç½‘å…³ï¼ˆGatewayï¼‰" class="headerlink" title="ç½‘å…³ï¼ˆGatewayï¼‰"></a>ç½‘å…³ï¼ˆGatewayï¼‰</h2><p>å½“ PC è®¿é—®ä¸åŒç½‘æ®µçš„æœåŠ¡æ—¶ï¼Œéœ€è¦å°†æ•°æ®äº¤ç»™ç½‘å…³å¤„ç†</p><h2 id="TTL"><a href="#TTL" class="headerlink" title="TTL"></a>TTL</h2><p>time to liveï¼šç”Ÿå‘½å‘¨æœŸï¼ŒæŒ‡å®šIPåŒ…è¢«è·¯ç”±å™¨ä¸¢å¼ƒä¹‹å‰å…è®¸é€šè¿‡çš„æœ€å¤§ç½‘æ®µæ•°é‡ã€‚</p><h2 id="tracert"><a href="#tracert" class="headerlink" title="tracert"></a>tracert</h2><p>æµ‹è¯•æœ¬åœ°åˆ°è¾¾ç›®æ ‡æ‰€ç»è¿‡çš„ä¸‰å±‚è®¾å¤‡</p><pre><code class="hljs angelscript">C:\Users\ecarry&gt;tracert www.baidu.comé€šè¿‡æœ€å¤š <span class="hljs-number">30</span> ä¸ªè·ƒç‚¹è·Ÿè¸ªåˆ° www.a.shifen.com [<span class="hljs-number">14.215</span><span class="hljs-number">.177</span><span class="hljs-number">.39</span>] çš„è·¯ç”±:  <span class="hljs-number">1</span>     *        *       &lt;<span class="hljs-number">1</span> æ¯«ç§’ OPENWRT [<span class="hljs-number">192.168</span><span class="hljs-number">.2</span><span class="hljs-number">.3</span>]  <span class="hljs-number">2</span>     <span class="hljs-number">1</span> ms    &lt;<span class="hljs-number">1</span> æ¯«ç§’   &lt;<span class="hljs-number">1</span> æ¯«ç§’ RT-AC1200G+<span class="hljs-number">-3220</span> [<span class="hljs-number">192.168</span><span class="hljs-number">.2</span><span class="hljs-number">.1</span>]  <span class="hljs-number">3</span>     <span class="hljs-number">1</span> ms     <span class="hljs-number">1</span> ms    &lt;<span class="hljs-number">1</span> æ¯«ç§’ SMBSHARE [<span class="hljs-number">192.168</span><span class="hljs-number">.1</span><span class="hljs-number">.1</span>]  <span class="hljs-number">4</span>    <span class="hljs-number">15</span> ms    <span class="hljs-number">22</span> ms     <span class="hljs-number">4</span> ms  <span class="hljs-number">100.64</span><span class="hljs-number">.0</span><span class="hljs-number">.1</span>  <span class="hljs-number">5</span>     *        *        *     è¯·æ±‚è¶…æ—¶ã€‚  <span class="hljs-number">6</span>     <span class="hljs-number">7</span> ms     <span class="hljs-number">7</span> ms     <span class="hljs-number">6</span> ms  <span class="hljs-number">120.36</span><span class="hljs-number">.57</span><span class="hljs-number">.29</span>  <span class="hljs-number">7</span>     *        *        *     è¯·æ±‚è¶…æ—¶ã€‚  <span class="hljs-number">8</span>    <span class="hljs-number">22</span> ms    <span class="hljs-number">22</span> ms    <span class="hljs-number">23</span> ms  <span class="hljs-number">113.96</span><span class="hljs-number">.4</span><span class="hljs-number">.126</span>  <span class="hljs-number">9</span>    <span class="hljs-number">23</span> ms    <span class="hljs-number">23</span> ms     *     <span class="hljs-number">98.96</span><span class="hljs-number">.135</span><span class="hljs-number">.219</span>.broad.fs.gd.dynamic<span class="hljs-number">.163</span>data.com.cn [<span class="hljs-number">219.135</span><span class="hljs-number">.96</span><span class="hljs-number">.98</span>] <span class="hljs-number">10</span>    <span class="hljs-number">20</span> ms    <span class="hljs-number">20</span> ms    <span class="hljs-number">20</span> ms  <span class="hljs-number">14.29</span><span class="hljs-number">.117</span><span class="hljs-number">.246</span> <span class="hljs-number">11</span>     *        *        *     è¯·æ±‚è¶…æ—¶ã€‚ <span class="hljs-number">12</span>     *        *        *     è¯·æ±‚è¶…æ—¶ã€‚ <span class="hljs-number">13</span>    <span class="hljs-number">19</span> ms    <span class="hljs-number">19</span> ms    <span class="hljs-number">18</span> ms  <span class="hljs-number">14.215</span><span class="hljs-number">.177</span><span class="hljs-number">.39</span></code></pre><h2 id="ARP-Address-Resolutionè§£æ-Protocol"><a href="#ARP-Address-Resolutionè§£æ-Protocol" class="headerlink" title="ARP(Address Resolutionè§£æ Protocol)"></a>ARP(Address Resolutionè§£æ Protocol)</h2><p>é€šè¿‡ç›®çš„ IP åœ°å€ï¼Œè¯·æ±‚å¯¹æ–¹ MAC åœ°å€çš„è¿‡ç¨‹</p><p><img src="/img/ip_netmask/ip_netmask_0.jpg"></p><p>ä¸€å°ä¸»æœºå‘å¦å¤–ä¸€å°ä¸»æœºå‘é€ ARP Request çš„ç›®çš„ MAC åœ°å€ä¸º<font color=red >å¹¿æ’­ MAC åœ°å€</font>ï¼ˆFFFF.FFFF.FFFFï¼‰ï¼Œå…¶è¯·æ±‚åŒ…ï¼ˆrequestï¼‰ç»“æ„ä¸º</p><p><img src="/img/ip_netmask/ip_netmask_1.jpg"></p><p>æŸ¥çœ‹ APR ç¼“å­˜è¡¨ï¼Œé€šè¿‡å‘½ä»¤<code>arp -a</code>æŸ¥çœ‹ï¼Œé€šè¿‡<code>arp -d</code>åˆ é™¤ç¼“å­˜è¡¨</p><pre><code class="hljs routeros">PC&gt;arp -a  Internet<span class="hljs-built_in"> Address </span>     Physical<span class="hljs-built_in"> Address </span>     Type  192.168.1.30          00d0.582e.0b9b        dynamic</code></pre><p>ARP å›åº”åŒ…ï¼ˆreplyï¼‰ç»“æ„ï¼š</p><p><img src="/img/ip_netmask/ip_netmask_2.jpg"></p>]]></content>
    
    
    <categories>
      
      <category>ç½‘ç»œ</category>
      
    </categories>
    
    
    <tags>
      
      <tag>ç½‘ç»œ</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>å…³äº Linux åˆ†åŒºçš„å°äº‹</title>
    <link href="/2020/06/09/Linux_part/"/>
    <url>/2020/06/09/Linux_part/</url>
    
    <content type="html"><![CDATA[<h1 id="åˆ†åŒº"><a href="#åˆ†åŒº" class="headerlink" title="åˆ†åŒº"></a>åˆ†åŒº</h1><blockquote><p>åˆ†åŒºæ˜¯ä¸ºäº†åœ¨é€»è¾‘ä¸Šå°†æŸäº›æŸ±é¢éš”å¼€å½¢æˆè¾¹ç•Œã€‚å®ƒæ˜¯ä»¥æŸ±é¢ä¸ºå•ä½æ¥åˆ’åˆ†çš„ï¼Œä½†æ˜¯ä»CentOS 7å¼€å§‹ï¼Œæ˜¯æŒ‰ç…§æ‰‡åŒºè¿›è¡Œåˆ’åˆ†çš„ã€‚</p><p>åœ¨ç£ç›˜æ•°æ®é‡éå¸¸å¤§çš„æƒ…å†µä¸‹ï¼Œåˆ’åˆ†åˆ†åŒºçš„å¥½å¤„æ˜¯æ‰«æå—ä½å›¾ç­‰æ›´å¿«é€Ÿï¼šä¸ç”¨å†æ‰«ææ•´å—ç£ç›˜çš„å—ä½å›¾ï¼Œåªéœ€æ‰«æå¯¹åº”åˆ†åŒºçš„å—ä½å›¾ã€‚</p></blockquote><h2 id="åˆ†åŒºæ–¹æ³•ï¼ˆMBRã€GPTï¼‰"><a href="#åˆ†åŒºæ–¹æ³•ï¼ˆMBRã€GPTï¼‰" class="headerlink" title="åˆ†åŒºæ–¹æ³•ï¼ˆMBRã€GPTï¼‰"></a>åˆ†åŒºæ–¹æ³•ï¼ˆMBRã€GPTï¼‰</h2><h3 id="MBR"><a href="#MBR" class="headerlink" title="MBR"></a>MBR</h3><p>MBRæ ¼å¼çš„ç£ç›˜ä¸­ï¼Œä¼šç»´æŠ¤ç£ç›˜ç¬¬ä¸€ä¸ªæ‰‡åŒºâ€”â€”MBRæ‰‡åŒºï¼Œåœ¨è¯¥æ‰‡åŒºä¸­ç¬¬446å­—èŠ‚ä¹‹åçš„64å­—èŠ‚æ˜¯åˆ†åŒºè¡¨ï¼Œæ¯ä¸ªåˆ†åŒºå ç”¨16å­—èŠ‚ï¼Œæ‰€ä»¥é™åˆ¶äº†ä¸€å—ç£ç›˜æœ€å¤šåªèƒ½æœ‰4ä¸ªä¸»åˆ†åŒº(Primary,P)ï¼Œå¦‚æœå¤šäº4ä¸ªåŒºï¼Œåªèƒ½å°†ä¸»åˆ†åŒºå°‘äº4ä¸ªï¼Œé€šè¿‡å»ºç«‹æ‰©å±•åˆ†åŒº(Extend,E)ï¼Œç„¶ååœ¨æ‰©å±•åˆ†åŒºå»ºç«‹é€»è¾‘åˆ†åŒº(Logical,L)çš„æ–¹å¼æ¥çªç ´4ä¸ªåˆ†åŒºçš„é™åˆ¶ï¼Œé€»è¾‘åˆ†åŒºçš„æ•°é‡ä¸é™åˆ¶ã€‚</p><p>åœ¨Linuxä¸­ï¼ŒMBRæ ¼å¼çš„ç£ç›˜ä¸»åˆ†åŒºå·ä»1-4ï¼Œæ‰©å±•åˆ†åŒºå·ä»2-4ï¼Œé€»è¾‘åˆ†åŒºå·ä»5å¼€å§‹ã€‚</p><p><strong>ä¾‹å¦‚</strong>ï¼Œä¸€å—ç›˜æƒ³åˆ†æˆ6ä¸ªåˆ†åŒºï¼Œå¯ä»¥ï¼š</p><p>1P+5Lï¼šsda1+sda5+sda6+sda7+sda8+sda9</p><p>2P+4Lï¼šsda1+sda2+sda5+sda6+sda7+sda8</p><p>3P+3Lï¼šsda1+sda2+sda3+sda5+sda6+sda7</p><h3 id="GPT"><a href="#GPT" class="headerlink" title="GPT"></a>GPT</h3><p>GPTæ ¼å¼çªç ´äº†MBRçš„é™åˆ¶ï¼Œå®ƒä¸å†é™åˆ¶åªèƒ½å­˜å‚¨4ä¸ªåˆ†åŒºè¡¨æ¡ç›®ï¼Œè€Œæ˜¯ä½¿ç”¨äº†ç±»ä¼¼MBRæ‰©å±•åˆ†åŒºè¡¨æ¡ç›®çš„æ ¼å¼ï¼Œå®ƒå…è®¸æœ‰128ä¸ªä¸»åˆ†åŒºï¼Œè¿™ä¹Ÿä½¿å¾—å®ƒå¯ä»¥å¯¹è¶…è¿‡2TBçš„ç£ç›˜è¿›è¡Œåˆ†åŒºã€‚</p><h2 id="MBR-å’Œ-GPT-åˆ†åŒºè¡¨ä¿¡æ¯"><a href="#MBR-å’Œ-GPT-åˆ†åŒºè¡¨ä¿¡æ¯" class="headerlink" title="MBR å’Œ GPT åˆ†åŒºè¡¨ä¿¡æ¯"></a>MBR å’Œ GPT åˆ†åŒºè¡¨ä¿¡æ¯</h2><p>åœ¨MBRæ ¼å¼åˆ†åŒºè¡¨ä¸­ï¼ŒMBRæ‰‡åŒºå ç”¨512ä¸ªå­—èŠ‚ï¼Œå‰446ä¸ªå­—èŠ‚æ˜¯ä¸»å¼•å¯¼è®°å½•ï¼Œå³boot loaderã€‚ä¸­é—´64å­—èŠ‚è®°å½•ç€åˆ†åŒºè¡¨ä¿¡æ¯ï¼Œæ¯ä¸ªä¸»åˆ†åŒºä¿¡æ¯å ç”¨16å­—èŠ‚ï¼Œå› æ­¤æœ€å¤šåªèƒ½æœ‰4ä¸ªä¸»åˆ†åŒºï¼Œæœ€å2ä¸ªå­—èŠ‚æ˜¯æœ‰æ•ˆæ ‡è¯†ä½ã€‚å¦‚æœä½¿ç”¨æ‰©å±•åˆ†åŒºï¼Œåˆ™æ‰©å±•åˆ†åŒºå¯¹åº”çš„16å­—èŠ‚è®°å½•çš„æ˜¯æŒ‡å‘æ‰©å±•åˆ†åŒºä¸­æ‰©å±•åˆ†åŒºè¡¨çš„æŒ‡é’ˆã€‚</p><p><img src="/img/linux_part/linux_part_1.png"></p><p>åœ¨MBRç£ç›˜ä¸Šï¼Œåˆ†åŒºå’Œå¯åŠ¨ä¿¡æ¯æ˜¯ä¿å­˜åœ¨ä¸€èµ·çš„ï¼Œå¦‚æœè¿™éƒ¨åˆ†æ•°æ®è¢«è¦†ç›–æˆ–ç ´åï¼Œåªèƒ½é‡å»ºMBRã€‚è€ŒGPTåœ¨æ•´ä¸ªç£ç›˜ä¸Šä¿å­˜å¤šä¸ªè¿™éƒ¨åˆ†ä¿¡æ¯çš„å‰¯æœ¬ï¼Œå› æ­¤å®ƒæ›´ä¸ºå¥å£®ï¼Œå¹¶å¯ä»¥æ¢å¤è¢«ç ´åçš„è¿™éƒ¨åˆ†ä¿¡æ¯ã€‚GPTè¿˜ä¸ºè¿™äº›ä¿¡æ¯ä¿å­˜äº†å¾ªç¯å†—ä½™æ ¡éªŒç (CRC)ä»¥ä¿è¯å…¶å®Œæ•´å’Œæ­£ç¡®ï¼Œå¦‚æœæ•°æ®è¢«ç ´åï¼ŒGPTä¼šå‘ç°è¿™äº›ç ´åï¼Œå¹¶ä»ç£ç›˜ä¸Šçš„å…¶ä»–åœ°æ–¹è¿›è¡Œæ¢å¤ã€‚</p><p>ä¸‹é¢æ˜¯GPTæ ¼å¼çš„åˆ†åŒºè¡¨ä¿¡æ¯ï¼Œå¤§è‡´çº¦å 17ä¸ªå­—èŠ‚ã€‚</p><p><img src="/img/linux_part/linux_part_2.png"></p><p>EFIéƒ¨åˆ†å¯ä»¥åˆ†ä¸º4ä¸ªåŒºåŸŸï¼šEFIä¿¡æ¯åŒº(GPTå¤´)ã€åˆ†åŒºè¡¨ã€GPTåˆ†åŒºåŒºåŸŸå’Œå¤‡ä»½åŒºåŸŸã€‚</p><ul><li>EFIä¿¡æ¯åŒº(GPTå¤´)ï¼šèµ·å§‹äºç£ç›˜çš„LBA1ï¼Œé€šå¸¸ä¹Ÿåªå ç”¨è¿™ä¸ªå•ä¸€æ‰‡åŒºã€‚å…¶ä½œç”¨æ˜¯å®šä¹‰åˆ†åŒºè¡¨çš„ä½ç½®å’Œå¤§å°ã€‚GPTå¤´è¿˜åŒ…å«å¤´å’Œåˆ†åŒºè¡¨çš„æ ¡éªŒå’Œï¼Œè¿™æ ·å°±å¯ä»¥åŠæ—¶å‘ç°é”™è¯¯ã€‚</li><li>åˆ†åŒºè¡¨ï¼šåˆ†åŒºè¡¨åŒºåŸŸåŒ…å«åˆ†åŒºè¡¨é¡¹ã€‚è¿™ä¸ªåŒºåŸŸç”±GPTå¤´å®šä¹‰ï¼Œä¸€èˆ¬å ç”¨ç£ç›˜LBA2ï½LBA33æ‰‡åŒºï¼Œæ¯æ‰‡åŒºå¯å­˜å‚¨4ä¸ªä¸»åˆ†åŒºçš„åˆ†åŒºä¿¡æ¯ï¼Œæ‰€ä»¥å…±èƒ½åˆ†128ä¸ªä¸»åˆ†åŒºã€‚åˆ†åŒºè¡¨ä¸­çš„æ¯ä¸ªåˆ†åŒºé¡¹ç”±èµ·å§‹åœ°å€ã€ç»“æŸåœ°å€ã€ç±»å‹å€¼ã€åå­—ã€å±æ€§æ ‡å¿—ã€GUIDå€¼ç»„æˆã€‚åˆ†åŒºè¡¨å»ºç«‹åï¼Œ128ä½çš„GUIDå¯¹ç³»ç»Ÿæ¥è¯´æ˜¯å”¯ä¸€çš„ã€‚</li><li>GPTåˆ†åŒºï¼šæœ€å¤§çš„åŒºåŸŸï¼Œç”±åˆ†é…ç»™åˆ†åŒºçš„æ‰‡åŒºç»„æˆã€‚è¿™ä¸ªåŒºåŸŸçš„èµ·å§‹å’Œç»“æŸåœ°å€ç”±GPTå¤´å®šä¹‰ã€‚</li><li>å¤‡ä»½åŒºï¼šå¤‡ä»½åŒºåŸŸä½äºç£ç›˜çš„å°¾éƒ¨ï¼ŒåŒ…å«GPTå¤´å’Œåˆ†åŒºè¡¨çš„å¤‡ä»½ã€‚å®ƒå ç”¨GPTç»“æŸæ‰‡åŒºå’ŒEFIç»“æŸæ‰‡åŒºä¹‹é—´çš„33ä¸ªæ‰‡åŒºã€‚å…¶ä¸­æœ€åä¸€ä¸ªæ‰‡åŒºç”¨æ¥å¤‡ä»½1å·æ‰‡åŒºçš„EFIä¿¡æ¯ï¼Œå…¶ä½™çš„32ä¸ªæ‰‡åŒºç”¨æ¥å¤‡ä»½LBA2ï½LBA33æ‰‡åŒºçš„åˆ†åŒºè¡¨ã€‚</li></ul><h2 id="æ·»åŠ ç£ç›˜"><a href="#æ·»åŠ ç£ç›˜" class="headerlink" title="æ·»åŠ ç£ç›˜"></a>æ·»åŠ ç£ç›˜</h2><p>æ­£å¸¸æƒ…å†µä¸‹ï¼Œæ·»åŠ ç£ç›˜åéœ€è¦é‡å¯ç³»ç»Ÿæ‰èƒ½è¢«å†…æ ¸è¯†åˆ«ï¼Œåœ¨ /dev/ ä¸‹æ‰æœ‰å¯¹åº”çš„è®¾å¤‡å·ï¼Œä½¿ç”¨ fdisk -l æ‰ä¼šæ˜¾ç¤ºå‡ºæ¥ã€‚ä½†æ˜¯æœ‰æ—¶å€™ä¸æ–¹ä¾¿é‡å¯ï¼Œæ‰€ä»¥ä¸‹é¢ä»‹ç»ä¸€ç§ç£ç›˜çƒ­æ’æ‹”æ–¹å¼ã€‚</p><h3 id="Linuxä¸Šç£ç›˜çƒ­æ’æ‹”"><a href="#Linuxä¸Šç£ç›˜çƒ­æ’æ‹”" class="headerlink" title="Linuxä¸Šç£ç›˜çƒ­æ’æ‹”"></a>Linuxä¸Šç£ç›˜çƒ­æ’æ‹”</h3><p>è·å– SCSI è®¾å¤‡ä¿¡æ¯ï¼š</p><pre><code class="hljs angelscript">[<span class="hljs-symbol">root@</span>localhost ~]# lsscsi[<span class="hljs-number">1</span>:<span class="hljs-number">0</span>:<span class="hljs-number">0</span>:<span class="hljs-number">0</span>]    cd/dvd  QEMU     QEMU DVD-ROM     <span class="hljs-number">2.5</span>+  /dev/sr0 [<span class="hljs-number">2</span>:<span class="hljs-number">0</span>:<span class="hljs-number">0</span>:<span class="hljs-number">0</span>]    disk    WD       Elements SE <span class="hljs-number">25</span>FE <span class="hljs-number">1021</span>  /dev/sdb [<span class="hljs-number">2</span>:<span class="hljs-number">0</span>:<span class="hljs-number">0</span>:<span class="hljs-number">1</span>]    enclosu WD       SES Device       <span class="hljs-number">1021</span>  -        [<span class="hljs-number">3</span>:<span class="hljs-number">0</span>:<span class="hljs-number">0</span>:<span class="hljs-number">0</span>]    disk    QEMU     QEMU HARDDISK    <span class="hljs-number">2.5</span>+  /dev/sda</code></pre><p>æœ‰äº›æ“ä½œç³»ç»Ÿæ²¡æœ‰ lsscsi å‘½ä»¤ï¼Œåˆ™å¯ä»¥ä½¿ç”¨ä¸‹é¢çš„æ–¹æ³•è·å– scsi è®¾å¤‡ä¿¡æ¯ï¼š</p><pre><code class="hljs angelscript">[<span class="hljs-symbol">root@</span>localhost ~]# ll /sys/bus/scsi/drivers/sd/æ€»ç”¨é‡ <span class="hljs-number">0</span>lrwxrwxrwx. <span class="hljs-number">1</span> root root    <span class="hljs-number">0</span> <span class="hljs-number">8</span>æœˆ   <span class="hljs-number">9</span> <span class="hljs-number">15</span>:<span class="hljs-number">54</span> <span class="hljs-number">2</span>:<span class="hljs-number">0</span>:<span class="hljs-number">0</span>:<span class="hljs-number">0</span> -&gt; ../../../../devices/pci0000:<span class="hljs-number">00</span>/<span class="hljs-number">0000</span>:<span class="hljs-number">00</span>:<span class="hljs-number">1</span>e<span class="hljs-number">.0</span>/<span class="hljs-number">0000</span>:<span class="hljs-number">01</span>:<span class="hljs-number">1</span>b<span class="hljs-number">.0</span>/usb3/<span class="hljs-number">3</span><span class="hljs-number">-1</span>/<span class="hljs-number">3</span><span class="hljs-number">-1</span>:<span class="hljs-number">1.0</span>/host2/target2:<span class="hljs-number">0</span>:<span class="hljs-number">0</span>/<span class="hljs-number">2</span>:<span class="hljs-number">0</span>:<span class="hljs-number">0</span>:<span class="hljs-number">0</span>lrwxrwxrwx. <span class="hljs-number">1</span> root root    <span class="hljs-number">0</span> <span class="hljs-number">8</span>æœˆ   <span class="hljs-number">9</span> <span class="hljs-number">15</span>:<span class="hljs-number">54</span> <span class="hljs-number">3</span>:<span class="hljs-number">0</span>:<span class="hljs-number">0</span>:<span class="hljs-number">0</span> -&gt; ../../../../devices/pci0000:<span class="hljs-number">00</span>/<span class="hljs-number">0000</span>:<span class="hljs-number">00</span>:<span class="hljs-number">05.0</span>/virtio1/host3/target3:<span class="hljs-number">0</span>:<span class="hljs-number">0</span>/<span class="hljs-number">3</span>:<span class="hljs-number">0</span>:<span class="hljs-number">0</span>:<span class="hljs-number">0</span>--w-------. <span class="hljs-number">1</span> root root <span class="hljs-number">4096</span> <span class="hljs-number">8</span>æœˆ   <span class="hljs-number">9</span> <span class="hljs-number">15</span>:<span class="hljs-number">54</span> bind--w-------. <span class="hljs-number">1</span> root root <span class="hljs-number">4096</span> <span class="hljs-number">7</span>æœˆ  <span class="hljs-number">20</span> <span class="hljs-number">18</span>:<span class="hljs-number">39</span> uevent--w-------. <span class="hljs-number">1</span> root root <span class="hljs-number">4096</span> <span class="hljs-number">8</span>æœˆ   <span class="hljs-number">9</span> <span class="hljs-number">15</span>:<span class="hljs-number">54</span> unbind[<span class="hljs-symbol">root@</span>localhost ~]# ll /sys/bus/scsi/drivers/sd/<span class="hljs-number">2</span>\:<span class="hljs-number">0</span>\:<span class="hljs-number">0</span>\:<span class="hljs-number">0</span>/block/æ€»ç”¨é‡ <span class="hljs-number">0</span>drwxr-xr-x. <span class="hljs-number">8</span> root root <span class="hljs-number">0</span> <span class="hljs-number">7</span>æœˆ  <span class="hljs-number">20</span> <span class="hljs-number">18</span>:<span class="hljs-number">39</span> sdb</code></pre><p>ç„¶åæŸ¥çœ‹ /proc/scsi/scsi æ–‡ä»¶ï¼Œè·å–å¯¹åº”scsiè®¾å¤‡çš„è¯¦ç»†ä¿¡æ¯ï¼š</p><pre><code class="hljs tcl">[root@localhost ~]# cat /<span class="hljs-keyword">proc</span>/scsi/scsi Attached<span class="hljs-title"> devices:</span><span class="hljs-title">Host:</span> scsi1<span class="hljs-title"> Channel:</span> 00<span class="hljs-title"> Id:</span> 00<span class="hljs-title"> Lun:</span> 00<span class="hljs-title">  Vendor:</span> QEMU<span class="hljs-title">     Model:</span> QEMU<span class="hljs-title"> DVD-ROM</span> <span class="hljs-title">    Rev:</span> 2.5+<span class="hljs-title">  Type:</span> <span class="hljs-title">  CD-ROM</span> <span class="hljs-title">                          ANSI</span> <span class="hljs-title"> SCSI</span> revision: 05Host:<span class="hljs-title"> scsi3</span> Channel: 00<span class="hljs-title"> Id:</span> 00<span class="hljs-title"> Lun:</span> 00&lt;-----/dev/sda<span class="hljs-title">  Vendor:</span> QEMU<span class="hljs-title">     Model:</span> QEMU<span class="hljs-title"> HARDDISK</span> <span class="hljs-title">   Rev:</span> 2.5+<span class="hljs-title">  Type:</span> <span class="hljs-title">  Direct-Access</span> <span class="hljs-title">                   ANSI</span> <span class="hljs-title"> SCSI</span> revision: 05Host:<span class="hljs-title"> scsi2</span> Channel: 00<span class="hljs-title"> Id:</span> 00<span class="hljs-title"> Lun:</span> 00&lt;-----/dev/sdb<span class="hljs-title">  Vendor:</span> WD<span class="hljs-title">       Model:</span> Elements<span class="hljs-title"> SE</span> 25FE<span class="hljs-title"> Rev:</span> 1021<span class="hljs-title">  Type:</span> <span class="hljs-title">  Direct-Access</span> <span class="hljs-title">                   ANSI</span> <span class="hljs-title"> SCSI</span> revision: 06Host:<span class="hljs-title"> scsi2</span> Channel: 00<span class="hljs-title"> Id:</span> 00<span class="hljs-title"> Lun:</span> 01<span class="hljs-title">  Vendor:</span> WD<span class="hljs-title">       Model:</span> SES<span class="hljs-title"> Device</span> <span class="hljs-title">      Rev:</span> 1021<span class="hljs-title">  Type:</span> <span class="hljs-title">  Enclosure</span> <span class="hljs-title">                       ANSI</span> <span class="hljs-title"> SCSI</span> revision: 06</code></pre><p>åœ¨æ­¤å¤„ï¼Œæœ‰ä¸¤å—<strong>ç›´è¿</strong>(<strong>Direct-Access</strong>)çš„ scsi ç£ç›˜ï¼Œä¸€å—é€šè¿‡å…‰é©±cd-romè¿æ¥çš„å…‰ç›˜ã€‚æˆ‘ä»¬åªè€ƒè™‘ scsi ç£ç›˜ï¼Œæ‰€ä»¥è¿™ä¸¤å—ç£ç›˜åœ¨ scsi ä¸­çš„å®šä½ç¬¦ä¸º2:0:0:0å’Œ3:0:0:0ã€‚<strong>å¦‚æœç»§ç»­æ’å…¥ä¸€å—ç›˜ï¼Œé‚£ä¹ˆæ–°ç›˜åœ¨scsiä¸­çš„å®šä½ç¬¦å¯èƒ½ä¸º4:0:0:0</strong>ï¼Œè¿™ä¸ªæ•°å€¼ä¸²éå¸¸é‡è¦ã€‚</p><h4 id="çƒ­æ’"><a href="#çƒ­æ’" class="headerlink" title="çƒ­æ’"></a>çƒ­æ’</h4><p>åœ¨å‘è®¡ç®—æœºä¸­æ’å…¥ä¸€å—ç£ç›˜åï¼Œå†…æ ¸å› ä¸ºè¯†åˆ«ä¸äº†å®ƒæ‰€ä»¥ä¸ä¼šäº§ç”Ÿä»»ä½•äº‹ä»¶é€šçŸ¥ï¼Œå› æ­¤åœ¨ /sys ç›®å½•ä¸­ä¸ä¼šäº§ç”Ÿä»»ä½•æ–‡ä»¶ï¼Œä»»ä½•å·¥å…·ä¹Ÿå°±è¯»å–ä¸äº†å®ƒã€‚é‡å¯ç³»ç»Ÿè‚¯å®šæ˜¯å¯ä»¥è§£å†³çš„ï¼Œä½†æ˜¯Linuxæ”¯æŒçƒ­æ’ã€‚</p><p>çƒ­æ’æ–°ç›˜çš„æ–¹å¼æ˜¯å‘ /proc/scsi/scsi ä¸­å†™å…¥æ–° scsi è®¾å¤‡çš„ä¿¡æ¯ã€‚æ–¹å¼å¦‚ä¸‹ï¼š</p><p><code>echo &quot;scsi add-single-device a b c d&quot; &gt;/proc/scsi/scsi</code></p><p>å…¶ä¸­ï¼š</p><p>   a == hostadapter id (first one being 0)</p><p>   b == SCSI channel on hostadapter (first one being 0)</p><p>   c == ID</p><p>   d == LUN (first one being 0)</p><p>ä¾‹å¦‚ä¸Šé¢çš„ä¾‹å­ï¼Œåº”è¯¥æ·»åŠ å¦‚ä¸‹ä¿¡æ¯ï¼š</p><p><code>[root@localhost ~]# echo &quot;scsi add-single-device 4:0:0:0&quot; &gt;/proc/scsi/scsi</code></p><p>é‡æ–°æ‰«æ scsi æ€»çº¿ä¹Ÿå¯ä»¥å®ç°çƒ­æ’çš„åŠŸèƒ½ï¼ŒæŸ¥çœ‹ä¸»æœº SCSI æ€»çº¿å·ï¼š</p><pre><code class="hljs gradle">[root@localhost ~]# ls <span class="hljs-regexp">/sys/</span><span class="hljs-keyword">class</span><span class="hljs-regexp">/scsi_host/</span>host0  host1  host2  host3#é‡æ–°æ‰«æscsiæ€»çº¿ä»¥çƒ­æ’æ‹”æ–¹å¼æ·»åŠ æ–°è®¾å¤‡ã€‚[root@localhost ~]# echo <span class="hljs-string">&quot;- - -&quot;</span> &gt; <span class="hljs-regexp">/sys/</span><span class="hljs-keyword">class</span><span class="hljs-regexp">/scsi_host/</span>host0/scan[root@localhost ~]# echo <span class="hljs-string">&quot;- - -&quot;</span> &gt; <span class="hljs-regexp">/sys/</span><span class="hljs-keyword">class</span><span class="hljs-regexp">/scsi_host/</span>host1/scan[root@localhost ~]# echo <span class="hljs-string">&quot;- - -&quot;</span> &gt; <span class="hljs-regexp">/sys/</span><span class="hljs-keyword">class</span><span class="hljs-regexp">/scsi_host/</span>host2/scan[root@localhost ~]# echo <span class="hljs-string">&quot;- - -&quot;</span> &gt; <span class="hljs-regexp">/sys/</span><span class="hljs-keyword">class</span><span class="hljs-regexp">/scsi_host/</span>host3/scan[root@localhost ~]# fdisk -l      # å†æŸ¥çœ‹å°±æœ‰äº†</code></pre><p>å¦‚æœ scsi_host ç›®å½•ç³»å¾ˆå¤šhostNç›®å½•ï¼Œåˆ™ä½¿ç”¨å¾ªç¯æ¥å®Œæˆï¼š</p><pre><code class="hljs gradle">[root@localhost ~]# ls <span class="hljs-regexp">/sys/</span><span class="hljs-keyword">class</span><span class="hljs-regexp">/scsi_host/</span>host0   host11  host14  host17  host2   host22  host25  host28  host30  host4  host7host1   host12  host15  host18  host20  host23  host26  host29  host31  host5  host8host10  host13  host16  host19  host21  host24  host27  host3   host32  host6  host9[root@localhost ~]# <span class="hljs-keyword">for</span> i in <span class="hljs-regexp">/sys/</span><span class="hljs-keyword">class</span><span class="hljs-regexp">/scsi_host/</span>host*/scan;<span class="hljs-keyword">do</span> echo <span class="hljs-string">&quot;- - -&quot;</span> &gt;$i;done</code></pre><p>çƒ­æ’ä¹‹åï¼Œfdisk -lç­‰å‘½ä»¤å°±å¯ä»¥è¯†åˆ«åˆ°è¯¥ç£ç›˜äº†ã€‚</p><h4 id="çƒ­æ‹”"><a href="#çƒ­æ‹”" class="headerlink" title="çƒ­æ‹”"></a>çƒ­æ‹”</h4><p>çƒ­æ‹”ç£ç›˜çš„æ–¹å¼æ˜¯åœ¨ /proc/scsi/scsi ä¸­ç§»é™¤å¯¹åº” scsi è®¾å¤‡çš„ä¿¡æ¯ã€‚æ–¹å¼å¦‚ä¸‹ï¼š</p><p><code>echo &quot;scsi remove-single-device a b c d&quot; &gt;/proc/scsi/scsi</code></p><p>ä¾‹å¦‚åˆ é™¤2:0:0:0è¿™å—ç£ç›˜ï¼š</p><p><code>[root@localhost ~]# echo &quot;scsi remove-single-device 2 0 0 0&quot; &gt;/proc/scsi/scsi</code></p><p>å› ä¸ºè¦åˆ é™¤çš„è®¾å¤‡å·²ç»å­˜åœ¨ï¼Œ/sysä¸­å·²ç»æœ‰å®ƒå®Œæ•´çš„ä¿¡æ¯ï¼Œæ‰€ä»¥ä¹Ÿä»å…¶è‡ªèº«è®¾å¤‡ä¸Šè¿›è¡Œåˆ é™¤ã€‚</p><p>é¦–å…ˆæŸ¥çœ‹scsiè®¾å¤‡ä¿¡æ¯:</p><pre><code class="hljs angelscript">[<span class="hljs-symbol">root@</span>localhost ~]# lsscsi[<span class="hljs-number">1</span>:<span class="hljs-number">0</span>:<span class="hljs-number">0</span>:<span class="hljs-number">0</span>]    cd/dvd  QEMU     QEMU DVD-ROM     <span class="hljs-number">2.5</span>+  /dev/sr0 [<span class="hljs-number">2</span>:<span class="hljs-number">0</span>:<span class="hljs-number">0</span>:<span class="hljs-number">0</span>]    disk    WD       Elements SE <span class="hljs-number">25</span>FE <span class="hljs-number">1021</span>  /dev/sdb [<span class="hljs-number">2</span>:<span class="hljs-number">0</span>:<span class="hljs-number">0</span>:<span class="hljs-number">1</span>]    enclosu WD       SES Device       <span class="hljs-number">1021</span>  -        [<span class="hljs-number">3</span>:<span class="hljs-number">0</span>:<span class="hljs-number">0</span>:<span class="hljs-number">0</span>]    disk    QEMU     QEMU HARDDISK    <span class="hljs-number">2.5</span>+  /dev/sda</code></pre><p> ä¾‹å¦‚è¦åˆ é™¤ /dev/sdbï¼Œå³2:0:0:0ã€‚å…ˆçœ‹çœ‹å®ƒçš„æ–‡ä»¶ä¿¡æ¯ï¼š</p><pre><code class="hljs routeros">[root@localhost ~]# ls /sys/bus/scsi/drivers/sd/2\:0\:0\:0/block           driver                        evt_mode_parameter_change_reported  ioerr_cnt      queue_depth  scsi_generic  ueventbsg             eh_timeout                    evt_soft_threshold_reached          iorequest_cnt  queue_type   scsi_level    unpriv_sgiodelete          evt_capacity_change_reported  generic                             max_sectors    rescan       state         vendordevice_blocked  evt_inquiry_change_reported   inquiry                             modalias       rev          subsystem     vpd_pg80device_busy     evt_lun_change_reported       iocounterbits                       model          scsi_device  timeout       vpd_pg83dh_state        evt_media_change              iodone_cnt                          power          scsi_disk   <span class="hljs-built_in"> type </span>         wwid</code></pre><p>åœ¨å…¶ä¸­æœ‰3ä¸ªæ–‡ä»¶ï¼šdeleteã€rescanå’Œstateã€‚å…¶ä¸­stateè®°å½•äº†è¯¥è®¾å¤‡æ˜¯å¦æ­£åœ¨è¿è¡Œä¸­ã€‚è€Œdeleteå’Œrescanæ–‡ä»¶åˆ™ç”¨äºåˆ é™¤å’Œé‡æ–°æ‰«æè¯¥è®¾å¤‡ã€‚</p><p>ä¾‹å¦‚ï¼Œåˆ é™¤è¯¥è®¾å¤‡ï¼Œå³çƒ­æ‹”ï¼š</p><p><code>[root@localhost ~]# echo 1 &gt; /sys/bus/scsi/drivers/sd/2\:0\:0\:0/delete</code></p><h2 id="ä½¿ç”¨-fdisk-åˆ†åŒºå·¥å…·"><a href="#ä½¿ç”¨-fdisk-åˆ†åŒºå·¥å…·" class="headerlink" title="ä½¿ç”¨ fdisk åˆ†åŒºå·¥å…·"></a>ä½¿ç”¨ fdisk åˆ†åŒºå·¥å…·</h2><p>fdisk å·¥å…·ç”¨æ¥åˆ† MBR ç£ç›˜ä¸Šçš„åŒºã€‚è¦åˆ† GPT ç£ç›˜ä¸Šçš„åŒºï¼Œå¯ä»¥ä½¿ç”¨ gdiskã€‚partedå·¥å…·å¯¹è¿™ä¸¤ç§æ ¼å¼çš„ç£ç›˜åˆ†åŒºéƒ½æ”¯æŒã€‚</p><p>å¦‚æœä¸€ä¸ªå­˜å‚¨è®¾å¤‡å·²ç»åˆ†è¿‡åŒºï¼Œé‚£ä¹ˆå®ƒå¯èƒ½æ˜¯mbræ ¼å¼çš„ï¼Œä¹Ÿå¯èƒ½æ˜¯gptæ ¼å¼çš„ï¼Œå¦‚æœå·²ç»æ˜¯mbræ ¼å¼çš„ï¼Œåˆ™åªèƒ½ç»§ç»­ä½¿ç”¨fdiskè¿›è¡Œåˆ†åŒºï¼Œå¦‚æœå·²ç»æ˜¯gptæ ¼å¼çš„ï¼Œåˆ™åªèƒ½ä½¿ç”¨gdiskè¿›è¡Œåˆ†åŒºã€‚å½“ç„¶ï¼Œæ— è®ºä»€ä¹ˆæ ¼å¼çš„éƒ½å¯ä»¥ä½¿ç”¨partedè¿›è¡Œåˆ†åŒºï¼Œåªä¸è¿‡ä¹Ÿåªèƒ½åˆ’åˆ†å’Œå·²å­˜åœ¨åˆ†åŒºæ ¼å¼ä¸€æ ·çš„åˆ†åŒºï¼Œå› ä¸ºæ— è®ºä½•ç§æ ¼å¼çš„åˆ†åŒºï¼Œå®ƒçš„åˆ†åŒºè¡¨å’Œåˆ†åŒºæ ‡è¯†æ˜¯å·²ç»å›ºå®šçš„ã€‚</p><p>ä½¿ç”¨fdiskåˆ†åŒºï¼Œå®ƒåªèƒ½å®ç°MBRæ ¼å¼çš„åˆ†åŒºï¼š</p><pre><code class="hljs sql">[root@localhost ~]<span class="hljs-comment"># fdisk /dev/sda</span>æ¬¢è¿ä½¿ç”¨ fdisk (util-linux 2.23.2)ã€‚æ›´æ”¹å°†åœç•™åœ¨å†…å­˜ä¸­ï¼Œç›´åˆ°æ‚¨å†³å®šå°†æ›´æ”¹å†™å…¥ç£ç›˜ã€‚ä½¿ç”¨å†™å…¥å‘½ä»¤å‰è¯·ä¸‰æ€ã€‚å‘½ä»¤(è¾“å…¥ m è·å–å¸®åŠ©)ï¼šmå‘½ä»¤æ“ä½œ   a   toggle a bootable flag   b   edit bsd disklabel   c   toggle the dos compatibility flag   d   <span class="hljs-keyword">delete</span> a <span class="hljs-keyword">partition</span>   g   <span class="hljs-keyword">create</span> a <span class="hljs-keyword">new</span> <span class="hljs-keyword">empty</span> GPT <span class="hljs-keyword">partition</span> <span class="hljs-keyword">table</span><span class="hljs-comment">#æ–°ç‰ˆæœ¬ fdisk å¼€å§‹æ”¯æŒ GPT åˆ†åŒºäº†</span>   G   <span class="hljs-keyword">create</span> an IRIX (SGI) <span class="hljs-keyword">partition</span> <span class="hljs-keyword">table</span>   l   <span class="hljs-keyword">list</span> known <span class="hljs-keyword">partition</span> types   m   print this menu   n   <span class="hljs-keyword">add</span> a <span class="hljs-keyword">new</span> <span class="hljs-keyword">partition</span>   o   <span class="hljs-keyword">create</span> a <span class="hljs-keyword">new</span> <span class="hljs-keyword">empty</span> DOS <span class="hljs-keyword">partition</span> <span class="hljs-keyword">table</span>   p   print the <span class="hljs-keyword">partition</span> <span class="hljs-keyword">table</span>   q   quit <span class="hljs-keyword">without</span> saving changes   s   <span class="hljs-keyword">create</span> a <span class="hljs-keyword">new</span> <span class="hljs-keyword">empty</span> Sun disklabel   t   <span class="hljs-keyword">change</span> a <span class="hljs-keyword">partition</span><span class="hljs-string">&#x27;s system id</span><span class="hljs-string">   u   change display/entry units</span><span class="hljs-string">   v   verify the partition table</span><span class="hljs-string">   w   write table to disk and exit</span><span class="hljs-string">   x   extra functionality (experts only)</span><span class="hljs-string"></span><span class="hljs-string">å‘½ä»¤(è¾“å…¥ m è·å–å¸®åŠ©)ï¼šp</span><span class="hljs-string"></span><span class="hljs-string">ç£ç›˜ /dev/sdaï¼š21.5 GB, 21474836480 å­—èŠ‚ï¼Œ41943040 ä¸ªæ‰‡åŒº</span><span class="hljs-string">Units = æ‰‡åŒº of 1 * 512 = 512 bytes</span><span class="hljs-string">æ‰‡åŒºå¤§å°(é€»è¾‘/ç‰©ç†)ï¼š512 å­—èŠ‚ / 512 å­—èŠ‚</span><span class="hljs-string">I/O å¤§å°(æœ€å°/æœ€ä½³)ï¼š512 å­—èŠ‚ / 512 å­—èŠ‚</span><span class="hljs-string">ç£ç›˜æ ‡ç­¾ç±»å‹ï¼šdos</span><span class="hljs-string">ç£ç›˜æ ‡è¯†ç¬¦ï¼š0x000c7ad0</span><span class="hljs-string"></span><span class="hljs-string">   è®¾å¤‡ Boot      Start         End      Blocks   Id  System</span><span class="hljs-string">/dev/sda1   *        2048     2099199     1048576   83  Linux</span><span class="hljs-string">/dev/sda2         2099200    41943039    19921920   8e  Linux LVM</span><span class="hljs-string"></span><span class="hljs-string">å‘½ä»¤(è¾“å…¥ m è·å–å¸®åŠ©)ï¼šn#æ–°å»ºåˆ†åŒº</span><span class="hljs-string">Partition type:</span><span class="hljs-string">   p   primary (2 primary, 0 extended, 2 free)#æ€»å…±å¯å»º4ä¸ªä¸»åˆ†åŒºï¼Œç°æœ‰2ä¸ªï¼Œè¿˜å‰©å¯å»ºä¸¤ä¸ª</span><span class="hljs-string">   e   extended#æ‰©å±•åˆ†åŒº</span><span class="hljs-string">Select (default p): p</span><span class="hljs-string">åˆ†åŒºå· (3,4ï¼Œé»˜è®¤ 3)ï¼š</span><span class="hljs-string">#å»ºç«‹å®Œåˆ†åŒºæ³¨æ„ä¿å­˜</span><span class="hljs-string">Command (m for help): w  </span><span class="hljs-string">The partition table has been altered!</span><span class="hljs-string"></span><span class="hljs-string">Calling ioctl() to re-read partition table.</span><span class="hljs-string">Syncing disks.</span></code></pre><p>ä¸Šé¢çš„ fdisk æ“ä½œå…¨éƒ¨æ˜¯åœ¨å†…å­˜ä¸­æ‰§è¡Œçš„ï¼Œå¿…é¡»ä¿å­˜ç”Ÿæ•ˆã€‚ä¿å­˜åï¼Œå†…æ ¸è¿˜æœªè¯†åˆ«è¯¥åˆ†åŒºï¼Œå¯ä»¥æŸ¥çœ‹ /proc/partition ç›®å½•ä¸‹å­˜åœ¨çš„æ–‡ä»¶ï¼Œè¿™äº›æ–‡ä»¶æ˜¯èƒ½è¢«å†…æ ¸è¯†åˆ«çš„åˆ†åŒºã€‚è¿è¡Œ<strong>partprobe</strong>æˆ–<strong>partx</strong>å‘½ä»¤é‡æ–°è¯»å–åˆ†åŒºè¡¨è®©å†…æ ¸è¯†åˆ«æ–°çš„åˆ†åŒºï¼Œå†…æ ¸è¯†åˆ«åæ‰å¯ä»¥æ ¼å¼åŒ–ã€‚è€Œä¸”åˆ†åŒºç»“æŸæ—¶æŒ‰wä¿å­˜åˆ†åŒºè¡¨æœ‰æ—¶å€™ä¼šå¤±è´¥ï¼Œæç¤ºé‡å¯ï¼Œè¿™æ—¶å€™è¿è¡Œpartprobeå‘½ä»¤å¯ä»¥ä»£æ›¿é‡å¯å°±ç”Ÿæ•ˆã€‚</p><pre><code class="hljs gradle">[root@localhost ~]# partprobe <span class="hljs-regexp">/dev/</span>sdb#ä¹Ÿå¯æŒ‡å®šåœ¨ <span class="hljs-regexp">/dev/</span>sdb ä¸Šé‡åŠ è½½åˆ†åŒºè¡¨</code></pre><h2 id="ä½¿ç”¨-gdisk-åˆ†åŒºå·¥å…·"><a href="#ä½¿ç”¨-gdisk-åˆ†åŒºå·¥å…·" class="headerlink" title="ä½¿ç”¨ gdisk åˆ†åŒºå·¥å…·"></a>ä½¿ç”¨ gdisk åˆ†åŒºå·¥å…·</h2><p>ä½¿ç”¨ gdsik éœ€è¦å®‰è£…è¿™ä¸ªå·¥å…·åŒ…ï¼š</p><pre><code class="hljs autoit">[root<span class="hljs-symbol">@localhost</span> ~]<span class="hljs-meta"># yum -y install gdisk</span></code></pre><p>åˆ†åŒºçš„æ—¶å€™ç›´æ¥å¸¦ä¸Šè®¾å¤‡å³å¯ã€‚ä»¥ä¸‹æ˜¯å¯¹æ–°ç¡¬ç›˜åˆ’åˆ†gptåˆ†åŒºçš„è¿‡ç¨‹ï¼š</p><pre><code class="hljs sql">[root@localhost ~]<span class="hljs-comment"># gdisk /dev/sdb</span>GPT fdisk (gdisk) version 0.8.10Partition table scan:  MBR: not present  BSD: not present  APM: not present  GPT: not presentCreating new GPT entries.Command (? for <span class="hljs-keyword">help</span>): ?b       back up GPT <span class="hljs-keyword">data</span> <span class="hljs-keyword">to</span> a <span class="hljs-keyword">file</span>c       <span class="hljs-keyword">change</span> a <span class="hljs-keyword">partition</span><span class="hljs-string">&#x27;s name</span><span class="hljs-string">d       delete a partition                               # åˆ é™¤åˆ†åŒº</span><span class="hljs-string">i       show detailed information on a partition         # åˆ—å‡ºåˆ†åŒºè¯¦ç»†ä¿¡æ¯</span><span class="hljs-string">l       list known partition types                       # åˆ—å‡ºæ‰€ä»¥å·²çŸ¥çš„åˆ†åŒºç±»å‹</span><span class="hljs-string">n       add a new partition                              # æ·»åŠ æ–°åˆ†åŒº</span><span class="hljs-string">o       create a new empty GUID partition table (GPT)    # åˆ›å»ºä¸€ä¸ªæ–°çš„ç©ºçš„guidåˆ†åŒºè¡¨</span><span class="hljs-string">p       print the partition table                        # è¾“å‡ºåˆ†åŒºè¡¨ä¿¡æ¯</span><span class="hljs-string">q       quit without saving changes                      # é€€å‡ºgdiskå·¥å…·</span><span class="hljs-string">r       recovery and transformation options (experts only) </span><span class="hljs-string">s       sort partitions                                </span><span class="hljs-string">t       change a partition&#x27;</span>s <span class="hljs-keyword">type</span> code                   <span class="hljs-comment"># ä¿®æ”¹åˆ†åŒºç±»å‹</span>v       <span class="hljs-keyword">verify</span> diskw       write <span class="hljs-keyword">table</span> <span class="hljs-keyword">to</span> disk <span class="hljs-keyword">and</span> <span class="hljs-keyword">exit</span>                     <span class="hljs-comment"># å°†åˆ†åŒºä¿¡æ¯å†™å…¥åˆ°ç£ç›˜</span>x       extra functionality (experts <span class="hljs-keyword">only</span>)             ?       print this menuCommand (? <span class="hljs-keyword">for</span> <span class="hljs-keyword">help</span>): n   <span class="hljs-comment">#æ·»åŠ ä¸€ä¸ªæ–°åˆ†åŒº</span><span class="hljs-keyword">Partition</span> <span class="hljs-built_in">number</span> (<span class="hljs-number">1</span><span class="hljs-number">-128</span>, <span class="hljs-keyword">default</span> <span class="hljs-number">1</span>):<span class="hljs-keyword">First</span> sector (<span class="hljs-number">34</span><span class="hljs-number">-41943006</span>, <span class="hljs-keyword">default</span> = <span class="hljs-number">2048</span>) <span class="hljs-keyword">or</span> &#123;+-&#125;<span class="hljs-keyword">size</span>&#123;KMGTP&#125;:<span class="hljs-keyword">Last</span> sector (<span class="hljs-number">2048</span><span class="hljs-number">-41943006</span>, <span class="hljs-keyword">default</span> = <span class="hljs-number">41943006</span>) <span class="hljs-keyword">or</span> &#123;+-&#125;<span class="hljs-keyword">size</span>&#123;KMGTP&#125;: +<span class="hljs-number">10</span>G<span class="hljs-keyword">Current</span> <span class="hljs-keyword">type</span> <span class="hljs-keyword">is</span> <span class="hljs-string">&#x27;Linux filesystem&#x27;</span><span class="hljs-keyword">Hex</span> code <span class="hljs-keyword">or</span> GUID (L <span class="hljs-keyword">to</span> <span class="hljs-keyword">show</span> codes, Enter = <span class="hljs-number">8300</span>):<span class="hljs-keyword">Changed</span> <span class="hljs-keyword">type</span> <span class="hljs-keyword">of</span> <span class="hljs-keyword">partition</span> <span class="hljs-keyword">to</span> <span class="hljs-string">&#x27;Linux filesystem&#x27;</span> Command (? <span class="hljs-keyword">for</span> <span class="hljs-keyword">help</span>): pDisk /dev/sdb: <span class="hljs-number">41943040</span> sectors, <span class="hljs-number">20.0</span> GiB<span class="hljs-keyword">Logical</span> sector <span class="hljs-keyword">size</span>: <span class="hljs-number">512</span> <span class="hljs-keyword">bytes</span>Disk identifier (GUID): F8AE925F<span class="hljs-number">-515</span>F<span class="hljs-number">-4807</span><span class="hljs-number">-92</span>ED<span class="hljs-number">-4109</span>D0827191<span class="hljs-keyword">Partition</span> <span class="hljs-keyword">table</span> holds up <span class="hljs-keyword">to</span> <span class="hljs-number">128</span> entries<span class="hljs-keyword">First</span> <span class="hljs-keyword">usable</span> sector <span class="hljs-keyword">is</span> <span class="hljs-number">34</span>, <span class="hljs-keyword">last</span> <span class="hljs-keyword">usable</span> sector <span class="hljs-keyword">is</span> <span class="hljs-number">41943006</span><span class="hljs-keyword">Partitions</span> will be aligned <span class="hljs-keyword">on</span> <span class="hljs-number">2048</span>-sector boundariesTotal free <span class="hljs-keyword">space</span> <span class="hljs-keyword">is</span> <span class="hljs-number">20971453</span> sectors (<span class="hljs-number">10.0</span> GiB) <span class="hljs-built_in">Number</span>  <span class="hljs-keyword">Start</span> (sector)    <span class="hljs-keyword">End</span> (sector)  <span class="hljs-keyword">Size</span>       Code  <span class="hljs-keyword">Name</span>   <span class="hljs-number">1</span>            <span class="hljs-number">2048</span>        <span class="hljs-number">20973567</span>   <span class="hljs-number">10.0</span> GiB    <span class="hljs-number">8300</span>  Linux filesystemCommand (? <span class="hljs-keyword">for</span> <span class="hljs-keyword">help</span>): i   <span class="hljs-comment"># æŸ¥çœ‹åˆ†åŒºè¯¦ç»†ä¿¡æ¯</span><span class="hljs-keyword">Using</span> <span class="hljs-number">1</span><span class="hljs-keyword">Partition</span> GUID code: <span class="hljs-number">0</span>FC63DAF<span class="hljs-number">-8483</span><span class="hljs-number">-4772</span><span class="hljs-number">-8E79</span><span class="hljs-number">-3</span>D69D8477DE4 (Linux filesystem)<span class="hljs-keyword">Partition</span> <span class="hljs-keyword">unique</span> GUID: B2452103<span class="hljs-number">-4</span>F32<span class="hljs-number">-4</span>B60-AEF7<span class="hljs-number">-4</span>BA42B7BF089<span class="hljs-keyword">First</span> sector: <span class="hljs-number">2048</span> (<span class="hljs-keyword">at</span> <span class="hljs-number">1024.0</span> KiB)<span class="hljs-keyword">Last</span> sector: <span class="hljs-number">20973567</span> (<span class="hljs-keyword">at</span> <span class="hljs-number">10.0</span> GiB)<span class="hljs-keyword">Partition</span> <span class="hljs-keyword">size</span>: <span class="hljs-number">20971520</span> sectors (<span class="hljs-number">10.0</span> GiB)<span class="hljs-keyword">Attribute</span> flags: <span class="hljs-number">0000000000000000</span><span class="hljs-keyword">Partition</span> <span class="hljs-keyword">name</span>: <span class="hljs-string">&#x27;Linux filesystem&#x27;</span>Command (? <span class="hljs-keyword">for</span> <span class="hljs-keyword">help</span>): w <span class="hljs-comment">#ä¿å­˜åˆ†åŒºè¡¨åˆ°ç£ç›˜</span><span class="hljs-keyword">Final</span> checks complete. About <span class="hljs-keyword">to</span> write GPT data. THIS WILL OVERWRITE EXISTING<span class="hljs-keyword">PARTITIONS</span>!!<span class="hljs-keyword">Do</span> you want <span class="hljs-keyword">to</span> proceed? (Y/N): YOK; writing new GUID partition table (GPT) to /dev/sdb.The operation has completed successfully.<span class="hljs-comment">#æ‰§è¡Œpartprobeé‡æ–°è¯»å–åˆ†åŒºè¡¨ä¿¡æ¯</span>[root@localhost ~]<span class="hljs-comment"># partprobe /dev/sdb</span></code></pre><h2 id="ä½¿ç”¨-parted-åˆ†åŒº"><a href="#ä½¿ç”¨-parted-åˆ†åŒº" class="headerlink" title="ä½¿ç”¨ parted åˆ†åŒº"></a>ä½¿ç”¨ parted åˆ†åŒº</h2><p>parted æ”¯æŒ mbr æ ¼å¼å’Œ gpt æ ¼å¼çš„ç£ç›˜åˆ†åŒºã€‚å®ƒçš„å¼ºå¤§åœ¨äºå¯ä»¥ä¸€æ­¥åˆ°ä½è€Œä¸éœ€è¦ä¸æ–­çš„äº¤äº’å¼è¾“å…¥(ä¹Ÿå¯ä»¥äº¤äº’å¼)ã€‚</p><p>partedåˆ†åŒºå·¥å…·æ˜¯å®æ—¶çš„ï¼Œæ‰€ä»¥æ¯ä¸€æ­¥æ“ä½œéƒ½æ˜¯ç›´æ¥å†™å…¥ç£ç›˜è€Œä¸æ˜¯å†™è¿›å†…å­˜ï¼Œå®ƒä¸åƒ fdisk/gdisk è¿˜éœ€è¦ w å‘½ä»¤å°†å†…å­˜ä¸­çš„ç»“æœä¿å­˜åˆ°ç£ç›˜ä¸­ã€‚</p><pre><code class="hljs pgsql">[root@localhost ~]# parted /dev/sdcGNU Parted <span class="hljs-number">2.1</span><span class="hljs-keyword">Using</span> /dev/sdcWelcome <span class="hljs-keyword">to</span> GNU Parted! <span class="hljs-keyword">Type</span> <span class="hljs-string">&#x27;help&#x27;</span> <span class="hljs-keyword">to</span> <span class="hljs-keyword">view</span> a list <span class="hljs-keyword">of</span> commands. (parted) help                                                               align-<span class="hljs-keyword">check</span> <span class="hljs-keyword">TYPE</span> N                      <span class="hljs-keyword">check</span> <span class="hljs-keyword">partition</span> N <span class="hljs-keyword">for</span> <span class="hljs-keyword">TYPE</span>(min|opt) alignment  <span class="hljs-keyword">check</span> NUMBER                            <span class="hljs-keyword">do</span> a simple <span class="hljs-keyword">check</span> <span class="hljs-keyword">on</span> the file <span class="hljs-keyword">system</span>(centos <span class="hljs-number">7</span>ä¸Šå·²åˆ é™¤è¯¥åŠŸèƒ½)  cp [<span class="hljs-keyword">FROM</span>-DEVICE] <span class="hljs-keyword">FROM</span>-NUMBER <span class="hljs-keyword">TO</span>-NUMBER  <span class="hljs-keyword">copy</span> file <span class="hljs-keyword">system</span> <span class="hljs-keyword">to</span> another <span class="hljs-keyword">partition</span>(centos <span class="hljs-number">7</span>ä¸Šå·²åˆ é™¤è¯¥åŠŸèƒ½)  help [COMMAND]                          print general help, <span class="hljs-keyword">or</span> help <span class="hljs-keyword">on</span> COMMAND  mklabel,mktable LABEL-<span class="hljs-keyword">TYPE</span>              <span class="hljs-keyword">create</span> a <span class="hljs-built_in">new</span> disklabel (<span class="hljs-keyword">partition</span> <span class="hljs-keyword">table</span>)  mkfs NUMBER FS-<span class="hljs-keyword">TYPE</span>                     make a FS-<span class="hljs-keyword">TYPE</span> file <span class="hljs-keyword">system</span> <span class="hljs-keyword">on</span> <span class="hljs-keyword">partition</span> NUMBER (centos <span class="hljs-number">7</span>ä¸Šå·²åˆ é™¤æ”¹è¯¥åŠŸèƒ½)   mkpart PART-<span class="hljs-keyword">TYPE</span> [FS-<span class="hljs-keyword">TYPE</span>] <span class="hljs-keyword">START</span> <span class="hljs-keyword">END</span>    make a <span class="hljs-keyword">partition</span>  mkpartfs PART-<span class="hljs-keyword">TYPE</span> FS-<span class="hljs-keyword">TYPE</span> <span class="hljs-keyword">START</span> <span class="hljs-keyword">END</span>    make a <span class="hljs-keyword">partition</span> <span class="hljs-keyword">with</span> a file <span class="hljs-keyword">system</span>(centos <span class="hljs-number">7</span>ä¸Šå·²åˆ é™¤è¯¥åŠŸèƒ½)     <span class="hljs-keyword">move</span> NUMBER <span class="hljs-keyword">START</span> <span class="hljs-keyword">END</span>                   <span class="hljs-keyword">move</span> <span class="hljs-keyword">partition</span> NUMBER(centos <span class="hljs-number">7</span>ä¸Šå·²åˆ é™¤è¯¥åŠŸèƒ½)   <span class="hljs-type">name</span> NUMBER <span class="hljs-type">NAME</span>                        <span class="hljs-type">name</span> <span class="hljs-keyword">partition</span> NUMBER <span class="hljs-keyword">as</span> <span class="hljs-type">NAME</span>  print [devices|free|list,<span class="hljs-keyword">all</span>|NUMBER]    display the <span class="hljs-keyword">partition</span> <span class="hljs-keyword">table</span>,available devices,free space, <span class="hljs-keyword">all</span> <span class="hljs-built_in">found</span> partitions,<span class="hljs-keyword">or</span> a particular <span class="hljs-keyword">partition</span>  quit                                    <span class="hljs-keyword">exit</span> program  rescue <span class="hljs-keyword">START</span> <span class="hljs-keyword">END</span>                        rescue a lost <span class="hljs-keyword">partition</span> near <span class="hljs-keyword">START</span> <span class="hljs-keyword">and</span> <span class="hljs-keyword">END</span>  resize NUMBER <span class="hljs-keyword">START</span> <span class="hljs-keyword">END</span>                 resize <span class="hljs-keyword">partition</span> NUMBER <span class="hljs-keyword">and</span> its file <span class="hljs-keyword">system</span>(ä¿®æ”¹åˆ†åŒºå¤§å°(centos <span class="hljs-number">7</span>ä¸Šå·²åˆ é™¤è¯¥åŠŸèƒ½))  rm NUMBER                               <span class="hljs-keyword">delete</span> <span class="hljs-keyword">partition</span> NUMBER (åˆ é™¤åˆ†åŒº)               <span class="hljs-keyword">select</span> DEVICE                           choose the device <span class="hljs-keyword">to</span> edit (é‡é€‰ç£ç›˜è¿›å…¥partedçŠ¶æ€)    <span class="hljs-keyword">set</span> NUMBER FLAG STATE                   change the FLAG <span class="hljs-keyword">on</span> <span class="hljs-keyword">partition</span> NUMBER(è®¾ç½®åˆ†åŒºçŠ¶æ€ï¼Œå¦‚å°†å…¶<span class="hljs-keyword">off</span>æˆ–<span class="hljs-keyword">on</span>)    toggle [NUMBER [FLAG]]                  toggle the state <span class="hljs-keyword">of</span> FLAG <span class="hljs-keyword">on</span> <span class="hljs-keyword">partition</span> NUMBER(ä¿®æ”¹æ–‡ä»¶ç³»ç»Ÿç±»å‹ï¼Œå¦‚swapã€lvm)    unit UNIT                               <span class="hljs-keyword">set</span> the <span class="hljs-keyword">default</span> unit <span class="hljs-keyword">to</span> UNIT(ä¿®æ”¹é»˜è®¤å•ä½ï¼ŒkB/MB/GBç­‰)  <span class="hljs-keyword">version</span>                                 display the <span class="hljs-keyword">version</span> number <span class="hljs-keyword">and</span> copyright information <span class="hljs-keyword">of</span> GNU Parted</code></pre><p>å¸¸ç”¨çš„å‘½ä»¤æ˜¯mklabelã€rmã€printã€mkpartã€helpã€quit</p><p>partedåˆ†åŒºçš„å‰ææ˜¯ç£ç›˜å·²ç»æœ‰åˆ†åŒºè¡¨(partition table)æˆ–ç£ç›˜æ ‡ç­¾(disk label)ï¼Œå¦åˆ™å°†æ˜¾ç¤ºâ€unrecognised disk labelâ€ï¼Œè¿™æ˜¯å’Œfdisk/gdiskä¸åŒçš„åœ°æ–¹ï¼Œæ‰€ä»¥éœ€è¦å…ˆä½¿ç”¨mklabelåˆ›å»ºæ ‡ç­¾æˆ–åˆ†åŒºè¡¨ï¼Œæœ€å¸¸è§çš„æ ‡ç­¾(åˆ†åŒºè¡¨)ä¸ºâ€msdosâ€å’Œâ€gptâ€ï¼Œå…¶ä¸­msdosåˆ†åŒºå°±æ˜¯MBRæ ¼å¼çš„åˆ†åŒºè¡¨ï¼Œä¹Ÿå°±æ˜¯ä¼šæœ‰ä¸»åˆ†åŒºã€æ‰©å±•åˆ†åŒºå’Œé€»è¾‘åˆ†åŒºçš„æ¦‚å¿µå’Œé™åˆ¶ã€‚</p><p>ä¸‹é¢ä½¿ç”¨ parted å¯¹ /dev/sdc åˆ›å»º msdos çš„æ–°åˆ†åŒºï¼š</p><pre><code class="hljs routeros">[root@localhost ~]# parted /dev/sdcGNU Parted 2.1Using /dev/sdbWelcome <span class="hljs-keyword">to</span> GNU Parted!<span class="hljs-built_in"> Type </span><span class="hljs-string">&#x27;help&#x27;</span> <span class="hljs-keyword">to</span> view a list of commands.(parted) mklabel             # åˆ›å»ºç£ç›˜åˆ†åŒºæ ‡ç­¾(åˆ†åŒºè¡¨ç±»å‹)                                               New disk label type? msdos   # é€‰æ‹©msdoså³MBRç±»å‹                                 # ä¸Šé¢çš„ä¸¤æ­¥ä¹Ÿå¯ä»¥ç›´æ¥ä¸€æ­¥è¿›è¡Œï¼š(parted) mklabel msdos      (parted) mkpart              # å¼€å§‹è¿›è¡Œåˆ†åŒº     Partition type?  primary/extended? p     # åˆ›å»ºä¸»åˆ†åŒºFile<span class="hljs-built_in"> system </span>type?  [ext2]? ext4          # åˆ›å»ºext4æ–‡ä»¶ç³»ç»Ÿ                                         # (æ³¨æ„ï¼Œè¿™é‡Œè™½ç„¶æŒ‡æ˜äº†æ–‡ä»¶ç³»ç»Ÿï¼Œä½†æ²¡æœ‰ä»»ä½•æ„ä¹‰ï¼Œåé¢è¿˜æ˜¯éœ€è¦æ‰‹åŠ¨æ ¼å¼åŒ–å¹¶é€‰æ‹©æ–‡ä»¶ç³»ç»Ÿç±»å‹)Start? 1                                 # åˆ†åŒºå¼€å§‹ä½ç½®ï¼Œé»˜è®¤æ˜¯Mä¸ºå•ä½ï¼Œè¡¨ç¤ºä»1Må¼€å§‹ï¼Œä¹Ÿå¯ç›´æ¥æŒ‡å®š1Gè¿™ç§æ–¹å¼End? 1024                                # åˆ†åŒºç»“æŸä½ç½®ï¼Œ<span class="hljs-attribute">1024-1</span>=1023M(parted) p                   # printï¼ŒæŸ¥çœ‹åˆ†åŒºä¿¡æ¯Model: VMware, VMware Virtual S (scsi)Disk /dev/sdc: 21.5GBSector size (logical/physical): 512B/512BPartition Table: msdosNumber  Start   End     Size   <span class="hljs-built_in"> Type </span>    File<span class="hljs-built_in"> system </span> Flags 1      1049kB  1024MB  1023MB  primary<span class="hljs-comment"># å¯ä»¥ä¸€æ­¥å®Œæˆä¸€ä¸ªå‘½ä»¤ä¸­çš„å¤šä¸ªåŠ¨ä½œ</span>(parted) mkpart p ext4 1026M 4096M       # å¯ä»¥ä¸€æ­¥å®Œæˆï¼Œä¹Ÿå¯ä»¥ä¸€æ­¥å®Œæˆåˆ°ä»»ä½•ä½ç½®ï¼Œç„¶åç»§ç»­äº¤äº’ä¸‹ä¸€æ­¥                                         # å¯èƒ½ä¼šæç¤ºåˆ†åŒºæœªå¯¹é½<span class="hljs-string">&quot;Warning: The resulting partition is not properly aligned for best performance.&quot;</span>ï¼Œå¿½ç•¥å®ƒ(parted) mkpart e 4098 -1    # åˆ›å»ºæ‰©å±•åˆ†åŒºï¼Œæ³¨æ„åˆ›å»ºæ‰©å±•åˆ†åŒºæ—¶ä¸æŒ‡å®šæ–‡ä»¶ç³»ç»Ÿç±»å‹ï¼›-1è¡¨ç¤ºå‰©ä½™çš„å…¨éƒ¨åˆ†é…ç»™è¯¥åˆ†åŒº(parted) p                                                               Model: VMware, VMware Virtual S (scsi)Disk /dev/sdc: 21.5GBSector size (logical/physical): 512B/512BPartition Table: msdos Number  Start   End     Size   <span class="hljs-built_in"> Type </span>     File<span class="hljs-built_in"> system </span> Flags 1      1049kB  1024MB  1023MB  primary 2      1026MB  4096MB  3070MB  primary 3      4098MB  21.5GB  17.4GB  extended               lba(parted) mkpart l ext4 4099 8194     # åˆ›å»ºé€»è¾‘åˆ†åŒºï¼ŒæŒ‡å®šext4(parted) mkpart l ext4 8195 -1       # ç»§ç»­åˆ›å»ºé€»è¾‘åˆ†åŒº(parted) pModel: VMware, VMware Virtual S (scsi)Disk /dev/sdc: 21.5GBSector size (logical/physical): 512B/512BPartition Table: msdosNumber  Start   End     Size   <span class="hljs-built_in"> Type </span>     File<span class="hljs-built_in"> system </span> Flags 1      1049kB  1024MB  1023MB  primary 2      1026MB  4096MB  3070MB  primary 3      4098MB  21.5GB  17.4GB  extended               lba 5      4099MB  8194MB  4095MB  logical 6      8195MB  21.5GB  13.3GB  logical(parted) rm 5    # åˆ é™¤5å·åˆ†åŒº(parted) pModel: VMware, VMware Virtual S (scsi)Disk /dev/sdc: 21.5GBSector size (logical/physical): 512B/512BPartition Table: msdosNumber  Start   End     Size   <span class="hljs-built_in"> Type </span>     File<span class="hljs-built_in"> system </span> Flags 1      1049kB  1024MB  1023MB  primary 2      1026MB  4096MB  3070MB  primary 3      4098MB  21.5GB  17.4GB  extended               lba 5      8195MB  21.5GB  13.3GB  logical(parted) quit                                    # é€€å‡ºpartedå·¥å…·Information: You may need <span class="hljs-keyword">to</span> update /etc/fstab.  # æç¤ºä½ è¦æ›´æ–°/etc/fstabä¸­çš„é…ç½®ï¼Œè¯´æ˜è¯¥å·¥å…·æ˜¯å¯ä»¥åœ¨çº¿åˆ†åŒºçš„</code></pre><p><font color=red>æ³¨ï¼šè™½ç„¶partedå·¥å…·ä¸­æŒ‡å®šäº†æ–‡ä»¶ç³»ç»Ÿï¼Œä½†æ˜¯å¹¶æ²¡æœ‰æ„ä¹‰ï¼Œå®ƒä»éœ€è¦æ‰‹åŠ¨è¿›è¡Œæ ¼å¼åŒ–å¹¶æŒ‡å®šåˆ†åŒºç±»å‹ã€‚</font></p><h1 id="æ ¼å¼åŒ–åˆ†åŒº"><a href="#æ ¼å¼åŒ–åˆ†åŒº" class="headerlink" title="æ ¼å¼åŒ–åˆ†åŒº"></a>æ ¼å¼åŒ–åˆ†åŒº</h1><h2 id="mkfs-å·¥å…·"><a href="#mkfs-å·¥å…·" class="headerlink" title="mkfs å·¥å…·"></a>mkfs å·¥å…·</h2><p>mkfså‘½ä»¤é€šå¸¸ç”¨äºåœ¨è®¾å¤‡ç¡¬ä»¶åˆ†åŒºä¸Šåˆ›å»ºlinuxæ–‡ä»¶ç³»ç»Ÿã€‚mkfs å‘½ä»¤æ”¯æŒå»ºç«‹å¤šç§ Linux æ–‡ä»¶ç³»ç»Ÿï¼Œå¦‚ extç³»åˆ—ï¼Œxfsç­‰ç­‰ã€‚å®é™…ä¸Šmkfsæ˜¯æ”¯æŒå¤šç§æ–‡ä»¶ç³»ç»Ÿæ„å»ºå‘½ä»¤<code>mkfs. TYPE</code>çš„å‰éƒ¨åˆ†ï¼Œmkfså‘½ä»¤é€šå¸¸æ‰§è¡Œçš„æ—¶å€™ä¹Ÿæ˜¯è°ƒç”¨<code>mkfs. TYPE</code>æ¥æ‰§è¡Œï¼Œå¦‚mkfs.ext2ï¼Œmkfs.vfsï¼Œmkfs.vfatç­‰ç­‰ã€‚</p><pre><code class="hljs css"><span class="hljs-selector-attr">[root@localhost ~]</span># <span class="hljs-selector-tag">mkfs</span><span class="hljs-selector-tag">mkfs</span>         <span class="hljs-selector-tag">mkfs</span><span class="hljs-selector-class">.btrfs</span>   <span class="hljs-selector-tag">mkfs</span><span class="hljs-selector-class">.cramfs</span>  <span class="hljs-selector-tag">mkfs</span><span class="hljs-selector-class">.ext2</span>    <span class="hljs-selector-tag">mkfs</span><span class="hljs-selector-class">.ext3</span>    <span class="hljs-selector-tag">mkfs</span><span class="hljs-selector-class">.ext4</span>    <span class="hljs-selector-tag">mkfs</span><span class="hljs-selector-class">.minix</span>   <span class="hljs-selector-tag">mkfs</span><span class="hljs-selector-class">.xfs</span></code></pre><h2 id="mke2fs-å·¥å…·"><a href="#mke2fs-å·¥å…·" class="headerlink" title="mke2fs å·¥å…·"></a>mke2fs å·¥å…·</h2><p>mkfs.ext2ã€mkfs.ext3ã€mkfs.ext4 æˆ– mkfs -t extX å…¶å®éƒ½æ˜¯åœ¨è°ƒç”¨mke2fså·¥å…·ã€‚</p><p>è¯¥å·¥å…·åˆ›å»ºæ–‡ä»¶ç³»ç»Ÿæ—¶ï¼Œä¼šä» /etc/mke2fs.conf é…ç½®ä¸­è¯»å–é»˜è®¤çš„é…ç½®é¡¹ï¼š</p><pre><code class="hljs mipsasm">mke<span class="hljs-symbol">2f</span>s [ -c ] [ -<span class="hljs-keyword">b </span><span class="hljs-keyword">block-size </span>] [ -f fragment-size ] [ -g <span class="hljs-keyword">blocks-per-group </span>] [ -G number-of-groups ]        [ -i <span class="hljs-keyword">bytes-per-inode </span>] [ -I inode-size ] [ -<span class="hljs-keyword">j </span>] [ -N number-of-inodes ] [ -m reserved-<span class="hljs-keyword">blocks-percentage </span>]        [ -q ] [ -r fs-revision-level ] [ -v ] [ -L volume-label ] [ -S ] [ -t fs-type ] device [ <span class="hljs-keyword">blocks-count </span>]é€‰é¡¹è¯´æ˜ï¼š-t fs-type         ï¼šæŒ‡å®šè¦åˆ›å»ºçš„æ–‡ä»¶ç³»ç»Ÿç±»å‹(<span class="hljs-keyword">ext2,ext3 </span><span class="hljs-keyword">ext4)ï¼Œè‹¥ä¸æŒ‡å®šï¼Œåˆ™ä»/etc/mke2fs.confä¸­è·å–é»˜è®¤çš„æ–‡ä»¶ç³»ç»Ÿç±»å‹ã€‚</span><span class="hljs-keyword">-b </span><span class="hljs-keyword">block-size </span>     ï¼šæŒ‡å®šæ¯ä¸ª<span class="hljs-keyword">blockçš„å¤§å°ï¼Œæœ‰æ•ˆå€¼æœ‰1024ã€2048å’Œ4096ï¼Œå•ä½æ˜¯å­—èŠ‚ã€‚</span><span class="hljs-keyword">-I </span>inode-size      ï¼šæŒ‡å®šinodeå¤§å°ï¼Œå•ä½ä¸ºå­—èŠ‚ã€‚å¿…é¡»ä¸º<span class="hljs-number">2</span>çš„å¹‚æ¬¡æ–¹ï¼Œä¸”å¤§äºç­‰äº<span class="hljs-number">128</span>å­—èŠ‚ã€‚å€¼è¶Šå¤§ï¼Œè¯´æ˜inodeçš„é›†åˆä½“inode tableå ç”¨è¶Šå¤šçš„ç©º                     é—´ï¼Œè¿™ä¸ä»…ä¼šæŒ¤å æ–‡ä»¶ç³»ç»Ÿä¸­çš„å¯ç”¨ç©ºé—´ï¼Œè¿˜ä¼šé™ä½æ€§èƒ½ï¼Œå› ä¸ºè¦æ‰«æinode tableéœ€è¦æ¶ˆè€—æ›´å¤šæ—¶é—´ï¼Œä½†æ˜¯åœ¨linux kernel <span class="hljs-number">2</span>.<span class="hljs-number">6</span>.<span class="hljs-number">10</span>                     ä¹‹åï¼Œç”±äºä½¿ç”¨inodeå­˜å‚¨äº†å¾ˆå¤šæ‰©å±•çš„é¢å¤–å±æ€§ï¼Œæ‰€ä»¥<span class="hljs-number">128</span>å­—èŠ‚å·²ç»ä¸å¤Ÿç”¨äº†ï¼Œå› æ­¤<span class="hljs-keyword">ext4é»˜è®¤çš„inode </span>sizeå·²ç»å˜ä¸º<span class="hljs-number">256</span>ï¼Œå°½ç®¡                     inodeå¤§å°å¢å¤§äº†ï¼Œä½†å› ä¸ºä½¿ç”¨inodeå­˜å‚¨æ‰©å±•å±æ€§å¸¦æ¥çš„æ€§èƒ½æå‡è¿œé«˜äºinode sizeå˜å¤§å¯¼è‡´çš„è´Ÿé¢å½±å“ï¼Œæ‰€ä»¥ä»å»ºè®®ä½¿ç”¨<span class="hljs-number">256</span>å­—                     èŠ‚çš„inodeã€‚-i <span class="hljs-keyword">bytes-per-inode </span>ï¼šæŒ‡å®šæ¯å¤šå°‘ä¸ªå­—èŠ‚å°±ä¸ºå…¶åˆ†é…ä¸€ä¸ªinodeå·ã€‚å€¼è¶Šå¤§ï¼Œè¯´æ˜ä¸€ä¸ªæ–‡ä»¶ç³»ç»Ÿä¸­åˆ†é…çš„inodeå·è¶Šå°‘ï¼Œæ›´é€‚ç”¨äºå­˜å‚¨å¤§é‡å¤§æ–‡ä»¶ï¼Œå€¼è¶Š                     å°ï¼Œinodeå·è¶Šå¤šï¼Œæ›´é€‚ç”¨äºå­˜å‚¨å¤§é‡å°æ–‡ä»¶ã€‚è¯¥å€¼ä¸èƒ½å°äºä¸€ä¸ª<span class="hljs-keyword">blockçš„å¤§å°ï¼Œå› ä¸ºè¿™æ ·ä¼šé€ æˆinodeå¤šä½™ã€‚</span><span class="hljs-keyword"> </span>                    æ³¨æ„ï¼Œåˆ›å»ºæ–‡ä»¶ç³»ç»Ÿåè¯¥å€¼å°±ä¸èƒ½å†æ”¹å˜äº†ã€‚-c                 ï¼šåˆ›å»ºæ–‡ä»¶ç³»ç»Ÿå‰å…ˆæ£€æŸ¥è®¾å¤‡æ˜¯å¦æœ‰<span class="hljs-keyword">bad </span><span class="hljs-keyword">blocksã€‚</span><span class="hljs-keyword">-f </span>fragment-size   ï¼šæŒ‡å®šfragmentsçš„å¤§å°ï¼Œå•ä½å­—èŠ‚ã€‚-g <span class="hljs-keyword">blocks-per-groupï¼šæŒ‡å®šæ¯ä¸ªå—ç»„ä¸­çš„blockæ•°é‡ã€‚ä¸å»ºè®®ä¿®æ”¹æ­¤é¡¹ã€‚</span><span class="hljs-keyword">-G </span>number-of-groupsï¼šè¯¥é€‰é¡¹ç”¨äº<span class="hljs-keyword">ext4æ–‡ä»¶ç³»ç»Ÿ(ä¸¥æ ¼åœ°è¯´æ˜¯å¯ç”¨äº†flex_bgç‰¹æ€§)ï¼ŒæŒ‡å®šè™šæ‹Ÿå—ç»„(å³ä¸€ä¸ªextent)ä¸­åŒ…å«çš„å—ç»„ä¸ªæ•°ï¼Œå¿…é¡»ä¸º2çš„å¹‚æ¬¡æ–¹ã€‚</span><span class="hljs-keyword"> </span>                    å¯¹äº<span class="hljs-keyword">ext4æ–‡ä»¶ç³»ç»Ÿæ¥è¯´ï¼Œä½¿ç”¨extentçš„åŠŸèƒ½èƒ½æå¤§æå‡å…¶æ€§èƒ½ã€‚</span><span class="hljs-keyword">-j </span>                ï¼šåˆ›å»ºå¸¦æœ‰æ—¥å¿—åŠŸèƒ½çš„æ–‡ä»¶ç³»ç»Ÿï¼Œå³<span class="hljs-keyword">ext3ã€‚å¦‚æœè¦æŒ‡å®šå…³äºæ—¥å¿—æ–¹é¢çš„è®¾ç½®ï¼Œåœ¨-jçš„åŸºç¡€ä¸Šå†ä½¿ç”¨-JæŒ‡å®šï¼Œä¸è¿‡ä¸€èˆ¬é»˜è®¤å³å¯ï¼Œå…·ä½“å¯</span><span class="hljs-keyword"> </span>                    æŒ‡å®šçš„é€‰é¡¹çœ‹manæ–‡æ¡£ã€‚ -L new-volume-labelï¼šæŒ‡å®šå·æ ‡åç§°ï¼Œåç§°ä¸å¾—è¶…å‡º<span class="hljs-number">16</span>å­—èŠ‚ã€‚-m reserved-<span class="hljs-keyword">blocks-percentageï¼šæŒ‡å®šæ–‡ä»¶ç³»ç»Ÿä¿ç•™blockæ•°é‡çš„æ¯”ä¾‹ï¼Œä¿ç•™ä¸€éƒ¨åˆ†blockï¼Œå¯ä»¥é™ä½ç‰©ç†ç¢ç‰‡ã€‚é»˜è®¤æ¯”ä¾‹ä¸º5%ã€‚</span><span class="hljs-keyword">-N </span>number-of-inodes ï¼šå¼ºåˆ¶æŒ‡å®šè¯¥æ–‡ä»¶ç³»ç»Ÿåº”è¯¥åˆ†é…å¤šå°‘ä¸ªinodeå·ï¼Œå®ƒä¼šè¦†ç›–é€šè¿‡è®¡ç®—å¾—å‡ºinodeæ•°é‡çš„ç»“æœ(æ ¹æ®<span class="hljs-keyword">blockå¤§å°ã€æ•°é‡å’Œæ¯å¤šå°‘å­—èŠ‚åˆ†é…</span><span class="hljs-keyword"> </span>                     ä¸€ä¸ªinodeå¾—å‡ºInodeæ•°é‡)ï¼Œä½†æ˜¯ä¸å»ºè®®è¿™ä¹ˆåšã€‚-q                  ï¼šå®‰é™æ¨¡å¼ï¼Œå¯ç”¨äºè„šæœ¬ä¸­-S                  ï¼šé‡å»ºsuperblockå’Œgroup descriptionsã€‚åœ¨æ‰€æœ‰çš„superblockå’Œå¤‡ä»½çš„superblockéƒ½æŸåæ—¶æœ‰ç”¨ã€‚å®ƒä¼šé‡æ–°åˆå§‹åŒ–superblockå’Œ                      group descriptionsï¼Œä½†ä¸ä¼šæ”¹å˜inode tableã€<span class="hljs-keyword">bmapå’Œimap(è‹¥çœŸçš„æ”¹å˜ï¼Œè¯¥åˆ†åŒºæ•°æ®å°±å…¨ä¸¢äº†ï¼Œè¿˜ä¸å¦‚é‡æ–°æ ¼å¼åŒ–)ã€‚åœ¨é‡å»º</span><span class="hljs-keyword"> </span>                     superblockåï¼Œåº”è¯¥æ‰§è¡Œe<span class="hljs-symbol">2f</span>sckæ¥ä¿è¯æ–‡ä»¶ç³»ç»Ÿçš„ä¸€è‡´æ€§ã€‚ä½†è¦æ³¨æ„ï¼Œåº”è¯¥å®Œå…¨æ­£ç¡®åœ°æŒ‡å®š<span class="hljs-keyword">blockçš„å¤§å°ï¼Œå…¶æ”¹é€‰é¡¹å¹¶ä¸èƒ½å®Œå…¨ä¿</span><span class="hljs-keyword"> </span>                     è¯æ•°æ®ä¸ä¸¢å¤±ã€‚-v                  ï¼šè¾“å‡ºè¯¦ç»†æ‰§è¡Œè¿‡ç¨‹</code></pre><p><strong>æ‰€ä»¥ï¼Œæœ‰å¯èƒ½ç”¨åˆ°çš„é€‰é¡¹ä¹Ÿå°± â€œ-tâ€ æŒ‡å®šæ–‡ä»¶ç³»ç»Ÿç±»å‹ï¼Œâ€-bâ€ æŒ‡å®š block å¤§å°ï¼Œâ€-Iâ€ æŒ‡å®š inode å¤§å°ï¼Œâ€-iâ€ æŒ‡å®šåˆ†é… inode çš„æ¯”ä¾‹ã€‚</strong></p><p>ä¾‹å¦‚ï¼š</p><pre><code class="hljs routeros">[root@localhost ~]# mke2fs -t ext4 -I 256 /dev/sdb2 -b 4096mke2fs 1.41.12 (17-May-2010)Filesystem label=OS type: LinuxBlock <span class="hljs-attribute">size</span>=4096 (<span class="hljs-attribute">log</span>=2)Fragment <span class="hljs-attribute">size</span>=4096 (<span class="hljs-attribute">log</span>=2)<span class="hljs-attribute">Stride</span>=0 blocks, Stripe <span class="hljs-attribute">width</span>=0 blocks655360 inodes, 2621440 blocks131072 blocks (5.00%) reserved <span class="hljs-keyword">for</span> the super userFirst data <span class="hljs-attribute">block</span>=0Maximum filesystem <span class="hljs-attribute">blocks</span>=268435456080 block groups32768 blocks per group, 32768 fragments per group8192 inodes per groupSuperblock backups stored on blocks:        32768, 98304, 163840, 229376, 294912, 819200, 884736, 1605632Writing inode tables: done                           Creating journal (32768 blocks): doneWriting superblocks <span class="hljs-keyword">and</span> filesystem<span class="hljs-built_in"> accounting </span>information: doneThis filesystem will be automatically checked every 39 mounts <span class="hljs-keyword">or</span>180 days, whichever comes first.  Use tune2fs -c <span class="hljs-keyword">or</span> -i <span class="hljs-keyword">to</span> override.</code></pre><h1 id="æŸ¥çœ‹æ–‡ä»¶ç³»ç»ŸçŠ¶æ€ä¿¡æ¯"><a href="#æŸ¥çœ‹æ–‡ä»¶ç³»ç»ŸçŠ¶æ€ä¿¡æ¯" class="headerlink" title="æŸ¥çœ‹æ–‡ä»¶ç³»ç»ŸçŠ¶æ€ä¿¡æ¯"></a>æŸ¥çœ‹æ–‡ä»¶ç³»ç»ŸçŠ¶æ€ä¿¡æ¯</h1><h2 id="lsblk-list-block-devices"><a href="#lsblk-list-block-devices" class="headerlink" title="lsblk(list block devices)"></a>lsblk(list block devices)</h2><blockquote><p>ç”¨äºåˆ—å‡ºè®¾å¤‡åŠå…¶çŠ¶æ€ï¼Œä¸»è¦åˆ—å‡ºéç©ºçš„å­˜å‚¨è®¾å¤‡ã€‚å…¶å®å®ƒåªä¼šåˆ—å‡º/sys/dev/blockä¸­çš„ä¸»æ¬¡è®¾å¤‡å·æ–‡ä»¶ï¼Œä¸”é»˜è®¤åªåˆ—å‡ºéç©ºè®¾å¤‡ã€‚</p></blockquote><pre><code class="hljs angelscript">[<span class="hljs-symbol">root@</span>localhost ~]# lsblkNAME            MAJ:MIN RM  SIZE RO TYPE MOUNTPOINTsda               <span class="hljs-number">8</span>:<span class="hljs-number">0</span>    <span class="hljs-number">0</span>   <span class="hljs-number">20</span>G  <span class="hljs-number">0</span> disk â”œâ”€sda1            <span class="hljs-number">8</span>:<span class="hljs-number">1</span>    <span class="hljs-number">0</span>    <span class="hljs-number">1</span>G  <span class="hljs-number">0</span> part /bootâ””â”€sda2            <span class="hljs-number">8</span>:<span class="hljs-number">2</span>    <span class="hljs-number">0</span>   <span class="hljs-number">19</span>G  <span class="hljs-number">0</span> part   â”œâ”€centos-root <span class="hljs-number">253</span>:<span class="hljs-number">0</span>    <span class="hljs-number">0</span>   <span class="hljs-number">17</span>G  <span class="hljs-number">0</span> lvm  /  â””â”€centos-swap <span class="hljs-number">253</span>:<span class="hljs-number">1</span>    <span class="hljs-number">0</span>    <span class="hljs-number">2</span>G  <span class="hljs-number">0</span> lvm  [SWAP]sdb               <span class="hljs-number">8</span>:<span class="hljs-number">16</span>   <span class="hljs-number">0</span>  <span class="hljs-number">1.8</span>T  <span class="hljs-number">0</span> disk â””â”€sdb1            <span class="hljs-number">8</span>:<span class="hljs-number">17</span>   <span class="hljs-number">0</span>  <span class="hljs-number">1.8</span>T  <span class="hljs-number">0</span> part sr0              <span class="hljs-number">11</span>:<span class="hljs-number">0</span>    <span class="hljs-number">1</span>  <span class="hljs-number">4.5</span>G  <span class="hljs-number">0</span> rom</code></pre><p>å…¶ä¸­ä¸Šé¢çš„å‡ åˆ—æ„ä¹‰å¦‚ä¸‹ï¼š</p><p>NAMEï¼šè®¾å¤‡åç§°ï¼›</p><p>MAJ:MINï¼šä¸»è®¾å¤‡å·å’Œæ­¤è®¾å¤‡å·ï¼›</p><p>RMï¼šæ˜¯å¦ä¸ºå¯å¸è½½è®¾å¤‡ï¼Œ1è¡¨ç¤ºå¯å¸è½½è®¾å¤‡ã€‚å¯å¸è½½è®¾å¤‡å¦‚å…‰ç›˜ã€USBç­‰ã€‚å¹¶éèƒ½å¤Ÿumountçš„å°±æ˜¯å¯å¸è½½çš„ï¼›</p><p>SIZEï¼šè®¾å¤‡æ€»ç©ºé—´å¤§å°ï¼›</p><p>ROï¼šæ˜¯å¦ä¸ºåªè¯»ï¼›</p><p>TYPEï¼šæ˜¯ç£ç›˜diskï¼Œè¿˜æ˜¯åˆ†åŒºpartï¼Œäº¦æˆ–æ˜¯romï¼Œè¿˜æœ‰loopè®¾å¤‡ï¼›</p><p>mountpointï¼šæŒ‚è½½ç‚¹ã€‚</p><p>å¦å¤–å¸¸ç”¨çš„ä¸€ä¸ªé€‰é¡¹æ˜¯â€-fâ€ï¼Œå®ƒå¯ä»¥æŸ¥çœ‹åˆ°æ–‡ä»¶ç³»ç»Ÿç±»å‹ï¼Œå’Œæ–‡ä»¶ç³»ç»Ÿçš„uuidå’ŒæŒ‚è½½ç‚¹ï¼š</p><pre><code class="hljs angelscript">[<span class="hljs-symbol">root@</span>localhost ~]# lsblk -fNAME            FSTYPE      LABEL           UUID                                   MOUNTPOINTsda                                                                                â”œâ”€sda1          xfs                         <span class="hljs-number">39</span>b6f37f<span class="hljs-number">-531f</span><span class="hljs-number">-41</span>c2-a498-dbe216fcfc4b   /bootâ””â”€sda2          LVM2_member                 BVd9cM-wbZz-QBn3<span class="hljs-number">-8</span>IOg-A8Xc-NZ5w-u98gYr   â”œâ”€centos-root xfs                         <span class="hljs-number">0</span>a8b095d<span class="hljs-number">-743e-494</span>b-a4e3<span class="hljs-number">-1</span>dca4211d9bb   /  â””â”€centos-swap swap                        b83b56ce<span class="hljs-number">-37f</span>2<span class="hljs-number">-460</span>a-bbd1<span class="hljs-number">-8</span>d4da4624493   [SWAP]sdb                                                                                â””â”€sdb1          ext4                        <span class="hljs-number">2</span>bc92060-a128<span class="hljs-number">-4</span>ad5-bfbe<span class="hljs-number">-9</span>cfb61dc1870   sr0             iso9660     CentOS <span class="hljs-number">7</span> x86_64 <span class="hljs-number">2020</span><span class="hljs-number">-04</span><span class="hljs-number">-22</span><span class="hljs-number">-00</span><span class="hljs-number">-54</span><span class="hljs-number">-00</span><span class="hljs-number">-00</span></code></pre><p><font color=red>æ³¨ï¼šæ¯ä¸ªå·²ç»æ ¼å¼åŒ–çš„æ–‡ä»¶ç³»ç»Ÿéƒ½æœ‰å…¶ç±»å‹å’Œuuidï¼Œè€Œæ²¡æœ‰æ ¼å¼åŒ–çš„è®¾å¤‡(å¦‚/dev/sdb3)ï¼Œå°†åªæ˜¾ç¤ºä¸€ä¸ªNameç»“æœï¼Œè¡¨ç¤ºè¯¥è®¾å¤‡è¿˜æœªè¿›è¡Œæ ¼å¼åŒ–ã€‚</font></p><h2 id="blkid"><a href="#blkid" class="headerlink" title="blkid"></a>blkid</h2><p>æŸ¥çœ‹æ–‡ä»¶ç³»ç»Ÿç±»å‹å’Œuuidï¼š</p><pre><code class="hljs routeros">[root@localhost ~]# blkid/dev/sr0: <span class="hljs-attribute">UUID</span>=<span class="hljs-string">&quot;2020-04-22-00-54-00-00&quot;</span> <span class="hljs-attribute">LABEL</span>=<span class="hljs-string">&quot;CentOS 7 x86_64&quot;</span> <span class="hljs-attribute">TYPE</span>=<span class="hljs-string">&quot;iso9660&quot;</span> <span class="hljs-attribute">PTTYPE</span>=<span class="hljs-string">&quot;dos&quot;</span> /dev/sda1: <span class="hljs-attribute">UUID</span>=<span class="hljs-string">&quot;39b6f37f-531f-41c2-a498-dbe216fcfc4b&quot;</span> <span class="hljs-attribute">TYPE</span>=<span class="hljs-string">&quot;xfs&quot;</span> /dev/sda2: <span class="hljs-attribute">UUID</span>=<span class="hljs-string">&quot;BVd9cM-wbZz-QBn3-8IOg-A8Xc-NZ5w-u98gYr&quot;</span> <span class="hljs-attribute">TYPE</span>=<span class="hljs-string">&quot;LVM2_member&quot;</span> /dev/mapper/centos-root: <span class="hljs-attribute">UUID</span>=<span class="hljs-string">&quot;0a8b095d-743e-494b-a4e3-1dca4211d9bb&quot;</span> <span class="hljs-attribute">TYPE</span>=<span class="hljs-string">&quot;xfs&quot;</span> /dev/mapper/centos-swap: <span class="hljs-attribute">UUID</span>=<span class="hljs-string">&quot;b83b56ce-37f2-460a-bbd1-8d4da4624493&quot;</span> <span class="hljs-attribute">TYPE</span>=<span class="hljs-string">&quot;swap&quot;</span> /dev/sdb1: <span class="hljs-attribute">UUID</span>=<span class="hljs-string">&quot;2bc92060-a128-4ad5-bfbe-9cfb61dc1870&quot;</span> <span class="hljs-attribute">TYPE</span>=<span class="hljs-string">&quot;ext4&quot;</span></code></pre><h2 id="du"><a href="#du" class="headerlink" title="du"></a>du</h2><blockquote><p>duå‘½ä»¤ç”¨äºè¯„ä¼°æ–‡ä»¶çš„ç©ºé—´å ç”¨æƒ…å†µï¼Œå®ƒä¼šç»Ÿè®¡æ¯ä¸ªæ–‡ä»¶çš„å¤§å°ï¼Œç»Ÿè®¡æ—¶ä¼šé€’å½’ç»Ÿè®¡ç›®å½•ä¸­çš„æ–‡ä»¶ï¼Œä¹Ÿå°±æ˜¯è¯´ï¼Œå®ƒä¼šéå†æ•´ä¸ªå¾…ç»Ÿè®¡ç›®å½•ï¼Œæ‰€ä»¥ç»Ÿè®¡é€Ÿåº¦ä¸Šå¯èƒ½å¹¶ä¸ç†æƒ³ã€‚</p></blockquote><pre><code class="hljs jboss-cli">du [OPTION]<span class="hljs-string">...</span> [FILE]<span class="hljs-string">...</span>é€‰é¡¹è¯´æ˜ï¼š-a, <span class="hljs-params">--all</span>ï¼šåˆ—å‡ºç›®å½•ä¸­æ‰€æœ‰æ–‡ä»¶çš„ç»Ÿè®¡ä¿¡æ¯ï¼Œé»˜è®¤åªä¼šåˆ—å‡ºç›®å½•ä¸­å­ç›®å½•çš„ç»Ÿè®¡ä¿¡æ¯ï¼Œè€Œä¸åˆ—å‡ºæ–‡ä»¶çš„ç»Ÿè®¡ä¿¡æ¯-h, <span class="hljs-params">--human-readable</span>ï¼šäººæ€§åŒ–æ˜¾ç¤ºå¤§å°-0, <span class="hljs-params">--null</span>ï¼šä»¥ç©ºå­—ç¬¦ç»“å°¾ï¼Œå³<span class="hljs-string">&quot;\0&quot;</span>è€Œéæ¢è¡Œçš„<span class="hljs-string">&quot;\n&quot;</span>-S, <span class="hljs-params">--separate-dirs</span>ï¼šä¸åŒ…å«å­ç›®å½•çš„å¤§å°-s, <span class="hljs-params">--summarize</span>ï¼šå¯¹ç›®å½•åšæ€»çš„ç»Ÿè®¡ï¼Œä¸åˆ—å‡ºç›®å½•å†…æ–‡ä»¶çš„å¤§å°ä¿¡æ¯-c,<span class="hljs-params">--total</span>ï¼šå¯¹ç»™å‡ºçš„æ–‡ä»¶æˆ–ç›®å½•åšæ€»è®¡ã€‚åœ¨ç»Ÿè®¡éåŒä¸€ä¸ªç›®å½•æ–‡ä»¶å¤§å°æ—¶éå¸¸æœ‰ç”¨ã€‚è§ä¸‹æ–‡ä¾‹å­ã€‚-d,<span class="hljs-params">--max-depth</span>ï¼šæŒ‡å®šæ˜¾ç¤ºæ—¶çš„ç›®å½•æ·±åº¦ï¼Œé»˜è®¤ä¼šé€’å½’æ˜¾ç¤ºæ‰€æœ‰å±‚æ¬¡<span class="hljs-params">--max-depth=N</span>ï¼šåªåˆ—å‡ºç»™å®šå±‚æ¬¡çš„ç›®å½•ç»Ÿè®¡ï¼Œå¦‚æœN=0ï¼Œåˆ™ç­‰ä»·äº<span class="hljs-string">&quot;-s&quot;</span>-x, <span class="hljs-params">--one-file-system</span>ï¼šå¿½ç•¥ä¸åŒæ–‡ä»¶ç³»ç»Ÿä¸Šçš„æ–‡ä»¶ï¼Œä¸å¯¹å®ƒä»¬è¿›è¡Œç»Ÿè®¡-X, <span class="hljs-params">--exclude-from=FILE</span>ï¼šä»æ–‡ä»¶ä¸­è¯»å–è¦æ’é™¤çš„æ–‡ä»¶<span class="hljs-params">--exclude=PATTERN</span>ï¼šæŒ‡å®šè¦å¿½ç•¥ä¸ç»Ÿè®¡çš„æ–‡ä»¶</code></pre><pre><code class="hljs gradle">[root@localhost ~]# du -sh <span class="hljs-regexp">/etc/</span><span class="hljs-number">35</span>M     <span class="hljs-regexp">/etc/</span></code></pre><pre><code class="hljs gradle">[root@localhost ~]# du -ah <span class="hljs-regexp">/tmp/</span><span class="hljs-number">0</span>       <span class="hljs-regexp">/tmp/</span>.Test-unix<span class="hljs-number">0</span>       <span class="hljs-regexp">/tmp/</span>.font-unix<span class="hljs-number">0</span>       <span class="hljs-regexp">/tmp/</span>.ICE-unix<span class="hljs-number">0</span>       <span class="hljs-regexp">/tmp/</span>.XIM-unix<span class="hljs-number">0</span>       <span class="hljs-regexp">/tmp/</span>.X11-unix<span class="hljs-number">4.0</span>K    <span class="hljs-regexp">/tmp/</span>oraysl.status<span class="hljs-number">4.0</span>K    <span class="hljs-regexp">/tmp/</span>oraynewph.status<span class="hljs-number">0</span>       <span class="hljs-regexp">/tmp/</span>systemd-<span class="hljs-keyword">private</span>-dd51c630d55b47ac953c22e69a6c1240-mariadb.service-jPbRmD/tmp<span class="hljs-number">0</span>       <span class="hljs-regexp">/tmp/</span>systemd-<span class="hljs-keyword">private</span>-dd51c630d55b47ac953c22e69a6c1240-mariadb.service-jPbRmD<span class="hljs-number">8.0</span>K    <span class="hljs-regexp">/tmp/</span></code></pre><h2 id="df"><a href="#df" class="headerlink" title="df"></a>df</h2><p>df ç”¨äºæŠ¥å‘Šç£ç›˜ç©ºé—´ä½¿ç”¨ç‡ï¼Œé»˜è®¤æ˜¾ç¤ºçš„å¤§å°æ˜¯1Kå¤§å°blockæ•°é‡ï¼Œä¹Ÿå°±æ˜¯ä»¥kä¸ºå•ä½ã€‚</p><p>å’Œ du ä¸åŒçš„æ˜¯ï¼Œdf æ˜¯è¯»å–æ¯ä¸ªæ–‡ä»¶ç³»ç»Ÿçš„ superblock ä¿¡æ¯ï¼Œæ‰€ä»¥è¯„ä¼°é€Ÿåº¦éå¸¸å¿«ã€‚ç”±äºæ˜¯è¯»å– superblockï¼Œæ‰€ä»¥å¦‚æœç›®å½•ä¸‹æŒ‚è½½äº†å¦ä¸€ä¸ªæ–‡ä»¶ç³»ç»Ÿï¼Œæ˜¯ä¸ä¼šå°†æ­¤æŒ‚è½½çš„æ–‡ä»¶ç³»ç»Ÿè®¡å…¥ç›®å½•å¤§å°çš„ã€‚<strong>æ³¨æ„ï¼Œdu å’Œ df ç»Ÿè®¡çš„ç»“æœæ˜¯ä¸ä¸€æ ·çš„ã€‚</strong></p><p>å¦‚æœç”¨ df ç»Ÿè®¡æŸä¸ªæ–‡ä»¶çš„ç©ºé—´ä½¿ç”¨æƒ…å†µï¼Œå°†ä¼šè½¬è€Œç»Ÿè®¡è¯¥æ–‡ä»¶æ‰€åœ¨æ–‡ä»¶ç³»ç»Ÿçš„ç©ºé—´ä½¿ç”¨æƒ…å†µã€‚</p><pre><code class="hljs angelscript">df [OPTION]... [FILE]...é€‰é¡¹è¯´æ˜ï¼š-hï¼šäººæ€§åŒ–è½¬æ¢å¤§å°çš„æ˜¾ç¤ºå•ä½-iï¼šç»Ÿè®¡inodeä½¿ç”¨æƒ…å†µè€Œéç©ºé—´ä½¿ç”¨æƒ…å†µ-l, --localï¼šåªåˆ—å‡ºæœ¬åœ°æ–‡ä»¶ç³»ç»Ÿçš„ä½¿ç”¨æƒ…å†µï¼Œä¸åˆ—å‡ºç½‘ç»œæ–‡ä»¶ç³»ç»Ÿä¿¡æ¯-T, --print-typeï¼šåŒæ—¶è¾“å‡ºæ–‡ä»¶ç³»ç»Ÿç±»å‹-t, --type=TYPEï¼šåªåˆ—å‡ºç»™å®šæ–‡ä»¶ç³»ç»Ÿçš„ç»Ÿè®¡ä¿¡æ¯-x, --exclude-type=TYPEï¼šæŒ‡å®šä¸æ˜¾ç¤ºçš„æ–‡ä»¶ç³»ç»Ÿç±»å‹çš„ç»Ÿè®¡ä¿¡æ¯[<span class="hljs-symbol">root@</span>localhost ~]# df -hTæ–‡ä»¶ç³»ç»Ÿ                ç±»å‹      å®¹é‡  å·²ç”¨  å¯ç”¨ å·²ç”¨% æŒ‚è½½ç‚¹devtmpfs                devtmpfs  <span class="hljs-number">908</span>M     <span class="hljs-number">0</span>  <span class="hljs-number">908</span>M    <span class="hljs-number">0</span>% /devtmpfs                   tmpfs     <span class="hljs-number">919</span>M     <span class="hljs-number">0</span>  <span class="hljs-number">919</span>M    <span class="hljs-number">0</span>% /dev/shmtmpfs                   tmpfs     <span class="hljs-number">919</span>M   <span class="hljs-number">33</span>M  <span class="hljs-number">887</span>M    <span class="hljs-number">4</span>% /runtmpfs                   tmpfs     <span class="hljs-number">919</span>M     <span class="hljs-number">0</span>  <span class="hljs-number">919</span>M    <span class="hljs-number">0</span>% /sys/fs/cgroup/dev/mapper/centos-root xfs        <span class="hljs-number">17</span>G  <span class="hljs-number">2.4</span>G   <span class="hljs-number">15</span>G   <span class="hljs-number">14</span>% //dev/sda1               xfs      <span class="hljs-number">1014</span>M  <span class="hljs-number">211</span>M  <span class="hljs-number">804</span>M   <span class="hljs-number">21</span>% /boottmpfs                   tmpfs     <span class="hljs-number">184</span>M     <span class="hljs-number">0</span>  <span class="hljs-number">184</span>M    <span class="hljs-number">0</span>% /run/user/<span class="hljs-number">0</span>[<span class="hljs-symbol">root@</span>localhost ~]# df -iæ–‡ä»¶ç³»ç»Ÿ                  Inode å·²ç”¨(I) å¯ç”¨(I) å·²ç”¨(I)% æŒ‚è½½ç‚¹devtmpfs                 <span class="hljs-number">232254</span>     <span class="hljs-number">405</span>  <span class="hljs-number">231849</span>       <span class="hljs-number">1</span>% /devtmpfs                    <span class="hljs-number">235193</span>       <span class="hljs-number">1</span>  <span class="hljs-number">235192</span>       <span class="hljs-number">1</span>% /dev/shmtmpfs                    <span class="hljs-number">235193</span>     <span class="hljs-number">542</span>  <span class="hljs-number">234651</span>       <span class="hljs-number">1</span>% /runtmpfs                    <span class="hljs-number">235193</span>      <span class="hljs-number">16</span>  <span class="hljs-number">235177</span>       <span class="hljs-number">1</span>% /sys/fs/cgroup/dev/mapper/centos-root <span class="hljs-number">8910848</span>   <span class="hljs-number">78419</span> <span class="hljs-number">8832429</span>       <span class="hljs-number">1</span>% //dev/sda1                <span class="hljs-number">524288</span>     <span class="hljs-number">339</span>  <span class="hljs-number">523949</span>       <span class="hljs-number">1</span>% /boottmpfs                    <span class="hljs-number">235193</span>       <span class="hljs-number">1</span>  <span class="hljs-number">235192</span>       <span class="hljs-number">1</span>% /run/user/<span class="hljs-number">0</span></code></pre><h1 id="æŒ‚è½½å’Œå¸è½½æ–‡ä»¶ç³»ç»Ÿ"><a href="#æŒ‚è½½å’Œå¸è½½æ–‡ä»¶ç³»ç»Ÿ" class="headerlink" title="æŒ‚è½½å’Œå¸è½½æ–‡ä»¶ç³»ç»Ÿ"></a>æŒ‚è½½å’Œå¸è½½æ–‡ä»¶ç³»ç»Ÿ</h1><h2 id="mount"><a href="#mount" class="headerlink" title="mount"></a>mount</h2><blockquote><p>mountç”¨æ¥æ˜¾ç¤ºæŒ‚è½½ä¿¡æ¯æˆ–è€…è¿›è¡Œæ–‡ä»¶ç³»ç»ŸæŒ‚è½½ï¼Œå®ƒçš„åŠŸèƒ½åŠå…¶çš„å¼ºå¤§(å¼ºå¤§åˆ°ç¦»è°±)ï¼Œå®ƒä¸ä»…æ”¯æŒæŒ‚è½½éå¸¸å¤šç§æ–‡ä»¶ç³»ç»Ÿï¼Œå¦‚ext/xfs/nfs/smbfs/cifs (winä¸Šçš„å…±äº«ç›®å½•)ç­‰ï¼Œè¿˜æ”¯æŒå…±äº«æŒ‚è½½ç‚¹ã€ç»§æ‰¿æŒ‚è½½ç‚¹(çˆ¶å­å…³ç³»)ã€ç»‘å®šæŒ‚è½½ç‚¹ã€ç§»åŠ¨æŒ‚è½½ç‚¹ç­‰ç­‰åŠŸèƒ½ã€‚åœ¨æœ¬æ–‡åªä»‹ç»å…¶æœ€ç®€å•çš„æŒ‚è½½åŠŸèƒ½ã€‚</p></blockquote><pre><code class="hljs routeros">mount # å°†æ˜¾ç¤ºå½“å‰å·²æŒ‚è½½ä¿¡æ¯mount [-t æ¬²æŒ‚è½½æ–‡ä»¶ç³»ç»Ÿç±»å‹ ] [-o ç‰¹æ®Šé€‰é¡¹] è®¾å¤‡å æŒ‚è½½ç›®å½•é€‰é¡¹è¯´æ˜ï¼š-a  å°†/etc/fstabæ–‡ä»¶é‡ŒæŒ‡å®šçš„æŒ‚è½½é€‰é¡¹é‡æ–°æŒ‚è½½ä¸€éã€‚-t  æ”¯æŒext2/ext3/ext4/vfat/fat/iso9660(å…‰ç›˜é»˜è®¤æ ¼å¼)ã€‚ ä¸ç”¨-tæ—¶é»˜è®¤ä¼šè°ƒç”¨blkidæ¥è·å–æ–‡ä»¶ç³»ç»Ÿç±»å‹ã€‚-n  ä¸æŠŠæŒ‚è½½è®°å½•å†™åœ¨/etc/mtabæ–‡ä»¶ä¸­ï¼Œä¸€èˆ¬æŒ‚è½½ä¼šåœ¨/proc/mountsä¸­è®°å½•ä¸‹æŒ‚è½½ä¿¡æ¯ï¼Œç„¶ååŒæ­¥åˆ°/etc/mtabï¼ŒæŒ‡å®š-nè¡¨ç¤ºä¸åŒæ­¥è¯¥æŒ‚è½½ä¿¡æ¯ã€‚-o  æŒ‡å®šæŒ‚è½½ç‰¹æ®Šé€‰é¡¹ã€‚ä¸‹é¢æ˜¯ä¸¤ä¸ªæ¯”è¾ƒå¸¸ç”¨çš„ï¼š    loop  æŒ‚è½½é•œåƒæ–‡ä»¶ï¼Œå¦‚isoæ–‡ä»¶    ro  åªè¯»æŒ‚è½½    rw  è¯»å†™æŒ‚è½½    auto  ç›¸å½“äºmount -a    dev å¦‚æœæŒ‚è½½çš„æ–‡ä»¶ç³»ç»Ÿä¸­æœ‰è®¾å¤‡è®¿é—®å…¥å£åˆ™å¯ç”¨å®ƒï¼Œä½¿å…¶å¯ä»¥ä½œä¸ºè®¾å¤‡è®¿é—®å…¥å£   <span class="hljs-built_in"> default </span>rw,suid,dev,exec,auto,nouser,async,<span class="hljs-keyword">and</span> relatime    async   å¼‚æ­¥æŒ‚è½½ï¼Œåªå†™åˆ°å†…å­˜    sync    åŒæ­¥æŒ‚è½½ï¼Œé€šè¿‡æŒ‚è½½ä½ç½®å†™å…¥å¯¹æ–¹ç¡¬ç›˜    atime   ä¿®æ”¹è®¿é—®æ—¶é—´ï¼Œæ¯æ¬¡è®¿é—®éƒ½ä¿®æ”¹atimeä¼šå¯¼è‡´æ€§èƒ½é™ä½ï¼Œæ‰€ä»¥é»˜è®¤æ˜¯noatime    noatime ä¸ä¿®æ”¹è®¿é—®æ—¶é—´ï¼Œé«˜å¹¶å‘æ—¶ä½¿ç”¨è¿™ä¸ªé€‰é¡¹å¯ä»¥å‡å°‘ç£ç›˜IO    nodiratime  ä¸ä¿®æ”¹æ–‡ä»¶å¤¹è®¿é—®æ—¶é—´ï¼Œé«˜å¹¶å‘æ—¶ä½¿ç”¨è¿™ä¸ªé€‰é¡¹å¯ä»¥å‡å°‘ç£ç›˜IO    exec/noexec  æŒ‚è½½åçš„æ–‡ä»¶ç³»ç»Ÿé‡Œçš„å¯æ‰§è¡Œç¨‹åºæ˜¯å¦å¯æ‰§è¡Œï¼Œé»˜è®¤æ˜¯å¯ä»¥æ‰§è¡Œexecï¼Œ ä¼˜å…ˆçº§é«˜äºæƒé™çš„é™å®š    remount  é‡æ–°æŒ‚è½½ï¼Œæ­¤æ—¶å¯ä»¥ä¸ç”¨æŒ‡å®šæŒ‚è½½ç‚¹ã€‚    suid/nosuid å¯¹æŒ‚è½½çš„æ–‡ä»¶ç³»ç»Ÿå¯ç”¨æˆ–ç¦ç”¨suidï¼Œå¯¹äºå¤–æ¥è®¾å¤‡æœ€å¥½ç¦ç”¨suid    _netdev éœ€è¦ç½‘ç»œæŒ‚è½½æ—¶é»˜è®¤å°†åœç•™åœ¨æŒ‚è½½ç•Œé¢ç›´åˆ°åŠ è½½ç½‘ç»œäº†ã€‚ä½¿ç”¨_netdevå¯ä»¥å¿½ç•¥ç½‘ç»œæ­£å¸¸æŒ‚è½½ã€‚å¦‚NFSå¼€æœºæŒ‚è½½ã€‚   <span class="hljs-built_in"> user </span> å…è®¸æ™®é€šç”¨æˆ·è¿›è¡ŒæŒ‚è½½è¯¥ç›®å½•ï¼Œä½†åªå…è®¸æŒ‚è½½è€…è¿›è¡Œå¸è½½è¯¥ç›®å½•   <span class="hljs-built_in"> users </span> å…è®¸æ‰€æœ‰ç”¨æˆ·æŒ‚è½½å’Œå¸è½½è¯¥ç›®å½•    nouser  ç¦æ­¢æ™®é€šç”¨æˆ·æŒ‚è½½å’Œå¸è½½è¯¥ç›®å½•ï¼Œè¿™æ˜¯é»˜è®¤çš„ï¼Œé»˜è®¤æƒ…å†µä¸‹ä¸€ä¸ªç›®å½•ä¸æŒ‡å®šuser/usersæ—¶ï¼Œå°†åªæœ‰rootèƒ½æŒ‚è½½</code></pre><p>ä½¿ç”¨å®ä¾‹ï¼š</p><p><strong>(1).æŒ‚è½½CentOSçš„å®‰è£…é•œåƒåˆ°/mntã€‚</strong></p><pre><code class="hljs awk">mount <span class="hljs-regexp">/dev/</span>cdrom /mnt</code></pre><p><strong>(2).é‡æ–°æŒ‚è½½ã€‚</strong></p><pre><code class="hljs apache"><span class="hljs-attribute">mount</span> -t ext<span class="hljs-number">4</span> -o remount /dev/sdb<span class="hljs-number">1</span> /data<span class="hljs-number">1</span></code></pre><p><strong>(3).é‡æ–°æŒ‚è½½æ–‡ä»¶ç³»ç»Ÿä¸ºå¯è¯»å†™</strong></p><pre><code class="hljs apache"><span class="hljs-attribute">mount</span> -t ext<span class="hljs-number">4</span> -o rw remount /dev/sdb<span class="hljs-number">1</span> /data<span class="hljs-number">1</span></code></pre><p><strong>(4).æŒ‚è½½windowsçš„å…±äº«ç›®å½•ã€‚</strong></p><p>winä¸Šå…±äº«æ–‡ä»¶çš„æ–‡ä»¶ç³»ç»Ÿæ˜¯cifsç±»å‹ï¼Œè¦åœ¨Linuxä¸ŠæŒ‚è½½ï¼Œå¿…é¡»å¾—æœ‰mount.cifså‘½ä»¤ï¼Œå¦‚æœæ²¡æœ‰åˆ™å®‰è£…cifs-utilsåŒ…ã€‚</p><p>å‡è®¾winä¸Šå…±äº«ç›®å½•çš„uncè·¯å¾„ä¸º\192.168.100.8\testï¼Œå…±äº«ç»™çš„ç”¨æˆ·åå’Œå¯†ç åˆ†åˆ«ä¸ºlong3:123ï¼Œè¦æŒ‚åœ¨linuxä¸Šçš„/mydataç›®å½•ä¸Šã€‚</p><pre><code class="hljs awk">mount.cifs -o username=<span class="hljs-string">&quot;long3&quot;</span>,password=<span class="hljs-string">&quot;123&quot;</span> <span class="hljs-regexp">//</span><span class="hljs-number">192.168</span>.<span class="hljs-number">100.8</span><span class="hljs-regexp">/test /my</span>data</code></pre><p>æ³¨æ„ï¼Œå¦‚æœæ˜¯æ¯”è¾ƒæ–°ç‰ˆæœ¬çš„win10(2017å¹´ä¹‹åæ›´æ–°çš„ç‰ˆæœ¬)æˆ–è¾ƒæ–°ç‰ˆæœ¬çš„win serverï¼Œç›´æ¥mount.cifsä¼šæŠ¥é”™ï¼š</p><pre><code class="hljs angelscript">[<span class="hljs-symbol">root@</span>localhost ~]# mount.cifs -o username=<span class="hljs-string">&quot;long3&quot;</span>,password=<span class="hljs-string">&quot;123&quot;</span> <span class="hljs-comment">//192.168.100.8/test /mnt         </span>mount error(<span class="hljs-number">112</span>): Host <span class="hljs-keyword">is</span> downRefer to the mount.cifs(<span class="hljs-number">8</span>) manual page (e.g. man mount.cifs)</code></pre><p>è¿™æ˜¯å› ä¸º2017å¹´å¾®è½¯çš„ä¸€ä¸ªè¡¥ä¸ç¦ç”¨äº†SMBv1åè®®ï¼Œé€šè¿‡smbclientçš„æŠ¥å‘Šå¯çŸ¥ï¼š</p><pre><code class="hljs autoit">[root<span class="hljs-symbol">@localhost</span> ~]<span class="hljs-meta"># yum -y install samba-client</span>[root<span class="hljs-symbol">@localhost</span> ~]<span class="hljs-meta"># smbclient -L //192.168.100.8</span>Enter root<span class="hljs-string">&#x27;s password: </span><span class="hljs-string">protocol negotiation failed: NT_STATUS_CONNECTION_RESET</span></code></pre><p>å› æ­¤ï¼Œåœ¨mountçš„æ—¶å€™æŒ‡å®šcifs(SMB)çš„ç‰ˆæœ¬å·ä¸º2.0å³å¯ï¼š</p><pre><code class="hljs cpp">[root@localhost ~]<span class="hljs-meta"># mount.cifs -o username=<span class="hljs-meta-string">&quot;long3&quot;</span>,password=<span class="hljs-meta-string">&quot;123&quot;</span>,vers=2.0 <span class="hljs-comment">//192.168.100.8/test /mnt</span></span></code></pre><h2 id="æŒ‚è½½é•œåƒæ–‡ä»¶"><a href="#æŒ‚è½½é•œåƒæ–‡ä»¶" class="headerlink" title="æŒ‚è½½é•œåƒæ–‡ä»¶"></a>æŒ‚è½½é•œåƒæ–‡ä»¶</h2><p>æœ‰æ—¶å€™éœ€è¦æŒ‚è½½CentOSçš„é•œåƒæ–‡ä»¶ï¼Œåœ¨è™šæ‹Ÿæœºä¸­ç»å¸¸æ˜¯å°†é•œåƒæ”¾å…¥è™šæ‹Ÿæœºçš„CD/DVDè™šæ‹Ÿå…‰é©±ä¸­ï¼Œç„¶ååœ¨Linuxä¸Šå¯¹/dev/cdromè¿›è¡ŒæŒ‚è½½ã€‚å…¶å®/dev/cdromæ˜¯/dev/sr0çš„ä¸€ä¸ªè½¯é“¾æ¥ï¼Œ/dev/sr0æ˜¯Linuxä¸­çš„å…‰é©±ï¼Œæ‰€ä»¥ä¸Šé¢çš„è¿‡ç¨‹ç›¸å½“äºæ˜¯å°†é•œåƒæ–‡ä»¶é€šè¿‡è™šæ‹Ÿè½¯ä»¶çš„è™šæ‹Ÿå…‰é©±å’Œlinuxçš„å…‰é©±è¿æ¥èµ·æ¥ï¼Œè¿™æ ·åªéœ€è¦æŒ‚è½½Linuxä¸­çš„å…‰é©±å°±å¯ä»¥äº†ã€‚ä½†æ˜¯ï¼Œåœ¨éè™šæ‹Ÿç¯å¢ƒä¸­æ²¡æœ‰è™šæ‹Ÿå…‰é©±ï¼Œè€Œä¸”åœ¨Linuxä¸­çš„ä¸€ä¸ªé•œåƒæ–‡ä»¶éš¾é“ä¸€å®šè¦æ‹·è´åˆ°ä¸»æœºä¸Šé€šè¿‡è™šæ‹Ÿå…‰é©±è¿›è¡Œè¿æ¥å—ï¼Ÿ</p><p>mountæ˜¯ä¸€ä¸ªæå…¶å¼ºå¤§çš„æŒ‚è½½å·¥å…·ï¼Œå®ƒæ”¯æŒæŒ‚è½½å¾ˆå¤šç§æ–‡ä»¶ç±»å‹ï¼Œå…¶ä¸­å°±æ”¯æŒæŒ‚è½½é•œåƒæ–‡ä»¶ï¼Œå…¶å®å®ƒè¿æŒ‚è½½ç›®å½•éƒ½æ”¯æŒã€‚</p><pre><code class="hljs angelscript">mount -o loop CentOS<span class="hljs-number">-6.6</span>-x86_64-bin-DVD2.iso /mnt[<span class="hljs-symbol">root@</span>localhost ~]# lsblkNAME     MAJ:MIN RM   SIZE RO TYPE MOUNTPOINTloop0      <span class="hljs-number">7</span>:<span class="hljs-number">0</span>    <span class="hljs-number">0</span>   <span class="hljs-number">1.2</span>G  <span class="hljs-number">0</span> loop /mntsda        <span class="hljs-number">8</span>:<span class="hljs-number">0</span>    <span class="hljs-number">0</span>    <span class="hljs-number">20</span>G  <span class="hljs-number">0</span> diskâ”œâ”€sda1   <span class="hljs-number">8</span>:<span class="hljs-number">1</span>    <span class="hljs-number">0</span>   <span class="hljs-number">250</span>M  <span class="hljs-number">0</span> part /bootâ”œâ”€sda2   <span class="hljs-number">8</span>:<span class="hljs-number">2</span>    <span class="hljs-number">0</span>  <span class="hljs-number">17.8</span>G  <span class="hljs-number">0</span> part /â””â”€sda3   <span class="hljs-number">8</span>:<span class="hljs-number">3</span>    <span class="hljs-number">0</span>     <span class="hljs-number">2</span>G  <span class="hljs-number">0</span> part [SWAP]sr0       <span class="hljs-number">11</span>:<span class="hljs-number">0</span>    <span class="hljs-number">1</span>  <span class="hljs-number">1024</span>M  <span class="hljs-number">0</span> rom</code></pre><h2 id="umount"><a href="#umount" class="headerlink" title="umount"></a>umount</h2><pre><code class="hljs properties"><span class="hljs-attr">umount</span> <span class="hljs-string">è®¾å¤‡åæˆ–æŒ‚è½½ç›®å½•</span><span class="hljs-attr">umount</span> <span class="hljs-string">-lf å¼ºåˆ¶å¸è½½</span></code></pre><h2 id="å¼€æœºè‡ªåŠ¨æŒ‚è½½-etc-fstab"><a href="#å¼€æœºè‡ªåŠ¨æŒ‚è½½-etc-fstab" class="headerlink" title="å¼€æœºè‡ªåŠ¨æŒ‚è½½/etc/fstab"></a>å¼€æœºè‡ªåŠ¨æŒ‚è½½/etc/fstab</h2><p>é€šè¿‡å°†æŒ‚è½½é€‰é¡¹å†™å…¥åˆ° /etc/fstab ä¸­ï¼Œç³»ç»Ÿä¼šè‡ªåŠ¨æŒ‚è½½è¯¥æ–‡ä»¶ä¸­çš„é…ç½®é¡¹ã€‚ä½†è¦æ³¨æ„ï¼Œè¯¥æ–‡ä»¶åœ¨å¼€æœºçš„å‰å‡ ä¸ªè¿‡ç¨‹ä¸­å°±è¢«è¯»å–ï¼Œæ‰€ä»¥é…ç½®é”™è¯¯å¾ˆå¯èƒ½ä¼šå¯¼è‡´å¼€æœºå¤±è´¥ã€‚</p><pre><code class="hljs angelscript">[<span class="hljs-symbol">root@</span>localhost ~]# cat /etc/fstab ## /etc/fstab# Created by anaconda on Sat Jun  <span class="hljs-number">6</span> <span class="hljs-number">20</span>:<span class="hljs-number">09</span>:<span class="hljs-number">07</span> <span class="hljs-number">2020</span>## Accessible filesystems, by <span class="hljs-built_in">ref</span>erence, are maintained under <span class="hljs-string">&#x27;/dev/disk&#x27;</span># See man pages fstab(<span class="hljs-number">5</span>), findfs(<span class="hljs-number">8</span>), mount(<span class="hljs-number">8</span>) <span class="hljs-keyword">and</span>/<span class="hljs-keyword">or</span> blkid(<span class="hljs-number">8</span>) <span class="hljs-keyword">for</span> more info#/dev/mapper/centos-root /                       xfs     defaults        <span class="hljs-number">0</span> <span class="hljs-number">0</span>UUID=<span class="hljs-number">39</span>b6f37f<span class="hljs-number">-531f</span><span class="hljs-number">-41</span>c2-a498-dbe216fcfc4b /boot                   xfs     defaults        <span class="hljs-number">0</span> <span class="hljs-number">0</span>/dev/mapper/centos-swap swap                    swap    defaults        <span class="hljs-number">0</span> <span class="hljs-number">0</span></code></pre><p>å…¶ä¸­æœ€åä¸¤åˆ—ï¼Œå®ƒä»¬åˆ†åˆ«è¡¨ç¤ºå¤‡ä»½æ–‡ä»¶ç³»ç»Ÿå’Œå¼€æœºè‡ªæ£€ï¼Œä¸€èˆ¬éƒ½å¯ä»¥è®¾ç½®ä¸º0ã€‚</p><p>ç”±äºèƒ½ç”¨çš„å¤‡ä»½å·¥å…·ä¼—å¤šï¼Œæ²¡äººä¼šåœ¨è¿™é‡Œè®¾ç½®å¤‡ä»½ï¼Œæ‰€ä»¥å¤‡ä»½åˆ—è®¾ç½®ä¸º0ã€‚</p><p>æœ€åä¸€åˆ—æ˜¯å¼€æœºè‡ªæ£€è®¾ç½®åˆ—ï¼Œå¼€æœºè‡ªæ£€è°ƒç”¨çš„æ˜¯fsckç¨‹åºï¼Œæ‰€æœ‰æœ‰äº›extç±»æ–‡ä»¶ç³»ç»Ÿä½œä¸ºâ€/â€œæ—¶ï¼Œå¯èƒ½ä¼šè®¾ç½®ä¸º1ï¼Œä½†æ˜¯fsckæ˜¯ä¸æ”¯æŒxfsæ–‡ä»¶ç³»ç»Ÿçš„ï¼Œæ‰€ä»¥å¯¹äºxfsæ–‡ä»¶ç³»ç»Ÿè€Œè¨€ï¼Œè¯¥é¡¹å¿…é¡»è®¾ç½®ä¸º0ã€‚</p><p>å…¶å®æ— éœ€è€ƒè™‘é‚£ä¹ˆå¤šï¼Œç›´æ¥å°†è¿™ä¸¤åˆ—è®¾ç½®ä¸º0å°±å¯ä»¥äº†ã€‚</p><h2 id="ä¿®å¤é”™è¯¯çš„-etc-fstab"><a href="#ä¿®å¤é”™è¯¯çš„-etc-fstab" class="headerlink" title="ä¿®å¤é”™è¯¯çš„/etc/fstab"></a>ä¿®å¤é”™è¯¯çš„/etc/fstab</h2><p>ä¸‡ä¸€ /etc/fstab é…ç½®é”™è¯¯ï¼Œå¯¼è‡´å¼€æœºæ— æ³•åŠ è½½ã€‚è¿™æ—¶æç¤ºè¾“å…¥ root å¯†ç è¿›å…¥å•äººç»´æŠ¤æ¨¡å¼ï¼Œåªä¸è¿‡å•äººæ¨¡å¼ä¸‹æ ¹æ–‡ä»¶ç³»ç»Ÿæ˜¯åªè¯»çš„ï¼Œå“ªæ€•æ˜¯ root ä¹Ÿæ— æ³•ç›´æ¥ä¿®æ”¹ /etc/fstabï¼Œæ‰€ä»¥åº”è¯¥å°†â€/â€œæ–‡ä»¶ç³»ç»Ÿè¿›è¡Œé‡æ–°æŒ‚è½½ã€‚</p><p>æ‰§è¡Œä¸‹é¢çš„å‘½ä»¤ï¼Œé‡æŒ‚è½½æ ¹åˆ†åŒºï¼Œå¹¶ç»™è¯»å†™æƒé™ï¼Œå†å»ä¿®æ”¹é”™è¯¯çš„ fstab æ–‡ä»¶è®°å½•ï¼Œå†é‡å¯ã€‚</p><pre><code class="hljs excel">mount -<span class="hljs-built_in">n</span> -o remount,rw /</code></pre><h1 id="SWAP-åˆ†åŒº"><a href="#SWAP-åˆ†åŒº" class="headerlink" title="SWAP åˆ†åŒº"></a>SWAP åˆ†åŒº</h1><h2 id="æŸ¥çœ‹å“ªä¸ªåˆ†åŒºåœ¨å……å½“-swap-åˆ†åŒº"><a href="#æŸ¥çœ‹å“ªä¸ªåˆ†åŒºåœ¨å……å½“-swap-åˆ†åŒº" class="headerlink" title="æŸ¥çœ‹å“ªä¸ªåˆ†åŒºåœ¨å……å½“ swap åˆ†åŒº"></a>æŸ¥çœ‹å“ªä¸ªåˆ†åŒºåœ¨å……å½“ swap åˆ†åŒº</h2><pre><code class="hljs angelscript">[<span class="hljs-symbol">root@</span>localhost ~]# lsblkNAME            MAJ:MIN RM  SIZE RO TYPE MOUNTPOINTsda               <span class="hljs-number">8</span>:<span class="hljs-number">0</span>    <span class="hljs-number">0</span>   <span class="hljs-number">20</span>G  <span class="hljs-number">0</span> disk â”œâ”€sda1            <span class="hljs-number">8</span>:<span class="hljs-number">1</span>    <span class="hljs-number">0</span>    <span class="hljs-number">1</span>G  <span class="hljs-number">0</span> part /bootâ””â”€sda2            <span class="hljs-number">8</span>:<span class="hljs-number">2</span>    <span class="hljs-number">0</span>   <span class="hljs-number">19</span>G  <span class="hljs-number">0</span> part   â”œâ”€centos-root <span class="hljs-number">253</span>:<span class="hljs-number">0</span>    <span class="hljs-number">0</span>   <span class="hljs-number">17</span>G  <span class="hljs-number">0</span> lvm  /  â””â”€centos-swap <span class="hljs-number">253</span>:<span class="hljs-number">1</span>    <span class="hljs-number">0</span>    <span class="hljs-number">2</span>G  <span class="hljs-number">0</span> lvm  [SWAP]sdb               <span class="hljs-number">8</span>:<span class="hljs-number">16</span>   <span class="hljs-number">0</span>  <span class="hljs-number">1.8</span>T  <span class="hljs-number">0</span> disk â””â”€sdb1            <span class="hljs-number">8</span>:<span class="hljs-number">17</span>   <span class="hljs-number">0</span>  <span class="hljs-number">1.8</span>T  <span class="hljs-number">0</span> part sr0              <span class="hljs-number">11</span>:<span class="hljs-number">0</span>    <span class="hljs-number">1</span>  <span class="hljs-number">4.5</span>G  <span class="hljs-number">0</span> rom [<span class="hljs-symbol">root@</span>localhost ~]# swapon  -sæ–‡ä»¶å                          ç±»å‹            å¤§å°    å·²ç”¨    æƒé™/dev/dm<span class="hljs-number">-1</span>                               partition       <span class="hljs-number">2097148</span> <span class="hljs-number">0</span>       <span class="hljs-number">-2</span></code></pre><h2 id="æ·»åŠ -swap-åˆ†åŒº"><a href="#æ·»åŠ -swap-åˆ†åŒº" class="headerlink" title="æ·»åŠ  swap åˆ†åŒº"></a>æ·»åŠ  swap åˆ†åŒº</h2><p>(1).å¯ä»¥æ–°åˆ†ä¸€ä¸ªåŒºï¼Œåœ¨åˆ†åŒºæ—¶æŒ‡å®šå…¶åˆ†åŒºçš„IDå·ä¸ºSWAPç±»å‹ã€‚</p><p>(2).æ ¼å¼åŒ–ä¸ºswapåˆ†åŒºï¼šmkswap</p><pre><code class="hljs angelscript">[<span class="hljs-symbol">root@</span>localhost ~]# mkswap /dev/sdb5Setting up swapspace version <span class="hljs-number">1</span>, size = <span class="hljs-number">1951096</span> KiBno label, UUID=<span class="hljs-number">02e5</span>af44<span class="hljs-number">-2</span>a16<span class="hljs-number">-479</span>d-b689<span class="hljs-number">-4e100</span>af6adf5</code></pre><p>(3).åŠ å…¥swapåˆ†åŒºç©ºé—´(swapon)ï¼š</p><pre><code class="hljs yaml">[<span class="hljs-string">root@localhost</span> <span class="hljs-string">~</span>]<span class="hljs-comment"># swapon /dev/sdb5  </span>[<span class="hljs-string">root@localhost</span> <span class="hljs-string">~</span>]<span class="hljs-comment"># free -m</span>             <span class="hljs-string">total</span>       <span class="hljs-string">used</span>       <span class="hljs-string">free</span>     <span class="hljs-string">shared</span>    <span class="hljs-string">buffers</span>     <span class="hljs-string">cached</span><span class="hljs-attr">Mem:</span>          <span class="hljs-number">1861        </span><span class="hljs-number">343</span>       <span class="hljs-number">1517          </span><span class="hljs-number">0</span>         <span class="hljs-number">16</span>        <span class="hljs-number">196</span><span class="hljs-string">-/+</span> <span class="hljs-attr">buffers/cache:</span>        <span class="hljs-number">131</span>       <span class="hljs-number">1730</span><span class="hljs-attr">Swap:</span>         <span class="hljs-number">3953          </span><span class="hljs-number">0</span>       <span class="hljs-number">3953</span></code></pre><p>(4).å–æ¶ˆswapåˆ†åŒºç©ºé—´(swapoff)ï¼š</p><pre><code class="hljs yaml">[<span class="hljs-string">root@xuexi</span> <span class="hljs-string">~</span>]<span class="hljs-comment"># swapoff /dev/sdb5</span>[<span class="hljs-string">root@xuexi</span> <span class="hljs-string">~</span>]<span class="hljs-comment"># free -m</span>             <span class="hljs-string">total</span>       <span class="hljs-string">used</span>       <span class="hljs-string">free</span>     <span class="hljs-string">shared</span>    <span class="hljs-string">buffers</span>     <span class="hljs-string">cached</span><span class="hljs-attr">Mem:</span>          <span class="hljs-number">1861        </span><span class="hljs-number">343</span>       <span class="hljs-number">1518          </span><span class="hljs-number">0</span>         <span class="hljs-number">16</span>        <span class="hljs-number">196</span><span class="hljs-string">-/+</span> <span class="hljs-attr">buffers/cache:</span>        <span class="hljs-number">130</span>       <span class="hljs-number">1731</span><span class="hljs-attr">Swap:</span>            <span class="hljs-number">0</span>          <span class="hljs-number">0</span>          <span class="hljs-number">0</span></code></pre><p>(5).å¼€æœºè‡ªåŠ¨åŠ è½½swapåˆ†åŒºï¼š</p><p>ä¿®æ”¹/etc/fstabï¼ŒåŠ ä¸Šä¸€è¡Œ</p><pre><code class="hljs angelscript">/dev/sda5    swap    swap    defaults    <span class="hljs-number">0</span>    <span class="hljs-number">0</span></code></pre><blockquote><p>å­¦ä¹ äº[<a href="https://www.cnblogs.com/f-ck-need-u/">éªé©¬é‡‘é¾™</a>]</p></blockquote>]]></content>
    
    
    <categories>
      
      <category>Linux</category>
      
    </categories>
    
    
    <tags>
      
      <tag>Linux</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>Linux å¼€æœºè¯¦ç»†æµç¨‹</title>
    <link href="/2020/06/01/Linux_boot/"/>
    <url>/2020/06/01/Linux_boot/</url>
    
    <content type="html"><![CDATA[<p>TODOâ€¦.</p>]]></content>
    
    
    <categories>
      
      <category>Linux</category>
      
    </categories>
    
    
    <tags>
      
      <tag>Linux</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>Linux ç®€å•å†…æ ¸ä¼˜åŒ–</title>
    <link href="/2020/05/13/kernel_modify/"/>
    <url>/2020/05/13/kernel_modify/</url>
    
    <content type="html"><![CDATA[<h1 id="ulimit"><a href="#ulimit" class="headerlink" title="ulimit"></a>ulimit</h1><p>ulimit ä¸º shell å†…å»ºæŒ‡ä»¤ï¼Œå¯ç”¨æ¥æ§åˆ¶shellæ‰§è¡Œç¨‹åºçš„èµ„æºã€‚</p><pre><code class="hljs less"><span class="hljs-selector-attr">[root@localhost ~]</span># <span class="hljs-selector-tag">ulimit</span> <span class="hljs-selector-tag">-a</span><span class="hljs-selector-tag">core</span> <span class="hljs-selector-tag">file</span> <span class="hljs-selector-tag">size</span>          (blocks, -c) <span class="hljs-selector-tag">0</span><span class="hljs-selector-tag">data</span> <span class="hljs-selector-tag">seg</span> <span class="hljs-selector-tag">size</span>           (kbytes, -d) <span class="hljs-selector-tag">unlimited</span><span class="hljs-selector-tag">scheduling</span> <span class="hljs-selector-tag">priority</span>             (-e) <span class="hljs-selector-tag">0</span><span class="hljs-selector-tag">file</span> <span class="hljs-selector-tag">size</span>               (blocks, -f) <span class="hljs-selector-tag">unlimited</span><span class="hljs-selector-tag">pending</span> <span class="hljs-selector-tag">signals</span>                 (-i) <span class="hljs-selector-tag">7257</span><span class="hljs-selector-tag">max</span> <span class="hljs-selector-tag">locked</span> <span class="hljs-selector-tag">memory</span>       (kbytes, -l) <span class="hljs-selector-tag">64</span><span class="hljs-selector-tag">max</span> <span class="hljs-selector-tag">memory</span> <span class="hljs-selector-tag">size</span>         (kbytes, -m) <span class="hljs-selector-tag">unlimited</span><span class="hljs-selector-tag">open</span> <span class="hljs-selector-tag">files</span>                      (-n) <span class="hljs-selector-tag">1024</span><span class="hljs-selector-tag">pipe</span> <span class="hljs-selector-tag">size</span>            (<span class="hljs-number">512</span> bytes, -p) <span class="hljs-selector-tag">8</span><span class="hljs-selector-tag">POSIX</span> <span class="hljs-selector-tag">message</span> <span class="hljs-selector-tag">queues</span>     (bytes, -q) <span class="hljs-selector-tag">819200</span><span class="hljs-selector-tag">real-time</span> <span class="hljs-selector-tag">priority</span>              (-r) <span class="hljs-selector-tag">0</span><span class="hljs-selector-tag">stack</span> <span class="hljs-selector-tag">size</span>              (kbytes, -s) <span class="hljs-selector-tag">8192</span><span class="hljs-selector-tag">cpu</span> <span class="hljs-selector-tag">time</span>               (seconds, -t) <span class="hljs-selector-tag">unlimited</span><span class="hljs-selector-tag">max</span> <span class="hljs-selector-tag">user</span> <span class="hljs-selector-tag">processes</span>              (-u) <span class="hljs-selector-tag">7257</span><span class="hljs-selector-tag">virtual</span> <span class="hljs-selector-tag">memory</span>          (kbytes, -v) <span class="hljs-selector-tag">unlimited</span><span class="hljs-selector-tag">file</span> <span class="hljs-selector-tag">locks</span>                      (-x) <span class="hljs-selector-tag">unlimited</span></code></pre><a id="more"></a><h2 id="core-file-size"><a href="#core-file-size" class="headerlink" title="core file size"></a>core file size</h2><p>core æ–‡ä»¶å…¶å®å°±æ˜¯å†…å­˜çš„æ˜ åƒï¼Œå½“ç¨‹åºå´©æºƒæ—¶ï¼Œå­˜å‚¨å†…å­˜çš„ç›¸åº”ä¿¡æ¯ï¼Œä¸»ç”¨ç”¨äºå¯¹ç¨‹åºè¿›è¡Œè°ƒè¯•ã€‚å½“ç¨‹åºå´©æºƒæ—¶ä¾¿ä¼šäº§ç”Ÿ core æ–‡ä»¶ï¼Œå…¶å®å‡†ç¡®çš„åº”è¯¥è¯´æ˜¯ core dump æ–‡ä»¶,é»˜è®¤ç”Ÿæˆä½ç½®ä¸å¯æ‰§è¡Œç¨‹åºä½äºåŒä¸€ç›®å½•ä¸‹ï¼Œæ–‡ä»¶åä¸º core.*** ï¼Œå…¶ä¸­***ä¸ºæ•°å­—ã€‚</p><p>å¼€å¯ core æ–‡ä»¶ç”Ÿæˆ</p><blockquote><p>æŸ¥çœ‹ core æ–‡ä»¶ç”Ÿæˆæ˜¯å¦æ‰“å¼€ï¼Œå¦‚æœä¸º0ï¼Œåˆ™è¡¨ç¤ºæ²¡æœ‰æ‰“å¼€ã€‚<br>[root@localhost ~]#  ulimit -c<br>0</p><p>ä¸´æ—¶è®¾ç½®ï¼ˆå¦‚ä¸‹è®¾ç½®2Gï¼Œå•ä½ä¸ºkbyteï¼‰<br>å¦‚æœç”Ÿæˆçš„ä¿¡æ¯è¶…è¿‡æ­¤å¤§å°ï¼Œå°†ä¼šè¢«è£å‰ªï¼Œæœ€ç»ˆç”Ÿæˆä¸€ä¸ªä¸å®Œæ•´çš„coreæ–‡ä»¶ã€‚åœ¨è°ƒè¯•æ­¤coreæ–‡ä»¶çš„æ—¶å€™ï¼Œ<strong>gdb</strong>ä¼šæç¤ºé”™è¯¯ã€‚<br>ulimit -c 4194304</p></blockquote><h2 id="file-size"><a href="#file-size" class="headerlink" title="file size"></a>file size</h2><p>æ–‡æœ¬æ–‡ä»¶æœ€å¤§å®¹é‡ï¼Œå¯ç”¨ <code>ulimit -f</code> + æ•°å­—ä¿®æ”¹ï¼Œéœ€è¦é™åˆ¶æ—¥å¿—æ–‡ä»¶å¤§å°æ—¶ï¼Œå¯ä»¥ä¿®æ”¹æ­¤é¡¹</p><h2 id="open-files"><a href="#open-files" class="headerlink" title="open files"></a>open files</h2><p>ç³»ç»Ÿæœ€å¤§æ‰“å¼€æ–‡ä»¶æ•°é‡ï¼Œå¯ç”¨<code>ulimit -n</code> + <strong>æ•°å­—</strong> æ›´æ”¹ï¼Œä¸€èˆ¬è®¾ç½®ä¸º65536</p><p><code>ulimit -n 65536</code></p><p>å¯åŠ¨ä»»ä½•è¿›ç¨‹ï¼Œéƒ½ä¼šåŠ è½½æ–‡ä»¶ã€‚é’ˆå¯¹ Web æœåŠ¡å™¨ã€åŸºäºjavaçš„æœåŠ¡ä¼šåŠ è½½æ›´å¤šçš„æ–‡ä»¶ï¼Œå¯¹äºè¿™äº›æœåŠ¡å™¨ï¼Œéœ€è¦ä¿®æ”¹æœ€å¤§æ‰“å¼€æ–‡ä»¶æ•°ã€‚</p><h2 id="max-user-processes"><a href="#max-user-processes" class="headerlink" title="max user processes"></a>max user processes</h2><p>ç”¨æˆ·å¯ä½¿ç”¨æœ€å¤šçš„è¿›ç¨‹æ•°ï¼Œå¯ç”¨<code>ulimit -u</code> + <strong>æ•°å­—</strong> æ›´æ”¹ï¼Œä¸€èˆ¬æ”¹ä¸º65536</p><p><code>ulimit -u 65536</code></p><p><strong><u>ä»¥ä¸Šä¿®æ”¹ä¸ºä¸´æ—¶ä¿®æ”¹ï¼Œéœ€è¦æ°¸ä¹…ä¿®æ”¹éœ€è¦ä¿®æ”¹é…ç½®æ–‡ä»¶<code>/etc/security/limits.conf</code></u></strong></p><p>å½“ä¿®æ”¹<code>/etc/security/limits.d/*.conf</code> ä¸‹çš„é…ç½®æ–‡ä»¶æ˜¯ï¼Œä¼šä¼˜å…ˆä½¿ç”¨æ­¤é…ç½®æ–‡ä»¶</p>]]></content>
    
    
    <categories>
      
      <category>Linux</category>
      
    </categories>
    
    
    <tags>
      
      <tag>Linux</tag>
      
      <tag>kernel</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>è§„åˆ’å’Œå®‰è£…ESXI</title>
    <link href="/2020/04/07/vSphere_esxi_deploy/"/>
    <url>/2020/04/07/vSphere_esxi_deploy/</url>
    
    <content type="html"><![CDATA[<h1 id="1-è§„åˆ’-vSphere-éƒ¨ç½²"><a href="#1-è§„åˆ’-vSphere-éƒ¨ç½²" class="headerlink" title="1. è§„åˆ’ vSphere éƒ¨ç½²"></a>1. è§„åˆ’ vSphere éƒ¨ç½²</h1><h2 id="1-1-æœåŠ¡å™¨å¹³å°"><a href="#1-1-æœåŠ¡å™¨å¹³å°" class="headerlink" title="1.1 æœåŠ¡å™¨å¹³å°"></a>1.1 æœåŠ¡å™¨å¹³å°</h2><p>æ£€æŸ¥è®¾å¤‡å…¼å®¹æ€§ï¼šå­˜å‚¨æ§åˆ¶å™¨æˆ–è€…ç½‘ç»œé€‚é…å™¨</p><p>å¯ä½¿ç”¨ VNware ç½‘ä¸Šæ”¯æŒæœç´¢çš„å…¼å®¹æŒ‡å—ï¼ˆCompatibility Guideï¼‰ï¼š<a href="http://www.vmware.com/resources/compatibility/">www.vmware.com/resources/compatibility/</a></p><a id="more"></a><h2 id="1-2-å­˜å‚¨æ¶æ„"><a href="#1-2-å­˜å‚¨æ¶æ„" class="headerlink" title="1.2 å­˜å‚¨æ¶æ„"></a>1.2 å­˜å‚¨æ¶æ„</h2><ul><li>åŸºäºå…‰çº¤é€šé“å’Œä»¥å¤ªç½‘å…‰çº¤é€šé“ï¼ˆFCoEï¼‰å­˜å‚¨</li><li>åŸºäºiSCSIçš„å­˜å‚¨</li><li>é€šè¿‡ç½‘ç»œæ–‡ä»¶ç³»ç»Ÿï¼ˆNFSï¼‰è®¿é—®çš„å­˜å‚¨</li><li>æ”¯æŒåœ¨ä¸€ç§è§£å†³æ–¹æ¡ˆä¸­ä½¿ç”¨å¤šç§å­˜å‚¨åè®®</li></ul><h2 id="1-3-ç½‘ç»œåŸºç¡€æ¶æ„"><a href="#1-3-ç½‘ç»œåŸºç¡€æ¶æ„" class="headerlink" title="1.3 ç½‘ç»œåŸºç¡€æ¶æ„"></a>1.3 ç½‘ç»œåŸºç¡€æ¶æ„</h2><ul><li>ESXI ç®¡ç†ç½‘ç»œè‡³å°‘éœ€è¦ä¸€ä¸ªNICï¼ˆç½‘ç»œæ¥å£å¡ï¼‰ï¼Œæ¨èå¢åŠ 1ä¸ª NIC å†—ä½™</li><li>vMotion éœ€è¦ä½¿ç”¨ä¸€ä¸ªNIC ï¼Œæ¨èå¢åŠ 1ä¸ª NIC å†—ä½™</li><li>ä½¿ç”¨ vSphere FT éœ€è¦è‡³å°‘ä¸€ä¸ªNIC ï¼Œæ¨èå¢åŠ 1ä¸ª NIC å†—ä½™</li><li>åœ¨ä½¿ç”¨ iSCSI ã€ NFS æˆ– VSAN çš„éƒ¨ç½²ç¯å¢ƒä¸­ï¼Œè‡³å°‘è¿˜éœ€å¢åŠ ä¸€ä¸ªNICï¼Œæœ€å¥½ä¸º2ä¸ª</li><li>éœ€è¦2ä¸ª NIC æ¥å¤„ç†æ¥è‡ªè™šæ‹Ÿæœºæœ¬èº«çš„æµé‡</li></ul><h1 id="2-éƒ¨ç½²-ESXI"><a href="#2-éƒ¨ç½²-ESXI" class="headerlink" title="2. éƒ¨ç½² ESXI"></a>2. éƒ¨ç½² ESXI</h1><h2 id="2-1-éƒ¨ç½²æ–¹æ³•"><a href="#2-1-éƒ¨ç½²æ–¹æ³•" class="headerlink" title="2.1 éƒ¨ç½²æ–¹æ³•"></a>2.1 éƒ¨ç½²æ–¹æ³•</h2><ul><li>äº¤äº’å¼å®‰è£… ESXI</li><li>æ— äººå¹²é¢„ï¼ˆè„šæœ¬åŒ–ï¼‰å®‰è£… ESXI</li><li>è‡ªåŠ¨åŒ–åˆ†é…ï¼ˆvSphere Auto Deployï¼‰ ESXI</li></ul><h2 id="2-2-æ— äººå¹²é¢„-ESXI-å®‰è£…è¿‡ç¨‹çš„å¯åŠ¨é¡¹é€‰æ‹©"><a href="#2-2-æ— äººå¹²é¢„-ESXI-å®‰è£…è¿‡ç¨‹çš„å¯åŠ¨é¡¹é€‰æ‹©" class="headerlink" title="2.2 æ— äººå¹²é¢„ ESXI å®‰è£…è¿‡ç¨‹çš„å¯åŠ¨é¡¹é€‰æ‹©"></a>2.2 æ— äººå¹²é¢„ ESXI å®‰è£…è¿‡ç¨‹çš„å¯åŠ¨é¡¹é€‰æ‹©</h2><table><thead><tr><th align="center">å¯åŠ¨é€‰é¡¹</th><th align="center">ç®€è¦è¯´æ˜</th></tr></thead><tbody><tr><td align="center">ks=cdrom:/path</td><td align="center">ä½¿ç”¨CD-ROM ä¸­æŒ‡å®šè·¯å¾„çš„å®‰è£…è„šæœ¬ã€‚å®‰è£…è„šæœ¬ä¼šæ£€æŸ¥æ‰€æœ‰CD-ROMé©±åŠ¨å™¨ï¼Œç›´åˆ°å‘ç°ä¸æ‰€æŒ‡å®šè·¯å¾„ç›¸åŒ¹é…çš„æ–‡ä»¶</td></tr><tr><td align="center">ks=usb</td><td align="center">USBè®¾å¤‡ä¸­æ ¹ç›®å½•ä¸‹åç§°ä¸ºks.cfgçš„å®‰è£…è„šæœ¬ã€‚å®‰è£…ç¨‹åºä¼šæœç´¢æ–‡ä»¶æ ¼å¼ä¸ºFAT16æˆ–FAT32çš„USBè®¾å¤‡</td></tr><tr><td align="center">ks=usb:/path</td><td align="center">ä½¿ç”¨USBè®¾å¤‡ä¸ŠæŒ‡å®šè·¯å¾„çš„å®‰è£…è„šæœ¬</td></tr><tr><td align="center">ks=protocol:/serverpath</td><td align="center">ä½¿ç”¨æŒ‡å®šç½‘ç»œä½ç½®çš„å®‰è£…è„šæœ¬ã€‚æ”¯æŒçš„åè®®NFSã€HTTPã€HTTPSã€FTP</td></tr></tbody></table><p>ä½¿ç”¨è„šæœ¬å®‰è£…ESXIï¼Œèƒ½å¤Ÿæé«˜å®‰è£…é€Ÿåº¦ï¼Œæœ‰åˆ©äºä¿è¯æ‰€æœ‰ESXIä¸»æœºéƒ½æœ‰ç»Ÿä¸€çš„é…ç½®ã€‚</p><h2 id="2-3-è‡ªåŠ¨åŒ–åˆ†é…ï¼ˆvSphere-Auto-Deployï¼‰-ESXI"><a href="#2-3-è‡ªåŠ¨åŒ–åˆ†é…ï¼ˆvSphere-Auto-Deployï¼‰-ESXI" class="headerlink" title="2.3 è‡ªåŠ¨åŒ–åˆ†é…ï¼ˆvSphere Auto Deployï¼‰ ESXI"></a>2.3 è‡ªåŠ¨åŒ–åˆ†é…ï¼ˆvSphere Auto Deployï¼‰ ESXI</h2><h1 id="çŸ¥è¯†ç‚¹"><a href="#çŸ¥è¯†ç‚¹" class="headerlink" title="çŸ¥è¯†ç‚¹"></a>çŸ¥è¯†ç‚¹</h1><h2 id="vSphere-è®¾è®¡éœ€è€ƒè™‘çš„ç½‘ç»œé—®é¢˜"><a href="#vSphere-è®¾è®¡éœ€è€ƒè™‘çš„ç½‘ç»œé—®é¢˜" class="headerlink" title="vSphere è®¾è®¡éœ€è€ƒè™‘çš„ç½‘ç»œé—®é¢˜"></a>vSphere è®¾è®¡éœ€è€ƒè™‘çš„ç½‘ç»œé—®é¢˜</h2><ul><li>VLANæ”¯æŒ</li><li>é“¾è·¯èšåˆã€ç½‘ç»œé€Ÿåº¦ï¼ˆ1Gbpsæˆ–10Gbpsï¼‰ã€è´Ÿè½½å‡è¡¡ã€NICæ¥å£</li></ul><h2 id="ä½¿ç”¨-vSphere-Auto-Deploy-éƒ¨ç½²-ESXI-çš„ä¼˜ç¼ºç‚¹"><a href="#ä½¿ç”¨-vSphere-Auto-Deploy-éƒ¨ç½²-ESXI-çš„ä¼˜ç¼ºç‚¹" class="headerlink" title="ä½¿ç”¨ vSphere Auto Deploy éƒ¨ç½² ESXI çš„ä¼˜ç¼ºç‚¹"></a>ä½¿ç”¨ vSphere Auto Deploy éƒ¨ç½² ESXI çš„ä¼˜ç¼ºç‚¹</h2><h3 id="ä¼˜ç‚¹"><a href="#ä¼˜ç‚¹" class="headerlink" title="ä¼˜ç‚¹"></a>ä¼˜ç‚¹</h3><p>å¯ä»¥å¿«é€Ÿåˆ†é…ã€å¿«é€Ÿé‡åˆ†é…åŠåœ¨åˆ†é…è¿‡ç¨‹ä¸­å¿«é€Ÿå¢åŠ æ–° ESXI æ˜ åƒæˆ–æ›´æ–°ã€‚</p><h3 id="ç¼ºç‚¹"><a href="#ç¼ºç‚¹" class="headerlink" title="ç¼ºç‚¹"></a>ç¼ºç‚¹</h3><p>å¢åŠ å¤æ‚æ€§åŠéœ€è¦é¢å¤–çš„é…ç½®ï¼Œè§£å†³éƒ¨ç½²æ— çŠ¶æ€é—®é¢˜</p>]]></content>
    
    
    <categories>
      
      <category>VMware</category>
      
    </categories>
    
    
    <tags>
      
      <tag>VMware</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>Linux nmcli ä½¿ç”¨åŠç½‘ç»œé…ç½®</title>
    <link href="/2020/03/26/linux_nmcli/"/>
    <url>/2020/03/26/linux_nmcli/</url>
    
    <content type="html"><![CDATA[<h1 id="ä¸€ã€nmcli-å‘½ä»¤å’Œç½‘ç»œé…ç½®æ–‡ä»¶å¯¹åº”å…³ç³»"><a href="#ä¸€ã€nmcli-å‘½ä»¤å’Œç½‘ç»œé…ç½®æ–‡ä»¶å¯¹åº”å…³ç³»" class="headerlink" title="ä¸€ã€nmcli å‘½ä»¤å’Œç½‘ç»œé…ç½®æ–‡ä»¶å¯¹åº”å…³ç³»"></a>ä¸€ã€nmcli å‘½ä»¤å’Œç½‘ç»œé…ç½®æ–‡ä»¶å¯¹åº”å…³ç³»</h1><table><thead><tr><th align="center">nmcli connection modify *</th><th align="center">ifcfg-* æ–‡ä»¶</th></tr></thead><tbody><tr><td align="center">ipv4.method manual</td><td align="center">BOOTPROTO=none</td></tr><tr><td align="center">ipv4.method auto</td><td align="center">BOOTPROTO=dhcp</td></tr><tr><td align="center">ipv4.addresses 192.168.1.1/24</td><td align="center">IPADDR=192.168.2.230,PREFIX=24</td></tr><tr><td align="center">ipv4.dns 8.8.8.8</td><td align="center">DNS1=8.8.8.8</td></tr><tr><td align="center">ipv4.dns-seach example.com</td><td align="center">DOMAIN=example.com</td></tr><tr><td align="center">ipv4.ignore-auto-dns true</td><td align="center">PEERDNS=no</td></tr><tr><td align="center">connection.autoconnect yes</td><td align="center">ONBOOT=yes</td></tr><tr><td align="center">connection.id eth0</td><td align="center">NAME=eth0</td></tr><tr><td align="center">connection.interface-name eth0</td><td align="center">DEVICE=eth0</td></tr><tr><td align="center">802-3-ethernet.mac-address â€¦</td><td align="center">HWADDR=â€¦</td></tr></tbody></table><p><font color=red>æ³¨ *ï¼šç½‘å¡åç§°</font></p><p>å¯ä»¥ä½¿ç”¨ <code>nmcli device</code> æŸ¥çœ‹ç½‘å¡</p><h2 id="1-1-åº”ç”¨"><a href="#1-1-åº”ç”¨" class="headerlink" title="1.1 åº”ç”¨"></a>1.1 åº”ç”¨</h2><pre><code class="hljs bash">[root@<span class="hljs-built_in">test</span> ~]<span class="hljs-comment"># cat /etc/sysconfig/network-scripts/ifcfg-ens18 </span>TYPE=EthernetPROXY_METHOD=noneBROWSER_ONLY=noBOOTPROTO=dhcpDEFROUTE=yesIPV4_FAILURE_FATAL=noIPV6INIT=yesIPV6_AUTOCONF=yesIPV6_DEFROUTE=yesIPV6_FAILURE_FATAL=noIPV6_ADDR_GEN_MODE=stable-privacyNAME=ens18DEVICE=ens18[root@<span class="hljs-built_in">test</span> ~]<span class="hljs-comment"># nmcli connection modify ens18 ipv4.addresses 192.168.2.230/24     &lt;---é…ç½®ipåœ°å€å’Œå­ç½‘æ©ç </span>[root@<span class="hljs-built_in">test</span> ~]<span class="hljs-comment"># nmcli connection modify ens18 ipv4.dns 114.114.114.114            &lt;---æ·»åŠ dns</span>[root@<span class="hljs-built_in">test</span> ~]<span class="hljs-comment"># nmcli connection modify ens18 +ipv4.dns 8.8.8.8                   &lt;---æ·»åŠ dns</span>[root@<span class="hljs-built_in">test</span> ~]<span class="hljs-comment"># nmcli connection modify ens18 ipv4.method manual                  &lt;---å°†ipè·å–æ–¹å¼æ”¹ä¸ºæ‰‹åŠ¨</span>[root@<span class="hljs-built_in">test</span> ~]<span class="hljs-comment"># nmcli connection modify ens18 ipv4.gateway 192.168.2.1            &lt;---é…ç½®ç½‘å…³åœ°å€</span>[root@<span class="hljs-built_in">test</span> ~]<span class="hljs-comment"># cat /etc/sysconfig/network-scripts/ifcfg-ens18                   </span>TYPE=EthernetPROXY_METHOD=noneBROWSER_ONLY=noBOOTPROTO=noneDEFROUTE=yesIPV4_FAILURE_FATAL=noIPV6INIT=yesIPV6_AUTOCONF=yesIPV6_DEFROUTE=yesIPV6_FAILURE_FATAL=noIPV6_ADDR_GEN_MODE=stable-privacyNAME=ens18DEVICE=ens18ONBOOT=yesIPADDR=192.168.2.230PREFIX=24DNS1=114.114.114.114DNS2=8.8.8.8GATEWAY=192.168.2.1</code></pre><h1 id="äºŒã€ä¸»æœºå"><a href="#äºŒã€ä¸»æœºå" class="headerlink" title="äºŒã€ä¸»æœºå"></a>äºŒã€ä¸»æœºå</h1><p>é»˜è®¤ä¸»æœºåä¸€èˆ¬ä¸ºï¼šlocalhost.localdomain</p><p>ä¿®æ”¹ä¸»æœºåï¼š</p><pre><code class="hljs bash">[root@localhost ~]<span class="hljs-comment"># hostnamectl set-hostname test</span>[root@localhost ~]<span class="hljs-comment"># cat /etc/hostname</span><span class="hljs-built_in">test</span></code></pre><h1 id="ä¸‰ã€nmcli-å‘½ä»¤çš„ä½¿ç”¨"><a href="#ä¸‰ã€nmcli-å‘½ä»¤çš„ä½¿ç”¨" class="headerlink" title="ä¸‰ã€nmcli å‘½ä»¤çš„ä½¿ç”¨"></a>ä¸‰ã€nmcli å‘½ä»¤çš„ä½¿ç”¨</h1><h2 id="3-1-æ˜¾ç¤ºç½‘å¡æˆ–æŸä¸ªç½‘å¡å…·ä½“ä¿¡æ¯ä¿¡æ¯"><a href="#3-1-æ˜¾ç¤ºç½‘å¡æˆ–æŸä¸ªç½‘å¡å…·ä½“ä¿¡æ¯ä¿¡æ¯" class="headerlink" title="3.1 æ˜¾ç¤ºç½‘å¡æˆ–æŸä¸ªç½‘å¡å…·ä½“ä¿¡æ¯ä¿¡æ¯"></a>3.1 æ˜¾ç¤ºç½‘å¡æˆ–æŸä¸ªç½‘å¡å…·ä½“ä¿¡æ¯ä¿¡æ¯</h2><pre><code class="hljs bash">[root@<span class="hljs-built_in">test</span> ~]<span class="hljs-comment"># nmcli connection</span>NAME   UUID                                  TYPE      DEVICE ens18  d43b7a46-0dff-9d53-1068-ccc58c977db3  ethernet  ens18  [root@<span class="hljs-built_in">test</span> ~]<span class="hljs-comment"># nmcli con show</span>NAME   UUID                                  TYPE      DEVICE ens18  d43b7a46-0dff-9d53-1068-ccc58c977db3  ethernet  ens18  [root@<span class="hljs-built_in">test</span> ~]<span class="hljs-comment"># nmcli con show ens18</span>connection.id:                          ens18connection.uuid:                        d43b7a46-0dff-9d53-1068-ccc58c977db3connection.stable-id:                   --connection.type:                        802-3-ethernetconnection.interface-name:              ens18</code></pre><h2 id="3-2-æ˜¾ç¤ºæ‰€æœ‰è®¾å¤‡çŠ¶æ€"><a href="#3-2-æ˜¾ç¤ºæ‰€æœ‰è®¾å¤‡çŠ¶æ€" class="headerlink" title="3.2 æ˜¾ç¤ºæ‰€æœ‰è®¾å¤‡çŠ¶æ€"></a>3.2 æ˜¾ç¤ºæ‰€æœ‰è®¾å¤‡çŠ¶æ€</h2><pre><code class="hljs bash">[root@<span class="hljs-built_in">test</span> ~]<span class="hljs-comment"># nmcli device status</span>DEVICE  TYPE      STATE      CONNECTION ens18   ethernet  connected  ens18      lo      loopback  unmanaged  --  `</code></pre><h2 id="3-3-é‡å¯ç½‘ç»œä½¿é…ç½®æ–‡ä»¶ç”Ÿæ•ˆ"><a href="#3-3-é‡å¯ç½‘ç»œä½¿é…ç½®æ–‡ä»¶ç”Ÿæ•ˆ" class="headerlink" title="3.3 é‡å¯ç½‘ç»œä½¿é…ç½®æ–‡ä»¶ç”Ÿæ•ˆ"></a>3.3 é‡å¯ç½‘ç»œä½¿é…ç½®æ–‡ä»¶ç”Ÿæ•ˆ</h2><ol><li><code>systemctl restart network</code></li><li><code>nmcli connection reload</code></li></ol><h2 id="3-4-æ˜¾ç¤ºæ‰€æœ‰æ´»åŠ¨è¿æ¥"><a href="#3-4-æ˜¾ç¤ºæ‰€æœ‰æ´»åŠ¨è¿æ¥" class="headerlink" title="3.4 æ˜¾ç¤ºæ‰€æœ‰æ´»åŠ¨è¿æ¥"></a>3.4 æ˜¾ç¤ºæ‰€æœ‰æ´»åŠ¨è¿æ¥</h2><pre><code class="hljs bash">[root@<span class="hljs-built_in">test</span> ~]<span class="hljs-comment"># nmcli connection show --active</span>NAME   UUID                                  TYPE      DEVICE ens18  d43b7a46-0dff-9d53-1068-ccc58c977db3  ethernet  ens18</code></pre><h2 id="3-5-åˆ é™¤å’Œæ·»åŠ ä¸€ä¸ªç½‘å¡è¿æ¥"><a href="#3-5-åˆ é™¤å’Œæ·»åŠ ä¸€ä¸ªç½‘å¡è¿æ¥" class="headerlink" title="3.5 åˆ é™¤å’Œæ·»åŠ ä¸€ä¸ªç½‘å¡è¿æ¥"></a>3.5 åˆ é™¤å’Œæ·»åŠ ä¸€ä¸ªç½‘å¡è¿æ¥</h2><pre><code class="hljs bash">[root@<span class="hljs-built_in">test</span> ~]<span class="hljs-comment">#  nmcli connection delete eth0 </span>[root@<span class="hljs-built_in">test</span> ~]<span class="hljs-comment">#  nmcli connection add type ethernet con-name eth0 ifname eno33554992</span></code></pre><h2 id="3-6-ç½‘ç»œæ¥å£çš„åœç”¨å’Œå¯ç”¨"><a href="#3-6-ç½‘ç»œæ¥å£çš„åœç”¨å’Œå¯ç”¨" class="headerlink" title="3.6 ç½‘ç»œæ¥å£çš„åœç”¨å’Œå¯ç”¨"></a>3.6 ç½‘ç»œæ¥å£çš„åœç”¨å’Œå¯ç”¨</h2><pre><code class="hljs bash">[root@<span class="hljs-built_in">test</span> ~]<span class="hljs-comment">#  nmcli connection down eth0 </span>[root@<span class="hljs-built_in">test</span> ~]<span class="hljs-comment">#  nmcli connection up eth0</span></code></pre>]]></content>
    
    
    <categories>
      
      <category>Linux</category>
      
    </categories>
    
    
    <tags>
      
      <tag>Linux</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>Linux LVM</title>
    <link href="/2020/03/12/linux_lvm/"/>
    <url>/2020/03/12/linux_lvm/</url>
    
    <content type="html"><![CDATA[<h1 id="ä¸€ã€LVM-Logical-Volume-Manager"><a href="#ä¸€ã€LVM-Logical-Volume-Manager" class="headerlink" title="ä¸€ã€LVM (Logical Volume Manager)"></a>ä¸€ã€LVM (Logical Volume Manager)</h1><p>LVMæ˜¯é€»è¾‘ç›˜å·ç®¡ç†ï¼ˆLogical Volume Managerï¼‰çš„ç®€ç§°ï¼Œå®ƒæ˜¯Linuxç¯å¢ƒä¸‹å¯¹ç£ç›˜åˆ†åŒºè¿›è¡Œç®¡ç†çš„ä¸€ç§æœºåˆ¶ï¼ŒLVM æ˜¯å»ºç«‹åœ¨ç¡¬ç›˜å’Œåˆ†åŒºä¹‹ä¸Šçš„ä¸€ä¸ªé€»è¾‘å±‚ï¼Œæ¥æé«˜ç£ç›˜åˆ†åŒºç®¡ç†çš„çµæ´»æ€§ã€‚</p><h1 id="äºŒã€LVM-ç‰¹ç‚¹"><a href="#äºŒã€LVM-ç‰¹ç‚¹" class="headerlink" title="äºŒã€LVM ç‰¹ç‚¹"></a>äºŒã€LVM ç‰¹ç‚¹</h1><p>LVM å°†å­˜å‚¨<strong>è™šæ‹ŸåŒ–</strong>ï¼Œä½¿ç”¨é€»è¾‘å·ï¼Œä¸ä¼šå—é™äºç‰©ç†ç£ç›˜çš„å¤§å°ã€‚å¦å¤–ï¼Œå’Œç¡¬ä»¶ç›¸å…³çš„å­˜å‚¨è®¾ç½®è¢«å…¶éšè—ï¼Œèƒ½ä¸ç”¨åœæ­¢åº”ç”¨æˆ–å¸è½½æ–‡ä»¶ç³»ç»Ÿæ¥è°ƒæ•´å·å¤§å°æˆ–æ•°æ®è¿ç§»ã€‚è¿™æ ·èƒ½å‡å°‘æ“ä½œæˆæœ¬ï¼ŒLVMæœ€å¤§çš„ç‰¹ç‚¹å°±æ˜¯å¯ä»¥å¯¹ç£ç›˜è¿›è¡ŒåŠ¨æ€ç®¡ç†ã€‚å› ä¸ºé€»è¾‘å·çš„å¤§å°æ˜¯å¯ä»¥åŠ¨æ€è°ƒæ•´çš„ï¼Œè€Œä¸”ä¸ä¼šä¸¢å¤±ç°æœ‰çš„æ•°æ®ã€‚å¦‚æœæˆ‘ä»¬æ–°å¢åŠ äº†ç¡¬ç›˜ï¼Œå…¶ä¹Ÿä¸ä¼šæ”¹å˜ç°æœ‰ä¸Šå±‚çš„é€»è¾‘å·ã€‚ä½œä¸ºä¸€ä¸ªåŠ¨æ€ç£ç›˜ç®¡ç†æœºåˆ¶ï¼Œé€»è¾‘å·æŠ€æœ¯å¤§å¤§æé«˜äº†ç£ç›˜ç®¡ç†çš„çµæ´»æ€§ã€‚</p><h1 id="ä¸‰ã€LVM-å·¥ä½œæœºåˆ¶"><a href="#ä¸‰ã€LVM-å·¥ä½œæœºåˆ¶" class="headerlink" title="ä¸‰ã€LVM å·¥ä½œæœºåˆ¶"></a>ä¸‰ã€LVM å·¥ä½œæœºåˆ¶</h1><p>LVMå°±æ˜¯é€šè¿‡å°†åº•å±‚çš„ç‰©ç†ç¡¬ç›˜æŠ½è±¡çš„å°è£…èµ·æ¥ï¼Œç„¶åä»¥é€»è¾‘å·çš„æ–¹å¼å‘ˆç°ç»™ä¸Šå±‚åº”ç”¨ã€‚åœ¨ä¼ ç»Ÿçš„ç£ç›˜ç®¡ç†æœºåˆ¶ä¸­ï¼Œæˆ‘ä»¬çš„ä¸Šå±‚åº”ç”¨æ˜¯ç›´æ¥è®¿é—®æ–‡ä»¶ç³»ç»Ÿï¼Œä»è€Œå¯¹åº•å±‚çš„ç‰©ç†ç¡¬ç›˜è¿›è¡Œè¯»å–ã€‚è€Œåœ¨LVMä¸­ï¼Œå…¶é€šè¿‡å¯¹åº•å±‚çš„ç¡¬ç›˜è¿›è¡Œå°è£…ï¼Œå½“æˆ‘ä»¬å¯¹åº•å±‚çš„ç‰©ç†ç¡¬ç›˜è¿›è¡Œæ“ä½œæ—¶ï¼Œå…¶ä¸å†æ˜¯é’ˆå¯¹äºåˆ†åŒºè¿›è¡Œæ“ä½œï¼Œè€Œæ˜¯é€šè¿‡ä¸€ä¸ªå«åšé€»è¾‘å·çš„ä¸œè¥¿æ¥å¯¹å…¶è¿›è¡Œåº•å±‚çš„ç£ç›˜ç®¡ç†æ“ä½œã€‚</p><h2 id="3-1-é€»è¾‘å·ç®¡ç†"><a href="#3-1-é€»è¾‘å·ç®¡ç†" class="headerlink" title="3.1 é€»è¾‘å·ç®¡ç†"></a>3.1 é€»è¾‘å·ç®¡ç†</h2><h3 id="3-1-1-ç‰©ç†å·ï¼ˆPVï¼ŒPhysical-Volumeï¼‰"><a href="#3-1-1-ç‰©ç†å·ï¼ˆPVï¼ŒPhysical-Volumeï¼‰" class="headerlink" title="3.1.1 ç‰©ç†å·ï¼ˆPVï¼ŒPhysical Volumeï¼‰"></a>3.1.1 ç‰©ç†å·ï¼ˆPVï¼ŒPhysical Volumeï¼‰</h3><p>ç‰©ç†å·å°±æ˜¯æŒ‡ç£ç›˜ï¼Œç£ç›˜åˆ†åŒºæˆ–ä»é€»è¾‘ä¸Šå’Œç£ç›˜åˆ†åŒºå…·æœ‰åŒæ ·åŠŸèƒ½çš„è®¾å¤‡(å¦‚RAID)ï¼Œæ˜¯LVMçš„åŸºæœ¬å­˜å‚¨é€»è¾‘å—ï¼Œä½†å’ŒåŸºæœ¬çš„ç‰©ç†å­˜å‚¨ä»‹è´¨ï¼ˆå¦‚åˆ†åŒºã€ç£ç›˜ç­‰ï¼‰æ¯”è¾ƒï¼Œå´åŒ…å«æœ‰å’ŒLVMç›¸å…³çš„ç®¡ç†å‚æ•°ã€‚å½“å‰ LVM å…è®¸ä½ åœ¨æ¯ä¸ªç‰©ç†å·ä¸Šä¿å­˜è¿™ä¸ªç‰©ç†å·çš„0è‡³2ä»½å…ƒæ•°æ®æ‹·è´ï¼Œé»˜è®¤ä¸º1ï¼Œä¿å­˜åœ¨è®¾å¤‡çš„å¼€å§‹å¤„ã€‚ä¸º2æ—¶ï¼Œåœ¨è®¾å¤‡ç»“æŸå¤„ä¿å­˜ç¬¬äºŒä»½å¤‡ä»½ã€‚</p><h3 id="3-1-1-å·ç»„ï¼ˆVGï¼ŒVolume-Groupï¼‰"><a href="#3-1-1-å·ç»„ï¼ˆVGï¼ŒVolume-Groupï¼‰" class="headerlink" title="3.1.1 å·ç»„ï¼ˆVGï¼ŒVolume Groupï¼‰"></a>3.1.1 å·ç»„ï¼ˆVGï¼ŒVolume Groupï¼‰</h3><p>LVM å·ç»„ç±»ä¼¼äºé LVM ç³»ç»Ÿä¸­çš„ç‰©ç†ç¡¬ç›˜ï¼Œå…¶ç”±ç‰©ç†å·ç»„æˆã€‚èƒ½åœ¨å·ç»„ä¸Šåˆ›å»ºä¸€ä¸ªæˆ–å¤šLVMåˆ†åŒºï¼ˆé€»è¾‘å·ï¼‰ï¼Œ LVMå·ç»„ç”±ä¸€ä¸ªæˆ–å¤šä¸ªç‰©ç†å·ç»„æˆã€‚</p><h3 id="3-1-1-é€»è¾‘å·ï¼ˆLVï¼ŒLogical-Volumeï¼‰"><a href="#3-1-1-é€»è¾‘å·ï¼ˆLVï¼ŒLogical-Volumeï¼‰" class="headerlink" title="3.1.1 é€»è¾‘å·ï¼ˆLVï¼ŒLogical Volumeï¼‰"></a>3.1.1 é€»è¾‘å·ï¼ˆLVï¼ŒLogical Volumeï¼‰</h3><p>LVMçš„é€»è¾‘å·ç±»ä¼¼äºé LVM ç³»ç»Ÿä¸­çš„ç¡¬ç›˜åˆ†åŒºï¼Œåœ¨é€»è¾‘å·ä¹‹ä¸Šèƒ½å»ºç«‹æ–‡ä»¶ç³»ç»Ÿ(æ¯”å¦‚/homeæˆ–/usrç­‰)ã€‚</p><p>å…³ç³»å›¾ï¼š</p><p><img src="/img/linux_lvm/linux_lvm_1.jpg"></p><h1 id="å››ã€åˆ›å»º-LVM"><a href="#å››ã€åˆ›å»º-LVM" class="headerlink" title="å››ã€åˆ›å»º LVM"></a>å››ã€åˆ›å»º LVM</h1><h2 id="4-1-æ£€æŸ¥ç³»ç»Ÿæ˜¯å¦å®‰è£…-LVM-ç®¡ç†å·¥å…·"><a href="#4-1-æ£€æŸ¥ç³»ç»Ÿæ˜¯å¦å®‰è£…-LVM-ç®¡ç†å·¥å…·" class="headerlink" title="4.1 æ£€æŸ¥ç³»ç»Ÿæ˜¯å¦å®‰è£… LVM ç®¡ç†å·¥å…·"></a>4.1 æ£€æŸ¥ç³»ç»Ÿæ˜¯å¦å®‰è£… LVM ç®¡ç†å·¥å…·</h2><pre><code class="hljs bash">[root@localhost ~]<span class="hljs-comment"># rpm -qa |grep lvm</span>lvm2-2.02.186-7.el7_8.2.x86_64lvm2-libs-2.02.186-7.el7_8.2.x86_64<span class="hljs-comment">#æœªå®‰è£…å¯ä½¿ç”¨ yum å®‰è£…</span>[root@localhost ~]<span class="hljs-comment"># yum install lvm*</span></code></pre><h2 id="4-2-åˆ›å»ºç‰©ç†å·-PV"><a href="#4-2-åˆ›å»ºç‰©ç†å·-PV" class="headerlink" title="4.2 åˆ›å»ºç‰©ç†å· PV"></a>4.2 åˆ›å»ºç‰©ç†å· PV</h2><p>åŸºæœ¬ PV å‘½ä»¤ï¼š</p><ul><li>pvcreate å°†ç‰©ç†åˆ†åŒºæ–°å»ºä¸º PV</li><li>pvs/pvscan æŸ¥çœ‹ç³»ç»Ÿé‡Œæœ‰ PV çš„ç£ç›˜</li><li>pvdisplay æ˜¾ç¤ºç³»ç»Ÿä¸Š PV çš„çŠ¶æ€</li><li>pvremove åˆ é™¤ PV</li></ul><pre><code class="hljs bash">[root@localhost ~]<span class="hljs-comment"># lsblk </span>NAME            MAJ:MIN RM SIZE RO TYPE MOUNTPOINTsdb               8:16   0   2G  0 disk sdc               8:32   0   2G  0 disk sdd               8:48   0   2G  0 disk sde               8:64   0   2G  0 disk sdf               8:80   0   2G  0 disk</code></pre><p>å‡†å¤‡ä½¿ç”¨ <strong>sdb</strong>ã€<strong>sdc</strong> æ¥åˆ›å»º LVMï¼š</p><pre><code class="hljs bash">[root@localhost ~]<span class="hljs-comment"># pvcreate /dev/sdb /dev/sdc</span>  Physical volume <span class="hljs-string">&quot;/dev/sdb&quot;</span> successfully created.  Physical volume <span class="hljs-string">&quot;/dev/sdc&quot;</span> successfully created.<span class="hljs-comment">#æŸ¥çœ‹åˆ›å»ºçš„ pv</span>[root@localhost ~]<span class="hljs-comment"># pvs</span>  PV         VG     Fmt  Attr PSize   PFree  /dev/sdb          lvm2 ---    2.00g 2.00g  /dev/sdc          lvm2 ---    2.00g 2.00g</code></pre><h2 id="4-3-åˆ›å»ºå·ç»„-VG"><a href="#4-3-åˆ›å»ºå·ç»„-VG" class="headerlink" title="4.3 åˆ›å»ºå·ç»„ VG"></a>4.3 åˆ›å»ºå·ç»„ VG</h2><p>åŸºæœ¬ VG å‘½ä»¤ï¼š</p><ul><li>vgcreat [-s xM] vg_name /dev/sd.. æ–°å»º vgï¼Œ-s åé¢æ¥ pe çš„å¤§å°ï¼ˆå¯é€‰ï¼‰ï¼Œå•ä½æ˜¯ Mã€Gã€‚å¯æ”¾å¤šå— pv</li><li>vgextend æ‰©å±• vgï¼Œå°±æ˜¯å¢åŠ  pv</li><li>vgs/vgscan æŸ¥çœ‹ç³»ç»Ÿé‡Œæœ‰ vg çš„ç£ç›˜</li><li>vgdisplay æ˜¾ç¤ºç³»ç»Ÿä¸Šçš„ vg çŠ¶æ€</li><li>vgremove åˆ é™¤ vg</li><li>vgreduce åœ¨ vg é‡Œåˆ é™¤ pv</li></ul><p>åˆ›å»ºåä¸º vg_test ï¼š</p><pre><code class="hljs bash">[root@localhost ~]<span class="hljs-comment"># vgcreate -s 16M vg_test /dev/sdb</span>  Volume group <span class="hljs-string">&quot;vg_test&quot;</span> successfully created<span class="hljs-comment">#æŸ¥çœ‹åˆ›å»ºå¥½çš„ vg</span>[root@localhost ~]<span class="hljs-comment"># vgs</span>  VG      <span class="hljs-comment">#PV #LV #SN Attr   VSize   VFree</span>  vg_test   1   0   0 wz--n-   1.98g 1.98g</code></pre><h2 id="4-4-åˆ›å»ºé€»è¾‘å·-lv"><a href="#4-4-åˆ›å»ºé€»è¾‘å·-lv" class="headerlink" title="4.4 åˆ›å»ºé€»è¾‘å· lv"></a>4.4 åˆ›å»ºé€»è¾‘å· lv</h2><p>åŸºæœ¬ LV å‘½ä»¤ï¼š</p><ul><li>lvcreate (-l pe num)/(-L size) -n lv_name vg_name æ–°å»º lvï¼Œlv å¤§å°ä¸¤ç§å¯é€‰ï¼š1. -l æŒ‡å®š pe çš„ä¸ªæ•°ï¼Œåˆ›å»ºvgæ—¶æœ‰æŒ‡å®š peå¤§å° 2.-Lç›´æ¥æŒ‡å®šè¦åˆ›å»º lv çš„å®¹é‡ï¼Œå•ä½ä¸º Mã€G</li><li>lvextend æ‰©å®¹</li><li>lvs/lvscan æŸ¥çœ‹ç³»ç»Ÿé‡Œæœ‰ lv çš„ç£ç›˜</li><li>lvdisplay æ˜¾ç¤ºç³»ç»Ÿä¸Š lv çš„çŠ¶æ€</li><li>lvremove åˆ é™¤ lv</li><li>lvreduce åœ¨ lv é‡Œå‡å°‘å®¹é‡</li></ul><p>åˆ›å»º lv_test</p><pre><code class="hljs bash"><span class="hljs-comment">#æŸ¥çœ‹ vg_test çŠ¶æ€</span>[root@localhost ~]<span class="hljs-comment"># vgdisplay </span>  --- Volume group ---  VG Name               vg_test  System ID               Format                lvm2  Metadata Areas        1  Metadata Sequence No  1  VG Access             <span class="hljs-built_in">read</span>/write  VG Status             resizable  MAX LV                0  Cur LV                0  Open LV               0  Max PV                0  Cur PV                1  Act PV                1  VG Size               1.98 GiB  PE Size               16.00 MiB  Total PE              127  Alloc PE / Size       0 / 0     Free  PE / Size       127 / 1.98 GiB  VG UUID               Oge6D2-KPLh-RqNA-cRJ8-mc1y-0rkC-aoXmVt<span class="hljs-comment">#è§ peå¯ç”¨127,æˆ‘ä»¬ä½¿ç”¨100ä¸ª pe</span>[root@localhost ~]<span class="hljs-comment"># lvcreate -l 100 -n lv_test vg_test</span>  Logical volume <span class="hljs-string">&quot;lv_test&quot;</span> created.[root@localhost ~]<span class="hljs-comment"># lvs</span>  LV      VG      Attr       LSize   Pool Origin Data%  Meta%  Move Log Cpy%Sync Convert                                                   lv_test vg_test -wi-a-----   1.56g</code></pre><p><strong>æ ¼å¼åŒ–åˆšåˆ›å»ºçš„ lv_test</strong></p><pre><code class="hljs bash">[root@localhost ~]<span class="hljs-comment"># mkfs.ext4 /dev/vg_test/lv_test </span>mke2fs 1.42.9 (28-Dec-2013)Discarding device blocks: <span class="hljs-keyword">done</span>                            Filesystem label=OS <span class="hljs-built_in">type</span>: LinuxBlock size=4096 (<span class="hljs-built_in">log</span>=2)Fragment size=4096 (<span class="hljs-built_in">log</span>=2)Stride=0 blocks, Stripe width=0 blocks102544 inodes, 409600 blocks20480 blocks (5.00%) reserved <span class="hljs-keyword">for</span> the super userFirst data block=0Maximum filesystem blocks=41943040013 block groups32768 blocks per group, 32768 fragments per group7888 inodes per groupSuperblock backups stored on blocks:         32768, 98304, 163840, 229376, 294912Allocating group tables: <span class="hljs-keyword">done</span>                            Writing inode tables: <span class="hljs-keyword">done</span>                            Creating journal (8192 blocks): <span class="hljs-keyword">done</span>Writing superblocks and filesystem accounting information: <span class="hljs-keyword">done</span></code></pre><p><strong>æŒ‚è½½ä½¿ç”¨ï¼›</strong></p><pre><code class="hljs bash">[root@localhost ~]<span class="hljs-comment"># mount /dev/vg_test/lv_test /mnt</span>[root@localhost ~]<span class="hljs-comment"># mount</span>/dev/mapper/vg_test-lv_test on /mnt <span class="hljs-built_in">type</span> ext4 (rw,relatime,seclabel,data=ordered)</code></pre><h1 id="äº”ã€LVM-åœ¨çº¿æ‰©å±•"><a href="#äº”ã€LVM-åœ¨çº¿æ‰©å±•" class="headerlink" title="äº”ã€LVM åœ¨çº¿æ‰©å±•"></a>äº”ã€LVM åœ¨çº¿æ‰©å±•</h1><p>å…ˆåœ¨ lv_testï¼ˆ/mntï¼‰ ä¸‹å†™å…¥æ•°æ®ï¼Œæµ‹è¯•åœ¨çº¿æ‰©å±•</p><pre><code class="hljs bash">[root@localhost mnt]<span class="hljs-comment"># touch hello_lvm</span>[root@localhost mnt]<span class="hljs-comment"># ls</span>hello_lvm</code></pre><p><font color=red>æ‰©å®¹ lv åˆ†ä¸¤ç§æƒ…å†µï¼Œç¬¬ä¸€æ˜¯åœ¨ vg å®¹é‡è¿˜æœ‰çš„æƒ…å†µä¸‹ï¼Œä¹Ÿå°±æ˜¯Free PE Size å¤Ÿç”¨æƒ…å†µä¸‹ã€‚ç¬¬äºŒæ˜¯åœ¨ vg ä¸å¤Ÿç”¨ï¼Œå¾—å…ˆæ‰©å®¹ vg çš„æƒ…å†µ</font></p><h2 id="5-1-åœ¨-vg-ä¸‹ç›´æ¥æ‰©å®¹"><a href="#5-1-åœ¨-vg-ä¸‹ç›´æ¥æ‰©å®¹" class="headerlink" title="5.1 åœ¨ vg ä¸‹ç›´æ¥æ‰©å®¹"></a>5.1 åœ¨ vg ä¸‹ç›´æ¥æ‰©å®¹</h2><pre><code class="hljs bash"><span class="hljs-comment">#æŸ¥çœ‹ vg è¿˜å‰©27ä¸ª pe</span> [root@localhost ~]<span class="hljs-comment"># vgdisplay </span>  Free  PE / Size       27 / 432.00 MiB<span class="hljs-comment">#ç°åœ¨ lv å¤§å°</span> [root@localhost ~]<span class="hljs-comment">#lvs</span>  LV      VG      Attr       LSize   Pool Origin Data%  Meta%  Move Log Cpy%Sync Convert                                                    lv_test vg_test -wi-ao----   1.56g   <span class="hljs-comment">#lv å†æ‰©å®¹ 20 ä¸ª peï¼Œæ‰€ä»¥è¦ -l 120ï¼Œä¹‹å‰ç»™äº† 100ï¼Œå†æ‰©å®¹åŠ ä¸Š20ï¼Œåˆ™120</span>[root@localhost ~]<span class="hljs-comment"># lvextend -l 120 /dev/vg_test/lv_test </span>  Size of logical volume vg_test/lv_test changed from 1.56 GiB (100 extents) to &lt;1.88 GiB (120 extents).  Logical volume vg_test/lv_test successfully resized.<span class="hljs-comment">#æŸ¥çœ‹å®é™…çš„ç£ç›˜å®¹é‡ï¼Œå‘ç°å¹¶æ²¡æ”¹å˜</span>[root@localhost ~]<span class="hljs-comment"># df -Th</span>Filesystem                  Type      Size  Used Avail Use% Mounted on/dev/mapper/vg_test-lv_test ext4      1.6G  4.7M  1.5G   1% /mnt<span class="hljs-comment">#éœ€è¦å¯¹æ–‡ä»¶ç³»ç»Ÿè¿›è¡Œæ‰©å®¹</span>[root@localhost ~]<span class="hljs-comment"># resize2fs /dev/vg_test/lv_test </span>resize2fs 1.42.9 (28-Dec-2013)Filesystem at /dev/vg_test/lv_test is mounted on /mnt; on-line resizing requiredold_desc_blocks = 1, new_desc_blocks = 1The filesystem on /dev/vg_test/lv_test is now 491520 blocks long.[root@localhost ~]<span class="hljs-comment"># df -Th</span>Filesystem                  Type      Size  Used Avail Use% Mounted on/dev/mapper/vg_test-lv_test ext4      1.9G  4.7M  1.8G   1% /mnt</code></pre><h4 id="tips"><a href="#tips" class="headerlink" title="tips"></a>tips</h4><ul><li>resize2fs /dev/vg_test/lv_testã€€ã€€ï¼ƒæ›´æ–°æ–‡ä»¶ç³»ç»Ÿçš„å¤§å°ï¼Œå³æ¿€æ´»</li><li>resize2fs -fã€€/dev/vg_test/lv_testã€€500Mã€€ï¼ƒå¼ºåˆ¶è®¾ç½®å¤§å°</li><li>dump2fs /dev/vgtest/lvtestã€€ã€€ï¼ƒæŸ¥çœ‹extç³»åˆ—æ–‡ä»¶ç³»ç»Ÿ</li></ul><h2 id="5-2-vg-ä¸å¤Ÿç”¨æƒ…å†µï¼Œæ‰©å®¹-lv"><a href="#5-2-vg-ä¸å¤Ÿç”¨æƒ…å†µï¼Œæ‰©å®¹-lv" class="headerlink" title="5.2 vg ä¸å¤Ÿç”¨æƒ…å†µï¼Œæ‰©å®¹ lv"></a>5.2 vg ä¸å¤Ÿç”¨æƒ…å†µï¼Œæ‰©å®¹ lv</h2><p><strong>vg ç©ºé—´ä¸å¤Ÿï¼Œéœ€å…ˆæ‰©å±• vgï¼Œæ‰©å±• vg å°±æ˜¯å¾€ vg ä¸­åŠ  pv</strong></p><p>åˆšå¥½å¼€å§‹åˆ›å»º pv æ—¶ï¼Œå¤šåˆ›å»ºäº†ä¸ª sdcï¼Œå°† pv sdc åŠ å…¥åˆ° vg_test é‡Œé¢ï¼š</p><pre><code class="hljs bash">[root@localhost ~]<span class="hljs-comment"># pvs</span>  PV         VG      Fmt  Attr PSize   PFree    /dev/sdb   vg_test lvm2 a--    1.98g 112.00m  /dev/sdc           lvm2 ---    2.00g   2.00g[root@localhost ~]<span class="hljs-comment"># vgextend vg_test /dev/sdc </span>  Volume group <span class="hljs-string">&quot;vg_test&quot;</span> successfully extended[root@localhost ~]<span class="hljs-comment"># vgextend vg_test /dev/sdc </span>  Volume group <span class="hljs-string">&quot;vg_test&quot;</span> successfully extended[root@localhost ~]<span class="hljs-comment"># vgdisplay </span>  --- Volume group ---  VG Name               vg_test  System ID               Format                lvm2  Metadata Areas        2  Metadata Sequence No  4  VG Access             <span class="hljs-built_in">read</span>/write  VG Status             resizable  MAX LV                0  Cur LV                1  Open LV               1  Max PV                0  Cur PV                2  Act PV                2  VG Size               &lt;3.97 GiB  PE Size               16.00 MiB  Total PE              254  Alloc PE / Size       120 / &lt;1.88 GiB  Free  PE / Size       134 / 2.09 GiB          &lt;-----å¯ç”¨å®¹é‡å˜å¤šäº†  VG UUID               Oge6D2-KPLh-RqNA-cRJ8-mc1y-0rkC-aoXmVt<span class="hljs-comment">#å°† pe æ•°é‡æ‰©å®¹åˆ° 220ä¸ª</span>[root@localhost ~]<span class="hljs-comment"># lvextend -l 220 /dev/vg_test/lv_test </span>  Size of logical volume vg_test/lv_test changed from &lt;1.88 GiB (120 extents) to &lt;3.44 GiB (220 extents).  Logical volume vg_test/lv_test successfully resized.[root@localhost ~]<span class="hljs-comment"># resize2fs /dev/vg_test/lv_test </span>resize2fs 1.42.9 (28-Dec-2013)Filesystem at /dev/vg_test/lv_test is mounted on /mnt; on-line resizing requiredold_desc_blocks = 1, new_desc_blocks = 1The filesystem on /dev/vg_test/lv_test is now 901120 blocks long.[root@localhost ~]<span class="hljs-comment"># df -Th</span>Filesystem                  Type      Size  Used Avail Use% Mounted on/dev/mapper/vg_test-lv_test ext4      3.4G  6.3M  3.2G   1% /mnt<span class="hljs-comment">#æŸ¥çœ‹æ•°æ®æ˜¯å¦è¿˜å­˜åœ¨</span>[root@localhost ~]<span class="hljs-comment"># ll /mnt/</span>-rw-r--r--. 1 root root     0 Aug 29 15:55 hello_lvm</code></pre><h1 id="å…­ã€LVM-ç¼©å‡"><a href="#å…­ã€LVM-ç¼©å‡" class="headerlink" title="å…­ã€LVM ç¼©å‡"></a>å…­ã€LVM ç¼©å‡</h1><p>LVM çš„ç¼©å‡éœ€è¦å¸è½½æ–‡ä»¶ç³»ç»Ÿâ€“<code>[root@localhost ~]# umount /mnt/</code></p><p><strong>ç¼©å‡æ“ä½œï¼š</strong></p><pre><code class="hljs bash">[root@localhost ~]<span class="hljs-comment"># lvs</span>  LV      VG      Attr       LSize   Pool Origin Data%  Meta%  Move Log Cpy%Sync Convert  root    centos  -wi-ao---- &lt;17.00g                                                      swap    centos  -wi-ao----   2.00g                                                      lv_test vg_test -wi-a-----  &lt;3.44g                                                    [root@localhost ~]<span class="hljs-comment"># resize2fs /dev/vg_test/lv_test 2G</span>resize2fs 1.42.9 (28-Dec-2013)Please run <span class="hljs-string">&#x27;e2fsck -f /dev/vg_test/lv_test&#x27;</span> first.<span class="hljs-comment">#éœ€è¦è¿›è¡Œæ–‡ä»¶ç³»ç»Ÿæ£€æµ‹</span>[root@localhost ~]<span class="hljs-comment"># e2fsck -f /dev/vg_test/lv_test </span>e2fsck 1.42.9 (28-Dec-2013)Pass 1: Checking inodes, blocks, and sizesPass 2: Checking directory structurePass 3: Checking directory connectivityPass 4: Checking reference countsPass 5: Checking group summary information/dev/vg_test/lv_test: 12/220864 files (8.3% non-contiguous), 23666/901120 blocks[root@localhost ~]<span class="hljs-comment"># resize2fs /dev/vg_test/lv_test 2G</span>resize2fs 1.42.9 (28-Dec-2013)Resizing the filesystem on /dev/vg_test/lv_test to 524288 (4k) blocks.The filesystem on /dev/vg_test/lv_test is now 524288 blocks long.[root@localhost ~]<span class="hljs-comment"># lvs</span>  LV      VG      Attr       LSize   Pool Origin Data%  Meta%  Move Log Cpy%Sync Convert                                                   lv_test vg_test -wi-a-----  &lt;3.44g                                                    [root@localhost ~]<span class="hljs-comment"># lvreduce -l 150 /dev/vg_test/lv_test </span>  WARNING: Reducing active logical volume to 2.34 GiB.  THIS MAY DESTROY YOUR DATA (filesystem etc.)Do you really want to reduce vg_test/lv_test? [y/n]: y  Size of logical volume vg_test/lv_test changed from &lt;3.44 GiB (220 extents) to 2.34 GiB (150 extents).  Logical volume vg_test/lv_test successfully resized.[root@localhost ~]<span class="hljs-comment"># lvs</span>  LV      VG      Attr       LSize   Pool Origin Data%  Meta%  Move Log Cpy%Sync Convert  root    centos  -wi-ao---- &lt;17.00g                                                      swap    centos  -wi-ao----   2.00g                                                      lv_test vg_test -wi-a-----   2.34g                                                    [root@localhost ~]<span class="hljs-comment"># mount /dev/vg_test/lv_test /mnt</span>[root@localhost ~]<span class="hljs-comment"># df -Th</span>Filesystem                  Type      Size  Used Avail Use% Mounted ondevtmpfs                    devtmpfs  908M     0  908M   0% /devtmpfs                       tmpfs     919M     0  919M   0% /dev/shmtmpfs                       tmpfs     919M  8.6M  911M   1% /runtmpfs                       tmpfs     919M     0  919M   0% /sys/fs/cgroup/dev/mapper/centos-root     xfs        17G  2.4G   15G  14% //dev/sda1                   xfs      1014M  211M  804M  21% /boottmpfs                       tmpfs     184M     0  184M   0% /run/user/0/dev/mapper/vg_test-lv_test ext4      2.0G  4.7M  1.9G   1% /mnt<span class="hljs-comment">#æŸ¥çœ‹æµ‹è¯•é—®ä»·</span>[root@localhost ~]<span class="hljs-comment"># ll /mnt/</span>total 16-rw-r--r--. 1 root root     0 Aug 29 15:55 hello_lvm</code></pre><h1 id="ä¸ƒã€åˆ é™¤LVM"><a href="#ä¸ƒã€åˆ é™¤LVM" class="headerlink" title="ä¸ƒã€åˆ é™¤LVM"></a>ä¸ƒã€åˆ é™¤LVM</h1><p>è¦å½»åº•çš„æ¥ç§»é™¤LVMçš„è¯ï¼Œéœ€è¦æŠŠåˆ›å»ºçš„æ­¥éª¤åè¿‡æ¥æ“ä½œã€‚</p><ol><li>å¸è½½ æ–‡ä»¶ç³»ç»Ÿ</li><li>åˆ é™¤lv</li><li>åˆ é™¤vg</li><li>åˆ é™¤pv</li></ol><pre><code class="hljs bash">[root@localhost ~]<span class="hljs-comment"># umount /mnt</span>[root@localhost ~]<span class="hljs-comment"># lvremove /dev/vg_test/lv_test </span>Do you really want to remove active logical volume vg_test/lv_test? [y/n]: y  Logical volume <span class="hljs-string">&quot;lv_test&quot;</span> successfully removed[root@localhost ~]<span class="hljs-comment"># vgremove /dev/vg_test</span>  Volume group <span class="hljs-string">&quot;vg_test&quot;</span> successfully removed[root@localhost ~]<span class="hljs-comment"># pvremove /dev/sdb /dev/sdc</span>  Labels on physical volume <span class="hljs-string">&quot;/dev/sdb&quot;</span> successfully wiped.  Labels on physical volume <span class="hljs-string">&quot;/dev/sdc&quot;</span> successfully wiped.</code></pre>]]></content>
    
    
    <categories>
      
      <category>Linux</category>
      
    </categories>
    
    
    <tags>
      
      <tag>Linux</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>CentOS 7 æ›´æ”¹ç½‘å¡åç§°</title>
    <link href="/2020/03/02/linux_change_ifname/"/>
    <url>/2020/03/02/linux_change_ifname/</url>
    
    <content type="html"><![CDATA[<p>Redhat 7 å®˜æ–¹æ–‡æ¡£ä»‹ç»å‘½åè§„åˆ™</p><p>CentOS 7 é»˜è®¤ç½‘å¡åå¤§å¤šä¸ºï¼šensï¼Œå·²ç»ä¸æ˜¯æˆ‘ä»¬ç†Ÿæ‚‰çš„ eth ï¼Œä»centos7å¼€å§‹ï¼Œç½‘å¡å‘½åä¼šæ ¹æ®å›ºä»¶ï¼Œæ‹“æ‰‘ç»“æ„å’Œä½ç½®ä¿¡æ¯æ¥ç¡®å®šã€‚</p><hr><h1 id="ä¸€ã€ä¿®æ”¹æ­¥éª¤"><a href="#ä¸€ã€ä¿®æ”¹æ­¥éª¤" class="headerlink" title="ä¸€ã€ä¿®æ”¹æ­¥éª¤"></a>ä¸€ã€ä¿®æ”¹æ­¥éª¤</h1><h2 id="1-1-ç¼–è¾‘ç½‘å¡çš„é…ç½®æ–‡ä»¶"><a href="#1-1-ç¼–è¾‘ç½‘å¡çš„é…ç½®æ–‡ä»¶" class="headerlink" title="1.1 ç¼–è¾‘ç½‘å¡çš„é…ç½®æ–‡ä»¶"></a>1.1 ç¼–è¾‘ç½‘å¡çš„é…ç½®æ–‡ä»¶</h2><pre><code class="hljs bash">[root@<span class="hljs-built_in">test</span> ~]<span class="hljs-comment"># vi /etc/sysconfig/network-scripts/ifcfg-ens18</span>NAME=eth0           &lt;--- æ”¹ä¸ºæƒ³è¦çš„åç§°ï¼Œå¦‚ eth0ï¼Œä¸‹åŒDEVICE=eth0</code></pre><h2 id="1-2-é‡å‘½åç½‘å¡é…ç½®æ–‡ä»¶"><a href="#1-2-é‡å‘½åç½‘å¡é…ç½®æ–‡ä»¶" class="headerlink" title="1.2 é‡å‘½åç½‘å¡é…ç½®æ–‡ä»¶"></a>1.2 é‡å‘½åç½‘å¡é…ç½®æ–‡ä»¶</h2><pre><code class="hljs bash">[root@localhost network-scripts]<span class="hljs-comment"># mv ifcfg-ens18 ifcfg-eth0</span></code></pre><h2 id="1-3-ä¿®æ”¹å†…æ ¸å‚æ•°é…ç½®æ–‡ä»¶"><a href="#1-3-ä¿®æ”¹å†…æ ¸å‚æ•°é…ç½®æ–‡ä»¶" class="headerlink" title="1.3 ä¿®æ”¹å†…æ ¸å‚æ•°é…ç½®æ–‡ä»¶"></a>1.3 ä¿®æ”¹å†…æ ¸å‚æ•°é…ç½®æ–‡ä»¶</h2><p><code>vi /etc/default/grub</code> ï¼Œæ·»åŠ çº¢è‰²æ¡†å†…å†…å®¹ï¼Œç¦ç”¨ CentOS7 ä¸Šçš„å‘½åè§„åˆ™</p><p><img src="/img/linux_change_ifname/linux_change_ifname_1.jpg"></p><h2 id="1-4-æ‰§è¡Œå‘½ä»¤"><a href="#1-4-æ‰§è¡Œå‘½ä»¤" class="headerlink" title="1.4 æ‰§è¡Œå‘½ä»¤"></a>1.4 æ‰§è¡Œå‘½ä»¤</h2><p><code>grub2-mkconfig -o /boot/grub2/grub.cfg</code> æ¥é‡æ–°ç”Ÿæˆ grub é…ç½®å¹¶æ›´æ–°å†…æ ¸å‚æ•°ã€‚é‡å¯è®¾å¤‡å¯ç”Ÿæ•ˆ</p><h2 id="1-5-åˆ›å»ºç½‘å¡æ¥å£å‘½åè§„åˆ™"><a href="#1-5-åˆ›å»ºç½‘å¡æ¥å£å‘½åè§„åˆ™" class="headerlink" title="1.5 åˆ›å»ºç½‘å¡æ¥å£å‘½åè§„åˆ™"></a>1.5 åˆ›å»ºç½‘å¡æ¥å£å‘½åè§„åˆ™</h2><p><code>vim /etc/udev/rules.d/70-persistent-ipoib.rules</code></p><p>æ·»åŠ å†…å®¹å¦‚ä¸‹ä¸€è¡Œï¼š</p><p><code>UBSYSTEM==&quot;net&quot;,ACTION==&quot;add&quot;,DRIVERS==&quot;?&quot;,ATTR&#123;address&#125;==&quot;&quot;,ATTR&#123;type&#125;==&quot;1&quot;,KERNEL==&quot;eth*&quot;,NAME=&quot;eth0&quot;</code></p><p>è¿™æ—¶é‡å¯å†æ·»åŠ ç½‘å¡å…¶åç§°å°±ä¼šè‡ªåŠ¨å˜æˆeth1ã€eth2 â€¦ ä¾æ¬¡ç±»æ¨ã€‚</p>]]></content>
    
    
    <categories>
      
      <category>Linux</category>
      
    </categories>
    
    
    <tags>
      
      <tag>Linux</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>Linux å†…æ ¸åŠç³»ç»Ÿæ—¥å¿—åˆ†æ</title>
    <link href="/2020/02/18/kernel_sys_log_cat/"/>
    <url>/2020/02/18/kernel_sys_log_cat/</url>
    
    <content type="html"><![CDATA[<h1 id="ç”±ç³»ç»ŸæœåŠ¡-rsyslogd-ç»Ÿä¸€ç®¡ç†"><a href="#ç”±ç³»ç»ŸæœåŠ¡-rsyslogd-ç»Ÿä¸€ç®¡ç†" class="headerlink" title="ç”±ç³»ç»ŸæœåŠ¡ rsyslogd ç»Ÿä¸€ç®¡ç†"></a>ç”±ç³»ç»ŸæœåŠ¡ rsyslogd ç»Ÿä¸€ç®¡ç†</h1><ul><li>è½¯ä»¶åŒ…ï¼šrsyslogd-x.x.x_0.x86_64</li><li>ä¸»è¦ç¨‹åºï¼š/sbin/rsyslogd</li><li>é…ç½®æ–‡ä»¶ï¼š/etc/rsyslog.conf</li></ul><h1 id="æ—¥å¿—æ¶ˆæ¯çº§åˆ«"><a href="#æ—¥å¿—æ¶ˆæ¯çº§åˆ«" class="headerlink" title="æ—¥å¿—æ¶ˆæ¯çº§åˆ«"></a>æ—¥å¿—æ¶ˆæ¯çº§åˆ«</h1><ul><li>0 EMERG ï¼ˆç´§æ€¥ï¼‰ï¼šå¯¼è‡´ä¸»æœºç³»ç»Ÿä¸å¯ç”¨çš„æƒ…å†µ</li><li>1 ALERTï¼ˆè­¦å‘Šï¼‰ï¼šå¿…é¡»é©¬ä¸Šé‡‡å–æªæ–½è§£å†³çš„é—®é¢˜</li><li>2 CRITï¼ˆä¸¥é‡ï¼‰ï¼šæ¯”è¾ƒä¸¥é‡çš„æƒ…å†µ</li><li>3 ERRï¼ˆé”™è¯¯ï¼‰ï¼šè¿è¡Œå‡ºç°é”™è¯¯</li><li>4 WARNINGï¼ˆæé†’ï¼‰ï¼šå¯èƒ½ä¼šå½±å“ç³»ç»ŸåŠŸèƒ½çš„æ—¶é—´</li><li>5 NOTICEï¼ˆæ³¨æ„ï¼‰ï¼šä¸ä¼šå½±å“ç³»ç»Ÿä½†æ˜¯å€¼å¾—æ³¨æ„</li><li>6 INFOï¼ˆä¿¡æ¯ï¼‰ï¼šä¸€èˆ¬ä¿¡æ¯</li><li>7 DEBUGï¼ˆè°ƒè¯•ï¼‰ï¼šç¨‹åºæˆ–ç³»ç»Ÿè°ƒè¯•ä¿¡æ¯ç­‰</li></ul><h1 id="æ—¥å¿—è®°å½•çš„ä¸€èˆ¬æ ¼å¼"><a href="#æ—¥å¿—è®°å½•çš„ä¸€èˆ¬æ ¼å¼" class="headerlink" title="æ—¥å¿—è®°å½•çš„ä¸€èˆ¬æ ¼å¼"></a>æ—¥å¿—è®°å½•çš„ä¸€èˆ¬æ ¼å¼</h1><pre><code class="hljs shell">[root@localhost ~]# tail -f /var/log/messagesJul 19 06:06:33 localhost ModemManager[905]: &lt;warn&gt; Couldn&#x27;t find support for device at &#x27;/sys/devices..&#x27;</code></pre><table><thead><tr><th align="center">Jul 19 06:06:33</th><th align="center">localhost</th><th align="center">ModemManager[905]</th><th align="center">&lt;warn&gt;</th><th align="center">Couldnâ€™t find</th></tr></thead><tbody><tr><td align="center">æ—¶é—´æˆ³</td><td align="center">ä¸»æœºå</td><td align="center">å­ç³»ç»Ÿ</td><td align="center">æ¶ˆæ¯çº§åˆ«</td><td align="center">æ¶ˆæ¯å­—æ®µå†…å®¹</td></tr></tbody></table>]]></content>
    
    
    <categories>
      
      <category>Linux</category>
      
    </categories>
    
    
    <tags>
      
      <tag>Linux</tag>
      
      <tag>kernel</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>Linux æ–‡ä»¶ç³»ç»Ÿçš„é€‰æ‹©</title>
    <link href="/2020/02/11/linux_fs/"/>
    <url>/2020/02/11/linux_fs/</url>
    
    <content type="html"><![CDATA[<h1 id="æ–‡ä»¶ç³»ç»Ÿç±»å‹"><a href="#æ–‡ä»¶ç³»ç»Ÿç±»å‹" class="headerlink" title="æ–‡ä»¶ç³»ç»Ÿç±»å‹"></a>æ–‡ä»¶ç³»ç»Ÿç±»å‹</h1><ul><li>ext2ï¼šlinux ä¸‹æ ‡å‡†æ–‡ä»¶ç³»ç»Ÿï¼Œæ— æ—¥å¿—è®°å½•ï¼ˆinodeï¼‰åŠŸèƒ½ã€‚</li><li>ext3ï¼šåœ¨ ext2 åŸºç¡€ä¸Šå¢åŠ äº†æ—¥å¿—è®°å½•åŠŸèƒ½ï¼ˆinodeï¼‰ï¼Œä»…æ”¯æŒ32000ä¸ªå­ç›®å½•ã€‚</li><li>exit4ï¼šext4 çš„åç»­ç‰ˆæœ¬ï¼Œlinux 2.6.28 å†…æ ¸å¼€å§‹æ”¯æŒã€‚æ— é™å­ç›®å½•æ”¯æŒï¼Œå¿«é€Ÿ fsckã€‚</li><li>xfsï¼šé«˜æ€§èƒ½æ–‡ä»¶ç³»ç»Ÿï¼Œlinux3.10 å†…æ ¸å¼€å§‹é»˜è®¤æ”¯æŒã€‚</li></ul><p><img src="/img/linux_fs/linux.jpg"></p><h2 id="æŸ¥çœ‹-linux-å†…æ ¸ç‰ˆæœ¬"><a href="#æŸ¥çœ‹-linux-å†…æ ¸ç‰ˆæœ¬" class="headerlink" title="æŸ¥çœ‹ linux å†…æ ¸ç‰ˆæœ¬"></a>æŸ¥çœ‹ linux å†…æ ¸ç‰ˆæœ¬</h2><pre><code class="hljs bash">[root@blog ~]<span class="hljs-comment"># uname -a</span>Linux blog 3.10.0-1127.el7.x86_64 <span class="hljs-comment">#1 SMP Tue Mar 31 23:36:51 UTC 2020 x86_64 x86_64 x86_64 GNU/Linux</span></code></pre><h3 id="redhat-centos-æŸ¥çœ‹å…·ä½“ç‰ˆæœ¬å·"><a href="#redhat-centos-æŸ¥çœ‹å…·ä½“ç‰ˆæœ¬å·" class="headerlink" title="redhat/centos æŸ¥çœ‹å…·ä½“ç‰ˆæœ¬å·"></a>redhat/centos æŸ¥çœ‹å…·ä½“ç‰ˆæœ¬å·</h3><pre><code class="hljs bash">[root@blog ~]<span class="hljs-comment"># cat /etc/redhat-release </span>CentOS Linux release 7.8.2003 (Core)</code></pre><h2 id="æ–‡ä»¶ç³»ç»Ÿé€‰æ‹©"><a href="#æ–‡ä»¶ç³»ç»Ÿé€‰æ‹©" class="headerlink" title="æ–‡ä»¶ç³»ç»Ÿé€‰æ‹©"></a>æ–‡ä»¶ç³»ç»Ÿé€‰æ‹©</h2><p>ext4ï¼šé€‚ç”¨äº<strong>è¯»</strong>æ“ä½œé¢‘ç¹ï¼ŒåŒæ—¶<strong>å°æ–‡ä»¶</strong>ä¼—å¤šçš„ä¸šåŠ¡</p><p>xfsï¼šé€‚ç”¨äº<strong>å†™</strong>æ“ä½œé¢‘ç¹ä¸šåŠ¡</p><p>ext3ï¼šé€‚ç”¨äºå¯¹æ€§èƒ½è¦æ±‚ä¸é«˜ã€æ•°æ®å®‰å…¨è¦æ±‚ä¸é«˜çš„ä¸šåŠ¡</p>]]></content>
    
    
    <categories>
      
      <category>Linux</category>
      
    </categories>
    
    
    <tags>
      
      <tag>Linux</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>Redhat/CentOS 7 å•ç”¨æˆ·ä¿®æ”¹ root å¯†ç </title>
    <link href="/2019/11/01/linux_change_pw/"/>
    <url>/2019/11/01/linux_change_pw/</url>
    
    <content type="html"><![CDATA[<h1 id="ä¿®æ”¹æ­¥éª¤"><a href="#ä¿®æ”¹æ­¥éª¤" class="headerlink" title="ä¿®æ”¹æ­¥éª¤"></a>ä¿®æ”¹æ­¥éª¤</h1><ol><li><p>é‡å¯ç³»ç»Ÿï¼Œåœ¨ Grub Boot Loader å€’è®¡æ—¶è¯»ç§’ç»“æŸå‰ï¼ŒæŒ‰ä¸‹ä»»æ„é”®</p></li><li><p>é€‰æ‹©ç¬¬ä¸€é¡¹ï¼Œå¹¶æŒ‰ä¸‹ e é”®ï¼Œç¼–è¾‘</p></li></ol><p><img src="/img/linux_change_pw/linux_change_pw_1.jpg"></p><ol start="3"><li>è¿›å…¥ç¼–è¾‘ç•Œé¢åï¼Œæ‰¾åˆ° linux16 å¼€å¤´çš„è¡Œï¼Œé€šè¿‡ Ctrl + e å¯ä»¥å¿«é€Ÿå®šä½åˆ°è¡Œæœ«ï¼Œç©ºæ ¼é”®åè¾“å…¥ rd.break</li></ol><p><img src="/img/linux_change_pw/linux_change_pw_2.jpg"></p><ol start="4"><li>ç¼–è¾‘å¥½åï¼ŒæŒ‰ä¸‹ Ctrl + xï¼Œå¼•å¯¼ç³»ç»Ÿï¼Œç³»ç»Ÿå°†å¯åŠ¨åˆ°ä¸´æ—¶å†…æ ¸ shell ç•Œé¢ï¼Œè¾“å…¥ä»¥ä¸‹æŒ‡ä»¤å³å¯ä¿®æ”¹å¯†ç </li></ol><p><img src="/img/linux_change_pw/linux_change_pw_3.jpg"></p><p><strong><font color=red>æ³¨æ„ï¼šä¿®æ”¹å¯†ç åï¼Œé¦–æ¬¡é‡å¯æ—¶é—´å°†ä¼šæ¯”è¾ƒé•¿ï¼Œå› ä¸ºç³»ç»Ÿå°†å¯¹æ‰€æœ‰æ–‡ä»¶è¿›è¡Œ SeLinux æ‰“æ ‡ï¼Œè¯·å‹¿åœ¨æ‰“æ ‡è¿‡ç¨‹ä¸­æ‰‹åŠ¨å¼ºåˆ¶é‡å¯ï¼Œå¦åˆ™ç³»ç»Ÿå°†ä¼šæ°¸ä¹…æ€§æŸåå¯¼è‡´æ— æ³•å¼€æœºã€‚</font></strong></p>]]></content>
    
    
    <categories>
      
      <category>Linux</category>
      
    </categories>
    
    
    <tags>
      
      <tag>Linux</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>Linux è¿ç»´æ•…éšœæ’æŸ¥ä¸ç³»ç»Ÿè°ƒä¼˜æŠ€å·§</title>
    <link href="/2019/10/24/linux_install_tips_and_fault_detect/"/>
    <url>/2019/10/24/linux_install_tips_and_fault_detect/</url>
    
    <content type="html"><![CDATA[<h1 id="æ›´æ”¹ä¸»æœºåï¼ˆhostnameï¼‰"><a href="#æ›´æ”¹ä¸»æœºåï¼ˆhostnameï¼‰" class="headerlink" title="æ›´æ”¹ä¸»æœºåï¼ˆhostnameï¼‰"></a>æ›´æ”¹ä¸»æœºåï¼ˆhostnameï¼‰</h1><p>åœ¨æ›´æ”¹ä¸»æœºåæ—¶å°†ä¸»æœºåæ·»åŠ è‡³ <code>/etc/hosts</code>ä¸‹ï¼Œåšä¸ªæ˜ å°„</p><p><code>127.0.0.1        hostname</code> </p><p>è¿™æ ·èƒ½å¤Ÿé¿å…åç»­å®‰è£…åº”ç”¨æ‰€å‡ºç°çš„é—®é¢˜</p><a id="more"></a><h1 id="SSH-è®¾ç½®"><a href="#SSH-è®¾ç½®" class="headerlink" title="SSH è®¾ç½®"></a>SSH è®¾ç½®</h1><p>ssh é…ç½®æ–‡ä»¶è·¯å¾„ï¼Œä¿®æ”¹é…ç½®æ–‡ä»¶å‰è®°å¾—å¤‡ä»½æ–‡ä»¶</p><p><code>cp /etc/ssh/sshd_config /etc/ssh/sshd_config.bak</code></p><p><code>/etc/ssh/sshd_config</code></p><h2 id="å…³é—­-GSSAPI-éªŒè¯ï¼Œå¯ä»¥æé«˜-ssh-è¿æ¥é€Ÿåº¦"><a href="#å…³é—­-GSSAPI-éªŒè¯ï¼Œå¯ä»¥æé«˜-ssh-è¿æ¥é€Ÿåº¦" class="headerlink" title="å…³é—­ GSSAPI éªŒè¯ï¼Œå¯ä»¥æé«˜ ssh è¿æ¥é€Ÿåº¦"></a>å…³é—­ GSSAPI éªŒè¯ï¼Œå¯ä»¥æé«˜ ssh è¿æ¥é€Ÿåº¦</h2><p> <code>GSSAPIAuthentication no</code></p><h2 id="ä¸ä½¿ç”¨-DNS-åæŸ¥ï¼Œå¯ä»¥æé«˜-ssh-è¿æ¥é€Ÿåº¦"><a href="#ä¸ä½¿ç”¨-DNS-åæŸ¥ï¼Œå¯ä»¥æé«˜-ssh-è¿æ¥é€Ÿåº¦" class="headerlink" title="ä¸ä½¿ç”¨ DNS åæŸ¥ï¼Œå¯ä»¥æé«˜ ssh è¿æ¥é€Ÿåº¦"></a>ä¸ä½¿ç”¨ DNS åæŸ¥ï¼Œå¯ä»¥æé«˜ ssh è¿æ¥é€Ÿåº¦</h2><p> <code>UseDNS no</code></p><h1 id="yum-è®¾ç½®"><a href="#yum-è®¾ç½®" class="headerlink" title="yum è®¾ç½®"></a>yum è®¾ç½®</h1><h2 id="å¸¸ç”¨-yum-æº"><a href="#å¸¸ç”¨-yum-æº" class="headerlink" title="å¸¸ç”¨ yum æº"></a>å¸¸ç”¨ yum æº</h2><ul><li>epelæºï¼š<a href="https://fedoraproject.org/wiki/EPEL">https://fedoraproject.org/wiki/EPEL</a> </li><li>repoforge æºï¼š<a href="http://repoforge.org/use/">http://repoforge.org/use/</a> </li></ul><h1 id="æ’éšœå…³æ³¨ç‚¹"><a href="#æ’éšœå…³æ³¨ç‚¹" class="headerlink" title="æ’éšœå…³æ³¨ç‚¹"></a>æ’éšœå…³æ³¨ç‚¹</h1><ul><li>/var/log/messages    #åº”ç”¨æ—¥å¿—æŸ¥è¯¢</li><li>/var/log/secure         #ç™»å½•æ—¥å¿—æŸ¥è¯¢</li><li>dmesg                        #ç³»ç»Ÿæ—¥å¿—æŸ¥è¯¢</li><li>/var/tmp ã€/tmp       #å®¹æ˜“æ”»å‡»ç‚¹æŸ¥è¯¢</li><li>crontab -l ã€/etc/crontab    #è®¡åˆ’ä»»åŠ¡æŸ¥è¯¢ï¼ˆç»å¸¸æ”»å‡»å¯¹è±¡ï¼‰</li></ul><h2 id="dmesg-å‘½ä»¤ã€æ–‡ä»¶"><a href="#dmesg-å‘½ä»¤ã€æ–‡ä»¶" class="headerlink" title="dmesg å‘½ä»¤ã€æ–‡ä»¶"></a>dmesg å‘½ä»¤ã€æ–‡ä»¶</h2><p>ç›´æ¥è¾“å‡ºå½“å‰æœ€æ–°çš„ç³»ç»Ÿæ—¥å¿—ã€‚</p><p>ç³»ç»Ÿæ¯æ¬¡å¼€æœºå°†æ—¥å¿—ä¿å­˜åˆ°<code>/var/log/dmesg</code></p><p>æ—§çš„æ—¥å¿—ä¼šä¿å­˜åˆ°<code>/var/log/dmesg.old</code></p><h2 id="secure-æ–‡ä»¶"><a href="#secure-æ–‡ä»¶" class="headerlink" title="secure æ–‡ä»¶"></a>secure æ–‡ä»¶</h2><p>ssh ç™»å½•æ—¥å¿—</p><p>å¯ä»¥é€šè¿‡è¿‡æ»¤æŸ¥çœ‹ç™»å½•æˆåŠŸçš„æ—¥å¿—</p><p><code>tail -1000 /var/log/secure |grep Accepted</code></p><h2 id="temp-æ–‡ä»¶å¤¹ï¼ˆ-var-tmp-ã€-tmp-ï¼‰"><a href="#temp-æ–‡ä»¶å¤¹ï¼ˆ-var-tmp-ã€-tmp-ï¼‰" class="headerlink" title="temp æ–‡ä»¶å¤¹ï¼ˆ/var/tmp ã€/tmp ï¼‰"></a>temp æ–‡ä»¶å¤¹ï¼ˆ/var/tmp ã€/tmp ï¼‰</h2><p>é€šè¿‡<code>ls -al</code>æŸ¥çœ‹ temp æ–‡ä»¶æ˜¯å¦æœ‰å¼‚å¸¸æ–‡ä»¶</p><h2 id="crontab"><a href="#crontab" class="headerlink" title="crontab"></a>crontab</h2><p>é€šè¿‡<code>crontab -l</code>æŸ¥çœ‹æ˜¯å¦æœ‰å¼‚å¸¸çš„è®¡åˆ’ä»»åŠ¡</p><p>ç³»ç»Ÿè®¡åˆ’ä»»åŠ¡é…ç½®æ–‡ä»¶åœ¨<code>/ect/crontab</code>ï¼Œç›®å½•<code>/etc/cron.*/</code>é‡Œæ”¾çš„è„šæœ¬ç§‘è‡ªåŠ¨æ‰§è¡Œï¼Œä¹Ÿè¦æ£€æŸ¥</p>]]></content>
    
    
    <categories>
      
      <category>Linux</category>
      
    </categories>
    
    
    <tags>
      
      <tag>Linux</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>Linux ç³»ç»Ÿæ€§èƒ½åˆ†ææ ‡å‡†</title>
    <link href="/2019/09/17/linux_performance_analysis/"/>
    <url>/2019/09/17/linux_performance_analysis/</url>
    
    <content type="html"><![CDATA[<table><thead><tr><th align="center">å½±å“æ€§èƒ½å› ç´ </th><th align="center">è¯„åˆ¤æ ‡å‡†</th><th align="center">è¯„åˆ¤æ ‡å‡†</th><th align="center">è¯„åˆ¤æ ‡å‡†</th></tr></thead><tbody><tr><td align="center"></td><td align="center">å¥½</td><td align="center">å</td><td align="center">ç³Ÿç³•</td></tr><tr><td align="center">CPU</td><td align="center">user% + sys% &lt; 70%</td><td align="center">user% + sys% = 85%</td><td align="center">user% + sys% &gt;= 90%</td></tr><tr><td align="center">å†…å­˜</td><td align="center">Swap In(si) &amp; Out(so)=0</td><td align="center">Per CPU with 10 page/s</td><td align="center">more Swap In &amp;Swap Out</td></tr><tr><td align="center">ç£ç›˜</td><td align="center">iowait% &lt; 20%</td><td align="center">iowait% = 35%</td><td align="center">iowait% &gt;= 50%</td></tr></tbody></table><h3 id="å…¶ä¸­"><a href="#å…¶ä¸­" class="headerlink" title="å…¶ä¸­"></a>å…¶ä¸­</h3><p>%userï¼šè¡¨ç¤º CPU å¤„åœ¨ç”¨æˆ·æ¨¡å¼ä¸‹çš„æ—¶é—´ç™¾åˆ†æ¯”ã€‚<br>%sysï¼šè¡¨ç¤º CPU å¤„åœ¨ç³»ç»Ÿæ¨¡å¼ä¸‹çš„æ—¶é—´ç™¾åˆ†æ¯”ã€‚<br>%iowaitï¼šè¡¨ç¤º CPU ç­‰å¾…è¾“å…¥è¾“å‡ºå®Œæˆæ—¶é—´çš„ç™¾åˆ†æ¯”ã€‚<br>swap inï¼šå³siï¼Œè¡¨ç¤ºè™šæ‹Ÿå†…å­˜çš„é¡µå¯¼å…¥ï¼Œå³ä»SWAP DISK äº¤æ¢åˆ° RAMã€‚</p>]]></content>
    
    
    <categories>
      
      <category>Linux</category>
      
    </categories>
    
    
    <tags>
      
      <tag>Linux</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>Linux ç³»ç»Ÿæƒé™ä¸æ­£å¸¸å¯¼è‡´ç³»ç»Ÿæ— æ³•å¯åŠ¨</title>
    <link href="/2019/08/17/linux_sys_root_bad/"/>
    <url>/2019/08/17/linux_sys_root_bad/</url>
    
    <content type="html"><![CDATA[<h1 id="é—®é¢˜æè¿°"><a href="#é—®é¢˜æè¿°" class="headerlink" title="é—®é¢˜æè¿°"></a>é—®é¢˜æè¿°</h1><h2 id="ç³»ç»Ÿå¡åœ¨ç™»å½•ç•Œé¢ï¼Œdebug-æ¨¡å¼æ˜¾ç¤ºå¤šé¡¹-FAILED"><a href="#ç³»ç»Ÿå¡åœ¨ç™»å½•ç•Œé¢ï¼Œdebug-æ¨¡å¼æ˜¾ç¤ºå¤šé¡¹-FAILED" class="headerlink" title="ç³»ç»Ÿå¡åœ¨ç™»å½•ç•Œé¢ï¼Œdebug æ¨¡å¼æ˜¾ç¤ºå¤šé¡¹ [FAILED]"></a>ç³»ç»Ÿå¡åœ¨ç™»å½•ç•Œé¢ï¼Œdebug æ¨¡å¼æ˜¾ç¤ºå¤šé¡¹ [FAILED]</h2><p><img src="/img/linux_sys_root_bad/linux_sys_root_bad_1.jpg"></p><a id="more"></a><h1 id="å‘Šè­¦ä¿¡æ¯"><a href="#å‘Šè­¦ä¿¡æ¯" class="headerlink" title="å‘Šè­¦ä¿¡æ¯"></a>å‘Šè­¦ä¿¡æ¯</h1><h2 id="1-è¿œç¨‹sshæ™®é€šç”¨æˆ·èƒ½å¤Ÿç™»å…¥ï¼Œä½†æ˜¯æ— æ³•åˆ‡æ¢-root-ç”¨æˆ·"><a href="#1-è¿œç¨‹sshæ™®é€šç”¨æˆ·èƒ½å¤Ÿç™»å…¥ï¼Œä½†æ˜¯æ— æ³•åˆ‡æ¢-root-ç”¨æˆ·" class="headerlink" title="1 è¿œç¨‹sshæ™®é€šç”¨æˆ·èƒ½å¤Ÿç™»å…¥ï¼Œä½†æ˜¯æ— æ³•åˆ‡æ¢ root ç”¨æˆ·"></a>1 è¿œç¨‹sshæ™®é€šç”¨æˆ·èƒ½å¤Ÿç™»å…¥ï¼Œä½†æ˜¯æ— æ³•åˆ‡æ¢ root ç”¨æˆ·</h2><pre><code class="hljs routeros">[user@location~]$ sudo su -sudo: unknow user:rootsudo: unable <span class="hljs-keyword">to</span> initialize<span class="hljs-built_in"> policy </span>plugin</code></pre><h2 id="2-æ™®é€šç”¨æˆ·ä¸‹ä½¿ç”¨-ps-ef-æŸ¥çœ‹ç”¨æˆ·è¿›ç¨‹-UID-æ˜¾ç¤ºä¸º-ixdba"><a href="#2-æ™®é€šç”¨æˆ·ä¸‹ä½¿ç”¨-ps-ef-æŸ¥çœ‹ç”¨æˆ·è¿›ç¨‹-UID-æ˜¾ç¤ºä¸º-ixdba" class="headerlink" title="2 æ™®é€šç”¨æˆ·ä¸‹ä½¿ç”¨ ps -ef æŸ¥çœ‹ç”¨æˆ·è¿›ç¨‹ UID æ˜¾ç¤ºä¸º ixdba"></a>2 æ™®é€šç”¨æˆ·ä¸‹ä½¿ç”¨ ps -ef æŸ¥çœ‹ç”¨æˆ·è¿›ç¨‹ UID æ˜¾ç¤ºä¸º ixdba</h2><p><img src="/img/linux_sys_root_bad/linux_sys_root_bad_2.jpg"></p><p>æ­£å¸¸ä¸ºï¼š</p><p><img src="/img/linux_sys_root_bad/linux_sys_root_bad_3.jpg"></p><h1 id="å¤„ç†è¿‡ç¨‹"><a href="#å¤„ç†è¿‡ç¨‹" class="headerlink" title="å¤„ç†è¿‡ç¨‹"></a>å¤„ç†è¿‡ç¨‹</h1><h2 id="1-æŸ¥çœ‹-etc-passwd"><a href="#1-æŸ¥çœ‹-etc-passwd" class="headerlink" title="1 æŸ¥çœ‹ /etc/passwd"></a>1 æŸ¥çœ‹ /etc/passwd</h2><p>å‘ç° <code>root:x:0:0:root:/root:/bin/bash</code>-&gt; <code>ixdba:x:0:0:root:/root:/bin/bash</code></p><h2 id="2-å°†-root-ç”¨æˆ·åæ”¹å›"><a href="#2-å°†-root-ç”¨æˆ·åæ”¹å›" class="headerlink" title="2 å°† root ç”¨æˆ·åæ”¹å›"></a>2 å°† root ç”¨æˆ·åæ”¹å›</h2><p>è¿›å•ç”¨æˆ·æ¨¡å¼ï¼Œä¿®æ”¹  /etc/passwd <code>ixdba:x:0:0:root:/root:/bin/bash</code>-&gt; <code>root:x:0:0:root:/root:/bin/bash</code></p><h1 id="æ ¹å› "><a href="#æ ¹å› " class="headerlink" title="æ ¹å› "></a>æ ¹å› </h1><p>root ç”¨æˆ·è¢«æ”¹æˆå…¶ä»–åç§°ï¼Œå¦‚æœ¬ä¾‹ä¸­çš„ ixdbaã€‚</p><p>æœåŠ¡åœ¨å¯åŠ¨è¿‡ç¨‹ä¸­ï¼Œéœ€è¦ root ç”¨æˆ·ååŠ root ç»„æ¥æˆæƒï¼ˆrootï¼Œrootï¼‰ï¼Œä¿®æ”¹åï¼ŒæœåŠ¡æ‰¾ä¸åˆ° root ç”¨æˆ·ï¼Œæ— æ³•å¾—åˆ°æˆæƒï¼Œæ‰€ä»¥å¾ˆå¤šæœåŠ¡ç³»ç»Ÿæ— æ³•å¯åŠ¨ã€‚</p><h1 id="è§£å†³æ–¹æ¡ˆ"><a href="#è§£å†³æ–¹æ¡ˆ" class="headerlink" title="è§£å†³æ–¹æ¡ˆ"></a>è§£å†³æ–¹æ¡ˆ</h1><p>å°† rootç”¨æˆ·åç§°æ”¹å› rootï¼Œé¿å…ä¿®æ”¹ root ç”¨æˆ·åã€‚</p>]]></content>
    
    
    <categories>
      
      <category>Linux</category>
      
    </categories>
    
    
    <tags>
      
      <tag>Linux</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>Linux ç³»ç»Ÿèµ„æº ulimit è®¾ç½®ä¸æ­£ç¡®å¯¼è‡´æ— æ³•ç™»å½•</title>
    <link href="/2019/07/15/linux_ulimit_bad/"/>
    <url>/2019/07/15/linux_ulimit_bad/</url>
    
    <content type="html"><![CDATA[<h1 id="é—®é¢˜æè¿°"><a href="#é—®é¢˜æè¿°" class="headerlink" title="é—®é¢˜æè¿°"></a>é—®é¢˜æè¿°</h1><h2 id="æœ¬åœ°åŠè¿œç¨‹-ssh-æ— æ³•ç™»å½•"><a href="#æœ¬åœ°åŠè¿œç¨‹-ssh-æ— æ³•ç™»å½•" class="headerlink" title="æœ¬åœ°åŠè¿œç¨‹ ssh æ— æ³•ç™»å½•"></a>æœ¬åœ°åŠè¿œç¨‹ ssh æ— æ³•ç™»å½•</h2><p>sshç™»å½•æœ‰æ˜¾ç¤º last loginï¼Œä½†æ˜¯ä¼šé—ªæ–­ï¼Œé‡è¿ã€‚</p><p>æœ¬åœ°ç™»å½•ä¸ºä¸€ç›´é‡å¤è¾“å…¥ç”¨æˆ·åå¯†ç ã€‚</p><a id="more"></a><h1 id="å‘Šè­¦ä¿¡æ¯"><a href="#å‘Šè­¦ä¿¡æ¯" class="headerlink" title="å‘Šè­¦ä¿¡æ¯"></a>å‘Šè­¦ä¿¡æ¯</h1><p>è¿›å…¥å•ç”¨æˆ·æ¨¡å¼ï¼ŒæŸ¥çœ‹ç™»å½•æ—¥å¿— <code>tail -f /var/log/secure</code></p><p><img src="/img/linux_ulimit_bad/linux_ulimit_bad_1.jpg"></p><p>å…³é”®ä¿¡æ¯</p><p>error: PAM: pam_open_session(): Permission denied</p><p>pam_limits(sshd:session): Could not set limit for â€˜nofileâ€™: Operation not permitted</p><h1 id="å¤„ç†è¿‡ç¨‹"><a href="#å¤„ç†è¿‡ç¨‹" class="headerlink" title="å¤„ç†è¿‡ç¨‹"></a>å¤„ç†è¿‡ç¨‹</h1><p>æŸ¥çœ‹ ulimit é…ç½®æ˜¯å¦å¼‚å¸¸ï¼š<code>ulimit -a</code></p><pre><code class="hljs gradle">[user@localhost~]# cat <span class="hljs-regexp">/etc/</span>security/limits.conf |<span class="hljs-keyword">grep</span> -v <span class="hljs-string">&quot;#&quot;</span></code></pre><p>æŸ¥çœ‹ ulimit é…ç½®<code> /etc/security/limits.conf</code> <code>/etc/security/limits.d/*.conf</code></p><pre><code class="hljs yaml">[<span class="hljs-string">user@localhost~</span>]<span class="hljs-comment"># cat /etc/security/limits.d/20-nproc.conf </span><span class="hljs-comment"># Default limit for number of user&#x27;s processes to prevent</span><span class="hljs-comment"># accidental fork bombs.</span><span class="hljs-comment"># See rhbz #432903 for reasoning.</span><span class="hljs-string">*</span>          <span class="hljs-string">soft</span>    <span class="hljs-string">nproc</span>     <span class="hljs-number">4096</span><span class="hljs-string">root</span>       <span class="hljs-string">soft</span>    <span class="hljs-string">nproc</span>     <span class="hljs-string">unlimited</span><span class="hljs-string">*</span>          <span class="hljs-string">soft</span>    <span class="hljs-string">nofile</span>    <span class="hljs-number">65536000</span><span class="hljs-string">*</span>          <span class="hljs-string">hard</span>    <span class="hljs-string">nofile</span>    <span class="hljs-number">65536000</span></code></pre><p>å°† nofile æ•°å€¼æ”¹å°åˆ° 65536</p><h1 id="æ ¹å› "><a href="#æ ¹å› " class="headerlink" title="æ ¹å› "></a>æ ¹å› </h1><p>nofile æ•°å€¼è®¾ç½®å¤ªå¤§å¯¼è‡´æº¢å‡ºï¼Œæ— æƒé™è®¾ç½®è¿‡å¤§  Could not set limit for â€˜nofileâ€™: Operation not permitted</p><h1 id="è§£å†³æ–¹æ¡ˆ"><a href="#è§£å†³æ–¹æ¡ˆ" class="headerlink" title="è§£å†³æ–¹æ¡ˆ"></a>è§£å†³æ–¹æ¡ˆ</h1><p>æ— æ³•ç™»å½•æƒ…å†µï¼Œéœ€è¦è¿›å…¥å•ç”¨æˆ·æ¨¡å¼æŸ¥çœ‹ç³»ç»Ÿé…ç½®æ˜¯å¦æ­£ç¡®ï¼š<br>å¦‚ï¼š/root/.bash_profile<br>æœ¬ä¾‹ä¸­ï¼Œè®¾ç½®èµ„æºé…ç½®æ–‡ä»¶ <code> /etc/security/limits.conf</code> <code>/etc/security/limits.d/*.conf</code> nofile è®¾ç½®è¿‡å¤§æº¢å‡ºï¼Œå¯¼è‡´ç³»ç»Ÿæ— æ³•åˆ†é… open files æƒé™ï¼Œæ— æ³•ç™»é™†ã€‚</p>]]></content>
    
    
    <categories>
      
      <category>Linux</category>
      
    </categories>
    
    
    <tags>
      
      <tag>Linux</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>MegaRAIDå¡æ— æ³•æ¸…é™¤VD ( Discard Cache) åˆ›å»ºraid</title>
    <link href="/2019/06/21/MegaRAID_not_clear_raid/"/>
    <url>/2019/06/21/MegaRAID_not_clear_raid/</url>
    
    <content type="html"><![CDATA[<h1 id="é—®é¢˜æè¿°"><a href="#é—®é¢˜æè¿°" class="headerlink" title="é—®é¢˜æè¿°"></a>é—®é¢˜æè¿°</h1><h2 id="1-å¼€æœºæç¤ºVDä¸¢å¤±"><a href="#1-å¼€æœºæç¤ºVDä¸¢å¤±" class="headerlink" title="1.å¼€æœºæç¤ºVDä¸¢å¤±"></a>1.å¼€æœºæç¤ºVDä¸¢å¤±</h2><p><img src="/img/megaraid/VD_lost_1.png"></p><h2 id="2-ç‚¹å‡»discard-cacheæ— æ•ˆï¼Œæ— æ³•æ¸…é™¤VDï¼Œç‚¹æ¸…é™¤åè¿˜æ˜¯æç¤ºæœ‰ä¸¢å¤±çš„vd"><a href="#2-ç‚¹å‡»discard-cacheæ— æ•ˆï¼Œæ— æ³•æ¸…é™¤VDï¼Œç‚¹æ¸…é™¤åè¿˜æ˜¯æç¤ºæœ‰ä¸¢å¤±çš„vd" class="headerlink" title="2.ç‚¹å‡»discard cacheæ— æ•ˆï¼Œæ— æ³•æ¸…é™¤VDï¼Œç‚¹æ¸…é™¤åè¿˜æ˜¯æç¤ºæœ‰ä¸¢å¤±çš„vd"></a>2.ç‚¹å‡»discard cacheæ— æ•ˆï¼Œæ— æ³•æ¸…é™¤VDï¼Œç‚¹æ¸…é™¤åè¿˜æ˜¯æç¤ºæœ‰ä¸¢å¤±çš„vd</h2><p><img src="/img/megaraid/VD_lost_2.png"><img src="/img/megaraid/VD_lost_3.png"></p><a id="more"></a><h2 id="3-åˆ›å»ºraidæŠ¥é”™ï¼Œæ— æ³•æ­£å¸¸åˆ›å»ºraidé…ç½®"><a href="#3-åˆ›å»ºraidæŠ¥é”™ï¼Œæ— æ³•æ­£å¸¸åˆ›å»ºraidé…ç½®" class="headerlink" title="3.åˆ›å»ºraidæŠ¥é”™ï¼Œæ— æ³•æ­£å¸¸åˆ›å»ºraidé…ç½®"></a>3.åˆ›å»ºraidæŠ¥é”™ï¼Œæ— æ³•æ­£å¸¸åˆ›å»ºraidé…ç½®</h2><p><img src="/img/megaraid/VD_lost_4.png"></p><h1 id="å‘Šè­¦ä¿¡æ¯"><a href="#å‘Šè­¦ä¿¡æ¯" class="headerlink" title="å‘Šè­¦ä¿¡æ¯"></a>å‘Šè­¦ä¿¡æ¯</h1><p>you cannot perform that operation because the contronller has preserved cache.you must either discard the preserved cache by going to the manage preserved cache operation or import the virtual drives that have preserved cache</p><h1 id="å¤„ç†è¿‡ç¨‹"><a href="#å¤„ç†è¿‡ç¨‹" class="headerlink" title="å¤„ç†è¿‡ç¨‹"></a>å¤„ç†è¿‡ç¨‹</h1><p>ç¡¬æ ¸å¤„ç†è¿‡ç¨‹ï¼š<br>æœåŠ¡å™¨ä¸‹ç”µï¼ŒæŠŠé˜µåˆ—å¡ç”µæ± æ‹”å‡ºæ”¾ç”µ</p><p>æˆ–è€…<br>1ã€ä¸‹è½½tookitå·¥å…·å¼•å¯¼è¿›å»tookitå‘½ä»¤è¡Œ</p><p>linux: ~ #./storcli64 -help | grep -i preserved<br>storcli /cx show preservedcache<br>storcli /cx/vx delete preservedcache[force]</p><p>1../storcli64 /c0 show preservedcache</p><p>å¯ä»¥çœ‹åˆ°æ˜¯å“ªä¸ªVDæœ‰preservedcache</p><p>2.æ ¹æ®ä¸Šé¢çš„å‘½ä»¤æŸ¥åˆ°çš„VDç¼–å·ï¼Œä¾‹å¦‚VDï¼š0ï¼Œæ‰§è¡Œï¼š</p><p>./storcli64 /c0/v0 delete preservedcache force</p><p>æ¸…é™¤å®Œæˆååˆ°raidå¡çš„webbiosé‡ŒæŠŠboot error handlingæ¢å¤åŸæ¥çš„è®¾ç½®</p><h1 id="æ ¹å› "><a href="#æ ¹å› " class="headerlink" title="æ ¹å› "></a>æ ¹å› </h1><p>RAIDå¡Cacheä¸­å­˜åœ¨æ•°æ®ï¼Œé‡å¯æœåŠ¡å™¨æˆ–è€…æ›´æ¢ç¡¬ç›˜åï¼ŒCacheä¸­çš„æ•°æ®æ— æ³•å†™åˆ°ç¡¬ç›˜ä¸­ï¼Œå¯¼è‡´å‡ºç°ä¸Šè¿°é—®é¢˜ã€‚</p><h1 id="è§£å†³æ–¹æ¡ˆ"><a href="#è§£å†³æ–¹æ¡ˆ" class="headerlink" title="è§£å†³æ–¹æ¡ˆ"></a>è§£å†³æ–¹æ¡ˆ</h1><p>Cache æ•°æ®çš„ä¿æŠ¤ï¼Œä¸€èˆ¬éƒ½ä¾èµ–äºé•œåƒä¸ç”µæ±  ( æˆ–è€…æ˜¯ UPS)ï¼Œè¦æ˜¯discard cacheæ— æ•ˆï¼Œå¯ä»¥è¯•ç€æ‹”å‡ºé˜µåˆ—å¡ç”µæ± è¯•è¯•ã€‚</p>]]></content>
    
    
    <categories>
      
      <category>è¿ç»´</category>
      
    </categories>
    
    
    <tags>
      
      <tag>è¿ç»´</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>Unexpected inconsistency run fsck å¤„ç†æŠ¥å‘Š</title>
    <link href="/2018/10/20/Linux_RUN_fsck/"/>
    <url>/2018/10/20/Linux_RUN_fsck/</url>
    
    <content type="html"><![CDATA[<h1 id="1ã€æ•…éšœæ‘˜è¦"><a href="#1ã€æ•…éšœæ‘˜è¦" class="headerlink" title="1ã€æ•…éšœæ‘˜è¦"></a>1ã€æ•…éšœæ‘˜è¦</h1><p>æœºå™¨æ„å¤–å®•æœºé‡å¯ï¼Œå‡ºç°æŠ¥é”™ï¼Œæ— æ³•è¿›å…¥ç³»ç»Ÿï¼Œå¦‚å›¾</p><p><img src="/img/linux_fsck/Linux_1.png"></p><h1 id="2ã€æ•…éšœå…·ä½“æƒ…å†µ"><a href="#2ã€æ•…éšœå…·ä½“æƒ…å†µ" class="headerlink" title="2ã€æ•…éšœå…·ä½“æƒ…å†µ"></a>2ã€æ•…éšœå…·ä½“æƒ…å†µ</h1><p>æç¤ºæŒ‰CTRL+Dç»§ç»­ï¼ŒæŒ‰äº†CTRL+Dä¼šé‡å¯ï¼Œå†æ¬¡å›åˆ°è¿™ä¸ªç•Œé¢ã€‚<br><img src="/img/linux_fsck/Linux_2.png"></p><pre><code>Give root passwd for maintenance</code></pre><p>æ ¹æ®æç¤ºè¾“å…¥å¯†ç è¿›è¡Œç»´æŠ¤ã€‚</p><h1 id="3ã€æ•…éšœåˆ†æåŠå¤„ç†"><a href="#3ã€æ•…éšœåˆ†æåŠå¤„ç†" class="headerlink" title="3ã€æ•…éšœåˆ†æåŠå¤„ç†"></a>3ã€æ•…éšœåˆ†æåŠå¤„ç†</h1><p>æ­£ç¡®è¾“å…¥å¯†ç åï¼Œè¿›å…¥åˆ°ç»´æŠ¤æ¨¡å¼ã€‚<br><img src="/img/linux_fsck/Linux_3.png"><br>åœ¨ä¿®å¤æ¨¡å¼ä¸‹ï¼Œé”®å…¥å‘½ä»¤<code>fsck â€“y</code>ï¼ˆåé¢å¯åŠ å…¶æŠ¥é”™ç›®å½•ï¼Œæ¯ä¸ªæŠ¥é”™ç›®å½•éƒ½ä¸ç›¸åŒï¼‰<br><img src="/img/linux_fsck/Linux_4.png"><br>è¾“å…¥åï¼Œç³»ç»Ÿä¼šæ£€æµ‹ä¿®å¤ç¡¬ç›˜ï¼Œæ£€æµ‹ä¿®å¤æ—¶é—´æ ¹æ®ç¡¬ç›˜é‡Œæ•°æ®å¤šå°‘è€Œå®šï¼Œæœ€åæ£€æµ‹å®Œæ¯•ã€‚è¾“å…¥rebooté‡å¯ã€‚<br>ä¸€èˆ¬æƒ…å†µä¸‹é‡å¯å®Œæ¯•å°±å¯ä»¥è¿›å…¥ç™»é™†ç•Œé¢ã€‚</p><h1 id="4ã€æ€»ç»“"><a href="#4ã€æ€»ç»“" class="headerlink" title="4ã€æ€»ç»“"></a>4ã€æ€»ç»“</h1><p>fsckçš„å‘½ä»¤çš„å‡ ä¸ªä½¿ç”¨æ–¹æ³•</p><p>æŒ‡ä»¤ï¼šfsck</p><p>ä½¿ç”¨æƒé™ : è¶…çº§ä½¿ç”¨è€…</p><p>ä½¿ç”¨æ–¹å¼ : fsck [-sACVRP] [-t fstype] [â€“] [fsck-options] filesys [â€¦]</p><p>è¯´æ˜ ï¼š æ£€æŸ¥ä¸ä¿®å¤ Linux æ¡£æ¡ˆç³»ç»Ÿï¼Œå¯ä»¥åŒæ—¶æ£€æŸ¥ä¸€ä¸ªæˆ–å¤šä¸ª Linux æ¡£æ¡ˆç³»ç»Ÿ</p><p>å‚æ•° ï¼š</p><p>filesys ï¼š device åç§°(eg./dev/sda1)ï¼Œmount ç‚¹ (eg. / æˆ– /usr)</p><p>-t : ç»™å®šæ¡£æ¡ˆç³»ç»Ÿçš„å‹å¼ï¼Œè‹¥åœ¨ /etc/fstab ä¸­å·²æœ‰å®šä¹‰æˆ– kernel æœ¬èº«å·²æ”¯æ´çš„åˆ™ä¸éœ€åŠ ä¸Šæ­¤å‚æ•°</p><p>-s : ä¾åºä¸€ä¸ªä¸€ä¸ªåœ°æ‰§è¡Œ fsck çš„æŒ‡ä»¤æ¥æ£€æŸ¥</p><p>-A : å¯¹/etc/fstab ä¸­æ‰€æœ‰åˆ—å‡ºæ¥çš„ partition åšæ£€æŸ¥</p><p>-C : æ˜¾ç¤ºå®Œæ•´çš„æ£€æŸ¥è¿›åº¦</p><p>-d : åˆ—å° e2fsck çš„ debug ç»“æœ</p><p>-p : åŒæ—¶æœ‰ -A æ¡ä»¶æ—¶ï¼ŒåŒæ—¶æœ‰å¤šä¸ª fsck çš„æ£€æŸ¥ä¸€èµ·æ‰§è¡Œ</p><p>-R : åŒæ—¶æœ‰ -A æ¡ä»¶æ—¶ï¼Œçœç•¥ / ä¸æ£€æŸ¥</p><p>-V : è¯¦ç»†æ˜¾ç¤ºæ¨¡å¼</p><p>-a : å¦‚æœæ£€æŸ¥æœ‰é”™åˆ™è‡ªåŠ¨ä¿®å¤</p><p>-r : å¦‚æœæ£€æŸ¥æœ‰é”™åˆ™ç”±ä½¿ç”¨è€…å›ç­”æ˜¯å¦ä¿®å¤</p>]]></content>
    
    
    <categories>
      
      <category>Linux</category>
      
    </categories>
    
    
    <tags>
      
      <tag>Linux</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>Python Cookbook Note</title>
    <link href="/2018/02/26/python_cookbook_note/"/>
    <url>/2018/02/26/python_cookbook_note/</url>
    
    <content type="html"><![CDATA[<h1 id="1ã€æ•°æ®ç»“æ„å’Œç®—æ³•"><a href="#1ã€æ•°æ®ç»“æ„å’Œç®—æ³•" class="headerlink" title="1ã€æ•°æ®ç»“æ„å’Œç®—æ³•"></a>1ã€æ•°æ®ç»“æ„å’Œç®—æ³•</h1><h2 id="1-1-å°†ä¸ç”¨çš„å˜é‡ä½¿ç”¨ä»»æ„å˜é‡åå»å ä½ï¼Œç„¶åä¸¢å¼ƒï¼Œå–å…¶æƒ³è¦çš„éƒ¨åˆ†"><a href="#1-1-å°†ä¸ç”¨çš„å˜é‡ä½¿ç”¨ä»»æ„å˜é‡åå»å ä½ï¼Œç„¶åä¸¢å¼ƒï¼Œå–å…¶æƒ³è¦çš„éƒ¨åˆ†" class="headerlink" title="1.1 å°†ä¸ç”¨çš„å˜é‡ä½¿ç”¨ä»»æ„å˜é‡åå»å ä½ï¼Œç„¶åä¸¢å¼ƒï¼Œå–å…¶æƒ³è¦çš„éƒ¨åˆ†"></a>1.1 å°†ä¸ç”¨çš„å˜é‡ä½¿ç”¨ä»»æ„å˜é‡åå»å ä½ï¼Œç„¶åä¸¢å¼ƒï¼Œå–å…¶æƒ³è¦çš„éƒ¨åˆ†</h2><pre><code class="hljs python">data = [<span class="hljs-string">&#x27;ACME&#x27;</span>,<span class="hljs-number">50</span>,<span class="hljs-number">91.1</span>,(<span class="hljs-number">2018</span>, <span class="hljs-number">2</span>, <span class="hljs-number">26</span>)]_,shares,price,_ = dataprint(shares)&gt;&gt;&gt;<span class="hljs-number">50</span></code></pre><h2 id="1-2-æ˜Ÿå·è§£å‹è¯­æ³•åœ¨å­—ç¬¦ä¸²æ“ä½œ"><a href="#1-2-æ˜Ÿå·è§£å‹è¯­æ³•åœ¨å­—ç¬¦ä¸²æ“ä½œ" class="headerlink" title="1.2 æ˜Ÿå·è§£å‹è¯­æ³•åœ¨å­—ç¬¦ä¸²æ“ä½œ"></a>1.2 æ˜Ÿå·è§£å‹è¯­æ³•åœ¨å­—ç¬¦ä¸²æ“ä½œ</h2><pre><code class="hljs python">line = <span class="hljs-string">&#x27;nobody:*:-2:-2:Unprivileged User:/var/empty:/usr/bin/false&#x27;</span>uname,*fields,homedir,sh = line.split(<span class="hljs-string">&#x27;:&#x27;</span>)                         print(uname)                                                       print(homedir)    &gt;&gt;&gt;nobody&gt;&gt;&gt;/var/empty</code></pre><h2 id="1-3-å½“è¦è§£å‹ä¸€å†™å…ƒç´ åä¸¢å¼ƒå®ƒä»¬ï¼Œä¸èƒ½ä½¿ç”¨-çš„æ—¶å€™ï¼Œå¯ä»¥ä½¿ç”¨æ™®é€šåºŸå¼ƒåç§°ï¼Œæ¯”å¦‚-æˆ–ign-ignore"><a href="#1-3-å½“è¦è§£å‹ä¸€å†™å…ƒç´ åä¸¢å¼ƒå®ƒä»¬ï¼Œä¸èƒ½ä½¿ç”¨-çš„æ—¶å€™ï¼Œå¯ä»¥ä½¿ç”¨æ™®é€šåºŸå¼ƒåç§°ï¼Œæ¯”å¦‚-æˆ–ign-ignore" class="headerlink" title="1.3 å½“è¦è§£å‹ä¸€å†™å…ƒç´ åä¸¢å¼ƒå®ƒä»¬ï¼Œä¸èƒ½ä½¿ç”¨*çš„æ—¶å€™ï¼Œå¯ä»¥ä½¿ç”¨æ™®é€šåºŸå¼ƒåç§°ï¼Œæ¯”å¦‚_æˆ–ign(ignore)"></a>1.3 å½“è¦è§£å‹ä¸€å†™å…ƒç´ åä¸¢å¼ƒå®ƒä»¬ï¼Œä¸èƒ½ä½¿ç”¨*çš„æ—¶å€™ï¼Œå¯ä»¥ä½¿ç”¨æ™®é€šåºŸå¼ƒåç§°ï¼Œæ¯”å¦‚_æˆ–ign(ignore)</h2><pre><code class="hljs python">c = [(<span class="hljs-number">2</span>,<span class="hljs-number">16</span>,<span class="hljs-number">2018</span>),<span class="hljs-string">&#x27;æ˜ŸæœŸä¸€&#x27;</span>,<span class="hljs-string">&#x27;æ™´&#x27;</span>]   (_,_,d),e,f = c               print(d)                      <span class="hljs-meta">&gt;&gt;&gt; </span><span class="hljs-number">2018</span></code></pre><h2 id="1-4-ä½¿ç”¨heapqæ¨¡å—æ¥æŸ¥æ‰¾æœ€å¤§æˆ–æœ€å°çš„Nä¸ªå…ƒç´ åˆ—è¡¨"><a href="#1-4-ä½¿ç”¨heapqæ¨¡å—æ¥æŸ¥æ‰¾æœ€å¤§æˆ–æœ€å°çš„Nä¸ªå…ƒç´ åˆ—è¡¨" class="headerlink" title="1.4 ä½¿ç”¨heapqæ¨¡å—æ¥æŸ¥æ‰¾æœ€å¤§æˆ–æœ€å°çš„Nä¸ªå…ƒç´ åˆ—è¡¨"></a>1.4 ä½¿ç”¨heapqæ¨¡å—æ¥æŸ¥æ‰¾æœ€å¤§æˆ–æœ€å°çš„Nä¸ªå…ƒç´ åˆ—è¡¨</h2><pre><code class="hljs python"><span class="hljs-keyword">import</span> heapq                         nums = [<span class="hljs-number">1</span>,<span class="hljs-number">4</span>,<span class="hljs-number">5</span>,<span class="hljs-number">2</span>,<span class="hljs-number">7</span>,<span class="hljs-number">3</span>,<span class="hljs-number">21</span>,<span class="hljs-number">-2</span>,<span class="hljs-number">63</span>,<span class="hljs-number">-14</span>]   <span class="hljs-comment">#æ‰“å°å‡ºæœ€å¤§æˆ–æœ€å°çš„3ä¸ªå…ƒç´  </span>print(heapq.nlargest(<span class="hljs-number">3</span>,nums))        print(heapq.nsmallest(<span class="hljs-number">3</span>,nums))&gt;&gt;&gt;[<span class="hljs-number">63</span>, <span class="hljs-number">21</span>, <span class="hljs-number">7</span>]&gt;&gt;&gt;[<span class="hljs-number">-14</span>, <span class="hljs-number">-2</span>, <span class="hljs-number">1</span>]</code></pre>]]></content>
    
    
    <categories>
      
      <category>Python</category>
      
    </categories>
    
    
    <tags>
      
      <tag>Python</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>æ€ä¹ˆå†™å‡ºä¸€æ‰‹æ¼‚äº®çš„ä»£ç -è½¬è½½ï¼ˆèœé¸Ÿå­¦Pythonï¼‰</title>
    <link href="/2018/02/08/How_to_code_Python/"/>
    <url>/2018/02/08/How_to_code_Python/</url>
    
    <content type="html"><![CDATA[<blockquote><p>èœé¸Ÿå­¦Pythonçš„ç¬¬138ç¯‡åŸåˆ›æ–‡ç« </p></blockquote><h1 id="1-æ‰“å°index"><a href="#1-æ‰“å°index" class="headerlink" title="1.æ‰“å°index"></a>1.æ‰“å°index</h1><p>å¯¹äºä¸€ä¸ªåˆ—è¡¨ï¼Œæˆ–è€…è¯´ä¸€ä¸ªåºåˆ—æˆ‘ä»¬ç»å¸¸éœ€è¦æ‰“å°å®ƒçš„index,ä¸€èˆ¬ä¼ ç»Ÿçš„åšæ³•æˆ–è€…è¯´æ¯”è¾ƒlowçš„å†™æ³•ï¼š</p><pre><code class="hljs python"><span class="hljs-comment"># Bad way</span>cities = [<span class="hljs-string">&#x27;Shanghai&#x27;</span>,<span class="hljs-string">&#x27;Beijing&#x27;</span>,<span class="hljs-string">&#x27;Shenzhen&#x27;</span>,<span class="hljs-string">&#x27;Chengdu&#x27;</span>]i = <span class="hljs-number">0</span><span class="hljs-keyword">for</span> c <span class="hljs-keyword">in</span> cities:    print(i + <span class="hljs-number">1</span>, <span class="hljs-string">&#x27;--&gt;&#x27;</span>,c)    i += <span class="hljs-number">1</span>&gt;&gt;&gt;1 --&gt; Shanghai2 --&gt; Beijing3 --&gt; Shenzhen4 --&gt; Chengdu</code></pre><p>ä¼˜é›…å†™æ³•æ˜¯å¤šç”¨<strong>enumerate</strong></p><pre><code class="hljs python"><span class="hljs-comment"># Good way</span><span class="hljs-keyword">for</span> i ,city <span class="hljs-keyword">in</span> enumerate(cities):    print(i + <span class="hljs-number">1</span>,<span class="hljs-string">&#x27;--&gt;&#x27;</span>,city)&gt;&gt;&gt;1 --&gt; Shanghai2 --&gt; Beijing3 --&gt; Shenzhen4 --&gt; Chengdu</code></pre><h2 id="Pythonå†…ç½®enumerate-å‡½æ•°"><a href="#Pythonå†…ç½®enumerate-å‡½æ•°" class="headerlink" title="Pythonå†…ç½®enumerate()å‡½æ•°"></a>Pythonå†…ç½®enumerate()å‡½æ•°</h2><h3 id="æè¿°"><a href="#æè¿°" class="headerlink" title="æè¿°"></a>æè¿°</h3><p>enumerate() å‡½æ•°ç”¨äºå°†ä¸€ä¸ªå¯éå†çš„æ•°æ®å¯¹è±¡(å¦‚åˆ—è¡¨ã€å…ƒç»„æˆ–å­—ç¬¦ä¸²)ç»„åˆä¸ºä¸€ä¸ªç´¢å¼•åºåˆ—ï¼ŒåŒæ—¶åˆ—å‡ºæ•°æ®å’Œæ•°æ®ä¸‹æ ‡ï¼Œä¸€èˆ¬ç”¨åœ¨ for å¾ªç¯å½“ä¸­ã€‚</p><h3 id="è¯­æ³•"><a href="#è¯­æ³•" class="headerlink" title="è¯­æ³•"></a>è¯­æ³•</h3><p><code>enumerate(sequence, [start=0])</code></p><ul><li>sequence â€“ ä¸€ä¸ªåºåˆ—ã€è¿­ä»£å™¨æˆ–å…¶ä»–æ”¯æŒè¿­ä»£å¯¹è±¡ã€‚</li><li>start â€“ ä¸‹æ ‡èµ·å§‹ä½ç½®ã€‚</li></ul><h3 id="è¿”å›å€¼"><a href="#è¿”å›å€¼" class="headerlink" title="è¿”å›å€¼"></a>è¿”å›å€¼</h3><p>è¿”å› enumerate(æšä¸¾) å¯¹è±¡ã€‚</p><h1 id="2-ä¸¤ä¸ªåºåˆ—çš„å¾ªç¯"><a href="#2-ä¸¤ä¸ªåºåˆ—çš„å¾ªç¯" class="headerlink" title="2.ä¸¤ä¸ªåºåˆ—çš„å¾ªç¯"></a>2.ä¸¤ä¸ªåºåˆ—çš„å¾ªç¯</h1><p>æˆ‘ä»¬ä¼šç»å¸¸å¯¹ä¸¤ä¸ªåºåˆ—è¿›è¡Œè®¡ç®—æˆ–è€…å¤„ç†ï¼Œæ¯”è¾ƒlowçš„æ–¹æ³•æ˜¯ç”¨ä¸‹æ ‡å»å¾ªç¯å¤„ç†ï¼š</p><pre><code class="hljs python">names = [<span class="hljs-string">&#x27;leo&#x27;</span>,<span class="hljs-string">&#x27;jack&#x27;</span>,<span class="hljs-string">&#x27;john&#x27;</span>,<span class="hljs-string">&#x27;james&#x27;</span>]colors = [<span class="hljs-string">&#x27;red&#x27;</span>,<span class="hljs-string">&#x27;green&#x27;</span>,<span class="hljs-string">&#x27;blue&#x27;</span>,<span class="hljs-string">&#x27;yellow&#x27;</span>]<span class="hljs-comment"># Bad way</span>n = min(len(names),len(colors))<span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> range(n):    print(names[i],<span class="hljs-string">&#x27;--&gt;&#x27;</span>,colors[i])&gt;&gt;&gt;leo --&gt; redjack --&gt; greenjohn --&gt; bluejames --&gt; yellow</code></pre><p>æ›´ä¼˜é›…ä¸€ç‚¹çš„æ–¹æ³•:ç”¨<strong>zip</strong>è½»æ¾æå®š:</p><pre><code class="hljs python">names = [<span class="hljs-string">&#x27;leo&#x27;</span>,<span class="hljs-string">&#x27;jack&#x27;</span>,<span class="hljs-string">&#x27;john&#x27;</span>,<span class="hljs-string">&#x27;james&#x27;</span>]colors = [<span class="hljs-string">&#x27;red&#x27;</span>,<span class="hljs-string">&#x27;green&#x27;</span>,<span class="hljs-string">&#x27;blue&#x27;</span>,<span class="hljs-string">&#x27;yellow&#x27;</span>]<span class="hljs-comment"># Good way</span><span class="hljs-keyword">for</span> name ,color <span class="hljs-keyword">in</span> zip(names,colors):    print(name,<span class="hljs-string">&#x27;--&gt;&#x27;</span>,color)&gt;&gt;&gt;leo --&gt; redjack --&gt; greenjohn --&gt; bluejames --&gt; yellow</code></pre><h1 id="3-å˜æ¢å˜é‡"><a href="#3-å˜æ¢å˜é‡" class="headerlink" title="3.å˜æ¢å˜é‡"></a>3.å˜æ¢å˜é‡</h1><p>å¤šä¸ªå˜é‡ä¹‹é—´çš„äº¤æ¢ï¼Œç›¸ä¿¡å¾ˆå¤šæœ‰c,c++è¯­è¨€åŸºç¡€çš„åŒå­¦å¯¹è¿™ä¸ªå†ç†Ÿæ‚‰ä¸è¿‡äº†ï¼Œæ¯”å¦‚æˆ‘ä»¬ç»å…¸çš„å†’æ³¡æ’åºï¼Œå°±ä¼šç”¨è¿™ä¸€æ‹›ï¼Œçœ‹çœ‹æ¯”è¾ƒä¼ ç»Ÿçš„åšæ³•å…ˆ:</p><pre><code class="hljs python">x = <span class="hljs-number">1</span>y = <span class="hljs-number">2</span><span class="hljs-comment"># Bad way</span>print(<span class="hljs-string">&#x27;&gt;&gt;Before:x=&#123;&#125;,y=&#123;&#125;&#x27;</span>.format(x,y))tmp = yy = xx = tmpprint(<span class="hljs-string">&#x27;&gt;&gt;After:x=&#123;&#125;,y=&#123;&#125;&#x27;</span>.format(x,y))&gt;&gt;&gt;&gt;&gt;Before:x=<span class="hljs-number">1</span>,y=<span class="hljs-number">2</span>&gt;&gt;After:x=<span class="hljs-number">2</span>,y=<span class="hljs-number">1</span></code></pre><p>æ›´ä¼˜é›…çš„åšæ³•æ˜¯ï¼š</p><pre><code class="hljs python">x = <span class="hljs-number">1</span>y = <span class="hljs-number">2</span><span class="hljs-comment"># Good way</span>print(<span class="hljs-string">&#x27;&gt;&gt;Before:x=&#123;&#125;,y=&#123;&#125;&#x27;</span>.format(x,y))x,y = y,xprint(<span class="hljs-string">&#x27;&gt;&gt;After:x=&#123;&#125;,y=&#123;&#125;&#x27;</span>.format(x,y))&gt;&gt;&gt;&gt;&gt;Before:x=<span class="hljs-number">1</span>,y=<span class="hljs-number">2</span>&gt;&gt;After:x=<span class="hljs-number">2</span>,y=<span class="hljs-number">1</span></code></pre><h1 id="4-å­—å…¸çš„è¯»å–"><a href="#4-å­—å…¸çš„è¯»å–" class="headerlink" title="4.å­—å…¸çš„è¯»å–"></a>4.å­—å…¸çš„è¯»å–</h1><p>å­—å…¸æ˜¯æˆ‘ä»¬ç»å¸¸ä½¿ç”¨çš„æ•°æ®ç»“æ„ï¼Œå¯¹äºå­—å…¸çš„è®¿é—®å’Œè¯»å–ï¼Œå¦‚æœæˆ‘ä»¬çš„è¯»å–çš„å­—å…¸çš„keyä¸ºç©ºæ€ä¹ˆåŠï¼Œä¸€èˆ¬æˆ‘ä»¬éœ€è¦ä¸€ä¸ªç¼ºçœå€¼,èœé¸Ÿçš„å†™æ³•:</p><pre><code class="hljs python">students=&#123;    <span class="hljs-string">&#x27;LILI&#x27;</span>:<span class="hljs-number">18</span>,    <span class="hljs-string">&#x27;Sam&#x27;</span>:<span class="hljs-number">25</span>&#125;<span class="hljs-comment">#Bad way</span><span class="hljs-keyword">if</span> <span class="hljs-string">&#x27;Susan&#x27;</span> <span class="hljs-keyword">in</span> students:    student = students[<span class="hljs-string">&#x27;Susan&#x27;</span>]<span class="hljs-keyword">else</span>:    student=<span class="hljs-string">&#x27;unknow&#x27;</span>print(<span class="hljs-string">&#x27;Susan is &#123;&#125; years old&#x27;</span>.format(student))&gt;&gt;&gt;Susan <span class="hljs-keyword">is</span> unknow years old</code></pre><p>æ¯”è¾ƒä¼˜é›…çš„åšæ³•æ˜¯:</p><pre><code class="hljs python">students=&#123;    <span class="hljs-string">&#x27;LILI&#x27;</span>:<span class="hljs-number">18</span>,    <span class="hljs-string">&#x27;Sam&#x27;</span>:<span class="hljs-number">25</span>&#125;<span class="hljs-comment"># Good way</span>student = students.get(<span class="hljs-string">&#x27;Susan&#x27;</span>,<span class="hljs-string">&#x27;unknow&#x27;</span>)print(<span class="hljs-string">&#x27;Susan is &#123;&#125; years old&#x27;</span>.format(student))</code></pre><p>å·§å¦™çš„åˆ©ç”¨äº†å­—å…¸getçš„ç”¨æ³•ï¼Œå¦‚æœå­—å…¸é‡Œé¢æ²¡æœ‰Susanè¿™ä¸ªkey,åˆ™ç”¨unknowæ¥è¡¨ç¤ºç¼ºçœå€¼ï¼</p><h1 id="5-æ–‡ä»¶è¯»å–æŸ¥æ‰¾"><a href="#5-æ–‡ä»¶è¯»å–æŸ¥æ‰¾" class="headerlink" title="5.æ–‡ä»¶è¯»å–æŸ¥æ‰¾"></a>5.æ–‡ä»¶è¯»å–æŸ¥æ‰¾</h1><p>é€šå¸¸æ¥è¯´ï¼Œæˆ‘ä»¬è¦æ‰“å¼€ä¸€ä¸ªæ–‡ä»¶ï¼Œç„¶åå¯¹æ–‡ä»¶çš„å†…å®¹è¿›è¡Œå¾ªç¯è¯»å–å’Œå¤„ç†ï¼Œèœé¸Ÿçš„å†™æ³•å¦‚ä¸‹ï¼š</p><pre><code class="hljs python"><span class="hljs-comment">#Bad way</span>f = open(<span class="hljs-string">&#x27;data.txt&#x27;</span>)<span class="hljs-keyword">try</span>:    text = f.read()    <span class="hljs-keyword">for</span> line <span class="hljs-keyword">in</span> text.split(<span class="hljs-string">&#x27;\n&#x27;</span>):        print(line)<span class="hljs-keyword">finally</span>:    f.close()</code></pre><p>æ›´ä¼˜é›…çš„å†™æ³•ï¼š</p><pre><code class="hljs python"><span class="hljs-comment">#Good way</span><span class="hljs-keyword">with</span> open(<span class="hljs-string">&#x27;data.txt&#x27;</span>) <span class="hljs-keyword">as</span> f:    <span class="hljs-keyword">for</span> line <span class="hljs-keyword">in</span> f:        print(line.strip(<span class="hljs-string">&#x27;\n&#x27;</span>))</code></pre><h1 id="6-å¾ªç¯æŸ¥æ‰¾"><a href="#6-å¾ªç¯æŸ¥æ‰¾" class="headerlink" title="6.å¾ªç¯æŸ¥æ‰¾"></a>6.å¾ªç¯æŸ¥æ‰¾</h1><p>æˆ‘ä»¬ç»å¸¸ä¼šåœ¨ä¸€ä¸ªå¤§çš„å¾ªç¯ä¸­ä½œæœç´¢ä¸šåŠ¡ï¼Œæ¯”å¦‚ä»ä¸€ä¸ªæ–‡ä»¶ä¸­æœç´¢å…³é”®å­—ï¼Œæ¯”å¦‚ä»æ–‡ä»¶ååˆ—è¡¨ä¸­æŸ¥æ‰¾ä¸€äº›ç‰¹æ®Šçš„æ–‡ä»¶åï¼Œæƒ³å½“ç„¶çš„å†™æ³•å¦‚ä¸‹ï¼š</p><pre><code class="hljs python">target_letter = <span class="hljs-string">&#x27;d&#x27;</span>letters = [<span class="hljs-string">&#x27;a&#x27;</span>,<span class="hljs-string">&#x27;b&#x27;</span>,<span class="hljs-string">&#x27;c&#x27;</span>]<span class="hljs-comment">#Bad way</span>found = <span class="hljs-literal">False</span><span class="hljs-keyword">for</span> letter <span class="hljs-keyword">in</span> letters:    <span class="hljs-keyword">if</span> letter == target_letter:        print(<span class="hljs-string">&#x27;Found&#x27;</span>)        found = <span class="hljs-literal">True</span>        <span class="hljs-keyword">break</span><span class="hljs-keyword">if</span> <span class="hljs-keyword">not</span> found:    print(<span class="hljs-string">&#x27;Not found&#x27;</span>)&gt;&gt;&gt;Not found</code></pre><p>æ›´ä¼˜é›…çš„å†™æ³•ï¼š</p><pre><code class="hljs python">target_letter = <span class="hljs-string">&#x27;d&#x27;</span>letters = [<span class="hljs-string">&#x27;a&#x27;</span>,<span class="hljs-string">&#x27;b&#x27;</span>,<span class="hljs-string">&#x27;c&#x27;</span>]<span class="hljs-comment">#Good way</span><span class="hljs-keyword">for</span> letter <span class="hljs-keyword">in</span> letters:    <span class="hljs-keyword">if</span> letter == target_letter:        print(<span class="hljs-string">&#x27;Found&#x27;</span>)        <span class="hljs-keyword">break</span><span class="hljs-keyword">else</span>:    print(<span class="hljs-string">&#x27;Not found&#x27;</span>)&gt;&gt;&gt;Not found</code></pre>]]></content>
    
    
    <categories>
      
      <category>Python</category>
      
    </categories>
    
    
    <tags>
      
      <tag>Python</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>Pythonæ“ä½œMySQLæ•°æ®åº“</title>
    <link href="/2018/01/25/Python_MySQL/"/>
    <url>/2018/01/25/Python_MySQL/</url>
    
    <content type="html"><![CDATA[<h1 id="Python3è¿æ¥MySQLæ•°æ®åº“"><a href="#Python3è¿æ¥MySQLæ•°æ®åº“" class="headerlink" title="Python3è¿æ¥MySQLæ•°æ®åº“"></a>Python3è¿æ¥MySQLæ•°æ®åº“</h1><p>ä½¿ç”¨Python3çš„<strong>PyMySQL</strong>åº“è¿æ¥MySQLæ•°æ®åº“ï¼Œå®ç°ç®€å•çš„å¢åˆ æ”¹æŸ¥ã€‚</p><h2 id="PyMySQL"><a href="#PyMySQL" class="headerlink" title="PyMySQL"></a>PyMySQL</h2><p>PyMySQLæ˜¯åœ¨Python3ä¸­ç”¨äºè¿æ¥MySQLæœåŠ¡å™¨çš„ä¸€ä¸ªåº“ã€‚ï¼ˆPython2ä½¿ç”¨çš„æ˜¯mysqldbã€‚ï¼‰</p><h2 id="æ•°æ®åº“è¿æ¥"><a href="#æ•°æ®åº“è¿æ¥" class="headerlink" title="æ•°æ®åº“è¿æ¥"></a>æ•°æ®åº“è¿æ¥</h2><p><strong>å®ä¾‹ï¼š</strong>è¿æ¥testæ•°æ®åº“</p><pre><code class="hljs javascript">#encoding=utf-8<span class="hljs-keyword">import</span> pymysql# æ‰“å¼€æ•°æ®åº“è¿æ¥&quot;localhost&quot;:æœ¬åœ°æœåŠ¡å™¨,&quot;root&quot;:ç”¨æˆ·å,&quot;666666&quot;:å¯†ç ,&quot;test&quot;:æ•°æ®åº“ådb = pymysql.connect(<span class="hljs-string">&quot;localhost&quot;</span>,<span class="hljs-string">&quot;root&quot;</span>,<span class="hljs-string">&quot;666666&quot;</span>,<span class="hljs-string">&quot;test&quot;</span>)# ä½¿ç”¨ cursor() æ–¹æ³•åˆ›å»ºä¸€ä¸ªæ¸¸æ ‡å¯¹è±¡ cursorcursor = db.cursor()# ä½¿ç”¨ execute()  æ–¹æ³•æ‰§è¡Œ SQL æŸ¥è¯¢cursor.execute(<span class="hljs-string">&quot;SELECT VERSION()&quot;</span>)# ä½¿ç”¨ fetchone() æ–¹æ³•è·å–å•æ¡æ•°æ®.data = cursor.fetchone()print(<span class="hljs-string">&quot;Database version: %s &quot;</span> %data)# å…³é—­æ•°æ®åº“db.close()</code></pre><p>è¾“å‡ºçš„ç»“æœä¸ºï¼š<code>Database version: 5.6.39 </code></p><h2 id="åˆ›å»ºæ•°æ®åº“è¡¨"><a href="#åˆ›å»ºæ•°æ®åº“è¡¨" class="headerlink" title="åˆ›å»ºæ•°æ®åº“è¡¨"></a>åˆ›å»ºæ•°æ®åº“è¡¨</h2><p><strong>å®ä¾‹ï¼š</strong>ç”¨**execute()**æ–¹æ³•æ¥ä¸ºæ•°æ®åº“åˆ›å»ºè¡¨</p><pre><code class="hljs javascript"># encoding=utf-8<span class="hljs-keyword">import</span> pymysql# æ‰“å¼€æ•°æ®åº“è¿æ¥&quot;localhost&quot;:æœ¬åœ°æœåŠ¡å™¨,&quot;root&quot;:ç”¨æˆ·å,&quot;666666&quot;:å¯†ç ,&quot;test&quot;:æ•°æ®åº“ådb = pymysql.connect(<span class="hljs-string">&quot;localhost&quot;</span>,<span class="hljs-string">&quot;root&quot;</span>,<span class="hljs-string">&quot;666666&quot;</span>,<span class="hljs-string">&quot;test&quot;</span>)# ä½¿ç”¨ cursor() æ–¹æ³•åˆ›å»ºä¸€ä¸ªæ¸¸æ ‡å¯¹è±¡ cursorcursor = db.cursor()# ä½¿ç”¨ execute() æ–¹æ³•æ‰§è¡Œ SQLï¼Œå¦‚æœè¡¨å­˜åœ¨åˆ™åˆ é™¤cursor.execute(<span class="hljs-string">&quot;DROP TABLE IF EXISTS testPyMySQL_tbl&quot;</span>)sql = <span class="hljs-string">&quot;&quot;</span><span class="hljs-string">&quot;CREATE TABLE testPyMySQL_tbl(</span><span class="hljs-string">         FIRST_NAME  CHAR(20) NOT NULL,</span><span class="hljs-string">         LAST_NAME  CHAR(20),</span><span class="hljs-string">         AGE INT,  </span><span class="hljs-string">         SEX CHAR(1),</span><span class="hljs-string">         INCOME FLOAT)&quot;</span><span class="hljs-string">&quot;&quot;</span>cursor.execute(sql)# å…³é—­æ•°æ®åº“è¿æ¥db.close()</code></pre><h2 id="æ’å…¥æ•°æ®"><a href="#æ’å…¥æ•°æ®" class="headerlink" title="æ’å…¥æ•°æ®"></a>æ’å…¥æ•°æ®</h2><p><strong>å®ä¾‹ï¼š</strong>å‘æ•°æ®è¡¨testPyMySQL_tblæ’å…¥æ•°æ®ï¼š</p><pre><code class="hljs javascript">#!<span class="hljs-regexp">/usr/</span>bin/python3#encoding=utf-8#ä½¿ç”¨æ‰§è¡Œ SQL INSERT è¯­å¥å‘è¡¨ testPyMySQL_tbl æ’å…¥è®°å½•ï¼š<span class="hljs-keyword">import</span> pymysql# æ‰“å¼€æ•°æ®åº“è¿æ¥db = pymysql.connect(<span class="hljs-string">&quot;localhost&quot;</span>,<span class="hljs-string">&quot;root&quot;</span>,<span class="hljs-string">&quot;666666&quot;</span>,<span class="hljs-string">&quot;test&quot;</span> )# ä½¿ç”¨cursor()æ–¹æ³•è·å–æ“ä½œæ¸¸æ ‡cursor = db.cursor()# SQL æ’å…¥è¯­å¥sql = <span class="hljs-string">&quot;&quot;</span><span class="hljs-string">&quot;INSERT INTO testPyMySQL_tbl(FIRST_NAME,</span><span class="hljs-string">         LAST_NAME, AGE, SEX, INCOME)</span><span class="hljs-string">         VALUES (&#x27;SAO&#x27;, &#x27;A&#x27;, 25, &#x27;M&#x27;, 10000)&quot;</span><span class="hljs-string">&quot;&quot;</span><span class="hljs-keyword">try</span>:   # æ‰§è¡Œsqlè¯­å¥   cursor.execute(sql)   # æäº¤åˆ°æ•°æ®åº“æ‰§è¡Œ   db.commit()except:   # å¦‚æœå‘ç”Ÿé”™è¯¯åˆ™å›æ»š   db.rollback()# å…³é—­æ•°æ®åº“è¿æ¥db.close()</code></pre><h2 id="æ•°æ®åº“æŸ¥è¯¢"><a href="#æ•°æ®åº“æŸ¥è¯¢" class="headerlink" title="æ•°æ®åº“æŸ¥è¯¢"></a>æ•°æ®åº“æŸ¥è¯¢</h2><p>PythonæŸ¥è¯¢Mysqlä½¿ç”¨ fetchone() æ–¹æ³•è·å–å•æ¡æ•°æ®, ä½¿ç”¨fetchall() æ–¹æ³•è·å–å¤šæ¡æ•°æ®ã€‚</p><ul><li><strong>fetchone()</strong>: è¯¥æ–¹æ³•è·å–ä¸‹ä¸€ä¸ªæŸ¥è¯¢ç»“æœé›†ã€‚ç»“æœé›†æ˜¯ä¸€ä¸ªå¯¹è±¡</li><li><strong>fetchall()</strong>: æ¥æ”¶å…¨éƒ¨çš„è¿”å›ç»“æœè¡Œ.</li><li><strong>rowcount</strong>: è¿™æ˜¯ä¸€ä¸ªåªè¯»å±æ€§ï¼Œå¹¶è¿”å›æ‰§è¡Œexecute()æ–¹æ³•åå½±å“çš„è¡Œæ•°ã€‚</li></ul><p><strong>å®ä¾‹ï¼š</strong>æŸ¥è¯¢testPyMySQL_tblè¡¨ä¸­å·¥èµ„å¤§äº1000çš„æ‰€æœ‰æ•°æ®ï¼š</p><pre><code class="hljs javascript">mysql&gt; SELECT * FROM testPyMySQL_tbl;+------------+-----------+------+------+--------+| FIRST_NAME | LAST_NAME | AGE  | SEX  | INCOME |+------------+-----------+------+------+--------+| SAO        | A         |   <span class="hljs-number">25</span> | M    |  <span class="hljs-number">10000</span> || SAO        | B         |   <span class="hljs-number">25</span> | M    |  <span class="hljs-number">10000</span> || SAO        | C         |   <span class="hljs-number">25</span> | M    |  <span class="hljs-number">10000</span> || SAO        | D         |   <span class="hljs-number">25</span> | M    |  <span class="hljs-number">10000</span> || SAO        | F         |   <span class="hljs-number">25</span> | M    |    <span class="hljs-number">500</span> || SAO        | G         |   <span class="hljs-number">25</span> | M    |   <span class="hljs-number">1000</span> || SAO        | H         |   <span class="hljs-number">25</span> | M    |   <span class="hljs-number">1100</span> |+------------+-----------+------+------+--------+<span class="hljs-number">7</span> rows <span class="hljs-keyword">in</span> set (<span class="hljs-number">0.00</span> sec)# encoding=utf-8<span class="hljs-keyword">import</span> pymysql# æ‰“å¼€æ•°æ®åº“è¿æ¥db = pymysql.connect(<span class="hljs-string">&quot;localhost&quot;</span>,<span class="hljs-string">&quot;root&quot;</span>,<span class="hljs-string">&quot;666666&quot;</span>,<span class="hljs-string">&quot;test&quot;</span> )# ä½¿ç”¨cursor()æ–¹æ³•è·å–æ“ä½œæ¸¸æ ‡cursor = db.cursor()# SQL æŸ¥è¯¢è¯­å¥sql = <span class="hljs-string">&quot;SELECT * FROM testPyMySQL_tbl \</span><span class="hljs-string">       WHERE INCOME &gt; &#x27;%d&#x27;&quot;</span> % (<span class="hljs-number">1000</span>)<span class="hljs-keyword">try</span>:   # æ‰§è¡ŒSQLè¯­å¥   cursor.execute(sql)   # è·å–æ‰€æœ‰è®°å½•åˆ—è¡¨   results = cursor.fetchall()   <span class="hljs-keyword">for</span> row <span class="hljs-keyword">in</span> results:      fname = row[<span class="hljs-number">0</span>]      lname = row[<span class="hljs-number">1</span>]      age = row[<span class="hljs-number">2</span>]      sex = row[<span class="hljs-number">3</span>]      income = row[<span class="hljs-number">4</span>]       # æ‰“å°ç»“æœ      print (<span class="hljs-string">&quot;fname=%s,lname=%s,age=%d,sex=%s,income=%d&quot;</span> % \             (fname, lname, age, sex, income ))except:   print (<span class="hljs-string">&quot;Error: unable to fetch data&quot;</span>)# å…³é—­æ•°æ®åº“è¿æ¥db.close()</code></pre><p>ç»“æœï¼š<br>fname=SAO,lname=A,age=25,sex=M,income=10000<br>fname=SAO,lname=B,age=25,sex=M,income=10000<br>fname=SAO,lname=C,age=25,sex=M,income=10000<br>fname=SAO,lname=D,age=25,sex=M,income=10000<br>fname=SAO,lname=H,age=25,sex=M,income=1100</p><h2 id="æ•°æ®åº“æ›´æ–°æ“ä½œ"><a href="#æ•°æ®åº“æ›´æ–°æ“ä½œ" class="headerlink" title="æ•°æ®åº“æ›´æ–°æ“ä½œ"></a>æ•°æ®åº“æ›´æ–°æ“ä½œ</h2><p><strong>å®ä¾‹ï¼š</strong>#æ›´æ–°æ“ä½œç”¨äºæ›´æ–°æ•°æ®è¡¨çš„çš„æ•°æ®ï¼Œä»¥ä¸‹å®ä¾‹å°† testPyMySQL_tblè¡¨ä¸­çš„ SEX ä¸º â€˜Mâ€™çš„AGE å­—æ®µé€’å¢1ï¼š</p><pre><code class="hljs javascript">#encoding=utf-8<span class="hljs-keyword">import</span> pymysql# æ‰“å¼€æ•°æ®åº“è¿æ¥db = pymysql.connect(<span class="hljs-string">&quot;localhost&quot;</span>,<span class="hljs-string">&quot;root&quot;</span>,<span class="hljs-string">&quot;666666&quot;</span>,<span class="hljs-string">&quot;test&quot;</span> )# ä½¿ç”¨cursor()æ–¹æ³•è·å–æ“ä½œæ¸¸æ ‡cursor = db.cursor()# SQL æ›´æ–°è¯­å¥sql = <span class="hljs-string">&quot;UPDATE testPyMySQL_tbl SET AGE = AGE + 1 WHERE SEX = &#x27;%c&#x27;&quot;</span> % (<span class="hljs-string">&#x27;M&#x27;</span>)<span class="hljs-keyword">try</span>:   # æ‰§è¡ŒSQLè¯­å¥   cursor.execute(sql)   # æäº¤åˆ°æ•°æ®åº“æ‰§è¡Œ   db.commit()except:   # å‘ç”Ÿé”™è¯¯æ—¶å›æ»š   db.rollback()# å…³é—­æ•°æ®åº“è¿æ¥db.close()</code></pre><h2 id="åˆ é™¤æ“ä½œ"><a href="#åˆ é™¤æ“ä½œ" class="headerlink" title="åˆ é™¤æ“ä½œ"></a>åˆ é™¤æ“ä½œ</h2><p>åˆ é™¤è¡¨ä¸­çš„æ•°å€¼<br><strong>å®ä¾‹ï¼š</strong>åˆ é™¤è¡¨ä¸­AGEå°äº18çš„æ‰€æœ‰æ•°æ®ï¼š</p><pre><code class="hljs javascript">mysql&gt; SELECT * FROM testPyMySQL_tbl;+------------+-----------+------+------+--------+| FIRST_NAME | LAST_NAME | AGE  | SEX  | INCOME |+------------+-----------+------+------+--------+| SAO        | A         |   <span class="hljs-number">16</span> | M    |  <span class="hljs-number">10000</span> || SAO        | B         |   <span class="hljs-number">27</span> | M    |  <span class="hljs-number">10000</span> || SAO        | C         |   <span class="hljs-number">18</span> | M    |  <span class="hljs-number">10000</span> || SAO        | D         |   <span class="hljs-number">15</span> | M    |  <span class="hljs-number">10000</span> || SAO        | F         |   <span class="hljs-number">27</span> | M    |    <span class="hljs-number">500</span> || SAO        | G         |   <span class="hljs-number">27</span> | M    |   <span class="hljs-number">1000</span> || SAO        | H         |   <span class="hljs-number">17</span> | M    |   <span class="hljs-number">1100</span> |+------------+-----------+------+------+--------+<span class="hljs-number">7</span> rows <span class="hljs-keyword">in</span> set (<span class="hljs-number">0.00</span> sec)# encoding=utf-8<span class="hljs-keyword">import</span> pymysql# æ‰“å¼€æ•°æ®åº“è¿æ¥db = pymysql.connect(<span class="hljs-string">&quot;localhost&quot;</span>,<span class="hljs-string">&quot;root&quot;</span>,<span class="hljs-string">&quot;666666&quot;</span>,<span class="hljs-string">&quot;test&quot;</span> )# ä½¿ç”¨cursor()æ–¹æ³•è·å–æ“ä½œæ¸¸æ ‡cursor = db.cursor()# SQL åˆ é™¤è¯­å¥sql = <span class="hljs-string">&quot;DELETE FROM testPyMySQL_tbl WHERE AGE &lt; &#x27;%d&#x27;&quot;</span> % (<span class="hljs-number">18</span>)<span class="hljs-keyword">try</span>:   # æ‰§è¡ŒSQLè¯­å¥   cursor.execute(sql)   # æäº¤ä¿®æ”¹   db.commit()except:   # å‘ç”Ÿé”™è¯¯æ—¶å›æ»š   db.rollback()# å…³é—­è¿æ¥db.close()mysql&gt; SELECT * FROM testPyMySQL_tbl;+------------+-----------+------+------+--------+| FIRST_NAME | LAST_NAME | AGE  | SEX  | INCOME |+------------+-----------+------+------+--------+| SAO        | B         |   <span class="hljs-number">27</span> | M    |  <span class="hljs-number">10000</span> || SAO        | C         |   <span class="hljs-number">18</span> | M    |  <span class="hljs-number">10000</span> || SAO        | F         |   <span class="hljs-number">27</span> | M    |    <span class="hljs-number">500</span> || SAO        | G         |   <span class="hljs-number">27</span> | M    |   <span class="hljs-number">1000</span> |+------------+-----------+------+------+--------+<span class="hljs-number">4</span> rows <span class="hljs-keyword">in</span> set (<span class="hljs-number">0.00</span> sec)</code></pre>]]></content>
    
    
    <categories>
      
      <category>Python</category>
      
    </categories>
    
    
    <tags>
      
      <tag>Python</tag>
      
      <tag>MySQL</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>MySQLä»å…¥é—¨åˆ°åˆ åº“è·‘è·¯</title>
    <link href="/2018/01/19/MySQL/"/>
    <url>/2018/01/19/MySQL/</url>
    
    <content type="html"><![CDATA[<p>Mysqlæ˜¯æœ€æµè¡Œçš„å…³ç³»å‹æ•°æ®åº“ç®¡ç†ç³»ç»Ÿï¼Œåœ¨WEBåº”ç”¨æ–¹é¢MySQLæ˜¯æœ€å¥½çš„RDBMS(Relational Database Management Systemï¼šå…³ç³»æ•°æ®åº“ç®¡ç†ç³»ç»Ÿ)åº”ç”¨è½¯ä»¶ä¹‹ä¸€ã€‚</p><a id="more"></a><h1 id="ä¸€ã€ä»€ä¹ˆæ˜¯æ•°æ®åº“ï¼Ÿ"><a href="#ä¸€ã€ä»€ä¹ˆæ˜¯æ•°æ®åº“ï¼Ÿ" class="headerlink" title="ä¸€ã€ä»€ä¹ˆæ˜¯æ•°æ®åº“ï¼Ÿ"></a>ä¸€ã€ä»€ä¹ˆæ˜¯æ•°æ®åº“ï¼Ÿ</h1><p>æ•°æ®åº“ï¼ˆDatabaseï¼‰æ˜¯æŒ‰ç…§æ•°æ®ç»“æ„æ¥ç»„ç»‡ã€å­˜å‚¨å’Œç®¡ç†æ•°æ®çš„ä»“åº“ï¼Œæ¯ä¸ªæ•°æ®åº“éƒ½æœ‰ä¸€ä¸ªæˆ–å¤šä¸ªä¸åŒçš„APIç”¨äºåˆ›å»ºï¼Œè®¿é—®ï¼Œç®¡ç†ï¼Œæœç´¢å’Œå¤åˆ¶æ‰€ä¿å­˜çš„æ•°æ®ã€‚æˆ‘ä»¬ä¹Ÿå¯ä»¥å°†æ•°æ®å­˜å‚¨åœ¨æ–‡ä»¶ä¸­ï¼Œä½†æ˜¯åœ¨æ–‡ä»¶ä¸­è¯»å†™æ•°æ®é€Ÿåº¦ç›¸å¯¹è¾ƒæ…¢ã€‚æ‰€ä»¥ï¼Œç°åœ¨æˆ‘ä»¬ä½¿ç”¨å…³ç³»å‹æ•°æ®åº“ç®¡ç†ç³»ç»Ÿï¼ˆRDBMSï¼‰æ¥å­˜å‚¨å’Œç®¡ç†çš„å¤§æ•°æ®é‡ã€‚æ‰€è°“çš„å…³ç³»å‹æ•°æ®åº“ï¼Œæ˜¯å»ºç«‹åœ¨å…³ç³»æ¨¡å‹åŸºç¡€ä¸Šçš„æ•°æ®åº“ï¼Œå€ŸåŠ©äºé›†åˆä»£æ•°ç­‰æ•°å­¦æ¦‚å¿µå’Œæ–¹æ³•æ¥å¤„ç†æ•°æ®åº“ä¸­çš„æ•°æ®ã€‚<br>RDBMSå³å…³ç³»æ•°æ®åº“ç®¡ç†ç³»ç»Ÿ(Relational Database Management System)çš„ç‰¹ç‚¹ï¼š</p><ul><li>1.æ•°æ®ä»¥è¡¨æ ¼çš„å½¢å¼å‡ºç°</li><li>2.æ¯è¡Œä¸ºå„ç§è®°å½•åç§°</li><li>3.æ¯åˆ—ä¸ºè®°å½•åç§°æ‰€å¯¹åº”çš„æ•°æ®åŸŸ</li><li>4.è®¸å¤šçš„è¡Œå’Œåˆ—ç»„æˆä¸€å¼ è¡¨å•</li><li>5.è‹¥å¹²çš„è¡¨å•ç»„æˆdatabase</li></ul><h1 id="äºŒã€RDBMS-æœ¯è¯­"><a href="#äºŒã€RDBMS-æœ¯è¯­" class="headerlink" title="äºŒã€RDBMS æœ¯è¯­"></a>äºŒã€RDBMS æœ¯è¯­</h1><ul><li>æ•°æ®åº“: æ•°æ®åº“æ˜¯ä¸€äº›å…³è”è¡¨çš„é›†åˆã€‚.</li><li>æ•°æ®è¡¨: è¡¨æ˜¯æ•°æ®çš„çŸ©é˜µã€‚åœ¨ä¸€ä¸ªæ•°æ®åº“ä¸­çš„è¡¨çœ‹èµ·æ¥åƒä¸€ä¸ªç®€å•çš„ç”µå­è¡¨æ ¼ã€‚</li><li>åˆ—: ä¸€åˆ—(æ•°æ®å…ƒç´ ) åŒ…å«äº†ç›¸åŒçš„æ•°æ®, ä¾‹å¦‚é‚®æ”¿ç¼–ç çš„æ•°æ®ã€‚</li><li>è¡Œï¼šä¸€è¡Œï¼ˆ=å…ƒç»„ï¼Œæˆ–è®°å½•ï¼‰æ˜¯ä¸€ç»„ç›¸å…³çš„æ•°æ®ï¼Œä¾‹å¦‚ä¸€æ¡ç”¨æˆ·è®¢é˜…çš„æ•°æ®ã€‚</li><li>å†—ä½™ï¼šå­˜å‚¨ä¸¤å€æ•°æ®ï¼Œå†—ä½™é™ä½äº†æ€§èƒ½ï¼Œä½†æé«˜äº†æ•°æ®çš„å®‰å…¨æ€§ã€‚</li><li>ä¸»é”®ï¼šä¸»é”®æ˜¯å”¯ä¸€çš„ã€‚ä¸€ä¸ªæ•°æ®è¡¨ä¸­åªèƒ½åŒ…å«ä¸€ä¸ªä¸»é”®ã€‚ä½ å¯ä»¥ä½¿ç”¨ä¸»é”®æ¥æŸ¥è¯¢æ•°æ®ã€‚</li><li>å¤–é”®ï¼šå¤–é”®ç”¨äºå…³è”ä¸¤ä¸ªè¡¨ã€‚</li><li>å¤åˆé”®ï¼šå¤åˆé”®ï¼ˆç»„åˆé”®ï¼‰å°†å¤šä¸ªåˆ—ä½œä¸ºä¸€ä¸ªç´¢å¼•é”®ï¼Œä¸€èˆ¬ç”¨äºå¤åˆç´¢å¼•ã€‚</li><li>ç´¢å¼•ï¼šä½¿ç”¨ç´¢å¼•å¯å¿«é€Ÿè®¿é—®æ•°æ®åº“è¡¨ä¸­çš„ç‰¹å®šä¿¡æ¯ã€‚ç´¢å¼•æ˜¯å¯¹æ•°æ®åº“è¡¨ä¸­ä¸€åˆ—æˆ–å¤šåˆ—çš„å€¼è¿›è¡Œæ’åºçš„ä¸€ç§ç»“æ„ã€‚ç±»ä¼¼äºä¹¦ç±çš„ç›®å½•ã€‚</li><li>å‚ç…§å®Œæ•´æ€§: å‚ç…§çš„å®Œæ•´æ€§è¦æ±‚å…³ç³»ä¸­ä¸å…è®¸å¼•ç”¨ä¸å­˜åœ¨çš„å®ä½“ã€‚ä¸å®ä½“å®Œæ•´æ€§æ˜¯å…³ç³»æ¨¡å‹å¿…é¡»æ»¡è¶³çš„å®Œæ•´æ€§çº¦æŸæ¡ä»¶ï¼Œç›®çš„æ˜¯ä¿è¯æ•°æ®çš„ä¸€è‡´æ€§ã€‚</li></ul><h1 id="ä¸‰ã€ä½¿ç”¨MySQL-Clientæ‰§è¡Œç®€å•çš„SQLå‘½ä»¤"><a href="#ä¸‰ã€ä½¿ç”¨MySQL-Clientæ‰§è¡Œç®€å•çš„SQLå‘½ä»¤" class="headerlink" title="ä¸‰ã€ä½¿ç”¨MySQL Clientæ‰§è¡Œç®€å•çš„SQLå‘½ä»¤"></a>ä¸‰ã€ä½¿ç”¨MySQL Clientæ‰§è¡Œç®€å•çš„SQLå‘½ä»¤</h1><p>è¿æ¥åˆ°MySQLæœåŠ¡å™¨ä¸Šï¼Œåœ¨MACä¸Šï¼Œå¯ä»¥å…ˆåˆ°<strong>ç³»ç»Ÿåå¥½è®¾ç½®</strong>é‡Œå°†MySQLæœåŠ¡æ‰“å¼€ï¼š<br><img src="/img/mysql/start_MySQL.png"><br><img src="/img/mysql/start_MySQL2.png"></p><p>åœ¨ç»ˆç«¯è¾“å…¥å‘½ä»¤ï¼š</p><pre><code class="hljs sql">ecarry:~ ecarry$ mysql -u root -p</code></pre><blockquote><p>å…¶ä¸­ -uä¸ºç”¨æˆ·ï¼Œåé¢ç´§è·Ÿrootï¼Œæ„ä¸ºä»¥rootè´¦æˆ·ç™»å½•ï¼Œ -pä¸ºå¯†ç </p></blockquote><pre><code class="hljs sql">ecarry:~ ecarry$ mysql -u root -pEnter password: mysql&gt;</code></pre><h1 id="å››ã€æ›´æ”¹å¯†ç "><a href="#å››ã€æ›´æ”¹å¯†ç " class="headerlink" title="å››ã€æ›´æ”¹å¯†ç "></a>å››ã€æ›´æ”¹å¯†ç </h1><p>è€ç‰ˆæœ¬çš„MySQLå®‰è£…æˆåŠŸåï¼Œé»˜è®¤çš„rootç”¨æˆ·å’Œå¯†ç ä¸ºç©ºï¼Œå¯ä»¥ä½¿ç”¨å‘½ä»¤æ¥åˆ›å»ºrootç”¨æˆ·å’Œå¯†ç ï¼š</p><blockquote><p>æˆ‘ä½¿ç”¨MySQLçš„ç‰ˆæœ¬æ˜¯5.6.39ï¼Œå¯ä»¥ç”¨<code>mysql --version</code>å‘½ä»¤æ¥æŸ¥çœ‹å½“å‰ç‰ˆæœ¬</p></blockquote><pre><code class="hljs sql">ecarry:~ ecarry$ mysql <span class="hljs-comment">--version</span>mysql  Ver 14.14 Distrib 5.6.39, for macos10.13 (x86_64) using  EditLine wrapper</code></pre><p>ä½¿ç”¨<code>mysqladmin -u root password &quot;new_password&quot;</code>æ¥æ›´æ”¹å¯†ç :</p><pre><code class="hljs sql">ecarry:~ ecarry$ mysqladmin -u root password new_password</code></pre><h1 id="äº”ã€åŸºæœ¬æ“ä½œ"><a href="#äº”ã€åŸºæœ¬æ“ä½œ" class="headerlink" title="äº”ã€åŸºæœ¬æ“ä½œ"></a>äº”ã€åŸºæœ¬æ“ä½œ</h1><h2 id="5-1-MySQLç”¨æˆ·è®¾ç½®"><a href="#5-1-MySQLç”¨æˆ·è®¾ç½®" class="headerlink" title="5.1 MySQLç”¨æˆ·è®¾ç½®"></a>5.1 MySQLç”¨æˆ·è®¾ç½®</h2><p>æ·»åŠ MySQLç”¨æˆ·ï¼Œåœ¨mysqlæ•°æ®åº“ä¸­çš„userè¡¨æ·»åŠ æ–°ç”¨æˆ·å³å¯ã€‚<br>ä¸‹é¢å®ä¾‹å°†æ·»åŠ ç”¨æˆ·åä¸ºguestï¼Œå¯†ç ä¸ºguest123ï¼Œæƒé™å¯è¿›è¡Œ<strong>SELECT</strong>,<strong>INSERT</strong>å’Œ<strong>UPDATE</strong>æ“ä½œæƒé™ï¼š</p><pre><code class="hljs sql">mysql&gt; use mysql;Reading table information for completion of table and column namesYou can turn off this feature to get a quicker startup <span class="hljs-keyword">with</span> -A<span class="hljs-keyword">Database</span> <span class="hljs-keyword">changed</span>mysql&gt; <span class="hljs-keyword">INSERT</span> <span class="hljs-keyword">INTO</span> <span class="hljs-keyword">user</span>    -&gt; (host,<span class="hljs-keyword">user</span>,<span class="hljs-keyword">password</span>,    -&gt; select_priv,insert_priv,update_priv)    -&gt; <span class="hljs-keyword">VALUES</span>(<span class="hljs-string">&#x27;localhost&#x27;</span>,<span class="hljs-string">&#x27;guest&#x27;</span>,    -&gt; <span class="hljs-keyword">PASSWORD</span>(<span class="hljs-string">&#x27;guest123&#x27;</span>),<span class="hljs-string">&#x27;Y&#x27;</span>,<span class="hljs-string">&#x27;Y&#x27;</span>,<span class="hljs-string">&#x27;Y&#x27;</span>);Query OK, 1 row affected, 3 warnings (0.00 sec)mysql&gt; FLUSH PRIVILEGES;Query OK, 0 rows affected (0.00 sec)mysql&gt; SELECT host,user,password FROM user WHERE user = &#x27;guest&#x27;;+<span class="hljs-comment">-----------+-------+-------------------------------------------+</span>| host      | user  | password                                  |+<span class="hljs-comment">-----------+-------+-------------------------------------------+</span>| localhost | guest | *F1573429579994EEA4459170FDAC55DF96C4BBE6 |+<span class="hljs-comment">-----------+-------+-------------------------------------------+</span>1 row in <span class="hljs-keyword">set</span> (<span class="hljs-number">0.00</span> sec)</code></pre><p>åœ¨æ·»åŠ ç”¨æˆ·æ—¶ï¼Œè¯·æ³¨æ„ä½¿ç”¨MySQLæä¾›çš„PASSWORD()å‡½æ•°æ¥å¯¹å¯†ç è¿›è¡ŒåŠ å¯†ï¼Œå¯ä»¥åœ¨åé¢çœ‹åˆ°å¯†ç ä¸ºï¼š*F1573429579994EEA4459170FDAC55DF96C4BBE6</p><p><strong>æ³¨æ„ï¼š</strong>åœ¨MySQL5.7ä¸­userè¡¨çš„passwordæ¢æˆäº†authentication_stringã€‚<br><strong>æ³¨æ„ï¼š</strong><code>FLUSH PRIVILEGES</code>è¯­å¥ï¼Œè¿™ä¸ªå‘½ä»¤æ‰§è¡Œåä¼šé‡æ–°è½½å…¥æˆæƒè¡¨ã€‚ä¸ä½¿ç”¨è¿™ä¸ªå‘½ä»¤ï¼Œå°†æ— æ³•ä½¿ç”¨æ–°åˆ›å»ºçš„ç”¨æˆ·æ¥è¿æ¥MySQLæœåŠ¡å™¨ï¼Œé™¤éé‡å¯MySQLæœåŠ¡å™¨ã€‚<br>åœ¨åˆ›å»ºç”¨æˆ·æ—¶ï¼Œå¯ä»¥ç»™ç”¨æˆ·æŒ‡å®šæƒé™ï¼Œåœ¨å¯¹åº”æƒé™åˆ—ä¸­ï¼Œåœ¨æ’å…¥è¯­å¥ä¸­è®¾ç½®ä¸ºâ€™Yâ€™å³å¯ã€‚</p><p><strong>ç”¨æˆ·æƒé™è¡¨ï¼š</strong></p><ul><li>SELECT_PRIVï¼šé€‰æ‹©æ•°æ®</li><li>INSERT_PRIVï¼šæ’å…¥æ•°æ®</li><li>UPDATE_PRIVï¼šä¿®æ”¹ç°æœ‰æ•°æ®</li><li>DELETE_PRIVï¼šåˆ é™¤ç°æœ‰æ•°æ®</li><li>CREATE_PRIVï¼šåˆ›å»ºæ–°çš„æ•°æ®åº“å’Œè¡¨</li><li>DROP_PRIVï¼šåˆ é™¤ç°æœ‰æ•°æ®åº“å’Œè¡¨</li><li>RELOAD_PRIVï¼šæ‰§è¡Œåˆ·æ–°å’Œé‡æ–°åŠ è½½MySQLæ‰€ç”¨å„ç§å†…éƒ¨ç¼“å­˜çš„ç‰¹å®šå‘½ä»¤ï¼ŒåŒ…æ‹¬æ—¥å¿—ï¼Œæƒé™ï¼Œä¸»æœºï¼ŒæŸ¥è¯¢å’Œè¡¨</li><li>SHUTDOWN_PRIVï¼šå…³é—­MySQLæœåŠ¡å™¨</li><li>PROCESS_PRIVï¼šå¯ä»¥é€šè¿‡SHOW PROCESSLISTå‘½ä»¤æŸ¥çœ‹å…¶å®ƒç”¨æˆ·çš„è¿›ç¨‹</li><li>FILE_PRIVï¼šæ‰§è¡ŒSELECT INTO OUTFILE å’ŒLOADDATA INFILEå‘½ä»¤</li><li>GRANT_PRIVï¼šå°†å·²ç»æˆäºˆç»™è¯¥ç”¨æˆ·è‡ªå·±çš„æƒé™å†æˆäºˆå…¶å®ƒç”¨æˆ·ã€‚</li><li>REFERENCES_PRIV</li><li>INDEX_PRIVï¼šåˆ›å»ºå’Œåˆ é™¤è¡¨ç´¢å¼•</li><li>ALTER_PRIVï¼šé‡å‘½åå’Œä¿®æ”¹è¡¨ç»“æ„</li></ul><h3 id="5-1-1-ç®¡ç†MySQLçš„å‘½ä»¤"><a href="#5-1-1-ç®¡ç†MySQLçš„å‘½ä»¤" class="headerlink" title="5.1.1 ç®¡ç†MySQLçš„å‘½ä»¤"></a>5.1.1 ç®¡ç†MySQLçš„å‘½ä»¤</h3><p> <strong>SHOW DATABASES</strong><br>åˆ—å‡ºMySQLæ•°æ®åº“ç®¡ç†ç³»ç»Ÿçš„æ•°æ®åº“åˆ—è¡¨ï¼š</p><pre><code class="hljs sql">mysql&gt; SHOW DATABASES;+<span class="hljs-comment">--------------------+</span>| Database           |+<span class="hljs-comment">--------------------+</span>| information_schema || test               |+<span class="hljs-comment">--------------------+</span>2 rows in <span class="hljs-keyword">set</span> (<span class="hljs-number">0.00</span> sec)</code></pre><p> <strong>USE æ•°æ®åº“å</strong><br>é€‰æ‹©è¦æ“ä½œçš„MySQLæ•°æ®åº“ï¼Œä½¿ç”¨è¿™å‘½ä»¤åæ‰€æœ‰mysqlå‘½ä»¤éƒ½åªé’ˆå¯¹è¯¥æ•°æ®åº“ã€‚</p><pre><code class="hljs sql">mysql&gt; USE test;Database changed</code></pre><p> <strong>SHOW TABLES</strong><br>æ˜¾ç¤ºæŒ‡å®šæ•°æ®åº“çš„æ‰€æœ‰è¡¨ï¼Œä½¿ç”¨è¯¥å‘½ä»¤å‰éœ€è¦ä½¿ç”¨USEå‘½ä»¤æ¥é€‰æ‹©è¦æ“ä½œçš„æ•°æ®åº“ã€‚</p><pre><code class="hljs sql">mysql&gt; USE mysql;Database changedmysql&gt; SHOW TABLES;+<span class="hljs-comment">---------------------------+</span>| Tables_in_mysql           |+<span class="hljs-comment">---------------------------+</span>| columns_priv              || db                        || event                     || time_zone_transition_type || user                      |+<span class="hljs-comment">---------------------------+</span>28 rows in <span class="hljs-keyword">set</span> (<span class="hljs-number">0.00</span> sec)</code></pre><p> <strong>SHOW COLUMNS FROM æ•°æ®è¡¨</strong><br>æ˜¾ç¤ºæ•°æ®è¡¨çš„å±æ€§ï¼Œå±æ€§ç±»å‹ï¼Œä¸»é”®ä¿¡æ¯ï¼Œæ˜¯å¦ä¸ºNULLï¼Œé»˜è®¤å€¼ç­‰ å…¶ä»–ä¿¡æ¯ã€‚</p><pre><code class="hljs sql">mysql&gt; SHOW COLUMNS FROM user;+<span class="hljs-comment">------------------------+-----------------------------------+------+-----+-----------------------+-------+</span>| Field                  | Type                              | Null | Key | Default               | Extra |+<span class="hljs-comment">------------------------+-----------------------------------+------+-----+-----------------------+-------+</span>| Host                   | char(60)                          | NO   | PRI |                       |       || User                   | char(16)                          | NO   | PRI |                       |       || Password               | char(41)                          | NO   |     |                       |       || Select_priv            | enum(&#x27;N&#x27;,&#x27;Y&#x27;)                     | NO   |     | N                     |       || ssl_type               | enum(&#x27;&#x27;,&#x27;ANY&#x27;,&#x27;X509&#x27;,&#x27;SPECIFIED&#x27;) | NO   |     |                       |       || x509_subject           | blob                              | NO   |     | NULL                  |       || max_user_connections   | int(11) unsigned                  | NO   |     | 0                     |       || plugin                 | char(64)                          | YES  |     | mysql_native_password |       || authentication_string  | text                              | YES  |     | NULL                  |       || password_expired       | enum(&#x27;N&#x27;,&#x27;Y&#x27;)                     | NO   |     | N                     |       |+<span class="hljs-comment">------------------------+-----------------------------------+------+-----+-----------------------+-------+</span>43 rows in <span class="hljs-keyword">set</span> (<span class="hljs-number">0.00</span> sec)</code></pre><p> <strong>SHOW INDES FROM æ•°æ®è¡¨</strong><br>æ˜¾ç¤ºæ•°æ®è¡¨çš„è¯¦ç»†ç´¢å¼•ä¿¡æ¯ï¼ŒåŒ…æ‹¬PRIMARY KEYï¼ˆä¸»é”®ï¼‰ã€‚</p><pre><code class="hljs sql">mysql&gt; SHOW INDEX FROM user;+<span class="hljs-comment">-------+------------+----------+--------------+-------------+-----------+-------------+----------+--------+------+------------+---------+---------------+</span>| Table | Non_unique | Key_name | Seq_in_index | Column_name | Collation | Cardinality | Sub_part | Packed | Null | Index_type | <span class="hljs-keyword">Comment</span> | Index_comment |+<span class="hljs-comment">-------+------------+----------+--------------+-------------+-----------+-------------+----------+--------+------+------------+---------+---------------+</span>| <span class="hljs-keyword">user</span>  |          <span class="hljs-number">0</span> | PRIMARY  |            <span class="hljs-number">1</span> | Host        | A         |        <span class="hljs-literal">NULL</span> |     <span class="hljs-literal">NULL</span> | <span class="hljs-literal">NULL</span>   |      | BTREE      |         |               || <span class="hljs-keyword">user</span>  |          <span class="hljs-number">0</span> | PRIMARY  |            <span class="hljs-number">2</span> | <span class="hljs-keyword">User</span>        | A         |           <span class="hljs-number">7</span> |     <span class="hljs-literal">NULL</span> | <span class="hljs-literal">NULL</span>   |      | BTREE      |         |               |+<span class="hljs-comment">-------+------------+----------+--------------+-------------+-----------+-------------+----------+--------+------+------------+---------+---------------+</span><span class="hljs-number">2</span> <span class="hljs-keyword">rows</span> <span class="hljs-keyword">in</span> <span class="hljs-keyword">set</span> (<span class="hljs-number">0.01</span> sec)</code></pre><h2 id="5-2-MySQLåˆ›å»ºæ•°æ®åº“"><a href="#5-2-MySQLåˆ›å»ºæ•°æ®åº“" class="headerlink" title="5.2 MySQLåˆ›å»ºæ•°æ®åº“"></a>5.2 MySQLåˆ›å»ºæ•°æ®åº“</h2><p><strong>ä½¿ç”¨mysqladminåˆ›å»ºæ•°æ®åº“ï¼š</strong></p><pre><code class="hljs sql">ecarry:~ ecarry$ mysqladmin -u root -p <span class="hljs-keyword">create</span> <span class="hljs-keyword">test</span>Enter <span class="hljs-keyword">password</span>:</code></pre><h2 id="5-3-MySQLåˆ é™¤æ•°æ®åº“"><a href="#5-3-MySQLåˆ é™¤æ•°æ®åº“" class="headerlink" title="5.3 MySQLåˆ é™¤æ•°æ®åº“"></a>5.3 MySQLåˆ é™¤æ•°æ®åº“</h2><p> <strong>ä½¿ç”¨mysqladminåˆ é™¤æ•°æ®åº“ï¼š</strong></p><pre><code class="hljs sql">ecarry:~ ecarry$ mysqladmin -u root -p <span class="hljs-keyword">drop</span> <span class="hljs-keyword">test</span>Enter <span class="hljs-keyword">password</span>:Dropping the <span class="hljs-keyword">database</span> <span class="hljs-keyword">is</span> potentially a very bad thing <span class="hljs-keyword">to</span> do.<span class="hljs-keyword">Any</span> <span class="hljs-keyword">data</span> <span class="hljs-keyword">stored</span> <span class="hljs-keyword">in</span> the <span class="hljs-keyword">database</span> will be destroyed.<span class="hljs-keyword">Do</span> you really want <span class="hljs-keyword">to</span> <span class="hljs-keyword">drop</span> the <span class="hljs-string">&#x27;test&#x27;</span> <span class="hljs-keyword">database</span> [y/N] y<span class="hljs-keyword">Database</span> <span class="hljs-string">&quot;test&quot;</span> dropped</code></pre><h2 id="5-4-MySQLæ•°æ®ç±»å‹"><a href="#5-4-MySQLæ•°æ®ç±»å‹" class="headerlink" title="5.4 MySQLæ•°æ®ç±»å‹"></a>5.4 MySQLæ•°æ®ç±»å‹</h2><p>MySQLæ”¯æŒå¤šç§ç±»å‹ï¼Œå¤§è‡´å¯ä»¥åˆ†ä¸ºä¸‰ç±»ï¼šæ•°å€¼ã€æ—¥æœŸ/æ—¶é—´å’Œå­—ç¬¦ä¸²ï¼ˆå­—ç¬¦ï¼‰ç±»å‹ã€‚</p><p> <strong>æ•°å€¼ç±»å‹</strong></p><p>MySQLæ”¯æŒæ‰€æœ‰æ ‡å‡†SQLæ•°å€¼æ•°æ®ç±»å‹ã€‚<br>è¿™äº›ç±»å‹åŒ…æ‹¬ä¸¥æ ¼æ•°å€¼æ•°æ®ç±»å‹(INTEGERã€SMALLINTã€DECIMALå’ŒNUMERIC)ï¼Œä»¥åŠè¿‘ä¼¼æ•°å€¼æ•°æ®ç±»å‹(FLOATã€REALå’ŒDOUBLE PRECISION)ã€‚<br>å…³é”®å­—INTæ˜¯INTEGERçš„åŒä¹‰è¯ï¼Œå…³é”®å­—DECæ˜¯DECIMALçš„åŒä¹‰è¯ã€‚<br>BITæ•°æ®ç±»å‹ä¿å­˜ä½å­—æ®µå€¼ï¼Œå¹¶ä¸”æ”¯æŒMyISAMã€MEMORYã€InnoDBå’ŒBDBè¡¨ã€‚<br>ä½œä¸ºSQLæ ‡å‡†çš„æ‰©å±•ï¼ŒMySQLä¹Ÿæ”¯æŒæ•´æ•°ç±»å‹TINYINTã€MEDIUMINTå’ŒBIGINTã€‚ä¸‹é¢çš„è¡¨æ˜¾ç¤ºäº†éœ€è¦çš„æ¯ä¸ªæ•´æ•°ç±»å‹çš„å­˜å‚¨å’ŒèŒƒå›´ã€‚</p><table><thead><tr><th>ç±»å‹</th><th align="center">å¤§å°</th><th align="center">èŒƒå›´ï¼ˆæœ‰ç¬¦å·ï¼‰</th><th align="center">èŒƒå›´ï¼ˆæ— ç¬¦å·ï¼‰</th><th align="center">ç”¨é€”</th></tr></thead><tbody><tr><td>TINYINT</td><td align="center">1å­—èŠ‚</td><td align="center">(-128ï¼Œ127)</td><td align="center">(0ï¼Œ255)</td><td align="center">å°æ•´æ•°å€¼</td></tr><tr><td>SMALLINT</td><td align="center">2å­—èŠ‚</td><td align="center">(-32 768ï¼Œ32 767)</td><td align="center">(0ï¼Œ65 535)</td><td align="center">å¤§æ•´æ•°å€¼</td></tr><tr><td>MEDIUMINT</td><td align="center">3å­—èŠ‚</td><td align="center">(-8 388 608ï¼Œ8 388 607)</td><td align="center">(0ï¼Œ16 777 215)</td><td align="center">å¤§æ•´æ•°å€¼</td></tr><tr><td>INTæˆ–INTEGER</td><td align="center">4å­—èŠ‚</td><td align="center">(-2 147 483 648ï¼Œ<br>2 147 483 647)</td><td align="center">(0ï¼Œ4 294 967 295)</td><td align="center">å¤§æ•´æ•°å€¼</td></tr><tr><td>BIGINT</td><td align="center">8å­—èŠ‚</td><td align="center">(-9 233 372 036 854 775 808ï¼Œ<br>9 223 372 036 854 775 807)</td><td align="center">(0ï¼Œ18 446 744 073 709 551 615)</td><td align="center">æå¤§æ•´æ•°å€¼</td></tr><tr><td>FLOAT</td><td align="center">4å­—èŠ‚</td><td align="center">(-3.402 823 466 E+38ï¼Œ<br>-1.175 494 351 E-38)ï¼Œ0ï¼Œ(1.175 494 351 E-38ï¼Œ<br>3.402 823 466 351 E+38)</td><td align="center">0ï¼Œ(1.175 494 351 E-38ï¼Œ<br>3.402 823 466 E+38)</td><td align="center">å•ç²¾åº¦/æµ®ç‚¹æ•°å€¼</td></tr><tr><td>DOUBLE</td><td align="center">8å­—èŠ‚</td><td align="center">(-1.797 693 134 862 315 7 E+308ï¼Œ<br>-2.225 073 858 507 201 4 E-308)ï¼Œ0ï¼Œ(2.225 073 858 507 201 4 E-308ï¼Œ<br>1.797 693 134 862 315 7 E+308)</td><td align="center">0ï¼Œ(2.225 073 858 507 201 4 E-308ï¼Œ<br>1.797 693 134 862 315 7 E+308)</td><td align="center">åŒç²¾åº¦/æµ®ç‚¹æ•°å€¼</td></tr><tr><td>DECIMAL</td><td align="center">å¯¹DECIMAL(M,D) ï¼Œå¦‚æœM&gt;Dï¼Œä¸ºM+2å¦åˆ™ä¸ºD+2</td><td align="center">ä¾èµ–äºMå’ŒDçš„å€¼</td><td align="center">ä¾èµ–äºMå’ŒDçš„å€¼</td><td align="center">å°æ•°å€¼</td></tr></tbody></table><p> <strong>æ—¥æœŸå’Œæ—¶é—´ç±»å‹</strong></p><p>è¡¨ç¤ºæ—¶é—´å€¼çš„æ—¥æœŸå’Œæ—¶é—´ç±»å‹ä¸ºDATETIMEã€DATEã€TIMESTAMPã€TIMEå’ŒYEARã€‚<br>æ¯ä¸ªæ—¶é—´ç±»å‹æœ‰ä¸€ä¸ªæœ‰æ•ˆå€¼èŒƒå›´å’Œä¸€ä¸ªâ€é›¶â€å€¼ï¼Œå½“æŒ‡å®šä¸åˆæ³•çš„MySQLä¸èƒ½è¡¨ç¤ºçš„å€¼æ—¶ä½¿ç”¨â€é›¶â€å€¼ã€‚<br>TIMESTAMPç±»å‹æœ‰ä¸“æœ‰çš„è‡ªåŠ¨æ›´æ–°ç‰¹æ€§ã€‚</p><table><thead><tr><th>ç±»å‹</th><th align="center">å¤§å°(å­—èŠ‚ï¼‰</th><th align="center">èŒƒå›´</th><th align="center">æ ¼å¼</th><th align="center">ç”¨é€”</th></tr></thead><tbody><tr><td>DATE</td><td align="center">3</td><td align="center">1000-01-01<br>9999-12-31</td><td align="center">YYYY-MM-DD</td><td align="center">æ—¥æœŸå€¼</td></tr><tr><td>TIME</td><td align="center">3</td><td align="center">-838:59:59â€™/â€˜838:59:59</td><td align="center">HH:MM:SS</td><td align="center">æ—¶é—´å€¼æˆ–æŒç»­æ—¶é—´</td></tr><tr><td>YEAR</td><td align="center">1</td><td align="center">1901/2155</td><td align="center">YYYY</td><td align="center">å¹´ä»½å€¼</td></tr><tr><td>DATETIME</td><td align="center">8</td><td align="center">1000-01-01 00:00:00<br>9999-12-31 23:59:59</td><td align="center">YYYY-MM-DD<br>HH:MM:SS</td><td align="center">æ··åˆæ—¥æœŸå’Œ<br>æ—¶é—´å€¼</td></tr><tr><td>TIMESTAMP</td><td align="center">4</td><td align="center">1970-01-01 00:00:00/2038</td><td align="center">YYYYMMDD<br>HHMMSS</td><td align="center">æ··åˆæ—¥æœŸå’Œæ—¶é—´å€¼<br>æ—¶é—´æˆ³</td></tr></tbody></table><p> <strong>å­—ç¬¦ä¸²ç±»å‹</strong></p><p>å­—ç¬¦ä¸²ç±»å‹æŒ‡CHARã€VARCHARã€BINARYã€VARBINARYã€BLOBã€TEXTã€ENUMå’ŒSETã€‚</p><table><thead><tr><th>ç±»å‹</th><th align="center">å¤§å°(å­—èŠ‚ï¼‰</th><th align="center">ç”¨é€”</th></tr></thead><tbody><tr><td>CHAR</td><td align="center">0-255</td><td align="center">å®šé•¿å­—ç¬¦ä¸²</td></tr><tr><td>VARCHAR</td><td align="center">0-65535</td><td align="center">å˜é•¿å­—ç¬¦ä¸²</td></tr><tr><td>TINYBLOB</td><td align="center">0-255</td><td align="center">ä¸è¶…è¿‡ 255 ä¸ªå­—ç¬¦çš„äºŒè¿›åˆ¶å­—ç¬¦ä¸²</td></tr><tr><td>TINYTEXT</td><td align="center">0-255</td><td align="center">çŸ­æ–‡æœ¬å­—ç¬¦ä¸²</td></tr><tr><td>BLOB</td><td align="center">0-65 535</td><td align="center">äºŒè¿›åˆ¶å½¢å¼çš„é•¿æ–‡æœ¬æ•°æ®</td></tr><tr><td>TEXT</td><td align="center">0-65 535</td><td align="center">é•¿æ–‡æœ¬æ•°æ®</td></tr><tr><td>MEDIUMBLOB</td><td align="center">0-16 777 215</td><td align="center">äºŒè¿›åˆ¶å½¢å¼çš„ä¸­ç­‰é•¿åº¦æ–‡æœ¬æ•°æ®</td></tr><tr><td>MEDIUMTEXT</td><td align="center">0-16 777 215</td><td align="center">ä¸­ç­‰é•¿åº¦æ–‡æœ¬æ•°æ®</td></tr><tr><td>LONGBLOB</td><td align="center">0-4 294 967 295</td><td align="center">äºŒè¿›åˆ¶å½¢å¼çš„æå¤§æ–‡æœ¬æ•°æ®</td></tr><tr><td>LONGTEXT</td><td align="center">0-4 294 967 295</td><td align="center">æå¤§æ–‡æœ¬æ•°æ®</td></tr></tbody></table><ul><li>CHARå’ŒVARCHARç±»å‹ç±»ä¼¼ï¼Œä½†å®ƒä»¬ä¿å­˜å’Œæ£€ç´¢çš„æ–¹å¼ä¸åŒã€‚å®ƒä»¬çš„æœ€å¤§é•¿åº¦å’Œæ˜¯å¦å°¾éƒ¨ç©ºæ ¼è¢«ä¿ç•™ç­‰æ–¹é¢ä¹Ÿä¸åŒã€‚åœ¨å­˜å‚¨æˆ–æ£€ç´¢è¿‡ç¨‹ä¸­ä¸è¿›è¡Œå¤§å°å†™è½¬æ¢ã€‚</li><li>BINARYå’ŒVARBINARYç±»ç±»ä¼¼äºCHARå’ŒVARCHARï¼Œä¸åŒçš„æ˜¯å®ƒä»¬åŒ…å«äºŒè¿›åˆ¶å­—ç¬¦ä¸²è€Œä¸è¦éäºŒè¿›åˆ¶å­—ç¬¦ä¸²ã€‚ä¹Ÿå°±æ˜¯è¯´ï¼Œå®ƒä»¬åŒ…å«å­—èŠ‚å­—ç¬¦ä¸²è€Œä¸æ˜¯å­—ç¬¦å­—ç¬¦ä¸²ã€‚è¿™è¯´æ˜å®ƒä»¬æ²¡æœ‰å­—ç¬¦é›†ï¼Œå¹¶ä¸”æ’åºå’Œæ¯”è¾ƒåŸºäºåˆ—å€¼å­—èŠ‚çš„æ•°å€¼å€¼ã€‚</li><li>BLOBæ˜¯ä¸€ä¸ªäºŒè¿›åˆ¶å¤§å¯¹è±¡ï¼Œå¯ä»¥å®¹çº³å¯å˜æ•°é‡çš„æ•°æ®ã€‚æœ‰4ç§BLOBç±»å‹ï¼šTINYBLOBã€BLOBã€MEDIUMBLOBå’ŒLONGBLOBã€‚å®ƒä»¬åªæ˜¯å¯å®¹çº³å€¼çš„æœ€å¤§é•¿åº¦ä¸åŒã€‚</li><li>æœ‰4ç§TEXTç±»å‹ï¼šTINYTEXTã€TEXTã€MEDIUMTEXTå’ŒLONGTEXTã€‚è¿™äº›å¯¹åº”4ç§BLOBç±»å‹ï¼Œæœ‰ç›¸åŒçš„æœ€å¤§é•¿åº¦å’Œå­˜å‚¨éœ€æ±‚ã€‚</li></ul><h2 id="5-5-MySQLåˆ›å»ºæ•°æ®è¡¨"><a href="#5-5-MySQLåˆ›å»ºæ•°æ®è¡¨" class="headerlink" title="5.5 MySQLåˆ›å»ºæ•°æ®è¡¨"></a>5.5 MySQLåˆ›å»ºæ•°æ®è¡¨</h2><p>åˆ›å»ºMySQLæ•°æ®è¡¨éœ€è¦ä»¥ä¸‹ä¿¡æ¯ï¼š</p><ul><li>è¡¨å</li><li>è¡¨å­—æ®µå</li><li>å®šä¹‰æ¯ä¸ªè¡¨å­—æ®µ</li></ul><p><strong>è¯­æ³•</strong></p><pre><code class="hljs sql"><span class="hljs-keyword">CREATE</span> <span class="hljs-keyword">TABLE</span> table_name (column_name column_type);</code></pre><p>ä¸‹é¢é€šè¿‡å®ä¾‹åœ¨testæ•°æ®åº“ä¸­åˆ›å»ºæ•°æ®è¡¨test_tblï¼š</p><pre><code class="hljs sql">mysql&gt; USE test;Database changedmysql&gt; SHOW TABLES;Empty <span class="hljs-keyword">set</span> (<span class="hljs-number">0.00</span> sec)mysql&gt; <span class="hljs-keyword">CREATE</span> <span class="hljs-keyword">TABLE</span> test_tbl(    -&gt; <span class="hljs-keyword">id</span> <span class="hljs-built_in">INT</span> <span class="hljs-keyword">NOT</span> <span class="hljs-literal">NULL</span> AUTO_INCREMENT,    -&gt; <span class="hljs-keyword">name</span> <span class="hljs-built_in">CHAR</span>(<span class="hljs-number">20</span>) <span class="hljs-keyword">NOT</span> <span class="hljs-literal">NULL</span>,    -&gt; age <span class="hljs-built_in">int</span>(<span class="hljs-number">9</span>) <span class="hljs-keyword">NOT</span> <span class="hljs-literal">NULL</span>,    -&gt; sex <span class="hljs-built_in">CHAR</span>(<span class="hljs-number">2</span>) <span class="hljs-keyword">NOT</span> <span class="hljs-literal">NULL</span>,    -&gt; submission_date <span class="hljs-built_in">DATE</span>,    -&gt; PRIMARY <span class="hljs-keyword">KEY</span> (<span class="hljs-keyword">id</span>));Query OK, 0 rows affected (0.03 sec)</code></pre><p>åˆ›å»ºæˆåŠŸåï¼Œå¯ä»¥é€šè¿‡å‘½ä»¤æ¥æŸ¥çœ‹è¡¨ç»“æ„ï¼š</p><pre><code class="hljs sql">mysql&gt; SHOW TABLES;+<span class="hljs-comment">----------------+</span>| Tables_in_test |+<span class="hljs-comment">----------------+</span>| test_tbl       |+<span class="hljs-comment">----------------+</span>1 row in <span class="hljs-keyword">set</span> (<span class="hljs-number">0.00</span> sec)mysql&gt; <span class="hljs-keyword">desc</span> test_tbl;+<span class="hljs-comment">-----------------+----------+------+-----+---------+----------------+</span>| Field           | Type     | Null | Key | Default | Extra          |+<span class="hljs-comment">-----------------+----------+------+-----+---------+----------------+</span>| id              | int(11)  | NO   | PRI | NULL    | auto_increment || name            | char(20) | NO   |     | NULL    |                || age             | int(9)   | NO   |     | NULL    |                || sex             | char(2)  | NO   |     | NULL    |                || submission_date | date     | YES  |     | NULL    |                |+<span class="hljs-comment">-----------------+----------+------+-----+---------+----------------+</span>5 rows in <span class="hljs-keyword">set</span> (<span class="hljs-number">0.00</span> sec)</code></pre><h2 id="5-6-MySQLåˆ é™¤æ•°æ®è¡¨"><a href="#5-6-MySQLåˆ é™¤æ•°æ®è¡¨" class="headerlink" title="5.6 MySQLåˆ é™¤æ•°æ®è¡¨"></a>5.6 MySQLåˆ é™¤æ•°æ®è¡¨</h2><p><strong>è¯­æ³•</strong><br><code>DROP TABLE æ•°æ®è¡¨å</code></p><pre><code class="hljs sql">mysql&gt; USE test;Database changedmysql&gt; SHOW TABLES;+<span class="hljs-comment">----------------+</span>| Tables_in_test |+<span class="hljs-comment">----------------+</span>| test_tbl       |+<span class="hljs-comment">----------------+</span>1 row in <span class="hljs-keyword">set</span> (<span class="hljs-number">0.00</span> sec)mysql&gt; <span class="hljs-keyword">DROP</span> <span class="hljs-keyword">TABLE</span> test_tbl;Query OK, 0 rows affected (0.8 sec)mysql&gt; SHOW TABLES;Empty <span class="hljs-keyword">set</span> (<span class="hljs-number">0.01</span> sec)</code></pre><h2 id="5-7-MySQLæ’å…¥æ•°æ®"><a href="#5-7-MySQLæ’å…¥æ•°æ®" class="headerlink" title="5.7 MySQLæ’å…¥æ•°æ®"></a>5.7 MySQLæ’å…¥æ•°æ®</h2><p>MySQL è¡¨ä¸­ä½¿ç”¨ <strong>INSERT INTO</strong> SQLè¯­å¥æ¥æ’å…¥æ•°æ®ã€‚</p><p><strong>å®ä¾‹</strong><br>å‘test_tblæ’å…¥æ•°æ®ï¼š</p><pre><code class="hljs sql">mysql&gt; INSERT INTO test_tbl    -&gt; (name,age,sex,submission_date)    -&gt; VALUES    -&gt; (&quot;pangzi W&quot;,&quot;25&quot;,&quot;M&quot;,NOW());Query OK, 1 row affected, 1 warning (0.00 sec)mysql&gt; SELECT * FROM test_tbl;+<span class="hljs-comment">----+----------+-----+-----+-----------------+</span>| id | name     | age | sex | submission_date |+<span class="hljs-comment">----+----------+-----+-----+-----------------+</span>|  1 | pangzi W |  25 | M   | 2018-01-22      |+<span class="hljs-comment">----+----------+-----+-----+-----------------+</span>1 row in <span class="hljs-keyword">set</span> (<span class="hljs-number">0.00</span> sec)</code></pre><ul><li>æ²¡æœ‰æä¾›idçš„æ•°æ®ï¼Œå› ä¸ºè¯¥å­—æ®µæˆ‘ä»¬åœ¨åˆ›å»ºè¡¨çš„æ—¶å€™å·²ç»è®¾ç½®å®ƒä¸º AUTO_INCREMENT(è‡ªåŠ¨å¢åŠ ) å±æ€§ï¼Œè¯¥å­—æ®µä¼šè‡ªåŠ¨é€’å¢è€Œä¸éœ€è¦æˆ‘ä»¬å»è®¾ç½®ã€‚</li><li>NOW() æ˜¯ä¸€ä¸ª MySQL å‡½æ•°ï¼Œè¯¥å‡½æ•°è¿”å›æ—¥æœŸå’Œæ—¶é—´ã€‚</li></ul><h2 id="5-8-MySQLæŸ¥è¯¢æ•°æ®"><a href="#5-8-MySQLæŸ¥è¯¢æ•°æ®" class="headerlink" title="5.8 MySQLæŸ¥è¯¢æ•°æ®"></a>5.8 MySQLæŸ¥è¯¢æ•°æ®</h2><p>MySQL æ•°æ®åº“ä½¿ç”¨SQL SELECTè¯­å¥æ¥æŸ¥è¯¢æ•°æ®ã€‚<br><strong>è¯­æ³•</strong></p><pre><code class="hljs sql"><span class="hljs-keyword">SELECT</span> column_name,column_name<span class="hljs-keyword">FROM</span> table_name[<span class="hljs-keyword">WHERE</span> Clause][<span class="hljs-keyword">LIMIT</span> N][ <span class="hljs-keyword">OFFSET</span> M]</code></pre><ul><li>æŸ¥è¯¢è¯­å¥ä¸­ä½ å¯ä»¥ä½¿ç”¨ä¸€ä¸ªæˆ–è€…å¤šä¸ªè¡¨ï¼Œè¡¨ä¹‹é—´ä½¿ç”¨é€—å·(,)åˆ†å‰²ï¼Œå¹¶ä½¿ç”¨WHEREè¯­å¥æ¥è®¾å®šæŸ¥è¯¢æ¡ä»¶ã€‚</li><li>SELECT å‘½ä»¤å¯ä»¥è¯»å–ä¸€æ¡æˆ–è€…å¤šæ¡è®°å½•ã€‚</li><li>ä½ å¯ä»¥ä½¿ç”¨æ˜Ÿå·ï¼ˆ*ï¼‰æ¥ä»£æ›¿å…¶ä»–å­—æ®µï¼ŒSELECTè¯­å¥ä¼šè¿”å›è¡¨çš„æ‰€æœ‰å­—æ®µæ•°æ®</li><li>ä½ å¯ä»¥ä½¿ç”¨ WHERE è¯­å¥æ¥åŒ…å«ä»»ä½•æ¡ä»¶ã€‚</li><li>ä½ å¯ä»¥ä½¿ç”¨ LIMIT å±æ€§æ¥è®¾å®šè¿”å›çš„è®°å½•æ•°ã€‚</li><li>ä½ å¯ä»¥é€šè¿‡OFFSETæŒ‡å®šSELECTè¯­å¥å¼€å§‹æŸ¥è¯¢çš„æ•°æ®åç§»é‡ã€‚é»˜è®¤æƒ…å†µä¸‹åç§»é‡ä¸º0ã€‚</li></ul><p><strong>å®ä¾‹</strong><br>è¿”å›æ•°æ®è¡¨æ‰€æœ‰æ•°æ®ï¼š</p><pre><code class="hljs sql">mysql&gt; SELECT * FROM bili;+<span class="hljs-comment">----------+----------+---------+--------+----------+--------+--------+</span>| aid      | view     | danmaku | reply  | favorite | coin   | share  |+<span class="hljs-comment">----------+----------+---------+--------+----------+--------+--------+</span>|        0 |        0 |       0 |      0 |        0 |      0 |      0 ||        2 |       -1 |    1866 |   4888 |     1604 |    480 |   1292 ||        7 |  1158359 |   22770 |  23613 |     9991 |   2189 |    538 ||        9 |  1237494 |    5025 |   4858 |    10015 |    994 |    833 ||       11 |   168711 |    2087 |   2499 |     1336 |    165 |     33 ||       12 |   495352 |    1392 |   2501 |     3743 |    357 |    310 ||       16 |   108035 |    1492 |   1144 |      874 |     81 |     36 ||       20 |   157311 |    3833 |   1788 |     3347 |    361 |    104 ||       23 |       -1 |   40371 |   9711 |    29289 |   2570 |   4562 ||       24 |   196740 |    5105 |    855 |     2897 |    296 |    124 ||       25 |    62049 |     931 |    448 |      726 |     56 |     32 ||       26 |    86121 |    2166 |    574 |     1800 |    252 |    124 ||       28 |    54482 |    1474 |    627 |      396 |     49 |     17 ||       31 |    60681 |    1375 |    457 |      306 |     14 |     24 |+<span class="hljs-comment">----------+----------+---------+--------+----------+--------+--------+</span>14 row in <span class="hljs-keyword">set</span> (<span class="hljs-number">0.00</span> sec)</code></pre><h2 id="5-9-MySQL-WHEREå­å¥"><a href="#5-9-MySQL-WHEREå­å¥" class="headerlink" title="5.9 MySQL WHEREå­å¥"></a>5.9 MySQL WHEREå­å¥</h2><p>æœ‰æ¡ä»¶çš„é€‰å–æ•°æ®ï¼Œå°†WHEREå­å¥æ·»åŠ åˆ°SELECTè¯­å¥ä¸­ã€‚<br><strong>è¯­æ³•</strong></p><pre><code class="hljs sql"><span class="hljs-keyword">SELECT</span> field1, field2,...fieldN <span class="hljs-keyword">FROM</span> table_name1, table_name2...[<span class="hljs-keyword">WHERE</span> condition1 [<span class="hljs-keyword">AND</span> [<span class="hljs-keyword">OR</span>]] condition2.....</code></pre><ul><li>æŸ¥è¯¢è¯­å¥ä¸­ä½ å¯ä»¥ä½¿ç”¨ä¸€ä¸ªæˆ–è€…å¤šä¸ªè¡¨ï¼Œè¡¨ä¹‹é—´ä½¿ç”¨é€—å·, åˆ†å‰²ï¼Œå¹¶ä½¿ç”¨WHEREè¯­å¥æ¥è®¾å®šæŸ¥è¯¢æ¡ä»¶ã€‚</li><li>ä½ å¯ä»¥åœ¨ WHERE å­å¥ä¸­æŒ‡å®šä»»ä½•æ¡ä»¶ã€‚</li><li>ä½ å¯ä»¥ä½¿ç”¨ AND æˆ–è€… OR æŒ‡å®šä¸€ä¸ªæˆ–å¤šä¸ªæ¡ä»¶ã€‚</li><li>WHERE å­å¥ä¹Ÿå¯ä»¥è¿ç”¨äº SQL çš„ DELETE æˆ–è€… UPDATE å‘½ä»¤ã€‚</li><li>WHERE å­å¥ç±»ä¼¼äºç¨‹åºè¯­è¨€ä¸­çš„ if æ¡ä»¶ï¼Œæ ¹æ® MySQL è¡¨ä¸­çš„å­—æ®µå€¼æ¥è¯»å–æŒ‡å®šçš„æ•°æ®ã€‚</li></ul><p><strong>å®ä¾‹</strong><br>æœç´¢æ•°æ®è¡¨ä¸­çš„å±æ€§ä¸ºå¥³æ€§æ•°æ®ï¼š</p><pre><code class="hljs sql">mysql&gt; SELECT * FROM test_tbl;+<span class="hljs-comment">----+----------+-----+-----+-----------------+</span>| id | name     | age | sex | submission_date |+<span class="hljs-comment">----+----------+-----+-----+-----------------+</span>|  1 | pangzi W |  25 | M   | 2018-01-22      ||  2 | san A    |  25 | M   | 2018-01-22      ||  3 | sao A    |  24 | M   | 2018-01-22      ||  4 | juju GOU |  26 | M   | 2018-01-22      ||  5 | li XIAO  |  23 | W   | 2018-01-22      ||  6 | nv JI    |  18 | W   | 2018-01-22      |+<span class="hljs-comment">----+----------+-----+-----+-----------------+</span>6 rows in <span class="hljs-keyword">set</span> (<span class="hljs-number">0.00</span> sec)mysql&gt; <span class="hljs-keyword">select</span> * <span class="hljs-keyword">FROM</span> test_tbl <span class="hljs-keyword">WHERE</span> sex = <span class="hljs-string">&#x27;W&#x27;</span>;+<span class="hljs-comment">----+---------+-----+-----+-----------------+</span>| id | name    | age | sex | submission_date |+<span class="hljs-comment">----+---------+-----+-----+-----------------+</span>|  5 | li XIAO |  23 | W   | 2018-01-22      ||  6 | nv JI   |  18 | W   | 2018-01-22      |+<span class="hljs-comment">----+---------+-----+-----+-----------------+</span>2 rows in <span class="hljs-keyword">set</span> (<span class="hljs-number">0.01</span> sec)</code></pre><h2 id="5-10-MySQL-UPDATEæŸ¥è¯¢"><a href="#5-10-MySQL-UPDATEæŸ¥è¯¢" class="headerlink" title="5.10 MySQL UPDATEæŸ¥è¯¢"></a>5.10 MySQL UPDATEæŸ¥è¯¢</h2><p>å¦‚æœæˆ‘ä»¬éœ€è¦ä¿®æ”¹æˆ–æ›´æ–° MySQL ä¸­çš„æ•°æ®ï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨ SQL UPDATE å‘½ä»¤æ¥æ“ä½œã€‚.<br><strong>è¯­æ³•</strong></p><p>ä»¥ä¸‹æ˜¯ UPDATE å‘½ä»¤ä¿®æ”¹ MySQL æ•°æ®è¡¨æ•°æ®çš„é€šç”¨ SQL è¯­æ³•ï¼š</p><pre><code class="hljs sql"><span class="hljs-keyword">UPDATE</span> table_name <span class="hljs-keyword">SET</span> field1=<span class="hljs-keyword">new</span>-value1, field2=<span class="hljs-keyword">new</span>-value2[<span class="hljs-keyword">WHERE</span> Clause]</code></pre><ul><li>ä½ å¯ä»¥åŒæ—¶æ›´æ–°ä¸€ä¸ªæˆ–å¤šä¸ªå­—æ®µã€‚</li><li>ä½ å¯ä»¥åœ¨ WHERE å­å¥ä¸­æŒ‡å®šä»»ä½•æ¡ä»¶ã€‚</li><li>ä½ å¯ä»¥åœ¨ä¸€ä¸ªå•ç‹¬è¡¨ä¸­åŒæ—¶æ›´æ–°æ•°æ®ã€‚</li></ul><p><strong>å®ä¾‹</strong></p><p>æ›´æ–°test_tblæ•°æ®è¡¨idä¸º1çš„nameæ•°æ®ï¼š</p><pre><code class="hljs sql">mysql&gt; SELECT * FROM test_tbl;+<span class="hljs-comment">----+----------+-----+-----+-----------------+</span>| id | name     | age | sex | submission_date |+<span class="hljs-comment">----+----------+-----+-----+-----------------+</span>|  1 | pangzi W |  25 | M   | 2018-01-22      ||  2 | san A    |  25 | M   | 2018-01-22      ||  3 | sao A    |  24 | M   | 2018-01-22      ||  4 | juju GOU |  26 | M   | 2018-01-22      ||  5 | li XIAO  |  23 | W   | 2018-01-22      ||  6 | nv JI    |  18 | W   | 2018-01-22      |+<span class="hljs-comment">----+----------+-----+-----+-----------------+</span>6 rows in <span class="hljs-keyword">set</span> (<span class="hljs-number">0.00</span> sec)mysql&gt; <span class="hljs-keyword">UPDATE</span> test_tbl <span class="hljs-keyword">SET</span> <span class="hljs-keyword">name</span>=<span class="hljs-string">&#x27;nv JI&#x27;</span> <span class="hljs-keyword">WHERE</span> <span class="hljs-keyword">id</span>=<span class="hljs-number">1</span>;Query OK, 1 row affected (0.00 sec)Rows matched: 1  Changed: 1  Warnings: 0mysql&gt; SELECT * FROM test_tbl;+<span class="hljs-comment">----+----------+-----+-----+-----------------+</span>| id | name     | age | sex | submission_date |+<span class="hljs-comment">----+----------+-----+-----+-----------------+</span>|  1 | nv JI    |  25 | M   | 2018-01-22      ||  2 | san A    |  25 | M   | 2018-01-22      ||  3 | sao A    |  24 | M   | 2018-01-22      ||  4 | juju GOU |  26 | M   | 2018-01-22      ||  5 | li XIAO  |  23 | W   | 2018-01-22      ||  6 | nv JI    |  18 | W   | 2018-01-22      |+<span class="hljs-comment">----+----------+-----+-----+-----------------+</span>6 rows in <span class="hljs-keyword">set</span> (<span class="hljs-number">0.00</span> sec)</code></pre><h2 id="5-11-MySQL-DELETEè¯­å¥"><a href="#5-11-MySQL-DELETEè¯­å¥" class="headerlink" title="5.11 MySQL DELETEè¯­å¥"></a>5.11 MySQL DELETEè¯­å¥</h2><p><strong>è¯­æ³•</strong></p><pre><code class="hljs sql"><span class="hljs-keyword">DELETE</span> <span class="hljs-keyword">FROM</span> table_name [<span class="hljs-keyword">WHERE</span> Clause]</code></pre><ul><li>å¦‚æœæ²¡æœ‰æŒ‡å®š WHERE å­å¥ï¼ŒMySQL è¡¨ä¸­çš„æ‰€æœ‰è®°å½•å°†è¢«åˆ é™¤ã€‚</li><li>ä½ å¯ä»¥åœ¨ WHERE å­å¥ä¸­æŒ‡å®šä»»ä½•æ¡ä»¶</li><li>æ‚¨å¯ä»¥åœ¨å•ä¸ªè¡¨ä¸­ä¸€æ¬¡æ€§åˆ é™¤è®°å½•ã€‚</li></ul><p><strong>å®ä¾‹</strong></p><p>åˆ é™¤test_tblæ•°æ®è¡¨id=5çš„æ•°æ®ï¼š</p><pre><code class="hljs sql">mysql&gt; SELECT * FROM test_tbl;+<span class="hljs-comment">----+----------+-----+-----+-----------------+</span>| id | name     | age | sex | submission_date |+<span class="hljs-comment">----+----------+-----+-----+-----------------+</span>|  1 | pangzi W |  25 | M   | 2018-01-22      ||  2 | san A    |  25 | M   | 2018-01-22      ||  3 | sao A    |  24 | M   | 2018-01-22      ||  4 | juju GOU |  26 | M   | 2018-01-22      ||  5 | li XIAO  |  23 | W   | 2018-01-22      ||  6 | nv JI    |  18 | W   | 2018-01-22      |+<span class="hljs-comment">----+----------+-----+-----+-----------------+</span>6 rows in <span class="hljs-keyword">set</span> (<span class="hljs-number">0.00</span> sec)mysql&gt; <span class="hljs-keyword">DELETE</span> <span class="hljs-keyword">FROM</span> test_tbl <span class="hljs-keyword">WHERE</span> <span class="hljs-keyword">id</span>=<span class="hljs-number">5</span>;Query OK, 1 row affected (0.00 sec)mysql&gt; SELECT * FROM test_tbl;+<span class="hljs-comment">----+----------+-----+-----+-----------------+</span>| id | name     | age | sex | submission_date |+<span class="hljs-comment">----+----------+-----+-----+-----------------+</span>|  1 | pangzi W |  25 | M   | 2018-01-22      ||  2 | san A    |  25 | M   | 2018-01-22      ||  3 | sao A    |  24 | M   | 2018-01-22      ||  4 | juju GOU |  26 | M   | 2018-01-22      ||  6 | nv JI    |  18 | W   | 2018-01-22      |+<span class="hljs-comment">----+----------+-----+-----+-----------------+</span>5 rows in <span class="hljs-keyword">set</span> (<span class="hljs-number">0.00</span> sec)</code></pre><h2 id="5-12-MySQL-LIKEå­å¥"><a href="#5-12-MySQL-LIKEå­å¥" class="headerlink" title="5.12 MySQL LIKEå­å¥"></a>5.12 MySQL LIKEå­å¥</h2><p>WHERE å­å¥ä¸­å¯ä»¥ä½¿ç”¨ç­‰å· <code>=</code> æ¥è®¾å®šè·å–æ•°æ®çš„æ¡ä»¶ï¼Œå¦‚ â€œurl = â€˜<a href="http://www.google.com&/#39;&quot;%E3%80%82">www.google.com&#39;&quot;ã€‚</a><br>ä½†æ˜¯æœ‰æ—¶å€™æˆ‘ä»¬éœ€è¦è·å– url å­—æ®µå«æœ‰ â€œcomâ€ å­—ç¬¦çš„æ‰€æœ‰è®°å½•ï¼Œè¿™æ—¶æˆ‘ä»¬å°±éœ€è¦åœ¨ WHERE å­å¥ä¸­ä½¿ç”¨ SQL LIKE å­å¥ã€‚</p><p><strong>è¯­æ³•</strong></p><pre><code class="hljs sql"><span class="hljs-keyword">SELECT</span> field1, field2,...fieldN <span class="hljs-keyword">FROM</span> table_name<span class="hljs-keyword">WHERE</span> field1 <span class="hljs-keyword">LIKE</span> condition1 [<span class="hljs-keyword">AND</span> [<span class="hljs-keyword">OR</span>]] filed2 = <span class="hljs-string">&#x27;somevalue&#x27;</span></code></pre><ul><li>ä½ å¯ä»¥åœ¨ WHERE å­å¥ä¸­æŒ‡å®šä»»ä½•æ¡ä»¶ã€‚</li><li>ä½ å¯ä»¥åœ¨ WHERE å­å¥ä¸­ä½¿ç”¨LIKEå­å¥ã€‚</li><li>ä½ å¯ä»¥ä½¿ç”¨LIKEå­å¥ä»£æ›¿ç­‰å· =ã€‚</li><li>LIKE é€šå¸¸ä¸ % ä¸€åŒä½¿ç”¨ï¼Œç±»ä¼¼äºä¸€ä¸ªå…ƒå­—ç¬¦çš„æœç´¢ã€‚</li><li>ä½ å¯ä»¥ä½¿ç”¨ AND æˆ–è€… OR æŒ‡å®šä¸€ä¸ªæˆ–å¤šä¸ªæ¡ä»¶ã€‚</li><li>ä½ å¯ä»¥åœ¨ DELETE æˆ– UPDATE å‘½ä»¤ä¸­ä½¿ç”¨ WHEREâ€¦LIKE å­å¥æ¥æŒ‡å®šæ¡ä»¶ã€‚</li></ul><p><strong>å®ä¾‹</strong><br>æŸ¥æ‰¾urlæ•°æ®è¡¨ä¸­æ‰€æœ‰å«.comçš„åœ°å€ï¼š</p><pre><code class="hljs sql">mysql&gt; SELECT * FROM url;+<span class="hljs-comment">----+----------------+</span>| id | url_list       |+<span class="hljs-comment">----+----------------+</span>|  1 | www.baidu.com  ||  2 | www.google.com ||  3 | ecarry.cc      ||  4 | weibo.com      ||  5 | www.google.cn  |+<span class="hljs-comment">----+----------------+</span>5 rows in <span class="hljs-keyword">set</span> (<span class="hljs-number">0.00</span> sec)mysql&gt; <span class="hljs-keyword">SELECT</span> * <span class="hljs-keyword">FROM</span> <span class="hljs-keyword">url</span> <span class="hljs-keyword">WHERE</span> url_list <span class="hljs-keyword">LIKE</span> <span class="hljs-string">&#x27;%com&#x27;</span>;+<span class="hljs-comment">----+----------------+</span>| id | url_list       |+<span class="hljs-comment">----+----------------+</span>|  1 | www.baidu.com  ||  2 | www.google.com ||  4 | weibo.com      |+<span class="hljs-comment">----+----------------+</span>3 rows in <span class="hljs-keyword">set</span> (<span class="hljs-number">0.00</span> sec)</code></pre><h2 id="5-13-MySQL-UNIONæ“ä½œç¬¦"><a href="#5-13-MySQL-UNIONæ“ä½œç¬¦" class="headerlink" title="5.13 MySQL UNIONæ“ä½œç¬¦"></a>5.13 MySQL UNIONæ“ä½œç¬¦</h2><p><strong>æè¿°</strong></p><p>MySQL UNION æ“ä½œç¬¦ç”¨äºè¿æ¥ä¸¤ä¸ªä»¥ä¸Šçš„ SELECT è¯­å¥çš„ç»“æœç»„åˆåˆ°ä¸€ä¸ªç»“æœé›†åˆä¸­ã€‚å¤šä¸ª SELECT è¯­å¥ä¼šåˆ é™¤é‡å¤çš„æ•°æ®ã€‚</p><p><strong>è¯­æ³•</strong></p><pre><code class="hljs sql"><span class="hljs-keyword">SELECT</span> expression1, expression2, ... expression_n<span class="hljs-keyword">FROM</span> <span class="hljs-keyword">tables</span>[<span class="hljs-keyword">WHERE</span> conditions]<span class="hljs-keyword">UNION</span> [<span class="hljs-keyword">ALL</span> | <span class="hljs-keyword">DISTINCT</span>]<span class="hljs-keyword">SELECT</span> expression1, expression2, ... expression_n<span class="hljs-keyword">FROM</span> <span class="hljs-keyword">tables</span>[<span class="hljs-keyword">WHERE</span> conditions];</code></pre><ul><li><strong>expression1, expression2, â€¦ expression_n</strong>: è¦æ£€ç´¢çš„åˆ—ã€‚</li><li><strong>tables</strong>: è¦æ£€ç´¢çš„æ•°æ®è¡¨ã€‚</li><li><strong>WHERE conditions</strong>: å¯é€‰ï¼Œ æ£€ç´¢æ¡ä»¶ã€‚</li><li><strong>DISTINCT</strong>: å¯é€‰ï¼Œåˆ é™¤ç»“æœé›†ä¸­é‡å¤çš„æ•°æ®ã€‚é»˜è®¤æƒ…å†µä¸‹ UNION æ“ä½œç¬¦å·²ç»åˆ é™¤äº†é‡å¤æ•°æ®ï¼Œæ‰€ä»¥ DISTINCT ä¿®é¥°ç¬¦å¯¹ç»“æœæ²¡å•¥å½±å“ã€‚</li><li><strong>ALL</strong>: å¯é€‰ï¼Œè¿”å›æ‰€æœ‰ç»“æœé›†ï¼ŒåŒ…å«é‡å¤æ•°æ®ã€‚</li></ul><p><strong>å®ä¾‹</strong></p><p>ä¸‹é¢æ˜¯é€‰è‡ª â€œWebsitesâ€ è¡¨çš„æ•°æ®ï¼š</p><pre><code class="hljs sql">mysql&gt; SELECT * FROM Websites;+<span class="hljs-comment">----+--------------+---------------------------+-------+---------+</span>| id | name         | url                       | alexa | country |+<span class="hljs-comment">----+--------------+---------------------------+-------+---------+</span>| 1  | Google       | https://www.google.cm/    | 1     | USA     || 2  | æ·˜å®          | https://www.taobao.com/   | 13    | CN      || 3  | èœé¸Ÿæ•™ç¨‹      | http://www.runoob.com/    | 4689  | CN      || 4  | å¾®åš          | http://weibo.com/         | 20    | CN      || 5  | Facebook     | https://www.facebook.com/ | 3     | USA     || 7  | stackoverflow | http://stackoverflow.com/ |   0 | IND      |+<span class="hljs-comment">----+---------------+---------------------------+-------+---------+</span></code></pre><p>ä¸‹é¢æ˜¯ â€œappsâ€ APP çš„æ•°æ®ï¼š</p><pre><code class="hljs sql">mysql&gt; SELECT * FROM apps;+<span class="hljs-comment">----+------------+-------------------------+---------+</span>| id | app_name   | url                     | country |+<span class="hljs-comment">----+------------+-------------------------+---------+</span>|  1 | QQ APP     | http://im.qq.com/       | CN      ||  2 | å¾®åš APP   | http://weibo.com/        | CN      ||  3 | æ·˜å® APP   | https://www.taobao.com/  | CN      |+<span class="hljs-comment">----+------------+-------------------------+---------+</span>3 rows in <span class="hljs-keyword">set</span> (<span class="hljs-number">0.00</span> sec)</code></pre><h3 id="5-13-1-SQL-UNION-å®ä¾‹"><a href="#5-13-1-SQL-UNION-å®ä¾‹" class="headerlink" title="5.13.1 SQL UNION å®ä¾‹"></a>5.13.1 SQL UNION å®ä¾‹</h3><p>ä¸‹é¢çš„ SQL è¯­å¥ä» â€œWebsitesâ€ å’Œ â€œappsâ€ è¡¨ä¸­é€‰å–æ‰€æœ‰ä¸åŒçš„countryï¼ˆåªæœ‰ä¸åŒçš„å€¼ï¼‰ï¼š</p><pre><code class="hljs sql">mysql&gt; SELECT country FROM Websites    -&gt; UNION    -&gt; SELECT country FROM apps    -&gt; ORDER BY country;+<span class="hljs-comment">---------+</span>| country |+<span class="hljs-comment">---------+</span>| CN      || IND     || USA     |+<span class="hljs-comment">---------+  </span>3 rows in <span class="hljs-keyword">set</span> (<span class="hljs-number">0.00</span> sec)</code></pre><p><strong>æ³¨é‡Šï¼š</strong>UNION ä¸èƒ½ç”¨äºåˆ—å‡ºä¸¤ä¸ªè¡¨ä¸­æ‰€æœ‰çš„countryã€‚å¦‚æœä¸€äº›ç½‘ç«™å’ŒAPPæ¥è‡ªåŒä¸€ä¸ªå›½å®¶ï¼Œæ¯ä¸ªå›½å®¶åªä¼šåˆ—å‡ºä¸€æ¬¡ã€‚UNION åªä¼šé€‰å–ä¸åŒçš„å€¼ã€‚è¯·ä½¿ç”¨ UNION ALL æ¥é€‰å–é‡å¤çš„å€¼ï¼</p><h3 id="5-13-2-SQL-UNION-ALL-å®ä¾‹"><a href="#5-13-2-SQL-UNION-ALL-å®ä¾‹" class="headerlink" title="5.13.2 SQL UNION ALL å®ä¾‹"></a>5.13.2 SQL UNION ALL å®ä¾‹</h3><p>ä¸‹é¢çš„ SQL è¯­å¥ä½¿ç”¨ UNION ALL ä» â€œWebsitesâ€ å’Œ â€œappsâ€ è¡¨ä¸­é€‰å–æ‰€æœ‰çš„countryï¼ˆä¹Ÿæœ‰é‡å¤çš„å€¼ï¼‰ï¼š</p><pre><code class="hljs sql">mysql&gt; SELECT country FROM Websites    -&gt; UNION ALL    -&gt; SELECT country FROM apps    -&gt; ORDER BY country;+<span class="hljs-comment">---------+</span>| country |+<span class="hljs-comment">---------+</span>| CN      || CN      || CN      || CN      || CN      || IND     || USA     || USA     || USA     |+<span class="hljs-comment">---------+  </span>3 rows in <span class="hljs-keyword">set</span> (<span class="hljs-number">0.00</span> sec)</code></pre><h3 id="5-13-3-å¸¦æœ‰-WHERE-çš„-SQL-UNION-ALL"><a href="#5-13-3-å¸¦æœ‰-WHERE-çš„-SQL-UNION-ALL" class="headerlink" title="5.13.3 å¸¦æœ‰ WHERE çš„ SQL UNION ALL"></a>5.13.3 å¸¦æœ‰ WHERE çš„ SQL UNION ALL</h3><p>ä¸‹é¢çš„ SQL è¯­å¥ä½¿ç”¨ UNION ALL ä» â€œWebsitesâ€ å’Œ â€œappsâ€ è¡¨ä¸­é€‰å–æ‰€æœ‰çš„ä¸­å›½(CN)çš„æ•°æ®ï¼ˆä¹Ÿæœ‰é‡å¤çš„å€¼ï¼‰ï¼š</p><pre><code class="hljs sql">mysql&gt; SELECT country,name FROM Websites    -&gt; WHERE country=&#x27;CN&#x27;    -&gt; UNION ALL    -&gt; SELECT country,app_name FROM apps    -&gt; WHERE country=&#x27;CN&#x27;    -&gt; ORDER BY country;+<span class="hljs-comment">---------+--------------+</span>| country |    name      |+<span class="hljs-comment">---------+--------------+</span>| CN      |   æ·˜å®        || CN      |   QQ APP     || CN      |   èœé¸Ÿ        || CN      |   å¾®åš APP    || CN      |   å¾®åš        || CN      |   æ·˜å® APP    |+<span class="hljs-comment">---------+--------------+  </span>6 rows in <span class="hljs-keyword">set</span> (<span class="hljs-number">0.00</span> sec)</code></pre><h2 id="5-14-MySQLæ’åº"><a href="#5-14-MySQLæ’åº" class="headerlink" title="5.14 MySQLæ’åº"></a>5.14 MySQLæ’åº</h2><p>æˆ‘ä»¬çŸ¥é“ä» MySQL è¡¨ä¸­ä½¿ç”¨ SQL SELECT è¯­å¥æ¥è¯»å–æ•°æ®ã€‚<br>å¦‚æœæˆ‘ä»¬éœ€è¦å¯¹è¯»å–çš„æ•°æ®è¿›è¡Œæ’åºï¼Œæˆ‘ä»¬å°±å¯ä»¥ä½¿ç”¨ MySQL çš„ ORDER BY å­å¥æ¥è®¾å®šä½ æƒ³æŒ‰å“ªä¸ªå­—æ®µå“ªç§æ–¹å¼æ¥è¿›è¡Œæ’åºï¼Œå†è¿”å›æœç´¢ç»“æœã€‚</p><p><strong>è¯­æ³•</strong></p><p>ä»¥ä¸‹æ˜¯ SQL SELECT è¯­å¥ä½¿ç”¨ ORDER BY å­å¥å°†æŸ¥è¯¢æ•°æ®æ’åºåå†è¿”å›æ•°æ®ï¼š</p><pre><code class="hljs sql"><span class="hljs-keyword">SELECT</span> field1, field2,...fieldN table_name1, table_name2...<span class="hljs-keyword">ORDER</span> <span class="hljs-keyword">BY</span> field1, [field2...] [<span class="hljs-keyword">ASC</span> [<span class="hljs-keyword">DESC</span>]]</code></pre><ul><li>ä½ å¯ä»¥ä½¿ç”¨ä»»ä½•å­—æ®µæ¥ä½œä¸ºæ’åºçš„æ¡ä»¶ï¼Œä»è€Œè¿”å›æ’åºåçš„æŸ¥è¯¢ç»“æœã€‚</li><li>ä½ å¯ä»¥è®¾å®šå¤šä¸ªå­—æ®µæ¥æ’åºã€‚</li><li>ä½ å¯ä»¥ä½¿ç”¨ ASC æˆ– DESC å…³é”®å­—æ¥è®¾ç½®æŸ¥è¯¢ç»“æœæ˜¯æŒ‰å‡åºæˆ–é™åºæ’åˆ—ã€‚ é»˜è®¤æƒ…å†µä¸‹ï¼Œå®ƒæ˜¯æŒ‰å‡åºæ’åˆ—ã€‚</li><li>ä½ å¯ä»¥æ·»åŠ  WHEREâ€¦LIKE å­å¥æ¥è®¾ç½®æ¡ä»¶ã€‚</li></ul><p><strong>å®ä¾‹</strong></p><p>æ¼”ç¤º<strong>test_tbl</strong>æ•°æ®è¡¨</p><pre><code class="hljs sql">mysql&gt; SELECT * FROM test_tbl;+<span class="hljs-comment">----+----------+-----+-----+-----------------+</span>| id | name     | age | sex | submission_date |+<span class="hljs-comment">----+----------+-----+-----+-----------------+</span>|  1 | pangzi W |  25 | M   | 2018-01-22      ||  2 | san A    |  25 | M   | 2018-01-22      ||  3 | sao A    |  24 | M   | 2018-01-22      ||  4 | juju GOU |  26 | M   | 2018-01-22      ||  6 | nv JI    |  18 | W   | 2018-01-22      |+<span class="hljs-comment">----+----------+-----+-----+-----------------+</span>5 rows in <span class="hljs-keyword">set</span> (<span class="hljs-number">0.00</span> sec)</code></pre><p>å°†<strong>test_tbl</strong>é€šè¿‡<strong>age</strong>å‡åºæ’åˆ—ï¼š</p><pre><code class="hljs sql">mysql&gt; SELECT * FROM test_tbl ORDER BY age ASC;+<span class="hljs-comment">----+----------+-----+-----+-----------------+</span>| id | name     | age | sex | submission_date |+<span class="hljs-comment">----+----------+-----+-----+-----------------+</span>|  6 | nv JI    |  18 | W   | 2018-01-22      ||  3 | sao A    |  24 | M   | 2018-01-22      ||  1 | pangzi W |  25 | M   | 2018-01-22      ||  2 | san A    |  25 | M   | 2018-01-22      ||  4 | juju GOU |  26 | M   | 2018-01-22      |+<span class="hljs-comment">----+----------+-----+-----+-----------------+</span>5 rows in <span class="hljs-keyword">set</span> (<span class="hljs-number">0.01</span> sec)</code></pre><p>å°†<strong>test_tbl</strong>é€šè¿‡<strong>age</strong>é™åºæ’åˆ—ï¼š</p><pre><code class="hljs sql">mysql&gt; SELECT * FROM test_tbl ORDER BY age DESC;+<span class="hljs-comment">----+----------+-----+-----+-----------------+</span>| id | name     | age | sex | submission_date |+<span class="hljs-comment">----+----------+-----+-----+-----------------+</span>|  4 | juju GOU |  26 | M   | 2018-01-22      ||  1 | pangzi W |  25 | M   | 2018-01-22      ||  2 | san A    |  25 | M   | 2018-01-22      ||  3 | sao A    |  24 | M   | 2018-01-22      ||  6 | nv JI    |  18 | W   | 2018-01-22      |+<span class="hljs-comment">----+----------+-----+-----+-----------------+</span>5 rows in <span class="hljs-keyword">set</span> (<span class="hljs-number">0.00</span> sec)</code></pre><h2 id="5-15-MySQL-GROUP-BYè¯­å¥ï¼ˆåˆ†ç»„ï¼‰"><a href="#5-15-MySQL-GROUP-BYè¯­å¥ï¼ˆåˆ†ç»„ï¼‰" class="headerlink" title="5.15 MySQL GROUP BYè¯­å¥ï¼ˆåˆ†ç»„ï¼‰"></a>5.15 MySQL GROUP BYè¯­å¥ï¼ˆåˆ†ç»„ï¼‰</h2><p>GROUP BY è¯­å¥æ ¹æ®ä¸€ä¸ªæˆ–å¤šä¸ªåˆ—å¯¹ç»“æœé›†è¿›è¡Œåˆ†ç»„ã€‚åœ¨åˆ†ç»„çš„åˆ—ä¸Šæˆ‘ä»¬å¯ä»¥ä½¿ç”¨ <strong>COUNT, SUM, AVG</strong>ç­‰å‡½æ•°ã€‚</p><p><strong>è¯­æ³•</strong></p><pre><code class="hljs sql"><span class="hljs-keyword">SELECT</span> column_name, <span class="hljs-keyword">function</span>(column_name)<span class="hljs-keyword">FROM</span> table_name<span class="hljs-keyword">WHERE</span> column_name <span class="hljs-keyword">operator</span> <span class="hljs-keyword">value</span><span class="hljs-keyword">GROUP</span> <span class="hljs-keyword">BY</span> column_name;</code></pre><p><strong>å®ä¾‹</strong></p><p>å¯¹employee_tblæ•°æ®è¡¨è¿›è¡Œåˆ†ç»„ï¼š</p><pre><code class="hljs sql">mysql&gt; SELECT * FROM employee_tbl;+<span class="hljs-comment">----+--------+---------------------+--------+</span>| id | name   | date                | singin |+<span class="hljs-comment">----+--------+---------------------+--------+</span>|  1 | å°æ˜ | 2016-04-22 15:25:33 |      1 ||  2 | å°ç‹ | 2016-04-20 15:25:47 |      3 ||  3 | å°ä¸½ | 2016-04-19 15:26:02 |      2 ||  4 | å°ç‹ | 2016-04-07 15:26:14 |      4 ||  5 | å°æ˜ | 2016-04-11 15:26:40 |      4 ||  6 | å°æ˜ | 2016-04-04 15:26:54 |      2 |+<span class="hljs-comment">----+--------+---------------------+--------+</span>6 rows in <span class="hljs-keyword">set</span> (<span class="hljs-number">0.00</span> sec)</code></pre><p>ä½¿ç”¨ GROUP BY è¯­å¥ å°†æ•°æ®è¡¨æŒ‰åå­—è¿›è¡Œåˆ†ç»„ï¼Œå¹¶ç»Ÿè®¡æ¯ä¸ªäººæœ‰å¤šå°‘æ¡è®°å½•ï¼š</p><pre><code class="hljs sql">mysql&gt; SELECT name, COUNT(*) FROM   employee_tbl GROUP BY name;+<span class="hljs-comment">--------+----------+</span>| name   | COUNT(*) |+<span class="hljs-comment">--------+----------+</span>| å°ä¸½ |        1 || å°æ˜ |        3 || å°ç‹ |        2 |+<span class="hljs-comment">--------+----------+</span>3 rows in <span class="hljs-keyword">set</span> (<span class="hljs-number">0.01</span> sec)</code></pre><h3 id="5-15-1-ä½¿ç”¨-WITH-ROLLUP"><a href="#5-15-1-ä½¿ç”¨-WITH-ROLLUP" class="headerlink" title="5.15.1 ä½¿ç”¨ WITH ROLLUP"></a>5.15.1 ä½¿ç”¨ WITH ROLLUP</h3><p>WITH ROLLUP å¯ä»¥å®ç°åœ¨åˆ†ç»„ç»Ÿè®¡æ•°æ®åŸºç¡€ä¸Šå†è¿›è¡Œç›¸åŒçš„ç»Ÿè®¡ï¼ˆSUM,AVG,COUNTâ€¦ï¼‰ã€‚</p><p>ä¾‹å¦‚æˆ‘ä»¬å°†ä»¥ä¸Šçš„æ•°æ®è¡¨æŒ‰åå­—è¿›è¡Œåˆ†ç»„ï¼Œå†ç»Ÿè®¡æ¯ä¸ªäººç™»å½•çš„æ¬¡æ•°ï¼š</p><pre><code class="hljs sql">mysql&gt; SELECT name, SUM(singin) as singin_count FROM  employee_tbl GROUP BY name WITH ROLLUP;+<span class="hljs-comment">--------+--------------+</span>| name   | singin_count |+<span class="hljs-comment">--------+--------------+</span>| å°ä¸½ |            2 || å°æ˜ |            7 || å°ç‹ |            7 || NULL   |           16 |+<span class="hljs-comment">--------+--------------+</span>4 rows in <span class="hljs-keyword">set</span> (<span class="hljs-number">0.00</span> sec)</code></pre><blockquote><p>å…¶ä¸­è®°å½• NULL è¡¨ç¤ºæ‰€æœ‰äººçš„ç™»å½•æ¬¡æ•°ã€‚</p></blockquote><p>æˆ‘ä»¬å¯ä»¥ä½¿ç”¨ coalesce æ¥è®¾ç½®ä¸€ä¸ªå¯ä»¥å–ä»£ NUll çš„åç§°ï¼Œcoalesce è¯­æ³•ï¼š<code>select coalesce(a,b,c);</code><br>å‚æ•°è¯´æ˜ï¼šå¦‚æœa==null,åˆ™é€‰æ‹©bï¼›å¦‚æœb==null,åˆ™é€‰æ‹©cï¼›å¦‚æœa!=null,åˆ™é€‰æ‹©aï¼›å¦‚æœa b c éƒ½ä¸ºnull ï¼Œåˆ™è¿”å›ä¸ºnullï¼ˆæ²¡æ„ä¹‰ï¼‰ã€‚<br>ä»¥ä¸‹å®ä¾‹ä¸­å¦‚æœåå­—ä¸ºç©ºæˆ‘ä»¬ä½¿ç”¨æ€»æ•°ä»£æ›¿ï¼š</p><pre><code class="hljs sql">mysql&gt; SELECT coalesce(name, &#x27;æ€»æ•°&#x27;), SUM(singin) as singin_count FROM  employee_tbl GROUP BY name WITH ROLLUP;+<span class="hljs-comment">--------------------------+--------------+</span>| coalesce(name, &#x27;æ€»æ•°&#x27;) | singin_count |+<span class="hljs-comment">--------------------------+--------------+</span>| å°ä¸½                   |            2 || å°æ˜                   |            7 || å°ç‹                   |            7 || æ€»æ•°                   |           16 |+<span class="hljs-comment">--------------------------+--------------+</span>4 rows in <span class="hljs-keyword">set</span> (<span class="hljs-number">0.01</span> sec)</code></pre><h2 id="5-16-MySQLè¿æ¥çš„ä½¿ç”¨"><a href="#5-16-MySQLè¿æ¥çš„ä½¿ç”¨" class="headerlink" title="5.16 MySQLè¿æ¥çš„ä½¿ç”¨"></a>5.16 MySQLè¿æ¥çš„ä½¿ç”¨</h2><p>åœ¨MySQLä¸­ï¼Œå¯ä»¥ä½¿ç”¨JOINåœ¨ä¸¤ä¸ªæˆ–å¤šä¸ªè¡¨ä¸­æŸ¥è¯¢æ•°æ®ã€‚<br>å¯ä»¥åœ¨ SELECT, UPDATE å’Œ DELETE è¯­å¥ä¸­ä½¿ç”¨ Mysql çš„ JOIN æ¥è”åˆå¤šè¡¨æŸ¥è¯¢ã€‚<br>JOIN æŒ‰ç…§åŠŸèƒ½å¤§è‡´åˆ†ä¸ºå¦‚ä¸‹ä¸‰ç±»ï¼š</p><ul><li><strong>INNER JOINï¼ˆå†…è¿æ¥,æˆ–ç­‰å€¼è¿æ¥ï¼‰</strong>ï¼šè·å–ä¸¤ä¸ªè¡¨ä¸­å­—æ®µåŒ¹é…å…³ç³»çš„è®°å½•ã€‚</li><li><strong>LEFT JOINï¼ˆå·¦è¿æ¥ï¼‰</strong>ï¼šè·å–å·¦è¡¨æ‰€æœ‰è®°å½•ï¼Œå³ä½¿å³è¡¨æ²¡æœ‰å¯¹åº”åŒ¹é…çš„è®°å½•ã€‚</li><li><strong>RIGHT JOINï¼ˆå³è¿æ¥ï¼‰</strong>ï¼š ä¸ LEFT JOIN ç›¸åï¼Œç”¨äºè·å–å³è¡¨æ‰€æœ‰è®°å½•ï¼Œå³ä½¿å·¦è¡¨æ²¡æœ‰å¯¹åº”åŒ¹é…çš„è®°å½•ã€‚</li></ul><p><strong>å®ä¾‹ï¼š</strong>ä½¿ç”¨èœé¸Ÿæ•™ç¨‹æ•°æ®åº“</p><pre><code class="hljs sql">mysql&gt; use RUNOOB;Database changedmysql&gt; SELECT * FROM tcount_tbl;+<span class="hljs-comment">---------------+--------------+</span>| runoob_author | runoob_count |+<span class="hljs-comment">---------------+--------------+</span>| èœé¸Ÿæ•™ç¨‹  | 10           || RUNOOB.COM    | 20           || Google        | 22           |+<span class="hljs-comment">---------------+--------------+</span>3 rows in <span class="hljs-keyword">set</span> (<span class="hljs-number">0.01</span> sec) mysql&gt; <span class="hljs-keyword">SELECT</span> * <span class="hljs-keyword">from</span> runoob_tbl;+<span class="hljs-comment">-----------+---------------+---------------+-----------------+</span>| runoob_id | runoob_title  | runoob_author | submission_date |+<span class="hljs-comment">-----------+---------------+---------------+-----------------+</span>| 1         | å­¦ä¹  PHP    | èœé¸Ÿæ•™ç¨‹  | 2017-04-12              || 2         | å­¦ä¹  MySQL  | èœé¸Ÿæ•™ç¨‹  | 2017-04-12              || 3         | å­¦ä¹  Java   | RUNOOB.COM    | 2015-05-01         || 4         | å­¦ä¹  sql | RUNOOB.COM    | 2016-03-06         || 5         | å­¦ä¹  C      | FK            | 2017-04-05         |+<span class="hljs-comment">-----------+---------------+---------------+-----------------+</span>5 rows in <span class="hljs-keyword">set</span> (<span class="hljs-number">0.01</span> sec)</code></pre><h3 id="5-16-1-MySQL-INNER-JOIN"><a href="#5-16-1-MySQL-INNER-JOIN" class="headerlink" title="5.16.1 MySQL INNER JOIN"></a>5.16.1 MySQL INNER JOIN</h3><p>ä½¿ç”¨MySQLçš„INNER JOIN(ä¹Ÿå¯ä»¥çœç•¥ INNER ä½¿ç”¨ JOINï¼Œæ•ˆæœä¸€æ ·)æ¥è¿æ¥ä»¥ä¸Šä¸¤å¼ è¡¨æ¥è¯»å–runoob_tblè¡¨ä¸­æ‰€æœ‰runoob_authorå­—æ®µåœ¨tcount_tblè¡¨å¯¹åº”çš„runoob_countå­—æ®µå€¼ï¼š</p><pre><code class="hljs sql">mysql&gt; SELECT a.runoob_id, a.runoob_author, b.runoob_count FROM runoob_tbl a INNER JOIN tcount_tbl b ON a.runoob_author = b.runoob_author;+<span class="hljs-comment">-------------+-----------------+----------------+</span>| a.runoob_id | a.runoob_author | b.runoob_count |+<span class="hljs-comment">-------------+-----------------+----------------+</span>| 1           | èœé¸Ÿæ•™ç¨‹    | 10             || 2           | èœé¸Ÿæ•™ç¨‹    | 10             || 3           | RUNOOB.COM      | 20             || 4           | RUNOOB.COM      | 20             |+<span class="hljs-comment">-------------+-----------------+----------------+</span>4 rows in <span class="hljs-keyword">set</span> (<span class="hljs-number">0.00</span> sec)</code></pre><p>ç­‰ä»·äºä½¿ç”¨** WHEREå­å¥**ï¼š</p><pre><code class="hljs sql">mysql&gt; SELECT a.runoob_id, a.runoob_author, b.runoob_count FROM runoob_tbl a, tcount_tbl b WHERE a.runoob_author = b.runoob_author;+<span class="hljs-comment">-------------+-----------------+----------------+</span>| a.runoob_id | a.runoob_author | b.runoob_count |+<span class="hljs-comment">-------------+-----------------+----------------+</span>| 1           | èœé¸Ÿæ•™ç¨‹    | 10             || 2           | èœé¸Ÿæ•™ç¨‹    | 10             || 3           | RUNOOB.COM      | 20             || 4           | RUNOOB.COM      | 20             |+<span class="hljs-comment">-------------+-----------------+----------------+</span>4 rows in <span class="hljs-keyword">set</span> (<span class="hljs-number">0.01</span> sec)</code></pre><p><img src="/img/mysql/img_innerjoin.gif"></p><h3 id="5-16-2-MySQL-LEFT-JOIN"><a href="#5-16-2-MySQL-LEFT-JOIN" class="headerlink" title="5.16.2 MySQL LEFT JOIN"></a>5.16.2 MySQL LEFT JOIN</h3><p>MySQL left join ä¸ join æœ‰æ‰€ä¸åŒã€‚ MySQL LEFT JOIN ä¼šè¯»å–å·¦è¾¹æ•°æ®è¡¨çš„å…¨éƒ¨æ•°æ®ï¼Œå³ä¾¿å³è¾¹è¡¨æ— å¯¹åº”æ•°æ®ã€‚</p><pre><code class="hljs sql">mysql&gt; SELECT a.runoob_id, a.runoob_author, b.runoob_count FROM runoob_tbl a LEFT JOIN tcount_tbl b ON a.runoob_author = b.runoob_author;+<span class="hljs-comment">-------------+-----------------+----------------+</span>| a.runoob_id | a.runoob_author | b.runoob_count |+<span class="hljs-comment">-------------+-----------------+----------------+</span>| 1           | èœé¸Ÿæ•™ç¨‹    | 10             || 2           | èœé¸Ÿæ•™ç¨‹    | 10             || 3           | RUNOOB.COM      | 20             || 4           | RUNOOB.COM      | 20             || 5           | FK              | NULL           |+<span class="hljs-comment">-------------+-----------------+----------------+</span>5 rows in <span class="hljs-keyword">set</span> (<span class="hljs-number">0.01</span> sec)</code></pre><p><img src="/img/mysql/img_leftjoin.gif"></p><h3 id="5-16-3-MySQL-RIGHT-JOIN"><a href="#5-16-3-MySQL-RIGHT-JOIN" class="headerlink" title="5.16.3 MySQL RIGHT JOIN"></a>5.16.3 MySQL RIGHT JOIN</h3><p>MySQL RIGHT JOIN ä¼šè¯»å–å³è¾¹æ•°æ®è¡¨çš„å…¨éƒ¨æ•°æ®ï¼Œå³ä¾¿å·¦è¾¹è¾¹è¡¨æ— å¯¹åº”æ•°æ®ã€‚</p><pre><code class="hljs sql">mysql&gt; SELECT a.runoob_id, a.runoob_author, b.runoob_count FROM runoob_tbl a RIGHT JOIN tcount_tbl b ON a.runoob_author = b.runoob_author;+<span class="hljs-comment">-------------+-----------------+----------------+</span>| a.runoob_id | a.runoob_author | b.runoob_count |+<span class="hljs-comment">-------------+-----------------+----------------+</span>| 1           | èœé¸Ÿæ•™ç¨‹    | 10             || 2           | èœé¸Ÿæ•™ç¨‹    | 10             || 3           | RUNOOB.COM      | 20             || 4           | RUNOOB.COM      | 20             || NULL        | NULL            | 22             |+<span class="hljs-comment">-------------+-----------------+----------------+</span>5 rows in <span class="hljs-keyword">set</span> (<span class="hljs-number">0.01</span> sec)</code></pre><p><img src="/img/mysql/img_rightjoin.gif"></p><h2 id="5-17-MySQL-NULLå€¼å¤„ç†"><a href="#5-17-MySQL-NULLå€¼å¤„ç†" class="headerlink" title="5.17 MySQL NULLå€¼å¤„ç†"></a>5.17 MySQL NULLå€¼å¤„ç†</h2><p>MySQL ä½¿ç”¨ SQL SELECT å‘½ä»¤åŠ WHERE å­å¥æ¥è¯»å–æ•°æ®è¡¨ä¸­çš„æ•°æ®,ä½†æ˜¯å½“æä¾›çš„æŸ¥è¯¢æ¡ä»¶å­—æ®µä¸º NULL æ—¶ï¼Œè¯¥å‘½ä»¤å¯èƒ½å°±æ— æ³•æ­£å¸¸å·¥ä½œã€‚<br>ä¸ºäº†å¤„ç†è¿™ç§æƒ…å†µï¼ŒMySQLæä¾›äº†ä¸‰å¤§è¿ç®—ç¬¦:</p><ul><li><strong>IS NULL</strong>: å½“åˆ—çš„å€¼æ˜¯ NULL,æ­¤è¿ç®—ç¬¦è¿”å› trueã€‚</li><li><strong>IS NOT NULL</strong>: å½“åˆ—çš„å€¼ä¸ä¸º NULL, è¿ç®—ç¬¦è¿”å› trueã€‚</li><li><strong>&lt;=&gt;</strong>: æ¯”è¾ƒæ“ä½œç¬¦ï¼ˆä¸åŒäº=è¿ç®—ç¬¦ï¼‰ï¼Œå½“æ¯”è¾ƒçš„çš„ä¸¤ä¸ªå€¼ä¸º NULL æ—¶è¿”å› trueã€‚</li></ul><p>å…³äº NULL çš„æ¡ä»¶æ¯”è¾ƒè¿ç®—æ˜¯æ¯”è¾ƒç‰¹æ®Šçš„ã€‚ä½ ä¸èƒ½ä½¿ç”¨ = NULL æˆ– != NULL åœ¨åˆ—ä¸­æŸ¥æ‰¾ NULL å€¼ ã€‚<br>åœ¨ MySQL ä¸­ï¼ŒNULL å€¼ä¸ä»»ä½•å…¶å®ƒå€¼çš„æ¯”è¾ƒï¼ˆå³ä½¿æ˜¯ NULLï¼‰æ°¸è¿œè¿”å› falseï¼Œå³ NULL = NULL è¿”å›false ã€‚<br>MySQL ä¸­å¤„ç† NULL ä½¿ç”¨ IS NULL å’Œ IS NOT NULL è¿ç®—ç¬¦ã€‚</p><p><strong>å®ä¾‹</strong></p><p>åœ¨æ•°æ®åº“testä¸­åˆ›å»ºæ•°æ®è¡¨test_NULLå«æœ‰ä¸¤åˆ—nameï¼Œageï¼Œåœ¨ageä¸­æ’å…¥NULLå€¼ã€‚</p><pre><code class="hljs sql">mysql&gt; CREATE TABLE test_NULL( name CHAR(10) NOT NULL, age INT);Query OK, 0 rows affected (0.02 sec)mysql&gt; desc test_NULL;+<span class="hljs-comment">-------+----------+------+-----+---------+-------+</span>| Field | Type     | Null | Key | Default | Extra |+<span class="hljs-comment">-------+----------+------+-----+---------+-------+</span>| name  | char(10) | NO   |     | NULL    |       || age   | int(11)  | YES  |     | NULL    |       |+<span class="hljs-comment">-------+----------+------+-----+---------+-------+</span>2 rows in <span class="hljs-keyword">set</span> (<span class="hljs-number">0.00</span> sec)mysql&gt; <span class="hljs-keyword">INSERT</span> <span class="hljs-keyword">INTO</span> test_NULL( <span class="hljs-keyword">name</span>,age) <span class="hljs-keyword">VALUES</span> (<span class="hljs-string">&#x27;LILI&#x27;</span>,<span class="hljs-number">20</span>);Query OK, 1 row affected (0.00 sec)mysql&gt; INSERT INTO test_NULL( name,age) VALUES (&#x27;LALA&#x27;,NULL);Query OK, 1 row affected (0.00 sec)mysql&gt; INSERT INTO test_NULL( name,age) VALUES (&#x27;FEIFEI&#x27;,NULL);Query OK, 1 row affected (0.00 sec)mysql&gt; INSERT INTO test_NULL( name,age) VALUES (&#x27;JIJI&#x27;,NULL);Query OK, 1 row affected (0.00 sec)mysql&gt; INSERT INTO test_NULL( name,age) VALUES (&#x27;GEGE&#x27;,25);Query OK, 1 row affected (0.00 sec)mysql&gt; SELECT * FROM test_NULL;+<span class="hljs-comment">--------+------+</span>| name   | age  |+<span class="hljs-comment">--------+------+</span>| LILI   |   20 || LALA   | NULL || FEIFEI | NULL || JIJI   | NULL || GEGE   |   25 |+<span class="hljs-comment">--------+------+</span>5 rows in <span class="hljs-keyword">set</span> (<span class="hljs-number">0.00</span> sec)</code></pre><p>ä½¿ç”¨SELECT,WHEREæŸ¥è¯¢NULLå€¼ç”¨**=<strong>å’Œ</strong>ï¼=**è¿ç®—ç¬¦æ˜¯ä¸èµ·ä½œç”¨çš„ï¼š</p><pre><code class="hljs sql">mysql&gt; SELECT * FROM test_NULL WHERE age=NULL;Empty <span class="hljs-keyword">set</span> (<span class="hljs-number">0.00</span> sec)mysql&gt; <span class="hljs-keyword">SELECT</span> * <span class="hljs-keyword">FROM</span> test_NULL <span class="hljs-keyword">WHERE</span> age!=<span class="hljs-literal">NULL</span>;Empty <span class="hljs-keyword">set</span> (<span class="hljs-number">0.00</span> sec)</code></pre><p>è¦æŸ¥è¯¢è¡¨ä¸­ageåˆ—ä¸ºæ˜¯å¦ä¸ºNULLå€¼çš„ï¼Œå¿…é¡»ä½¿ç”¨<strong>IS NULL</strong>å’Œ<strong>IS NOT NULL</strong> ï¼š</p><pre><code class="hljs sql">mysql&gt; SELECT * FROM test_NULL WHERE age is NULL;+<span class="hljs-comment">--------+------+</span>| name   | age  |+<span class="hljs-comment">--------+------+</span>| LALA   | NULL || FEIFEI | NULL || JIJI   | NULL |+<span class="hljs-comment">--------+------+</span>3 rows in <span class="hljs-keyword">set</span> (<span class="hljs-number">0.00</span> sec)mysql&gt; <span class="hljs-keyword">SELECT</span> * <span class="hljs-keyword">FROM</span> test_NULL <span class="hljs-keyword">WHERE</span> age <span class="hljs-keyword">is</span> <span class="hljs-keyword">NOT</span> <span class="hljs-literal">NULL</span>;+<span class="hljs-comment">------+------+</span>| name | age  |+<span class="hljs-comment">------+------+</span>| LILI |   20 || GEGE |   25 |+<span class="hljs-comment">------+------+</span>2 rows in <span class="hljs-keyword">set</span> (<span class="hljs-number">0.00</span> sec)</code></pre><h2 id="5-18-MySQLæ­£åˆ™è¡¨è¾¾å¼"><a href="#5-18-MySQLæ­£åˆ™è¡¨è¾¾å¼" class="headerlink" title="5.18 MySQLæ­£åˆ™è¡¨è¾¾å¼"></a>5.18 MySQLæ­£åˆ™è¡¨è¾¾å¼</h2><p>ä¸‹è¡¨ä¸­çš„æ­£åˆ™æ¨¡å¼å¯åº”ç”¨äº REGEXP æ“ä½œç¬¦ä¸­ã€‚</p><table><thead><tr><th align="center">æ¨¡å¼</th><th align="center">æè¿°</th></tr></thead><tbody><tr><td align="center">^</td><td align="center">åŒ¹é…è¾“å…¥å­—ç¬¦ä¸²çš„å¼€å§‹ä½ç½®ã€‚å¦‚æœè®¾ç½®äº† RegExp å¯¹è±¡çš„ Multiline å±æ€§ï¼Œ<br> ^ ä¹ŸåŒ¹é… â€˜\nâ€™ æˆ– â€˜\râ€™ ä¹‹åçš„ä½ç½®ã€‚</td></tr><tr><td align="center">$</td><td align="center">åŒ¹é…è¾“å…¥å­—ç¬¦ä¸²çš„ç»“æŸä½ç½®ã€‚å¦‚æœè®¾ç½®äº†RegExp å¯¹è±¡çš„ Multiline å±æ€§ï¼Œ<br> $ä¹ŸåŒ¹é… â€˜\nâ€™ æˆ– â€˜\râ€™ ä¹‹å‰çš„ä½ç½®ã€‚</td></tr><tr><td align="center">.</td><td align="center">åŒ¹é…é™¤ â€œ\nâ€ ä¹‹å¤–çš„ä»»ä½•å•ä¸ªå­—ç¬¦ã€‚è¦åŒ¹é…åŒ…æ‹¬ â€˜\nâ€™ åœ¨å†…çš„ä»»ä½•å­—ç¬¦ï¼Œ<br>è¯·ä½¿ç”¨è±¡ â€˜[.\n]â€™ çš„æ¨¡å¼ã€‚</td></tr><tr><td align="center">[â€¦]</td><td align="center">å­—ç¬¦é›†åˆã€‚åŒ¹é…æ‰€åŒ…å«çš„ä»»æ„ä¸€ä¸ªå­—ç¬¦ã€‚ä¾‹å¦‚ï¼Œ â€˜[abc]â€™ å¯ä»¥åŒ¹é… â€œplainâ€ ä¸­çš„ â€˜aâ€™ã€‚</td></tr><tr><td align="center">[^â€¦]</td><td align="center">è´Ÿå€¼å­—ç¬¦é›†åˆã€‚åŒ¹é…æœªåŒ…å«çš„ä»»æ„å­—ç¬¦ã€‚ä¾‹å¦‚ï¼Œ â€˜[^abc]â€™ å¯ä»¥åŒ¹é… â€œplainâ€ ä¸­çš„â€™pâ€™ã€‚</td></tr><tr><td align="center">p1/p2/p3</td><td align="center">åŒ¹é… p1 æˆ– p2 æˆ– p3ã€‚ä¾‹å¦‚ï¼Œâ€™z/foodâ€™ èƒ½åŒ¹é… â€œzâ€ æˆ– â€œfoodâ€ã€‚<br>â€˜(z/f)oodâ€™ åˆ™åŒ¹é… â€œzoodâ€ æˆ– â€œfoodâ€ã€‚</td></tr><tr><td align="center">*</td><td align="center">åŒ¹é…å‰é¢çš„å­è¡¨è¾¾å¼é›¶æ¬¡æˆ–å¤šæ¬¡ã€‚ä¾‹å¦‚ï¼Œzo* èƒ½åŒ¹é… â€œzâ€ ä»¥åŠ â€œzooâ€ã€‚* ç­‰ä»·äº{0,}ã€‚</td></tr><tr><td align="center">+</td><td align="center">åŒ¹é…å‰é¢çš„å­è¡¨è¾¾å¼ä¸€æ¬¡æˆ–å¤šæ¬¡ã€‚ä¾‹å¦‚ï¼Œâ€™zo+â€™ èƒ½åŒ¹é… â€œzoâ€ ä»¥åŠ â€œzooâ€ï¼Œ<br>ä½†ä¸èƒ½åŒ¹é… â€œzâ€ã€‚+ ç­‰ä»·äº {1,}ã€‚</td></tr><tr><td align="center">{n}</td><td align="center">n æ˜¯ä¸€ä¸ªéè´Ÿæ•´æ•°ã€‚åŒ¹é…ç¡®å®šçš„ n æ¬¡ã€‚ä¾‹å¦‚ï¼Œâ€™o{2}â€™ ä¸èƒ½åŒ¹é… â€œBobâ€ ä¸­çš„ â€˜oâ€™ï¼Œ<br>ä½†æ˜¯èƒ½åŒ¹é… â€œfoodâ€ ä¸­çš„ä¸¤ä¸ª oã€‚</td></tr><tr><td align="center">{n,m}</td><td align="center">m å’Œ n å‡ä¸ºéè´Ÿæ•´æ•°ï¼Œå…¶ä¸­n &lt;= mã€‚æœ€å°‘åŒ¹é… n æ¬¡ä¸”æœ€å¤šåŒ¹é… m æ¬¡ã€‚</td></tr></tbody></table><p><strong>å®ä¾‹</strong></p><p>åœ¨æ•°æ®è¡¨nameä¸­æŸ¥æ‰¾åå­—æ—¶ï¼š<br>æŸ¥æ‰¾nameå­—æ®µä¸­ä»¥â€˜stâ€™ä¸ºå¼€å¤´çš„æ‰€æœ‰æ•°æ®ï¼š</p><pre><code class="hljs sql">mysql&gt; SELECT name FROM person_tbl WHERE name REGEXP &#x27;^st&#x27;;</code></pre><p>æŸ¥æ‰¾nameå­—æ®µä¸­ä»¥â€˜okâ€™ç»“å°¾çš„æ‰€æœ‰æ•°æ®ï¼š</p><pre><code class="hljs sql">mysql&gt; SELECT name FROM person_tbl WHERE name REGEXP &#x27;ok$&#x27;;</code></pre><p>æŸ¥æ‰¾nameå­—æ®µä¸­åŒ…å«â€˜marâ€™å­—ç¬¦ä¸²çš„æ‰€æœ‰æ•°æ®ï¼š</p><pre><code class="hljs sql">mysql&gt; SELECT name FROM person_tbl WHERE name REGEXP &#x27;mar&#x27;;</code></pre><p>æŸ¥æ‰¾nameå­—æ®µä¸­ä»¥å…ƒéŸ³å­—ç¬¦å¼€å¤´æˆ–ä»¥â€˜okâ€™å­—ç¬¦ä¸²ç»“å°¾çš„æ‰€æœ‰æ•°æ®ï¼š</p><pre><code class="hljs sql">mysql&gt; SELECT name FROM person_tbl WHERE name REGEXP &#x27;^[aeiou]|ok$&#x27;;</code></pre><h2 id="5-19-MySQL-ALTERå‘½ä»¤"><a href="#5-19-MySQL-ALTERå‘½ä»¤" class="headerlink" title="5.19 MySQL ALTERå‘½ä»¤"></a>5.19 MySQL ALTERå‘½ä»¤</h2><p>å½“æˆ‘ä»¬éœ€è¦ä¿®æ”¹æ•°æ®è¡¨åæˆ–è€…ä¿®æ”¹æ•°æ®è¡¨å­—æ®µæ—¶ï¼Œå°±éœ€è¦ä½¿ç”¨åˆ°MySQL ALTERå‘½ä»¤ã€‚<br>å…ˆåˆ›å»ºä¸€å¼ è¡¨testalter_tblï¼š</p><pre><code class="hljs sql">mysql&gt; CREATE TABLE testalter_tbl(i INT, C CHAR(10));Query OK, 0 rows affected (0.02 sec)mysql&gt; SHOW COLUMNS FROM testalter_tbl;+<span class="hljs-comment">-------+----------+------+-----+---------+-------+</span>| Field | Type     | Null | Key | Default | Extra |+<span class="hljs-comment">-------+----------+------+-----+---------+-------+</span>| i     | int(11)  | YES  |     | NULL    |       || C     | char(10) | YES  |     | NULL    |       |+<span class="hljs-comment">-------+----------+------+-----+---------+-------+</span>2 rows in <span class="hljs-keyword">set</span> (<span class="hljs-number">0.00</span> sec)</code></pre><h3 id="5-19-1-åˆ é™¤ï¼Œæ·»åŠ æˆ–ä¿®æ”¹å­—æ®µ"><a href="#5-19-1-åˆ é™¤ï¼Œæ·»åŠ æˆ–ä¿®æ”¹å­—æ®µ" class="headerlink" title="5.19.1 åˆ é™¤ï¼Œæ·»åŠ æˆ–ä¿®æ”¹å­—æ®µ"></a>5.19.1 åˆ é™¤ï¼Œæ·»åŠ æˆ–ä¿®æ”¹å­—æ®µ</h3><ol><li>ä½¿ç”¨ALTER å‘½ä»¤åŠ DROP å­å¥æ¥åˆ é™¤ä»¥ä¸Šåˆ›å»ºè¡¨çš„ i å­—æ®µï¼š</li></ol><pre><code class="hljs sql">mysql&gt; ALTER TABLE testalter_tbl DROP i;Query OK, 0 rows affected (0.02 sec)Records: 0  Duplicates: 0  Warnings: 0mysql&gt; SHOW COLUMNS FROM testalter_tbl;+<span class="hljs-comment">-------+----------+------+-----+---------+-------+</span>| Field | Type     | Null | Key | Default | Extra |+<span class="hljs-comment">-------+----------+------+-----+---------+-------+</span>| C     | char(10) | YES  |     | NULL    |       |+<span class="hljs-comment">-------+----------+------+-----+---------+-------+</span>1 row in <span class="hljs-keyword">set</span> (<span class="hljs-number">0.00</span> sec)</code></pre><p><strong>å¦‚æœæ•°æ®è¡¨ä¸­åªå‰©ä½™ä¸€ä¸ªå­—æ®µåˆ™æ— æ³•ä½¿ç”¨DROPæ¥åˆ é™¤å­—æ®µã€‚</strong></p><ol start="2"><li>ä½¿ç”¨ ADD å­å¥æ¥å‘è¡¨ testalter_tbl ä¸­æ·»åŠ  i å­—æ®µï¼Œå¹¶å®šä¹‰æ•°æ®ç±»å‹:</li></ol><pre><code class="hljs sql">mysql&gt; ALTER TABLE testalter_tbl ADD i INT;Query OK, 0 rows affected (0.02 sec)Records: 0  Duplicates: 0  Warnings: 0mysql&gt; SHOW COLUMNS FROM testalter_tbl;+<span class="hljs-comment">-------+----------+------+-----+---------+-------+</span>| Field | Type     | Null | Key | Default | Extra |+<span class="hljs-comment">-------+----------+------+-----+---------+-------+</span>| C     | char(10) | YES  |     | NULL    |       || i     | int(11)  | YES  |     | NULL    |       |+<span class="hljs-comment">-------+----------+------+-----+---------+-------+</span>2 rows in <span class="hljs-keyword">set</span> (<span class="hljs-number">0.00</span> sec)</code></pre><p>æ‰§è¡Œä»¥ä¸Šå‘½ä»¤åï¼Œi å­—æ®µä¼šè‡ªåŠ¨æ·»åŠ åˆ°æ•°æ®è¡¨å­—æ®µçš„æœ«å°¾ã€‚</p><ol start="3"><li>å¦‚æœä½ éœ€è¦æŒ‡å®šæ–°å¢å­—æ®µçš„ä½ç½®ï¼Œå¯ä»¥ä½¿ç”¨MySQLæä¾›çš„å…³é”®å­— FIRST (è®¾å®šä½ç¬¬ä¸€åˆ—)ï¼Œ AFTER å­—æ®µåï¼ˆè®¾å®šä½äºæŸä¸ªå­—æ®µä¹‹åï¼‰:</li></ol><pre><code class="hljs sql">mysql&gt; ALTER TABLE testalter_tbl ADD a INT FIRST;Query OK, 0 rows affected (0.02 sec)Records: 0  Duplicates: 0  Warnings: 0mysql&gt; SHOW COLUMNS FROM testalter_tbl;+<span class="hljs-comment">-------+----------+------+-----+---------+-------+</span>| Field | Type     | Null | Key | Default | Extra |+<span class="hljs-comment">-------+----------+------+-----+---------+-------+</span>| a     | int(11)  | YES  |     | NULL    |       || C     | char(10) | YES  |     | NULL    |       || i     | int(11)  | YES  |     | NULL    |       |+<span class="hljs-comment">-------+----------+------+-----+---------+-------+</span>3 rows in <span class="hljs-keyword">set</span> (<span class="hljs-number">0.00</span> sec)mysql&gt; <span class="hljs-keyword">ALTER</span> <span class="hljs-keyword">TABLE</span> testalter_tbl <span class="hljs-keyword">ADD</span> b <span class="hljs-built_in">INT</span> <span class="hljs-keyword">AFTER</span> a;Query OK, 0 rows affected (0.02 sec)Records: 0  Duplicates: 0  Warnings: 0mysql&gt; SHOW COLUMNS FROM testalter_tbl;+<span class="hljs-comment">-------+----------+------+-----+---------+-------+</span>| Field | Type     | Null | Key | Default | Extra |+<span class="hljs-comment">-------+----------+------+-----+---------+-------+</span>| a     | int(11)  | YES  |     | NULL    |       || b     | int(11)  | YES  |     | NULL    |       || C     | char(10) | YES  |     | NULL    |       || i     | int(11)  | YES  |     | NULL    |       |+<span class="hljs-comment">-------+----------+------+-----+---------+-------+</span>4 rows in <span class="hljs-keyword">set</span> (<span class="hljs-number">0.00</span> sec)</code></pre><h3 id="5-19-2-ä¿®æ”¹å­—æ®µç±»å‹åŠåç§°"><a href="#5-19-2-ä¿®æ”¹å­—æ®µç±»å‹åŠåç§°" class="headerlink" title="5.19.2 ä¿®æ”¹å­—æ®µç±»å‹åŠåç§°"></a>5.19.2 ä¿®æ”¹å­—æ®µç±»å‹åŠåç§°</h3><p>å¦‚æœéœ€è¦ä¿®æ”¹å­—æ®µç±»å‹åŠåç§°, ä½ å¯ä»¥åœ¨ALTERå‘½ä»¤ä¸­ä½¿ç”¨ MODIFY æˆ– CHANGE å­å¥ ã€‚</p><p><strong>å®ä¾‹ï¼š</strong>æŠŠå­—æ®µ c çš„ç±»å‹ä» CHAR(10) æ”¹ä¸º CHAR(1)ï¼Œå¯ä»¥æ‰§è¡Œä»¥ä¸‹å‘½ä»¤:</p><pre><code class="hljs sql">mysql&gt; ALTER TABLE testalter_tbl MODIFY c CHAR(1);Query OK, 0 rows affected (0.01 sec)Records: 0  Duplicates: 0  Warnings: 0mysql&gt; SHOW COLUMNS FROM testalter_tbl;+<span class="hljs-comment">-------+---------+------+-----+---------+-------+</span>| Field | Type    | Null | Key | Default | Extra |+<span class="hljs-comment">-------+---------+------+-----+---------+-------+</span>| a     | int(11) | YES  |     | NULL    |       || b     | int(11) | YES  |     | NULL    |       || c     | char(1) | YES  |     | NULL    |       || i     | int(11) | YES  |     | NULL    |       |+<span class="hljs-comment">-------+---------+------+-----+---------+-------+</span>4 rows in <span class="hljs-keyword">set</span> (<span class="hljs-number">0.00</span> sec)</code></pre><p>ä½¿ç”¨ CHANGE å­å¥, è¯­æ³•æœ‰å¾ˆå¤§çš„ä¸åŒã€‚ åœ¨ CHANGE å…³é”®å­—ä¹‹åï¼Œç´§è·Ÿç€çš„æ˜¯ä½ è¦ä¿®æ”¹çš„å­—æ®µåï¼Œç„¶åæŒ‡å®šæ–°å­—æ®µååŠç±»å‹ã€‚<br><strong>å®ä¾‹ï¼š</strong>å°†å­—æ®µiæ”¹ä¸ºjå¹¶å°†æ•°æ®ç±»å‹æ”¹ä¸ºBIGINTï¼Œå†å°†BIGINTæ”¹ä¸ºINTã€‚</p><pre><code class="hljs sql">mysql&gt; SHOW COLUMNS FROM testalter_tbl;+<span class="hljs-comment">-------+---------+------+-----+---------+-------+</span>| Field | Type    | Null | Key | Default | Extra |+<span class="hljs-comment">-------+---------+------+-----+---------+-------+</span>| a     | int(11) | YES  |     | NULL    |       || b     | int(11) | YES  |     | NULL    |       || c     | char(1) | YES  |     | NULL    |       || i     | int(11) | YES  |     | NULL    |       |+<span class="hljs-comment">-------+---------+------+-----+---------+-------+</span>4 rows in <span class="hljs-keyword">set</span> (<span class="hljs-number">0.00</span> sec)mysql&gt; <span class="hljs-keyword">ALTER</span> <span class="hljs-keyword">TABLE</span> testalter_tbl <span class="hljs-keyword">CHANGE</span> i j <span class="hljs-built_in">BIGINT</span>;Query OK, 0 rows affected (0.02 sec)Records: 0  Duplicates: 0  Warnings: 0mysql&gt; SHOW COLUMNS FROM testalter_tbl;+<span class="hljs-comment">-------+------------+------+-----+---------+-------+</span>| Field | Type       | Null | Key | Default | Extra |+<span class="hljs-comment">-------+------------+------+-----+---------+-------+</span>| a     | int(11)    | YES  |     | NULL    |       || b     | int(11)    | YES  |     | NULL    |       || c     | char(1)    | YES  |     | NULL    |       || j     | bigint(20) | YES  |     | NULL    |       |+<span class="hljs-comment">-------+------------+------+-----+---------+-------+</span>4 rows in <span class="hljs-keyword">set</span> (<span class="hljs-number">0.01</span> sec)mysql&gt; <span class="hljs-keyword">ALTER</span> <span class="hljs-keyword">TABLE</span> testalter_tbl <span class="hljs-keyword">CHANGE</span> j j <span class="hljs-built_in">INT</span>;Query OK, 0 rows affected (0.02 sec)Records: 0  Duplicates: 0  Warnings: 0mysql&gt; SHOW COLUMNS FROM testalter_tbl;+<span class="hljs-comment">-------+---------+------+-----+---------+-------+</span>| Field | Type    | Null | Key | Default | Extra |+<span class="hljs-comment">-------+---------+------+-----+---------+-------+</span>| a     | int(11) | YES  |     | NULL    |       || b     | int(11) | YES  |     | NULL    |       || c     | char(1) | YES  |     | NULL    |       || j     | int(11) | YES  |     | NULL    |       |+<span class="hljs-comment">-------+---------+------+-----+---------+-------+</span>4 rows in <span class="hljs-keyword">set</span> (<span class="hljs-number">0.00</span> sec)</code></pre><h3 id="5-19-3-ALTER-TABLE-å¯¹-Null-å€¼å’Œé»˜è®¤å€¼çš„å½±å“"><a href="#5-19-3-ALTER-TABLE-å¯¹-Null-å€¼å’Œé»˜è®¤å€¼çš„å½±å“" class="headerlink" title="5.19.3 ALTER TABLE å¯¹ Null å€¼å’Œé»˜è®¤å€¼çš„å½±å“"></a>5.19.3 ALTER TABLE å¯¹ Null å€¼å’Œé»˜è®¤å€¼çš„å½±å“</h3><p>å½“ä½ ä¿®æ”¹å­—æ®µæ—¶ï¼Œä½ å¯ä»¥æŒ‡å®šæ˜¯å¦åŒ…å«å€¼æˆ–è€…æ˜¯å¦è®¾ç½®é»˜è®¤å€¼ã€‚<br><strong>å®ä¾‹ï¼š</strong>æŒ‡å®šå­—æ®µ j ä¸º NOT NULL ä¸”é»˜è®¤å€¼ä¸º100 ã€‚</p><pre><code class="hljs sql">mysql&gt; SHOW COLUMNS FROM testalter_tbl;+<span class="hljs-comment">-------+---------+------+-----+---------+-------+</span>| Field | Type    | Null | Key | Default | Extra |+<span class="hljs-comment">-------+---------+------+-----+---------+-------+</span>| a     | int(11) | YES  |     | NULL    |       || b     | int(11) | YES  |     | NULL    |       || c     | char(1) | YES  |     | NULL    |       || j     | int(11) | YES  |     | NULL    |       |+<span class="hljs-comment">-------+---------+------+-----+---------+-------+</span>4 rows in <span class="hljs-keyword">set</span> (<span class="hljs-number">0.00</span> sec)mysql&gt; <span class="hljs-keyword">ALTER</span> <span class="hljs-keyword">TABLE</span> testalter_tbl    -&gt; <span class="hljs-keyword">MODIFY</span> j <span class="hljs-built_in">BIGINT</span> <span class="hljs-keyword">NOT</span> <span class="hljs-literal">NULL</span> <span class="hljs-keyword">DEFAULT</span> <span class="hljs-number">100</span>;Query OK, 0 rows affected (0.02 sec)Records: 0  Duplicates: 0  Warnings: 0mysql&gt; SHOW COLUMNS FROM testalter_tbl;+<span class="hljs-comment">-------+------------+------+-----+---------+-------+</span>| Field | Type       | Null | Key | Default | Extra |+<span class="hljs-comment">-------+------------+------+-----+---------+-------+</span>| a     | int(11)    | YES  |     | NULL    |       || b     | int(11)    | YES  |     | NULL    |       || c     | char(1)    | YES  |     | NULL    |       || j     | bigint(20) | NO   |     | 100     |       |+<span class="hljs-comment">-------+------------+------+-----+---------+-------+</span>4 rows in <span class="hljs-keyword">set</span> (<span class="hljs-number">0.01</span> sec)</code></pre><p>å¦‚æœä¸è®¾ç½®é»˜è®¤å€¼ï¼ŒMySQLä¼šè‡ªåŠ¨è®¾ç½®è¯¥å­—æ®µé»˜è®¤ä¸º NULLã€‚</p><h3 id="5-19-4-ä¿®æ”¹å­—æ®µé»˜è®¤å€¼"><a href="#5-19-4-ä¿®æ”¹å­—æ®µé»˜è®¤å€¼" class="headerlink" title="5.19.4 ä¿®æ”¹å­—æ®µé»˜è®¤å€¼"></a>5.19.4 ä¿®æ”¹å­—æ®µé»˜è®¤å€¼</h3><p>ä»¥ä½¿ç”¨ ALTER æ¥ä¿®æ”¹å­—æ®µçš„é»˜è®¤å€¼ã€‚<br><strong>å®ä¾‹ï¼š</strong></p><pre><code class="hljs sql">mysql&gt; SHOW COLUMNS FROM testalter_tbl;+<span class="hljs-comment">-------+------------+------+-----+---------+-------+</span>| Field | Type       | Null | Key | Default | Extra |+<span class="hljs-comment">-------+------------+------+-----+---------+-------+</span>| a     | int(11)    | YES  |     | NULL    |       || b     | int(11)    | YES  |     | NULL    |       || c     | char(1)    | YES  |     | NULL    |       || j     | bigint(20) | NO   |     | 100     |       |+<span class="hljs-comment">-------+------------+------+-----+---------+-------+</span>4 rows in <span class="hljs-keyword">set</span> (<span class="hljs-number">0.01</span> sec)mysql&gt; <span class="hljs-keyword">ALTER</span> <span class="hljs-keyword">TABLE</span> testalter_tbl <span class="hljs-keyword">ALTER</span> a <span class="hljs-keyword">SET</span> <span class="hljs-keyword">DEFAULT</span> <span class="hljs-number">1000</span>;Query OK, 0 rows affected (0.01 sec)Records: 0  Duplicates: 0  Warnings: 0mysql&gt; SHOW COLUMNS FROM testalter_tbl;+<span class="hljs-comment">-------+------------+------+-----+---------+-------+</span>| Field | Type       | Null | Key | Default | Extra |+<span class="hljs-comment">-------+------------+------+-----+---------+-------+</span>| a     | int(11)    | YES  |     | 1000    |       || b     | int(11)    | YES  |     | NULL    |       || c     | char(1)    | YES  |     | NULL    |       || j     | bigint(20) | NO   |     | 100     |       |+<span class="hljs-comment">-------+------------+------+-----+---------+-------+</span>4 rows in <span class="hljs-keyword">set</span> (<span class="hljs-number">0.00</span> sec)</code></pre><p>ä½¿ç”¨ ALTER å‘½ä»¤åŠ DROPå­å¥æ¥åˆ é™¤å­—æ®µçš„é»˜è®¤å€¼ã€‚<br><strong>å®ä¾‹ï¼š</strong></p><pre><code class="hljs sql">mysql&gt; ALTER TABLE testalter_tbl ALTER j DROP DEFAULT;Query OK, 0 rows affected (0.02 sec)Records: 0  Duplicates: 0  Warnings: 0mysql&gt; SHOW COLUMNS FROM testalter_tbl;+<span class="hljs-comment">-------+------------+------+-----+---------+-------+</span>| Field | Type       | Null | Key | Default | Extra |+<span class="hljs-comment">-------+------------+------+-----+---------+-------+</span>| a     | int(11)    | YES  |     | 1000    |       || b     | int(11)    | YES  |     | NULL    |       || c     | char(1)    | YES  |     | NULL    |       || j     | bigint(20) | NO   |     | NULL    |       |+<span class="hljs-comment">-------+------------+------+-----+---------+-------+</span>4 rows in <span class="hljs-keyword">set</span> (<span class="hljs-number">0.00</span> sec)</code></pre><h3 id="5-19-5-ä¿®æ”¹æ•°æ®è¡¨ç±»å‹"><a href="#5-19-5-ä¿®æ”¹æ•°æ®è¡¨ç±»å‹" class="headerlink" title="5.19.5 ä¿®æ”¹æ•°æ®è¡¨ç±»å‹"></a>5.19.5 ä¿®æ”¹æ•°æ®è¡¨ç±»å‹</h3><p>ä½¿ç”¨ ALTER å‘½ä»¤åŠ TYPE å­å¥ä¿®æ”¹æ•°æ®è¡¨ç±»å‹ï¼Œå°†æ•°æ®è¡¨testalter_tblçš„ç±»å‹æ”¹ä¸ºMYSAMï¼š<br><strong>æ³¨æ„ï¼š</strong>æŸ¥çœ‹æ•°æ®è¡¨ç±»å‹å¯ä»¥ä½¿ç”¨ SHOW TABLE STATUS è¯­å¥ã€‚</p><pre><code class="hljs sql">mysql&gt; SHOW TABLE STATUS LIKE &#x27;testalter_tbl&#x27;\G;*************************** 1. row ***************************           Name: testalter_tbl         Engine: InnoDB        Version: 10     Row_format: Compact           Rows: 0 Avg_row_length: 0    Data_length: 16384Max_data_length: 0   Index_length: 0      Data_free: 0 Auto_increment: NULL    Create_time: 2018-01-24 11:06:35    Update_time: NULL     Check_time: NULL      Collation: latin1_swedish_ci       <span class="hljs-keyword">Checksum</span>: <span class="hljs-literal">NULL</span> Create_options:         <span class="hljs-keyword">Comment</span>: <span class="hljs-number">1</span> <span class="hljs-keyword">row</span> <span class="hljs-keyword">in</span> <span class="hljs-keyword">set</span> (<span class="hljs-number">0.01</span> sec)mysql&gt; <span class="hljs-keyword">ALTER</span> <span class="hljs-keyword">TABLE</span> testalter_tbl <span class="hljs-keyword">ENGINE</span>=MYISAM;Query OK, 0 rows affected (0.02 sec)Records: 0  Duplicates: 0  Warnings: 0mysql&gt; SHOW TABLE STATUS LIKE &#x27;testalter_tbl&#x27;\G;*************************** 1. row ***************************           Name: testalter_tbl         Engine: MyISAM        Version: 10     Row_format: Fixed           Rows: 0 Avg_row_length: 0    Data_length: 0Max_data_length: 5066549580791807   Index_length: 1024      Data_free: 0 Auto_increment: NULL    Create_time: 2018-01-24 11:17:33    Update_time: 2018-01-24 11:17:33     Check_time: NULL      Collation: latin1_swedish_ci       <span class="hljs-keyword">Checksum</span>: <span class="hljs-literal">NULL</span> Create_options:         <span class="hljs-keyword">Comment</span>: <span class="hljs-number">1</span> <span class="hljs-keyword">row</span> <span class="hljs-keyword">in</span> <span class="hljs-keyword">set</span> (<span class="hljs-number">0.00</span> sec)</code></pre><h3 id="5-19-6-ä¿®æ”¹è¡¨å"><a href="#5-19-6-ä¿®æ”¹è¡¨å" class="headerlink" title="5.19.6 ä¿®æ”¹è¡¨å"></a>5.19.6 ä¿®æ”¹è¡¨å</h3><p>å¦‚æœéœ€è¦ä¿®æ”¹æ•°æ®è¡¨çš„åç§°ï¼Œå¯ä»¥åœ¨ ALTER TABLE è¯­å¥ä¸­ä½¿ç”¨ RENAME å­å¥æ¥å®ç°ã€‚<br><strong>å®ä¾‹ï¼š</strong>ä¿®æ”¹è¡¨test_NULLä¸ºtestnull_tbl:</p><pre><code class="hljs sql">mysql&gt; ALTER TABLE test_NULL RENAME TO testnull_tbl;Query OK, 0 rows affected (0.01 sec)mysql&gt; SHOW TABLES;+<span class="hljs-comment">----------------+</span>| Tables_in_test |+<span class="hljs-comment">----------------+</span>| bili           || test_tbl       || testalter_tbl  || testnull_tbl   || url            |+<span class="hljs-comment">----------------+</span>5 rows in <span class="hljs-keyword">set</span> (<span class="hljs-number">0.00</span> sec)</code></pre>]]></content>
    
    
    <categories>
      
      <category>æ•°æ®åº“</category>
      
    </categories>
    
    
    <tags>
      
      <tag>MySQL</tag>
      
      <tag>æ•°æ®åº“</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>SUN M4000æ•…éšœå¤„ç†æŠ¥å‘Š</title>
    <link href="/2017/02/22/SUN_M4000/"/>
    <url>/2017/02/22/SUN_M4000/</url>
    
    <content type="html"><![CDATA[<h1 id="ï¼‘ã€æ•…éšœæ‘˜è¦"><a href="#ï¼‘ã€æ•…éšœæ‘˜è¦" class="headerlink" title="ï¼‘ã€æ•…éšœæ‘˜è¦"></a>ï¼‘ã€æ•…éšœæ‘˜è¦</h1><p>å‘ç°M4000å†…å­˜å‘Šè­¦,åŸæœ‰64Gå†…å­˜ï¼Œç°åœ¨åªè¯†åˆ«32G</p><a id="more"></a><p><img src="/img/sun/SUN_M4000_DOWN.png"></p><h1 id="2ã€æ•…éšœå…·ä½“æƒ…å†µ"><a href="#2ã€æ•…éšœå…·ä½“æƒ…å†µ" class="headerlink" title="2ã€æ•…éšœå…·ä½“æƒ…å†µ"></a>2ã€æ•…éšœå…·ä½“æƒ…å†µ</h1><pre><code>XSCF&gt; showstatus </code></pre><p>é”™è¯¯æ—¥å¿—</p><pre><code class="hljs bash">    MBU_A Status:Normal;        MEMB<span class="hljs-comment">#0 Status:Normal;</span>*           MEM<span class="hljs-comment">#0B Status:Deconfigured;</span>*           MEM<span class="hljs-comment">#1B Status:Deconfigured;</span>*           MEM<span class="hljs-comment">#2B Status:Deconfigured;</span>*           MEM<span class="hljs-comment">#3B Status:Deconfigured;</span>        MEMB<span class="hljs-comment">#1 Status:Normal;</span>*           MEM<span class="hljs-comment">#0B Status:Deconfigured;</span>*           MEM<span class="hljs-comment">#1B Status:Deconfigured;</span>*           MEM<span class="hljs-comment">#2B Status:Deconfigured;</span>*           MEM<span class="hljs-comment">#3B Status:Deconfigured;</span>        MEMB<span class="hljs-comment">#2 Status:Normal;</span>*           MEM<span class="hljs-comment">#0B Status:Deconfigured;</span>*           MEM<span class="hljs-comment">#1B Status:Deconfigured;</span>*           MEM<span class="hljs-comment">#2B Status:Deconfigured;</span>*           MEM<span class="hljs-comment">#3B Status:Deconfigured;</span>        MEMB<span class="hljs-comment">#3 Status:Normal;</span>*           MEM<span class="hljs-comment">#0B Status:Deconfigured;</span>*           MEM<span class="hljs-comment">#1B Status:Faulted;</span>*           MEM<span class="hljs-comment">#2B Status:Deconfigured;</span>*           MEM<span class="hljs-comment">#3B Status:Deconfigured;</span></code></pre><p>å®šä½å†…å­˜ä½ç½®ï¼š</p><p>å‘ç°MEMAä¸Šçš„å†…å­˜éƒ½ä¸ºæ­£å¸¸ï¼Œå†…å­˜MEMBä¸Šçš„å†…å­˜æŠ¥é”™ï¼ŒMEMB#3ä¸Šçš„MEM#1Bçš„çŠ¶æ€ä¸ºFaultedï¼Œè¯´æ˜è¿™æ ¹å†…å­˜æŸåï¼Œå…¶ä»–å†…å­˜å—å…¶å½±å“å¯¼è‡´é™çº§ã€‚<br>(å›¾æ˜¯M5000æœºå™¨)<br><img src="/img/sun/m5000_mem.png"></p><h1 id="3ã€æ•…éšœåˆ†æåŠå¤„ç†"><a href="#3ã€æ•…éšœåˆ†æåŠå¤„ç†" class="headerlink" title="3ã€æ•…éšœåˆ†æåŠå¤„ç†"></a>3ã€æ•…éšœåˆ†æåŠå¤„ç†</h1><ol><li><p>å…ˆå°†æœºå™¨ä¸‹ç”µ</p><p> XSCF&gt; shutdown -g0 -y<br>ç¡®è®¤ç”µæºå·²å…³é—­</p><p> XSCF&gt; poweroff -a<br>æˆ–è€… <code>XSCF&gt;poweroff -d 00</code>å…³é—­ç”µæº</p></li><li><p>æ ¹æ®ä¸Šå›¾æ‰¾åˆ°å†…å­˜å…·ä½“ä½ç½®</p></li><li><p>æ›´æ¢çŠ¶æ€ä¸ºFaultedçš„å†…å­˜</p></li><li><p>é‡æ–°ä¸Šç”µï¼ŒæŸ¥çœ‹æœºå™¨çŠ¶æ€</p></li></ol><pre><code class="hljs bash">XSCF&gt; poweron -d 00XSCF&gt; showstatusNo failures found <span class="hljs-keyword">in</span> System Initialization.</code></pre><p>5.æŸ¥çœ‹æ‰€æœ‰å†…å­˜æ˜¯å¦è¯†åˆ«åˆ°</p><pre><code class="hljs bash">XSCF&gt; showhardconf</code></pre><h1 id="4ã€æ€»ç»“"><a href="#4ã€æ€»ç»“" class="headerlink" title="4ã€æ€»ç»“"></a>4ã€æ€»ç»“</h1><p>1.æ›´æ¢å†…å­˜ï¼Œå¿…é¡»å…ˆå°†æœºå™¨ä¸‹ç”µã€‚</p><p>2.ç”±äºæœºå™¨å¤ªé‡ï¼ˆ~80kgï¼‰ï¼Œéœ€è¦å¤šäººé…åˆã€‚</p>]]></content>
    
    
    <categories>
      
      <category>è¿ç»´</category>
      
    </categories>
    
    
    <tags>
      
      <tag>è¿ç»´</tag>
      
    </tags>
    
  </entry>
  
  
  
  
</search>
